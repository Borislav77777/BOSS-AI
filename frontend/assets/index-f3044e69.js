var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,l=(e,t)=>{for(var s in t||(t={}))n.call(t,s)&&o(e,s,t[s]);if(i)for(var s of i(t))a.call(t,s)&&o(e,s,t[s]);return e},c=(e,r)=>t(e,s(r)),d=(e,t)=>{var s={};for(var r in e)n.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&i)for(var r of i(e))t.indexOf(r)<0&&a.call(e,r)&&(s[r]=e[r]);return s},m=(e,t,s)=>new Promise((r,i)=>{var n=e=>{try{o(s.next(e))}catch(t){i(t)}},a=e=>{try{o(s.throw(e))}catch(t){i(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,a);o((s=s.apply(e,t)).next())});import{u as h,j as u,m as p,A as g}from"./ui-6e69ec1b.js";import{a as x,r as v,R as f}from"./vendor-324528e4.js";var y,b,j=(y={"assets/index-f3044e69.js"(e){!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t={},s=x;t.createRoot=s.createRoot,t.hydrateRoot=s.hydrateRoot;const r=v.createContext(void 0);function i(){const e=v.useContext(r);return void 0===e?(console.warn("usePlatform called outside PlatformProvider, returning fallback context"),{state:{user:null,layout:{sidebarCollapsed:!1,sidebarWidth:300,chatVisible:!0,chatWidth:400,chatInputHeight:300,workspaceLayout:"grid",activeService:null,activeTool:null,activeSection:"workspace",activeSettingsCategory:"all",activeWidgetsCategory:[],chatType:"default",expandedTabsHeight:0},services:[],activeChat:null,workspaceItems:[],settings:{theme:"dark",fontSize:"medium",animations:!0,sidebarCollapsed:!1,useColoredText:!1,textColor:"#ffffff",accentsEnabled:!1,autoScroll:!0,hideChatFunctionButtons:!1,showTimestamps:!1},isLoading:!0,error:null,isInitialized:!1},dispatch:()=>{},switchService:()=>{},switchTool:()=>{},sendMessage:()=>m(this,null,function*(){}),createWorkspaceItem:()=>{},updateSettings:()=>{},toggleSidebar:()=>{},toggleChat:()=>{},setChatType:()=>{},switchSection:()=>{},setActiveSettingsCategory:()=>{},setExpandedTabsHeight:()=>{},toggleService:()=>{},executeServiceTool:()=>m(this,null,function*(){return{success:!1}})}):e}const n=new class{constructor(){this.serviceIntegrations=new Map,this.handlers=new Map,this.chatButtons=new Map,this.eventListeners={onMessageReceived:[],onResponseGenerated:[],onHandlerExecuted:[]}}registerServiceIntegration(e){this.serviceIntegrations.set(e.serviceId,e),e.handlers.forEach(e=>{this.handlers.set(e.id,e)}),e.chatButtons.forEach(e=>{this.chatButtons.set(e.id,e)}),console.log(`[ChatIntegration] Сервис ${e.serviceId} зарегистрирован`)}unregisterServiceIntegration(e){const t=this.serviceIntegrations.get(e);t&&(t.handlers.forEach(e=>{this.handlers.delete(e.id)}),t.chatButtons.forEach(e=>{this.chatButtons.delete(e.id)}),this.serviceIntegrations.delete(e),console.log(`[ChatIntegration] Сервис ${e} удален`))}registerHandler(e){this.handlers.set(e.id,e),console.log(`[ChatIntegration] Обработчик ${e.id} зарегистрирован`)}unregisterHandler(e){this.handlers.delete(e),console.log(`[ChatIntegration] Обработчик ${e} удален`)}getHandler(e){return this.handlers.get(e)||null}getAllHandlers(){return Array.from(this.handlers.values())}getServiceHandlers(e){return Array.from(this.handlers.values()).filter(t=>t.serviceId===e)}processMessage(e,t){return m(this,null,function*(){const s=[],r=this.findMatchingHandlers(e);for(const n of r)try{const r=yield this.executeHandler(n.id,e,t);s.push(r)}catch(i){console.error(`[ChatIntegration] Ошибка выполнения обработчика ${n.id}:`,i)}return s})}executeHandler(e,t,s){return m(this,null,function*(){const r=this.handlers.get(e);if(!r)throw new Error(`Обработчик ${e} не найден`);if(!r.isEnabled)throw new Error(`Обработчик ${e} отключен`);const i=Date.now();try{const n=yield r.handler(t,s),a=Date.now()-i;return n.metadata.processingTime=a,n.metadata.handlerId=e,this.eventListeners.onHandlerExecuted.forEach(e=>e(r,n)),this.eventListeners.onResponseGenerated.forEach(e=>e(n)),console.log(`[ChatIntegration] Обработчик ${e} выполнен за ${a}ms`),n}catch(n){throw console.error(`[ChatIntegration] Ошибка в обработчике ${e}:`,n),n}})}registerChatButton(e){this.chatButtons.set(e.id,e),console.log(`[ChatIntegration] Кнопка ${e.id} зарегистрирована`)}unregisterChatButton(e){this.chatButtons.delete(e),console.log(`[ChatIntegration] Кнопка ${e} удалена`)}getChatButtons(e){const t=Array.from(this.chatButtons.values());return e?t.filter(t=>t.serviceId===e):t}onMessageReceived(e){this.eventListeners.onMessageReceived.push(e)}onResponseGenerated(e){this.eventListeners.onResponseGenerated.push(e)}onHandlerExecuted(e){this.eventListeners.onHandlerExecuted.push(e)}syncWithChat(){console.log("[ChatIntegration] Синхронизация с чатом")}exportHandlers(e){return e?this.getServiceHandlers(e):this.getAllHandlers()}importHandlers(e){e.forEach(e=>{this.handlers.set(e.id,e)}),console.log(`[ChatIntegration] Импортировано ${e.length} обработчиков`)}findMatchingHandlers(e){const t=[];for(const s of this.handlers.values())s.isEnabled&&s.triggers.some(t=>e.toLowerCase().includes(t.toLowerCase()))&&t.push(s);return t.sort((e,t)=>t.priority-e.priority)}},a={},o=function(e,t,s){if(!t||0===t.length)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in a)return;a[e]=!0;const t=e.endsWith(".css"),i=t?'[rel="stylesheet"]':"";if(s)for(let s=r.length-1;s>=0;s--){const i=r[s];if(i.href===e&&(!t||"stylesheet"===i.rel))return}else if(document.querySelector(`link[href="${e}"]${i}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise((t,s)=>{n.addEventListener("load",t),n.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})};class y{constructor(){this.cache=new Map,this.loadingPromises=new Map}get(e){return this.cache.get(e)}set(e,t){this.cache.set(e,t)}isLoading(e){return this.loadingPromises.has(e)}setLoadingPromise(e,t){this.loadingPromises.set(e,t)}getLoadingPromise(e){return this.loadingPromises.get(e)}deleteLoadingPromise(e){this.loadingPromises.delete(e)}clear(){this.cache.clear(),this.loadingPromises.clear()}delete(e){this.cache.delete(e),this.loadingPromises.delete(e)}}const b=new class{constructor(){this.cache=new y,this.basePath="/services/modules/",this.configPath="/services/"}loadServiceConfig(e){return m(this,null,function*(){try{const t=yield fetch(`${this.configPath}${e}.json`);if(!t.ok)throw new Error(`Failed to load service config: ${t.statusText}`);return yield t.json()}catch(t){const s=t instanceof Error?t.message:"Неизвестная ошибка";console.error(`Error loading service config for ${e}:`,s);const r=new Error(`Failed to load service config for ${e}: ${s}`);throw t instanceof Error&&t.stack&&(r.stack=t.stack),r}})}loadServiceModule(e){return m(this,null,function*(){const t=this.cache.get(e);if(t)return t;const s=this.cache.getLoadingPromise(e);if(s)return s;const r=this.loadModuleFromPath(e);this.cache.setLoadingPromise(e,r);try{const t=yield r;return this.cache.set(e,t),this.cache.deleteLoadingPromise(e),t}catch(i){throw this.cache.deleteLoadingPromise(e),i}})}loadModuleFromPath(e){return m(this,null,function*(){try{const t=`${this.basePath}${e}/index.js`;{const e=yield fetch(t);if(!e.ok)throw new Error(`Failed to load module: ${e.statusText}`);const s=yield e.blob(),r=URL.createObjectURL(s);try{return(yield o(()=>import(r),[])).default}finally{URL.revokeObjectURL(r)}}}catch(t){return console.error(`Error loading service module ${e}:`,t),this.createFallbackModule(e)}})}createFallbackModule(e){return{initialize:()=>m(this,null,function*(){console.warn(`Service ${e} is using fallback module`)}),execute:(t,s)=>m(this,null,function*(){return console.warn(`Tool ${t} from service ${e} is not implemented`),{error:"Tool not implemented"}}),cleanup:()=>m(this,null,function*(){})}}preloadService(e){return m(this,null,function*(){try{yield this.loadServiceModule(e)}catch(t){console.warn(`Failed to preload service ${e}:`,t)}})}preloadServices(e){return m(this,null,function*(){const t=e.map(e=>this.preloadService(e));yield Promise.allSettled(t)})}unloadService(e){const t=this.cache.get(e);t&&t.cleanup&&t.cleanup().catch(t=>{console.error(`Error cleaning up service ${e}:`,t)}),this.cache.delete(e)}isServiceLoaded(e){return void 0!==this.cache.get(e)}isServiceLoading(e){return this.cache.isLoading(e)}getLoadedServices(){return Array.from(this.cache.cache.keys())}clearCache(){this.cache.clear()}setBasePath(e){this.basePath=e}setConfigPath(e){this.configPath=e}},j=new class{constructor(e={}){this.subscriptions=new Map,this.activeRequests=new Map,this.middleware=[],this.isRunningFlag=!1,this.eventBuffer=[],this.requestHandlers=new Map,this.config=l({maxConcurrentRequests:100,defaultTimeout:3e4,eventBufferSize:1e3,enableLogging:!0,enableMetrics:!0},e)}publish(e){if(!this.isRunningFlag)return this.log("ServiceBus не запущен, событие добавлено в буфер"),void this.eventBuffer.push(e);let t=e;for(const s of this.middleware.sort((e,t)=>e.priority-t.priority))if(s.beforeEvent){const r=s.beforeEvent(t);if(null===r)return void this.log(`Событие ${e.id} заблокировано middleware ${s.name}`);t=r}this.deliverEvent(t);for(const s of this.middleware.sort((e,t)=>e.priority-t.priority))s.afterEvent&&s.afterEvent(t);this.log(`Событие ${e.id} опубликовано`)}subscribe(e,t){const s=this.generateId(),r={id:s,eventType:e,handler:t,serviceId:"unknown",createdAt:new Date};return this.subscriptions.set(s,r),this.log(`Подписка ${s} создана для события ${e}`),s}unsubscribe(e){this.subscriptions.get(e)&&(this.subscriptions.delete(e),this.log(`Подписка ${e} удалена`))}request(e){return m(this,null,function*(){if(!this.isRunningFlag)throw new Error("ServiceBus не запущен");if(this.activeRequests.size>=this.config.maxConcurrentRequests)throw new Error("Превышен лимит одновременных запросов");let t=e;for(const i of this.middleware.sort((e,t)=>e.priority-t.priority))if(i.beforeRequest){const s=i.beforeRequest(t);if(null===s)throw new Error(`Запрос ${e.id} заблокирован middleware`);t=s}const s={id:e.id,method:e.method,source:e.source,target:e.target,status:"pending",createdAt:new Date};this.activeRequests.set(e.id,s);try{const r=`${e.target}:${e.method}`,i=this.requestHandlers.get(r);if(!i)throw new Error(`Обработчик для ${e.target}:${e.method} не найден`);const n=yield i(t);s.status="completed",s.completedAt=new Date;let a=n;for(const e of this.middleware.sort((e,t)=>e.priority-t.priority))if(e.afterResponse){const t=e.afterResponse(a);t&&(a=t)}return this.log(`Запрос ${e.id} выполнен успешно`),a}catch(r){return s.status="error",s.completedAt=new Date,this.log(`Ошибка выполнения запроса ${e.id}:`,r),{id:this.generateId(),requestId:e.id,success:!1,error:r instanceof Error?r.message:"Неизвестная ошибка",timestamp:new Date}}finally{this.activeRequests.delete(e.id)}})}respond(e,t,s){const r=`${e}:${t}`;this.requestHandlers.set(r,s),this.log(`Обработчик ${r} зарегистрирован`)}unrespond(e,t){const s=`${e}:${t}`;this.requestHandlers.delete(s),this.log(`Обработчик ${s} удален`)}addMiddleware(e){this.middleware.push(e),this.middleware.sort((e,t)=>e.priority-t.priority),this.log(`Middleware ${e.name} добавлен`)}removeMiddleware(e){const t=this.middleware.findIndex(t=>t.name===e);-1!==t&&(this.middleware.splice(t,1),this.log(`Middleware ${e} удален`))}start(){for(this.isRunningFlag=!0,this.log("ServiceBus запущен");this.eventBuffer.length>0;){const e=this.eventBuffer.shift();e&&this.publish(e)}}stop(){this.isRunningFlag=!1,this.log("ServiceBus остановлен")}isRunning(){return this.isRunningFlag}getSubscriptions(){return Array.from(this.subscriptions.values())}getActiveRequests(){return Array.from(this.activeRequests.values())}getMiddleware(){return[...this.middleware]}deliverEvent(e){const t=Array.from(this.subscriptions.values()).filter(t=>t.eventType===e.type||"*"===t.eventType);for(const r of t)try{r.handler(e)}catch(s){this.log(`Ошибка в обработчике события ${r.id}:`,s)}}generateId(){return`sb_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}log(e,...t){this.config.enableLogging&&console.log(`[ServiceBus] ${e}`,...t)}}({maxConcurrentRequests:100,defaultTimeout:3e4,eventBufferSize:1e3,enableLogging:!0,enableMetrics:!0});j.addMiddleware(new class{constructor(e=!0,t=!0){this.enableEventLogging=e,this.enableRequestLogging=t,this.name="LoggingMiddleware",this.priority=100}beforeEvent(e){return this.enableEventLogging&&console.log(`[ServiceBus] Событие: ${e.type} от ${e.source}`,{id:e.id,data:e.data,timestamp:e.timestamp}),e}afterEvent(e){return this.enableEventLogging&&console.log(`[ServiceBus] Событие ${e.id} доставлено`),e}beforeRequest(e){return this.enableRequestLogging&&console.log(`[ServiceBus] Запрос: ${e.method} от ${e.source} к ${e.target}`,{id:e.id,params:e.params,timestamp:e.timestamp}),e}afterResponse(e){return this.enableRequestLogging&&console.log(`[ServiceBus] Ответ: ${e.requestId}`,{success:e.success,data:e.data,error:e.error,timestamp:e.timestamp}),e}}),j.addMiddleware(new class{constructor(e=!1){this.strictMode=e,this.name="ValidationMiddleware",this.priority=50}beforeEvent(e){return e.id&&e.type&&e.source?this.isValidEventType(e.type)?e.data&&"object"!=typeof e.data?(console.error("[ServiceBus] Данные события должны быть объектом"),null):e:(console.error(`[ServiceBus] Невалидный тип события: ${e.type}`),null):(console.error("[ServiceBus] Невалидное событие: отсутствуют обязательные поля"),null)}afterEvent(e){return e}beforeRequest(e){return e.id&&e.method&&e.source&&e.target?this.isValidMethod(e.method)?e.params&&"object"!=typeof e.params?(console.error("[ServiceBus] Параметры запроса должны быть объектом"),null):e:(console.error(`[ServiceBus] Невалидный метод: ${e.method}`),null):(console.error("[ServiceBus] Невалидный запрос: отсутствуют обязательные поля"),null)}afterResponse(e){return"boolean"!=typeof e.success?(console.error("[ServiceBus] Поле success в ответе должно быть булевым"),null):(e.success||e.error||console.warn("[ServiceBus] Неуспешный ответ без описания ошибки"),e)}isValidEventType(e){return["service.registered","service.unregistered","service.activated","service.deactivated","service.error","data.changed","user.action","system.notification"].includes(e)||e.startsWith("custom.")}isValidMethod(e){return["get","set","create","update","delete","execute","process","validate","transform"].includes(e)||e.includes(".")}}),j.addMiddleware(new class{constructor(e=[],t=[],s=[],r=[]){this.allowedSources=e,this.blockedSources=t,this.allowedMethods=s,this.blockedMethods=r,this.name="SecurityMiddleware",this.priority=10}beforeEvent(e){return this.blockedSources.includes(e.source)?(console.warn(`[ServiceBus] Событие заблокировано: источник ${e.source} в черном списке`),null):this.allowedSources.length>0&&!this.allowedSources.includes(e.source)?(console.warn(`[ServiceBus] Событие заблокировано: источник ${e.source} не в белом списке`),null):e.ttl&&e.ttl<Date.now()-e.timestamp.getTime()?(console.warn(`[ServiceBus] Событие ${e.id} истекло`),null):(e.data&&(e.data=this.sanitizeData(e.data)),e)}afterEvent(e){return e}beforeRequest(e){return this.blockedSources.includes(e.source)?(console.warn(`[ServiceBus] Запрос заблокирован: источник ${e.source} в черном списке`),null):this.allowedSources.length>0&&!this.allowedSources.includes(e.source)?(console.warn(`[ServiceBus] Запрос заблокирован: источник ${e.source} не в белом списке`),null):this.blockedMethods.includes(e.method)?(console.warn(`[ServiceBus] Запрос заблокирован: метод ${e.method} в черном списке`),null):this.allowedMethods.length>0&&!this.allowedMethods.includes(e.method)?(console.warn(`[ServiceBus] Запрос заблокирован: метод ${e.method} не в белом списке`),null):(e.params&&(e.params=this.sanitizeData(e.params)),e)}afterResponse(e){return e.data&&(e.data=this.sanitizeData(e.data)),e}sanitizeData(e){if("string"==typeof e)return e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");if(Array.isArray(e))return e.map(e=>this.sanitizeData(e));if(e&&"object"==typeof e){const t={};for(const[s,r]of Object.entries(e))s.startsWith("__")||s.includes("prototype")||s.includes("constructor")||(t[s]=this.sanitizeData(r));return t}return e}}),j.start();const w=new class{constructor(){this.channels=new Map,this.messages=new Map,this.subscriptions=new Map,this.serviceStatuses=new Map,this.serviceData=new Map,this.isRunningFlag=!1,this.eventListeners={onMessageReceived:[],onChannelCreated:[],onChannelDestroyed:[],onServiceJoined:[],onServiceLeft:[]}}createChannel(e,t,s){const r={id:this.generateId(),name:e,type:t,participants:s,isActive:!0,metadata:{createdAt:new Date,lastActivity:new Date,messageCount:0}};return this.channels.set(r.id,r),this.messages.set(r.id,[]),this.eventListeners.onChannelCreated.forEach(e=>e(r)),console.log(`[ServiceCommunication] Создан канал ${e} (${t})`),r}joinChannel(e,t){const s=this.channels.get(e);return!!s&&(s.participants.includes(t)||(s.participants.push(t),this.eventListeners.onServiceJoined.forEach(s=>s(e,t)),console.log(`[ServiceCommunication] Сервис ${t} подключен к каналу ${e}`)),!0)}leaveChannel(e,t){const s=this.channels.get(e);if(!s)return!1;const r=s.participants.indexOf(t);return-1!==r&&(s.participants.splice(r,1),this.eventListeners.onServiceLeft.forEach(s=>s(e,t)),console.log(`[ServiceCommunication] Сервис ${t} отключен от канала ${e}`)),!0}getChannel(e){return this.channels.get(e)||null}getServiceChannels(e){return Array.from(this.channels.values()).filter(t=>t.participants.includes(e))}sendMessage(e){return m(this,null,function*(){if(!this.isRunningFlag)return console.warn("[ServiceCommunication] Менеджер не запущен"),!1;const t=this.channels.get(e.channelId);if(!t)return console.error(`[ServiceCommunication] Канал ${e.channelId} не найден`),!1;if(!t.participants.includes(e.senderId))return console.error(`[ServiceCommunication] Сервис ${e.senderId} не имеет доступа к каналу ${e.channelId}`),!1;const s=this.messages.get(e.channelId)||[];return s.push(e),this.messages.set(e.channelId,s),t.metadata.lastActivity=new Date,t.metadata.messageCount++,this.notifySubscribers(e),this.eventListeners.onMessageReceived.forEach(t=>t(e)),console.log(`[ServiceCommunication] Сообщение отправлено в канал ${e.channelId}`),!0})}sendDirectMessage(e,t,s="message"){return m(this,null,function*(){const r={id:this.generateId(),channelId:"direct",senderId:"system",recipientId:e,type:s,content:t,timestamp:new Date,priority:"normal",metadata:{tags:["direct"],correlationId:this.generateId()}};return yield this.sendMessage(r)})}broadcastMessage(e,t="notification"){return m(this,null,function*(){const s={id:this.generateId(),channelId:"broadcast",senderId:"system",type:t,content:e,timestamp:new Date,priority:"normal",metadata:{tags:["broadcast"]}};return yield this.sendMessage(s)})}multicastMessage(e,t,s="message"){return m(this,null,function*(){const e={id:this.generateId(),channelId:"multicast",senderId:"system",type:s,content:t,timestamp:new Date,priority:"normal",metadata:{tags:["multicast"]}};return yield this.sendMessage(e)})}getMessages(e,t){const s=this.messages.get(e)||[];return t?s.slice(-t):s}getServiceMessages(e,t){const s=[];for(const r of this.messages.values()){const t=r.filter(t=>t.senderId===e||t.recipientId===e);s.push(...t)}return t?s.slice(-t):s}getUnreadCount(e){return 0}subscribeToChannel(e,t,s){const r=this.generateId();return this.subscriptions.set(r,{serviceId:t,callback:s}),console.log(`[ServiceCommunication] Сервис ${t} подписан на канал ${e}`),r}subscribeToService(e,t){const s=this.generateId();return this.subscriptions.set(s,{serviceId:e,callback:t}),console.log(`[ServiceCommunication] Подписка на сервис ${e}`),s}unsubscribe(e){this.subscriptions.delete(e),console.log(`[ServiceCommunication] Подписка ${e} удалена`)}onMessageReceived(e){this.eventListeners.onMessageReceived.push(e)}onChannelCreated(e){this.eventListeners.onChannelCreated.push(e)}onChannelDestroyed(e){this.eventListeners.onChannelDestroyed.push(e)}onServiceJoined(e){this.eventListeners.onServiceJoined.push(e)}onServiceLeft(e){this.eventListeners.onServiceLeft.push(e)}getServiceStatus(e){const t=this.serviceStatuses.get(e);return t?t.status:"offline"}setServiceStatus(e,t){this.serviceStatuses.set(e,{serviceId:e,status:t,lastSeen:new Date,capabilities:[],metadata:{}}),console.log(`[ServiceCommunication] Статус сервиса ${e}: ${t}`)}getOnlineServices(){return Array.from(this.serviceStatuses.values()).filter(e=>"online"===e.status).map(e=>e.serviceId)}syncServiceData(e,t){this.serviceData.set(e,t),console.log(`[ServiceCommunication] Данные сервиса ${e} синхронизированы`)}getServiceData(e){return this.serviceData.get(e)}subscribeToServiceData(e,t){const s=this.generateId();return console.log(`[ServiceCommunication] Подписка на данные сервиса ${e}`),s}start(){this.isRunningFlag=!0,console.log("[ServiceCommunication] Менеджер запущен")}stop(){this.isRunningFlag=!1,console.log("[ServiceCommunication] Менеджер остановлен")}isRunning(){return this.isRunningFlag}getStats(){return{totalChannels:this.channels.size,totalMessages:Array.from(this.messages.values()).reduce((e,t)=>e+t.length,0),activeServices:this.getOnlineServices().length,onlineServices:this.getOnlineServices(),messageRate:0,averageLatency:0,errorRate:0}}notifySubscribers(e){for(const s of this.subscriptions.values())if(s.serviceId===e.senderId||s.serviceId===e.recipientId||"broadcast"===e.channelId)try{s.callback(e)}catch(t){console.error("[ServiceCommunication] Ошибка в обработчике подписки:",t)}}generateId(){return`sc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}};w.start();class N{constructor(){this.PLATFORM_VERSION="1.0.0",this.REQUIRED_FIELDS=["id","name","version","category"],this.VALID_CATEGORIES=["ai","utility","communication","productivity","entertainment","system","settings","file","time","transcription","chat","rewrite","summary","translation","commands","create","upload","search","organize","analysis","generation","actions"],this.VALID_ICONS=["Bot","Settings","FileText","MessageCircle","Clock","Mic","Search","Download","Upload","Edit","Trash","Save","Share","Copy","Paste","Cut","Undo","Redo","Play","Pause","Stop","Volume","VolumeX","Volume1","Volume2","Volume3","Volume4","Volume5","Volume6","Volume7","Volume8","Volume9","Volume10","Volume11","Volume12","Volume13","Volume14","Volume15","Volume16","Volume17","Volume18","Volume19","Volume20","Volume21","Volume22","Volume23","Volume24","Volume25","Volume26","Volume27","Volume28","Volume29","Volume30","Grid","Cog","Monitor","Plus","Minus","Check","X","Alert","Info","Warning","Error","Success","List","Layout","Palette","Zap","Lightning","Smile","BarChart3"]}validateService(e){const t=[],s=[],r=[];return this.validateRequiredFields(e,t),this.validateDataTypes(e,t),this.validateValues(e,t,s),this.validateTools(e,t,s),this.validateSettings(e,t,s),this.validateChatButtons(e,t,s),this.validateTheme(e,t,s),e.dependencies&&Array.isArray(e.dependencies)&&e.dependencies.forEach(e=>{"string"!=typeof e?t.push(`Зависимость должна быть строкой: ${e}`):""===e.trim()?t.push("Пустая зависимость недопустима"):this.isValidServiceId(e)||s.push(`Некорректный ID зависимости: ${e}`)}),this.generateSuggestions(e,r),{isValid:0===t.length,errors:t,warnings:s,suggestions:r}}validateDependencies(e){const t=[],s=[];return e.dependencies&&Array.isArray(e.dependencies)&&e.dependencies.forEach(e=>{"string"!=typeof e?t.push(`Зависимость должна быть строкой: ${e}`):""===e.trim()?t.push("Пустая зависимость недопустима"):this.isValidServiceId(e)||s.push(`Некорректный ID зависимости: ${e}`)}),{isValid:0===t.length,errors:t,warnings:s,suggestions:[]}}checkConflicts(e,t){const s=[];t.find(t=>t.id===e.id)&&s.push(`Сервис с ID '${e.id}' уже зарегистрирован`);const r=t.find(t=>t.priority===e.priority);r&&s.push(`Сервис '${r.name}' уже использует приоритет ${e.priority}`);const i=t.find(t=>t.icon===e.icon);return i&&s.push(`Сервис '${i.name}' уже использует иконку '${e.icon}'`),s}validateRequiredFields(e,t){this.REQUIRED_FIELDS.forEach(s=>{s in e&&void 0!==e[s]||t.push(`Отсутствует обязательное поле: ${s}`)})}validateDataTypes(e,t){"string"!=typeof e.id&&t.push("Поле id должно быть строкой"),"string"!=typeof e.name&&t.push("Поле name должно быть строкой"),"string"!=typeof e.version&&t.push("Поле version должно быть строкой"),"string"!=typeof e.category&&t.push("Поле category должно быть строкой"),"boolean"!=typeof e.isActive&&t.push("Поле isActive должно быть булевым"),"number"!=typeof e.priority&&t.push("Поле priority должно быть числом"),Array.isArray(e.tools)||t.push("Поле tools должно быть массивом"),Array.isArray(e.dependencies)||t.push("Поле dependencies должно быть массивом")}validateValues(e,t,s){e.id&&!this.isValidServiceId(e.id)&&t.push("ID сервиса должен содержать только буквы, цифры, дефисы и подчеркивания"),e.version&&!this.isValidVersion(e.version)&&t.push("Версия должна быть в формате semver (например, 1.0.0)"),e.category&&!this.VALID_CATEGORIES.includes(e.category)&&s.push(`Неизвестная категория: ${e.category}. Рекомендуемые: ${this.VALID_CATEGORIES.join(", ")}`),e.icon&&!this.VALID_ICONS.includes(e.icon)&&s.push(`Неизвестная иконка: ${e.icon}. Рекомендуемые: ${this.VALID_ICONS.slice(0,10).join(", ")}...`),(e.priority<0||e.priority>1e3)&&s.push("Приоритет должен быть от 0 до 1000")}validateTools(e,t,s){Array.isArray(e.tools)&&e.tools.forEach((e,r)=>{e.id||t.push(`Инструмент ${r}: отсутствует ID`),e.name||t.push(`Инструмент ${r}: отсутствует название`),e.description||s.push(`Инструмент ${r}: отсутствует описание`),e.icon||s.push(`Инструмент ${r}: отсутствует иконка`),"boolean"!=typeof e.isEnabled&&t.push(`Инструмент ${r}: isEnabled должно быть булевым`)})}validateSettings(e,t,s){e.settings&&"object"!=typeof e.settings&&t.push("Настройки должны быть объектом")}validateChatButtons(e,t,s){e.chatButtons&&(Array.isArray(e.chatButtons)?e.chatButtons.forEach((e,s)=>{e.id||t.push(`Кнопка чата ${s}: отсутствует ID`),e.name||t.push(`Кнопка чата ${s}: отсутствует название`),e.action||t.push(`Кнопка чата ${s}: отсутствует действие`),e.position&&!["top","bottom"].includes(e.position)&&t.push(`Кнопка чата ${s}: неверная позиция '${e.position}'`)}):t.push("chatButtons должно быть массивом"))}validateTheme(e,t,s){e.theme&&(e.theme.id||t.push("Тема сервиса: отсутствует ID"),e.theme.name||t.push("Тема сервиса: отсутствует название"),e.theme.colors||s.push("Тема сервиса: отсутствуют цвета"))}generateSuggestions(e,t){(!e.description||e.description.length<10)&&t.push("Добавьте более подробное описание сервиса"),e.author||t.push("Укажите автора сервиса"),e.tools&&0===e.tools.length&&t.push("Добавьте хотя бы один инструмент"),e.chatButtons&&0!==e.chatButtons.length||t.push("Добавьте кнопки для чата для лучшей интеграции"),e.theme||t.push("Добавьте тему для улучшения внешнего вида"),0===e.priority&&t.push("Установите приоритет для правильной сортировки")}isValidServiceId(e){return/^[a-zA-Z0-9_-]+$/.test(e)}isValidVersion(e){return/^\d+\.\d+\.\d+$/.test(e)}}const k=new class{constructor(){this.services=new Map,this.eventListeners={onServiceRegistered:[],onServiceUnregistered:[],onServiceActivated:[],onServiceDeactivated:[]},this.validator=new N}registerService(e){return m(this,null,function*(){const t=this.validator.validateService(e);if(!t.isValid)return t;const s=Array.from(this.services.values()).map(e=>e.config),r=this.validator.checkConflicts(e,s);if(r.length>0)return{isValid:!1,errors:r,warnings:t.warnings,suggestions:t.suggestions};const i=this.extractCapabilities(e),n=this.extractDependencies(e),a={config:e,capabilities:i,dependencies:n,isRegistered:!0,isActive:e.isActive||!1,lastUpdated:new Date,metadata:{author:e.author||"Unknown",license:"MIT",repository:void 0,documentation:void 0}};return this.services.set(e.id,a),this.eventListeners.onServiceRegistered.forEach(e=>e(a)),{isValid:!0,errors:[],warnings:t.warnings,suggestions:t.suggestions}})}unregisterService(e){return m(this,null,function*(){if(!this.services.get(e))return!1;const t=this.getDependentServices(e);return t.length>0?(console.warn(`Нельзя удалить сервис ${e}: от него зависят ${t.join(", ")}`),!1):(this.services.delete(e),this.eventListeners.onServiceUnregistered.forEach(t=>t(e)),!0)})}clearRegistry(){return m(this,null,function*(){console.log("[ServiceRegistry] Очистка реестра сервисов"),this.services.clear(),this.eventListeners={onServiceRegistered:[],onServiceUnregistered:[],onServiceActivated:[],onServiceDeactivated:[]}})}getService(e){return this.services.get(e)||null}getAllServices(){return Array.from(this.services.values())}getServicesByCategory(e){return Array.from(this.services.values()).filter(t=>t.config.category===e)}getServiceCapabilities(e){const t=this.services.get(e);return t?t.capabilities:null}validateService(e){return this.validator.validateService(e)}validateDependencies(e){const t=this.services.get(e);if(!t)return{isValid:!1,errors:[`Сервис ${e} не найден`],warnings:[],suggestions:[]};const s=[],r=[];return t.dependencies.forEach(e=>{const t=this.services.get(e.serviceId);t?t.isActive||(e.optional?r.push(`Опциональная зависимость ${e.serviceId} неактивна`):s.push(`Обязательная зависимость ${e.serviceId} неактивна`)):e.optional?r.push(`Опциональная зависимость ${e.serviceId} не найдена`):s.push(`Обязательная зависимость ${e.serviceId} не найдена`)}),{isValid:0===s.length,errors:s,warnings:r,suggestions:[]}}checkConflicts(e){const t=this.services.get(e);if(!t)return[];const s=Array.from(this.services.values()).filter(t=>t.config.id!==e).map(e=>e.config);return this.validator.checkConflicts(t.config,s)}getServiceDependencies(e){const t=this.services.get(e);return t?t.dependencies:[]}getDependentServices(e){const t=[];return this.services.forEach((s,r)=>{r!==e&&s.dependencies.some(t=>t.serviceId===e)&&t.push(r)}),t}resolveDependencyTree(e){const t=[],s=new Set,r=e=>{if(s.has(e))return;s.add(e);const i=this.services.get(e);i&&(i.dependencies.forEach(e=>{r(e.serviceId)}),t.push(e))};return r(e),t}isServiceRegistered(e){return this.services.has(e)}isServiceActive(e){const t=this.services.get(e);return!!t&&t.isActive}activateService(e){return m(this,null,function*(){const t=this.services.get(e);if(!t)return!1;const s=this.validateDependencies(e);return s.isValid?(t.isActive=!0,t.config.isActive=!0,this.eventListeners.onServiceActivated.forEach(t=>t(e)),!0):(console.error(`Нельзя активировать сервис ${e}:`,s.errors),!1)})}deactivateService(e){return m(this,null,function*(){const t=this.services.get(e);if(!t)return!1;const s=this.getDependentServices(e);return s.length>0?(console.warn(`Нельзя деактивировать сервис ${e}: от него зависят ${s.join(", ")}`),!1):(t.isActive=!1,t.config.isActive=!1,this.eventListeners.onServiceDeactivated.forEach(t=>t(e)),!0)})}onServiceRegistered(e){this.eventListeners.onServiceRegistered.push(e)}onServiceUnregistered(e){this.eventListeners.onServiceUnregistered.push(e)}onServiceActivated(e){this.eventListeners.onServiceActivated.push(e)}onServiceDeactivated(e){this.eventListeners.onServiceDeactivated.push(e)}extractCapabilities(e){return{id:e.id,name:e.name,version:e.version,category:e.category,capabilities:{settings:!!e.settings,workspace:!1,chat:!!(e.chatButtons&&e.chatButtons.length>0),widgets:"widgets"===e.category,api:!!e.chatApiBaseUrl,events:!1},dependencies:e.dependencies||[],conflicts:[],requirements:{minPlatformVersion:"1.0.0",nodeVersion:">=16.0.0",browserSupport:["Chrome","Firefox","Safari","Edge"]}}}extractDependencies(e){return e.dependencies?e.dependencies.map(e=>({serviceId:e,version:"latest",optional:!1,description:`Зависимость от сервиса ${e}`})):[]}};class S{static validateColorScheme(e){const t=[],s=[];for(const i of this.REQUIRED_COLOR_KEYS)e[i]?this.isValidColor(e[i])||t.push(`Некорректный формат цвета для ${i}: ${e[i]}`):t.push(`Отсутствует обязательный цвет: ${i}`);const r=Object.entries(e).filter(([e])=>!this.REQUIRED_COLOR_KEYS.includes(e));for(const[i,n]of r)n&&!this.isValidColor(n)&&s.push(`Некорректный формат дополнительного цвета ${i}: ${n}`);return{isValid:0===t.length,errors:t,warnings:s.length>0?s:void 0}}static validateServiceTheme(e){const t=[],s=[];if(e.id?/^[a-zA-Z0-9-_]+$/.test(e.id)||t.push("ID темы содержит недопустимые символы"):t.push("Отсутствует ID темы"),e.name||t.push("Отсутствует название темы"),e.colors){const r=this.validateColorScheme(e.colors);t.push(...r.errors),r.warnings&&s.push(...r.warnings)}else t.push("Отсутствует цветовая схема");if(e.variables)for(const[r,i]of Object.entries(e.variables))this.VALID_CSS_VARIABLE_PATTERN.test(r)||t.push(`Некорректное имя CSS переменной: ${r}`),"string"!=typeof i&&t.push(`CSS переменная ${r} должна быть строкой`);if(e.animations)for(const[r,i]of Object.entries(e.animations))this.VALID_ANIMATION_PATTERN.test(r)||t.push(`Некорректное имя анимации: ${r}`),"string"!=typeof i&&t.push(`Анимация ${r} должна быть строкой`);return{isValid:0===t.length,errors:t,warnings:s.length>0?s:void 0}}static validateCSSVariable(e,t){const s=[];return this.VALID_CSS_VARIABLE_PATTERN.test(e)||s.push(`Некорректное имя CSS переменной: ${e}`),"string"!=typeof t&&s.push("Значение CSS переменной должно быть строкой"),{isValid:0===s.length,errors:s}}static isValidColor(e){if("string"!=typeof e)return!1;for(const s of this.VALID_COLOR_FORMATS)if(s.test(e))return!0;try{const t=(new Option).style;return t.color=e,""!==t.color}catch(t){return!1}}static validateAnimation(e,t){const s=[];return this.VALID_ANIMATION_PATTERN.test(e)||s.push(`Некорректное имя анимации: ${e}`),"string"!=typeof t&&s.push("Значение анимации должно быть строкой"),{isValid:0===s.length,errors:s}}static validateThemeConfig(e){const t=[];if(!e||"object"!=typeof e)return t.push("Конфигурация темы должна быть объектом"),{isValid:!1,errors:t};const s=e;return s.id&&"string"==typeof s.id||t.push("Отсутствует или некорректный ID темы"),s.name&&"string"==typeof s.name||t.push("Отсутствует или некорректное название темы"),{isValid:0===t.length,errors:t}}}S.VALID_COLOR_FORMATS=[/^#[0-9A-Fa-f]{3}$/,/^#[0-9A-Fa-f]{6}$/,/^#[0-9A-Fa-f]{8}$/,/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/,/^rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d.]+\s*\)$/,/^hsl\(\s*\d+\s*,\s*\d+%\s*,\s*\d+%\s*\)$/,/^hsla\(\s*\d+\s*,\s*\d+%\s*,\s*\d+%\s*,\s*[\d.]+\s*\)$/,/^var\(--[a-zA-Z0-9-]+\)$/,/^theme\(['"][^'"]+['"]\)$/],S.REQUIRED_COLOR_KEYS=["primary","secondary","accent","background","text","border"],S.VALID_CSS_VARIABLE_PATTERN=/^--[a-zA-Z0-9-]+$/,S.VALID_ANIMATION_PATTERN=/^[a-zA-Z0-9-]+$/;class C{constructor(){this.changeQueue=[],this.isProcessing=!1,this.processingTimeout=null,this.config={defaultTheme:"dark",enableBatching:!0,enableValidation:!0,enableServiceThemes:!0,batchDelay:16},this.state={currentTheme:this.config.defaultTheme,serviceThemes:new Map,isProcessing:!1,changeQueue:[],listeners:new Set},this.initializeDefaultThemes()}static getInstance(){return C.instance||(C.instance=new C),C.instance}initializeDefaultThemes(){this.registerServiceTheme("light",{id:"light",name:"Светлая тема",description:"Классическая светлая тема",colors:{primary:"#000000",secondary:"#f3f4f6",accent:"#000000",background:"#ffffff",surface:"#ffffff",text:"#000000",textSecondary:"#000000",border:"rgba(0,0,0,0.12)",muted:"#000000",destructive:"#ef4444",success:"#10b981",warning:"#f59e0b",info:"#000000"},variables:{"--background":"#ffffff","--foreground":"#000000","--primary":"#000000","--secondary":"#f3f4f6","--muted":"#000000","--border":"rgba(0,0,0,0.12)"}}),this.registerServiceTheme("dark",{id:"dark",name:"Темная тема",description:"Современная темная тема",colors:{primary:"#000000",secondary:"#1a1a1a",accent:"#000000",background:"#000000",surface:"#1a1a1a",text:"#ffffff",textSecondary:"#ffffff",border:"rgba(255,255,255,0.10)",muted:"#ffffff",destructive:"#ef4444",success:"#10b981",warning:"#f59e0b",info:"#000000"},variables:{"--background":"#000000","--foreground":"#ffffff","--primary":"#ffffff","--secondary":"#1a1a1a","--muted":"#ffffff","--border":"rgba(255,255,255,0.10)"}})}setTheme(e){this.state.currentTheme!==e&&(this.state.currentTheme=e,this.applyTheme(),this.notifyListeners())}getCurrentTheme(){return this.state.currentTheme}registerServiceTheme(e,t){if(this.config.enableValidation){const s=S.validateServiceTheme(t);if(!s.isValid)return void console.error(`Ошибка валидации темы сервиса ${e}:`,s.errors)}this.state.serviceThemes.set(e,t)}unregisterServiceTheme(e){this.state.serviceThemes.delete(e)}getServiceTheme(e){if(e&&"string"==typeof e)return this.state.serviceThemes.get(e);console.warn("Invalid serviceId provided to getServiceTheme:",e)}getAllThemes(){const e=[];return e.push({id:"light",name:"Светлая",type:"light",isDefault:!1,version:"1.0.0",description:"Классическая светлая тема"},{id:"dark",name:"Темная",type:"dark",isDefault:!0,version:"1.0.0",description:"Современная темная тема"}),this.state.serviceThemes.forEach((t,s)=>{e.push({id:`service-${s}`,name:t.name,type:"service",isServiceTheme:!0,serviceId:s,version:t.version||"1.0.0",author:t.author,description:t.description})}),e}applyTheme(){const e=document.documentElement,t=this.state.currentTheme;e.setAttribute("data-theme",t),this.applyThemeVariables(t)}applyThemeVariables(e){const t=document.documentElement;let s;if(e.startsWith("service-")){const t=e.replace("service-","");s=this.state.serviceThemes.get(t)}else s=this.state.serviceThemes.get(e);s?(s.variables&&Object.entries(s.variables).forEach(([e,s])=>{t.style.setProperty(e,s)}),Object.entries(s.colors).forEach(([e,s])=>{t.style.setProperty(`--${e}`,s)}),s.animations&&Object.entries(s.animations).forEach(([e,s])=>{t.style.setProperty(`--animation-${e}`,s)})):console.warn(`Тема ${e} не найдена`)}queueThemeChange(e){this.config.enableBatching?(this.changeQueue.push(e),this.isProcessing||this.processChanges()):this.applyThemeChange(e)}processChanges(){if(this.isProcessing||0===this.changeQueue.length)return;this.isProcessing=!0;const e=this.groupChanges(this.changeQueue);this.batchApplyChanges(e),this.changeQueue=[],this.isProcessing=!1,this.notifyListeners()}groupChanges(e){const t={attributes:{},variables:{},animations:{}};return e.forEach(e=>{switch(e.type){case"theme":t.attributes["data-theme"]=e.value;break;case"color":case"variable":t.variables[e.key]=e.value;break;case"animation":t.animations[e.key]=e.value}}),t}batchApplyChanges(e){requestAnimationFrame(()=>{const t=document.documentElement;Object.entries(e.attributes).forEach(([e,s])=>{t.setAttribute(e,s)}),Object.entries(e.variables).forEach(([e,s])=>{t.style.setProperty(e,s)}),Object.entries(e.animations).forEach(([e,s])=>{t.style.setProperty(`--animation-${e}`,s)})})}applyThemeChange(e){const t=document.documentElement;switch(e.type){case"theme":t.setAttribute("data-theme",e.value);break;case"color":case"variable":t.style.setProperty(e.key,e.value);break;case"animation":t.style.setProperty(`--animation-${e.key}`,e.value)}}subscribe(e){return this.state.listeners.add(e),()=>{this.state.listeners.delete(e)}}notifyListeners(){const e=[...this.changeQueue];this.state.listeners.forEach(t=>{try{t(this.state.currentTheme,e)}catch(s){console.error("Ошибка в слушателе темы:",s)}})}updateConfig(e){this.config=l(l({},this.config),e)}getConfig(){return l({},this.config)}reset(){this.state.currentTheme=this.config.defaultTheme,this.state.serviceThemes.clear(),this.changeQueue=[],this.initializeDefaultThemes(),this.applyTheme()}getStats(){return{currentTheme:this.state.currentTheme,registeredThemes:this.state.serviceThemes.size,pendingChanges:this.changeQueue.length,listeners:this.state.listeners.size,isProcessing:this.state.isProcessing}}}const E=C.getInstance(),I=new class{constructor(){this.serviceIntegrations=new Map,this.workspaceItems=new Map,this.eventListeners={onItemCreated:[],onItemUpdated:[],onItemDeleted:[],onItemSelected:[]}}registerServiceIntegration(e){this.serviceIntegrations.set(e.serviceId,e),e.autoCreateItems&&e.workspaceItems.forEach(e=>{this.workspaceItems.set(e.id,e),this.eventListeners.onItemCreated.forEach(t=>t(e))}),console.log(`[WorkspaceIntegration] Сервис ${e.serviceId} зарегистрирован`)}unregisterServiceIntegration(e){const t=this.serviceIntegrations.get(e);t&&(t.workspaceItems.forEach(e=>{this.workspaceItems.delete(e.id),this.eventListeners.onItemDeleted.forEach(t=>t(e.id))}),this.serviceIntegrations.delete(e),console.log(`[WorkspaceIntegration] Сервис ${e} удален`))}createWorkspaceItem(e,t,s){const r=this.serviceIntegrations.get(e);if(!r)throw new Error(`Сервис ${e} не зарегистрирован`);const i=r.itemTemplates.find(e=>e.id===t);if(!i)throw new Error(`Шаблон ${t} не найден для сервиса ${e}`);const n=l({id:this.generateId(),name:i.name,type:i.type,icon:i.icon,description:i.description,content:s||i.template.content,metadata:{serviceId:e,createdAt:new Date,updatedAt:new Date,tags:i.tags,permissions:{read:!0,write:!0,delete:!0}}},i.template);return this.workspaceItems.set(n.id,n),this.eventListeners.onItemCreated.forEach(e=>e(n)),console.log(`[WorkspaceIntegration] Создан элемент ${n.name} для сервиса ${e}`),n}updateWorkspaceItem(e,t){const s=this.workspaceItems.get(e);if(!s)return!1;const r=c(l(l({},s),t),{metadata:c(l({},s.metadata),{updatedAt:new Date})});return this.workspaceItems.set(e,r),this.eventListeners.onItemUpdated.forEach(e=>e(r)),console.log(`[WorkspaceIntegration] Обновлен элемент ${e}`),!0}deleteWorkspaceItem(e){return!!this.workspaceItems.get(e)&&(this.workspaceItems.delete(e),this.eventListeners.onItemDeleted.forEach(t=>t(e)),console.log(`[WorkspaceIntegration] Удален элемент ${e}`),!0)}getWorkspaceItem(e){return this.workspaceItems.get(e)||null}getServiceItems(e){return Array.from(this.workspaceItems.values()).filter(t=>t.metadata.serviceId===e)}getAllItems(){return Array.from(this.workspaceItems.values())}getItemTemplates(e){const t=this.serviceIntegrations.get(e);return t?t.itemTemplates:[]}onItemCreated(e){this.eventListeners.onItemCreated.push(e)}onItemUpdated(e){this.eventListeners.onItemUpdated.push(e)}onItemDeleted(e){this.eventListeners.onItemDeleted.push(e)}onItemSelected(e){this.eventListeners.onItemSelected.push(e)}syncWithPlatform(){console.log("[WorkspaceIntegration] Синхронизация с платформой")}exportItems(e){return e?this.getServiceItems(e):this.getAllItems()}importItems(e){e.forEach(e=>{this.workspaceItems.set(e.id,e),this.eventListeners.onItemCreated.forEach(t=>t(e))}),console.log(`[WorkspaceIntegration] Импортировано ${e.length} элементов`)}generateId(){return`ws_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}},T=new class{constructor(){this.services=[],this.hasLoadedOnce=!1,this.isLoading=!1}validateAndNormalizeConfig(e){try{const t=l({},e);Array.isArray(t.tools)&&(t.tools=t.tools.map(e=>{const s=l({},e);return s.action||(s.action=s.id),s.action!==s.id&&console.warn(`[services] Tool action differs from id in service ${t.id}: tool.id='${s.id}', action='${s.action}'`),s})),Array.isArray(t.chatFunctions)&&(t.chatFunctions=t.chatFunctions.map(e=>{const s=l({},e);return s.id||console.warn(`[services] Chat function without id in service ${t.id}`),"action"in s&&s.action||(s.action=s.id),s.action&&s.id&&s.action!==s.id&&console.warn(`[services] Chat function action differs from id in service ${t.id}: id='${s.id}', action='${s.action}'`),s.isChatFunction=!0,s}));const s=new Set,r=new Set;return(t.tools||[]).forEach(e=>{s.add(e.id),r.add(e.action||e.id)}),(t.chatFunctions||[]).forEach(e=>{s.add(e.id),r.add(e.action||e.id)}),Array.isArray(t.chatButtons)&&(t.chatButtons=t.chatButtons.map(e=>{const i=l({},e);return i.isEnabled||!1===i.isEnabled||(i.isEnabled=!0),"top"!==i.position&&"bottom"!==i.position&&(void 0!==i.position&&console.warn(`[services] Invalid chatButton.position '${i.position}' in service ${t.id}, defaulting to 'top'`),i.position="top"),!i.action||s.has(i.action)||r.has(i.action)||console.warn(`[services] chatButton.action '${i.action}' not found in tools/chatFunctions of service ${t.id}`),i})),t}catch(t){return console.warn(`[services] Validation failed for service ${e.id}:`,t),e}}loadAllServices(){return m(this,null,function*(){try{if(this.isLoading)return void console.log("[ServiceManager] Загрузка сервисов уже в процессе, пропускаем");if(this.hasLoadedOnce&&this.services.length>0)return void console.log("[ServiceManager] Сервисы уже загружены, пропускаем повторную загрузку");this.isLoading=!0,console.log("[ServiceManager] Начинаем загрузку сервисов..."),this.services=[],yield k.clearRegistry();const t=["ai-assistant.json","example-service.json","file-manager.json","settings.json","chatgpt-service.json","widgets-service.json","prompts-service.json","real-speech-service.json"];for(const s of t)try{const e=yield fetch(`/services/${s}`);if(!e.ok){console.warn(`Файл сервиса ${s} не найден`);continue}const t=yield e.json(),r=this.validateAndNormalizeConfig(t),i=yield k.registerService(r);if(!i.isValid){console.error(`Ошибка регистрации сервиса ${r.id}:`,i.errors);continue}i.warnings.length>0&&console.warn(`Предупреждения для сервиса ${r.id}:`,i.warnings),i.suggestions.length>0&&console.info(`Предложения для сервиса ${r.id}:`,i.suggestions);const n={config:r,module:null,isLoaded:!1};this.services.some(e=>e.config.id===r.id)||(this.services.push(n),r.theme&&E.registerServiceTheme(r.id,r.theme))}catch(e){const t=e instanceof Error?e.message:"Неизвестная ошибка";console.error(`Ошибка загрузки сервиса ${s}:`,t),e instanceof Error&&e.stack&&console.error("Stack trace:",e.stack)}this.hasLoadedOnce=!0,console.log("[ServiceManager] Загрузка сервисов завершена успешно")}catch(e){console.error("Ошибка загрузки сервисов:",e)}finally{this.isLoading=!1}})}loadServiceFromFile(e){return m(this,null,function*(){try{const t=yield fetch(`/services/${e}`);if(!t.ok)throw new Error(`HTTP ${t.status}`);const s=yield t.json(),r={config:this.validateAndNormalizeConfig(s),module:null,isLoaded:!1};"settings"!==s.id&&"settings"!==s.category||this.services.push(r)}catch(t){console.error(`Ошибка загрузки сервиса ${e}:`,t)}})}loadService(e){return m(this,null,function*(){let t=this.services.find(t=>t.config.id===e);if(!t)try{const s=this.validateAndNormalizeConfig(yield b.loadServiceConfig(e));t={config:s,module:null,isLoaded:!1},this.services.push(t),s.theme&&E.registerServiceTheme(s.id,s.theme)}catch(s){throw console.error(`Не удалось загрузить конфигурацию сервиса ${e}:`,s),new Error(`Сервис ${e} не найден`)}if(!t.isLoaded)try{const s=yield b.loadServiceModule(e);s.initialize&&(yield s.initialize()),t.module=s,t.isLoaded=!0,t.error=void 0}catch(s){throw t.error=s instanceof Error?s.message:"Неизвестная ошибка",console.error(`Ошибка загрузки сервиса ${e}:`,s),s}})}unloadService(e){const t=this.services.find(t=>t.config.id===e);t&&(t.module&&t.module.cleanup&&t.module.cleanup().catch(t=>{console.error(`Ошибка при выгрузке сервиса ${e}:`,t)}),t.isLoaded=!1,t.module=null,b.unloadService(e))}getService(e){return this.services.find(t=>t.config.id===e)}getAllServices(){return this.services}executeTool(e,t,s){return m(this,null,function*(){const r=this.getService(e);if(!r)throw new Error(`Сервис ${e} не найден`);const i=r.config.tools.find(e=>e.id===t);if(!i)throw new Error(`Инструмент ${t} не найден в сервисе ${e}`);if(!i.isEnabled)throw new Error(`Инструмент ${t} отключен`);if(i.isChatFunction)return yield this.executeChatFunction(r,i,s);if(r.isLoaded||(yield this.loadService(e)),r.module&&r.module.execute)try{return yield r.module.execute(t,l(l({},i),s))}catch(n){throw console.error(`Ошибка выполнения инструмента ${t} через модуль:`,n),n}return{success:!0,message:`Инструмент ${i.name} выполнен`,data:null}})}executeChatFunction(e,t,s){return m(this,null,function*(){try{if(t.chatApiEndpoint&&e.config.chatApiBaseUrl){const r=yield fetch(`${e.config.chatApiBaseUrl}${t.chatApiEndpoint}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.config.chatApiKey||""}`},body:JSON.stringify(l({prompt:t.chatPrompt||t.description,serviceId:e.config.id,toolId:t.id},s))});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=yield r.json();return{success:!0,message:`Чат функция ${t.name} выполнена`,data:i,isChatResponse:!0}}return{success:!0,message:`Чат функция ${t.name} готова к выполнению`,data:{prompt:t.chatPrompt||t.description,serviceId:e.config.id,toolId:t.id},isChatResponse:!0}}catch(r){throw console.error(`Ошибка выполнения чат функции ${t.name}:`,r),r}})}getChatButtons(){const e=[];return this.services.filter(e=>e.config.isActive).forEach(t=>{t.config.chatButtons&&e.push(...t.config.chatButtons.filter(e=>e.isEnabled))}),e}validateAllServices(){try{this.services.forEach(e=>{e.config=this.validateAndNormalizeConfig(e.config)})}catch(e){console.warn("[services] Validation pass failed:",e)}}getChatButtonsGrouped(){const e=[],t=[];return this.services.filter(e=>e.config.isActive).forEach(s=>{const r=(s.config.chatButtons||[]).filter(e=>e.isEnabled);if(0===r.length)return;const i=r.filter(e=>"top"===(e.position||"top")),n=r.filter(e=>"bottom"===(e.position||"top"));i.length>0&&e.push({serviceId:s.config.id,serviceName:s.config.name,serviceIcon:s.config.icon,buttons:i}),n.length>0&&t.push({serviceId:s.config.id,serviceName:s.config.name,serviceIcon:s.config.icon,buttons:n})}),{top:e,bottom:t}}findChatFunctionInService(e,t){const s=(e.config.chatFunctions||[]).find(e=>e.isChatFunction&&e.isEnabled&&(e.id===t||e.action===t));return s||e.config.tools.find(e=>e.isChatFunction&&e.isEnabled&&(e.id===t||e.action===t))}executeChatButton(e,t,s){return m(this,null,function*(){const r=this.getService(e);if(!r)throw new Error(`Сервис ${e} не найден`);const i=this.findChatFunctionInService(r,t.action||t.id);return i?this.executeTool(r.config.id,i.id,s):{success:!1,message:`Не найдена чат-функция для кнопки ${t.name}`}})}getChatFunctions(){const e=[];return this.services.filter(e=>e.config.isActive&&e.isLoaded).forEach(t=>{t.config.chatFunctions&&e.push(...t.config.chatFunctions.filter(e=>e.isEnabled)),e.push(...t.config.tools.filter(e=>e.isChatFunction&&e.isEnabled))}),e}getActiveServices(){return this.services.filter(e=>e.config.isActive&&e.isLoaded)}getSortedServices(){return[...this.services].sort((e,t)=>e.config.priority-t.config.priority)}preloadService(e){return m(this,null,function*(){try{yield b.preloadService(e)}catch(t){console.warn(`Не удалось предзагрузить сервис ${e}:`,t)}})}preloadServices(e){return m(this,null,function*(){yield b.preloadServices(e)})}isServiceLoaded(e){const t=this.getService(e);return!!t&&t.isLoaded}isServiceLoading(e){return b.isServiceLoading(e)}getLoadedServices(){return this.services.filter(e=>e.isLoaded).map(e=>e.config.id)}getServiceInfo(e){return k.getService(e)}getServiceCapabilities(e){return k.getServiceCapabilities(e)}validateService(e){return k.validateService(e)}validateServiceDependencies(e){return k.validateDependencies(e)}getServicesByCategory(e){return k.getServicesByCategory(e)}activateService(e){return m(this,null,function*(){return yield k.activateService(e)})}deactivateService(e){return m(this,null,function*(){return yield k.deactivateService(e)})}onServiceRegistered(e){k.onServiceRegistered(t=>e(t.config))}onServiceUnregistered(e){k.onServiceUnregistered(e)}onServiceActivated(e){k.onServiceActivated(e)}onServiceDeactivated(e){k.onServiceDeactivated(e)}registerWorkspaceIntegration(e,t,s=!0){I.registerServiceIntegration({serviceId:e,workspaceItems:t,autoCreateItems:s,itemTemplates:[],eventHandlers:{onItemCreate:e=>{console.log(`[ServiceManager] Создан элемент Workspace: ${e.name}`)},onItemUpdate:e=>{console.log(`[ServiceManager] Обновлен элемент Workspace: ${e.name}`)},onItemDelete:e=>{console.log(`[ServiceManager] Удален элемент Workspace: ${e}`)},onItemSelect:e=>{console.log(`[ServiceManager] Выбран элемент Workspace: ${e.name}`)}}})}createWorkspaceItem(e,t,s){return I.createWorkspaceItem(e,t,s)}getServiceWorkspaceItems(e){return I.getServiceItems(e)}syncWorkspace(){I.syncWithPlatform()}registerChatIntegration(e,t,s){n.registerServiceIntegration({serviceId:e,handlers:t,chatButtons:s,autoRegister:!0,eventHandlers:{onMessageReceived:t=>{console.log(`[ServiceManager] Получено сообщение для сервиса ${e}:`,t)},onResponseGenerated:t=>{console.log(`[ServiceManager] Сгенерирован ответ для сервиса ${e}:`,t)},onHandlerExecuted:(t,s)=>{console.log(`[ServiceManager] Выполнен обработчик ${t.name} для сервиса ${e}`)}}})}getServiceChatButtons(e){return n.getChatButtons(e)}getServiceChatHandlers(e){return n.getServiceHandlers(e)}syncChat(){n.syncWithChat()}createServiceChannel(e,t,s){return w.createChannel(e,t,s)}sendServiceMessage(e,t,s="message"){return w.sendDirectMessage(e,t,s)}getServiceStatus(e){return w.getServiceStatus(e)}setServiceStatus(e,t){w.setServiceStatus(e,t)}syncServiceData(e,t){w.syncServiceData(e,t)}getServiceData(e){return w.getServiceData(e)}getServiceCommunicationStats(){return w.getStats()}publishEvent(e,t,s="ServiceManager"){j.publish({id:`sm_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:e,source:s,data:t,timestamp:new Date,priority:"normal"})}subscribeToEvents(e,t){return j.subscribe(e,t)}requestFromService(e,t,s){return m(this,null,function*(){const r=yield j.request({id:`sm_req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,method:t,params:s,source:"ServiceManager",target:e,timestamp:new Date});if(!r.success)throw new Error(r.error||"Неизвестная ошибка");return r.data})}registerServiceHandler(e,t,s){j.respond(e,t,e=>m(this,null,function*(){try{const t=yield s(e.params);return{id:`sm_resp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,requestId:e.id,success:!0,data:t,timestamp:new Date}}catch(t){return{id:`sm_resp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,requestId:e.id,success:!1,error:t instanceof Error?t.message:"Неизвестная ошибка",timestamp:new Date}}}))}},A=new class{constructor(){this.activeModes=new Map,this.availableModes=[],this.initializeModes()}initializeModes(){this.availableModes=[{id:"chatgpt-analysis",name:"Глубокое исследование",description:"Детальный анализ и исследование темы",icon:"Search",serviceId:"chatgpt-service",isActive:!1,priority:1,capabilities:["analysis","research","explanation"],promptTemplate:"Проведи глубокое исследование темы: {userInput}. Рассмотри все аспекты, приведи примеры и сделай выводы.",responseFormat:"markdown"},{id:"chatgpt-generation",name:"Генерация контента",description:"Создание текстов, идей и решений",icon:"Wand2",serviceId:"chatgpt-service",isActive:!1,priority:2,capabilities:["generation","creativity","writing"],promptTemplate:"Создай качественный контент на тему: {userInput}. Используй креативный подход и современные методы.",responseFormat:"text"},{id:"chatgpt-summary",name:"Краткое изложение",description:"Сжатие и структурирование информации",icon:"FileText",serviceId:"chatgpt-service",isActive:!1,priority:3,capabilities:["summarization","structuring","clarity"],promptTemplate:"Создай краткое и структурированное изложение: {userInput}. Выдели ключевые моменты.",responseFormat:"markdown"},{id:"ai-legal-consultation",name:"Юридическая консультация",description:"Правовые советы и анализ документов",icon:"Scale",serviceId:"ai-assistant",isActive:!1,priority:1,capabilities:["legal","analysis","advice"],promptTemplate:"Предоставь юридическую консультацию по вопросу: {userInput}. Укажи правовые нормы и рекомендации.",responseFormat:"markdown"},{id:"ai-contract-generation",name:"Создание договора",description:"Генерация правовых документов",icon:"FileText",serviceId:"ai-assistant",isActive:!1,priority:2,capabilities:["legal","generation","documents"],promptTemplate:"Создай договор на основе требований: {userInput}. Включи все необходимые пункты.",responseFormat:"text"},{id:"ai-task-creation",name:"Создание задачи",description:"Планирование и структурирование задач",icon:"CheckSquare",serviceId:"ai-assistant",isActive:!1,priority:3,capabilities:["planning","organization","productivity"],promptTemplate:"Создай структурированный план задач для: {userInput}. Разбей на этапы и приоритеты.",responseFormat:"markdown"}]}analyzeUserIntent(e){return m(this,null,function*(){const t=e.toLowerCase(),s=[],r={analysis:["анализ","исследование","изучить","разобрать","проанализировать"],generation:["создать","написать","сгенерировать","придумать","разработать"],legal:["юрист","право","договор","консультация","правовой","юридический"],planning:["план","задача","организовать","спланировать","структурировать"],summary:["кратко","суть","изложение","резюме","сжать"]};for(const[e,i]of Object.entries(r))if(i.some(e=>t.includes(e))){const t=this.availableModes.filter(t=>t.capabilities.some(t=>t.includes(e)));s.push(...t)}return 0===s.length&&s.push(this.availableModes.find(e=>"chatgpt-analysis"===e.id),this.availableModes.find(e=>"ai-legal-consultation"===e.id)),s.slice(0,3)})}activateMode(e,t){return m(this,null,function*(){const s=this.availableModes.find(t=>t.id===e);if(!s)throw new Error(`Режим ${e} не найден`);const r={modeId:e,serviceId:s.serviceId,activatedAt:new Date,context:{userInput:t},userIntent:t};return this.activeModes.set(e,r),s.isActive=!0,r})}processRequest(e,t){return m(this,null,function*(){if(!this.activeModes.get(e))throw new Error(`Режим ${e} не активирован`);const s=this.availableModes.find(t=>t.id===e);if(!s)throw new Error(`Режим ${e} не найден`);const r=yield T.executeChatButton(s.serviceId,{id:e,name:s.name,description:s.description,icon:s.icon,action:e,isEnabled:!0,color:"blue"});return{mode:s,response:"string"==typeof r?r:JSON.stringify(r),suggestions:this.generateSuggestions(s,t),nextActions:this.generateNextActions(s),confidence:.85}})}generateSuggestions(e,t){const s=[];return e.capabilities.includes("legal")&&(s.push("Нужна ли дополнительная правовая информация?"),s.push("Хотите создать документ на основе этого?")),e.capabilities.includes("analysis")&&(s.push("Углубиться в детали?"),s.push("Рассмотреть альтернативные подходы?")),e.capabilities.includes("generation")&&(s.push("Создать дополнительные варианты?"),s.push("Развить идею дальше?")),s}generateNextActions(e){const t=[];return e.capabilities.includes("legal")&&(t.push("Создать договор"),t.push("Найти похожие случаи")),e.capabilities.includes("analysis")&&(t.push("Создать диаграмму"),t.push("Экспортировать результаты")),t}getActiveModes(){return Array.from(this.activeModes.values())}deactivateMode(e){this.activeModes.delete(e);const t=this.availableModes.find(t=>t.id===e);t&&(t.isActive=!1)}getAvailableModes(){return this.availableModes}},M=new class{constructor(){this.context={attachedItems:[],userLocation:"workspace"},this.listeners=new Set,this.handleAttachContext=e=>{const t=e.detail;-1===this.context.attachedItems.findIndex(e=>e.id===t.id)&&(this.context.attachedItems.push(t),this.notifyListeners(),console.log(`Контекст прикреплен: ${t.type} - ${t.title}`))},this.handleDetachContext=e=>{const{id:t}=e.detail;this.context.attachedItems=this.context.attachedItems.filter(e=>e.id!==t),this.notifyListeners(),console.log(`Контекст удален: ${t}`)},this.handleWorkspaceNavigate=e=>{const{projectId:t}=e.detail,s=this.findProjectById(t);s&&(this.context.activeProject={id:s.id,title:s.title,type:"project"},this.context.userLocation="project",this.autoAttachActiveProject(),this.notifyListeners(),console.log(`Активный проект: ${s.title}`))},this.handleWorkspaceSendToChat=e=>{const{items:t}=e.detail;t.forEach(e=>{const t={id:e.id,type:"folder"===e.type?"project":"note"===e.type?"document":e.type,title:e.title,icon:e.emoji||"📄",content:e.content,metadata:{path:e.path,size:e.size,tags:e.tags,createdAt:e.createdAt,updatedAt:e.updatedAt},removable:!0,source:"workspace"};this.attachContext(t)})},this.initEventListeners()}initEventListeners(){window.addEventListener("chat:attach-context",this.handleAttachContext),window.addEventListener("chat:detach-context",this.handleDetachContext),window.addEventListener("workspace:navigate",this.handleWorkspaceNavigate),window.addEventListener("workspace:send-to-chat",this.handleWorkspaceSendToChat)}autoAttachActiveProject(){if(this.context.activeProject&&!this.context.attachedItems.find(e=>"project"===e.type&&e.id===this.context.activeProject.id)){const e={id:this.context.activeProject.id,type:"project",title:this.context.activeProject.title,icon:"📁",removable:!0,source:"workspace",metadata:{autoAttached:!0}};this.context.attachedItems.push(e)}}findProjectById(e){var t;return((null==(t=window.__PLATFORM_STATE__)?void 0:t.workspaceItems)||[]).find(t=>t.id===e&&"folder"===t.type)||null}attachContext(e){window.dispatchEvent(new CustomEvent("chat:attach-context",{detail:e}))}detachContext(e){window.dispatchEvent(new CustomEvent("chat:detach-context",{detail:{id:e}}))}getContext(){return l({},this.context)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){this.listeners.forEach(e=>{try{e(this.getContext())}catch(t){console.error("Ошибка в слушателе контекста чата:",t)}})}clearContext(){this.context.attachedItems=[],this.context.activeProject=void 0,this.context.activeDocument=void 0,this.context.userLocation="workspace",this.notifyListeners(),console.log("Контекст чата очищен")}getContextForAI(){const e=this.generateContextSummary();return{attachedItems:this.context.attachedItems,activeProject:this.context.activeProject,userLocation:this.context.userLocation,contextSummary:e}}generateContextSummary(){const e=[];if(this.context.activeProject&&e.push(`Активный проект: ${this.context.activeProject.title}`),this.context.attachedItems.length>0){const t=this.context.attachedItems.map(e=>`${e.type}: ${e.title}`).join(", ");e.push(`Прикрепленные элементы: ${t}`)}return e.push(`Расположение пользователя: ${this.context.userLocation}`),e.join(" | ")}},R={NETWORK:"NETWORK_ERROR",VALIDATION:"VALIDATION_ERROR",AUTHENTICATION:"AUTHENTICATION_ERROR",AUTHORIZATION:"AUTHORIZATION_ERROR",NOT_FOUND:"NOT_FOUND_ERROR",SERVER:"SERVER_ERROR",CLIENT:"CLIENT_ERROR",UNKNOWN:"UNKNOWN_ERROR"},P={NETWORK_TIMEOUT:"NETWORK_TIMEOUT",NETWORK_OFFLINE:"NETWORK_OFFLINE",NETWORK_CONNECTION_FAILED:"NETWORK_CONNECTION_FAILED",INVALID_INPUT:"INVALID_INPUT",MISSING_REQUIRED_FIELD:"MISSING_REQUIRED_FIELD",INVALID_FORMAT:"INVALID_FORMAT",INVALID_CREDENTIALS:"INVALID_CREDENTIALS",TOKEN_EXPIRED:"TOKEN_EXPIRED",TOKEN_INVALID:"TOKEN_INVALID",FILE_TOO_LARGE:"FILE_TOO_LARGE",FILE_TYPE_NOT_SUPPORTED:"FILE_TYPE_NOT_SUPPORTED",FILE_UPLOAD_FAILED:"FILE_UPLOAD_FAILED",MESSAGE_SEND_FAILED:"MESSAGE_SEND_FAILED",MESSAGE_TOO_LONG:"MESSAGE_TOO_LONG",CHAT_NOT_FOUND:"CHAT_NOT_FOUND"},L={GENERIC:"Произошла неожиданная ошибка",NETWORK:"Ошибка сети. Проверьте подключение к интернету",VALIDATION:"Ошибка валидации данных",AUTHENTICATION:"Ошибка аутентификации",AUTHORIZATION:"Недостаточно прав для выполнения операции",NOT_FOUND:"Запрашиваемый ресурс не найден",SERVER:"Ошибка сервера. Попробуйте позже",FILE_UPLOAD:"Ошибка загрузки файла",MESSAGE_SEND:"Ошибка отправки сообщения"},$={MAX_ERRORS_IN_STORAGE:50,ERROR_RETENTION_DAYS:7,LOG_LEVELS:{ERROR:"error",WARNING:"warning",INFO:"info",DEBUG:"debug"}},_=new class{constructor(){this.notifications=[],this.listeners=[],this.nextId=1}show(e,t,s,r){var i;const n={id:"notification_"+this.nextId++,type:e,title:t,message:s,duration:null!=(i=null==r?void 0:r.duration)?i:this.getDefaultDuration(e),actions:null==r?void 0:r.actions,metadata:null==r?void 0:r.metadata};return this.notifications.unshift(n),this.notifyListeners(),n.duration&&n.duration>0&&setTimeout(()=>{this.hide(n.id)},n.duration),n.id}success(e,t,s){return this.show("success",e,t,s)}error(e,t,s){return this.show("error",e,t,s)}warning(e,t,s){return this.show("warning",e,t,s)}info(e,t,s){return this.show("info",e,t,s)}hide(e){this.notifications=this.notifications.filter(t=>t.id!==e),this.notifyListeners()}hideAll(){this.notifications=[],this.notifyListeners()}getNotifications(){return[...this.notifications]}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}showErrorBoundaryNotification(e,t){const s=this.determineErrorType(e),r=this.getErrorTitle(s),i=this.getErrorMessage(e,s);return this.error(r,i,{duration:0,actions:[{label:"Подробности",action:()=>this.showErrorDetails(e,t),variant:"secondary"},{label:"Закрыть",action:()=>this.hideAll(),variant:"primary"}],metadata:{errorType:s,componentStack:null==t?void 0:t.componentStack,errorBoundary:null==t?void 0:t.errorBoundary}})}getDefaultDuration(e){switch(e){case"success":default:return 3e3;case"error":return 0;case"warning":return 5e3;case"info":return 4e3}}determineErrorType(e){return"TypeError"===e.name?"Ошибка типа":"ReferenceError"===e.name?"Ошибка ссылки":"NetworkError"===e.name?"Ошибка сети":e.message.includes("fetch")?"Ошибка загрузки":e.message.includes("auth")?"Ошибка аутентификации":e.message.includes("permission")?"Ошибка доступа":"Неизвестная ошибка"}getErrorTitle(e){return e}getErrorMessage(e,t){if(e.message)return e.message;switch(t){case"Ошибка сети":return L.NETWORK;case"Ошибка аутентификации":return L.AUTHENTICATION;case"Ошибка доступа":return L.AUTHORIZATION;default:return L.GENERIC}}showErrorDetails(e,t){this.info("Детали ошибки","Подробная информация об ошибке выведена в консоль разработчика")}notifyListeners(){this.listeners.forEach(e=>e(this.notifications))}};function O(e){var t,s,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(s=O(e[t]))&&(r&&(r+=" "),r+=s)}else for(s in e)e[s]&&(r&&(r+=" "),r+=s);return r}function D(){for(var e,t,s=0,r="";s<arguments.length;)(e=arguments[s++])&&(t=B(e))&&(r&&(r+=" "),r+=t);return r}function B(e){if("string"==typeof e)return e;for(var t,s="",r=0;r<e.length;r++)e[r]&&(t=B(e[r]))&&(s&&(s+=" "),s+=t);return s}function z(e){var t=function(e){var t=e.theme,s=e.prefix,r={nextPart:new Map,validators:[]},i=function(e,t){return t?e.map(function(e){return[e[0],e[1].map(function(e){return"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(function(e){var s=e[0],r=e[1];return[t+s,r]})):e})]}):e}(Object.entries(e.classGroups),s);return i.forEach(function(e){var s=e[0];W(e[1],r,s,t)}),r}(e),s=e.conflictingClassGroups,r=e.conflictingClassGroupModifiers,i=void 0===r?{}:r;return{getClassGroupId:function(e){var s=e.split("-");return""===s[0]&&1!==s.length&&s.shift(),F(s,t)||function(e){if(H.test(e)){var t=H.exec(e)[1],s=null==t?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}}(e)},getConflictingClassGroupIds:function(e,t){var r=s[e]||[];return t&&i[e]?[].concat(r,i[e]):r}}}function F(e,t){var s;if(0===e.length)return t.classGroupId;var r=e[0],i=t.nextPart.get(r),n=i?F(e.slice(1),i):void 0;if(n)return n;if(0!==t.validators.length){var a=e.join("-");return null==(s=t.validators.find(function(e){return(0,e.validator)(a)}))?void 0:s.classGroupId}}var H=/^\[(.+)\]$/;function W(e,t,s,r){e.forEach(function(e){if("string"!=typeof e){if("function"==typeof e)return e.isThemeGetter?void W(e(r),t,s,r):void t.validators.push({validator:e,classGroupId:s});Object.entries(e).forEach(function(e){var i=e[0];W(e[1],G(t,i),s,r)})}else(""===e?t:G(t,e)).classGroupId=s})}function G(e,t){var s=e;return t.split("-").forEach(function(e){s.nextPart.has(e)||s.nextPart.set(e,{nextPart:new Map,validators:[]}),s=s.nextPart.get(e)}),s}function V(e){if(e<1)return{get:function(){},set:function(){}};var t=0,s=new Map,r=new Map;function i(i,n){s.set(i,n),++t>e&&(t=0,r=s,s=new Map)}return{get:function(e){var t=s.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(i(e,t),t):void 0},set:function(e,t){s.has(e)?s.set(e,t):i(e,t)}}}function U(e){var t=e.separator||":",s=1===t.length,r=t[0],i=t.length;return function(e){for(var n,a=[],o=0,l=0,c=0;c<e.length;c++){var d=e[c];if(0===o){if(d===r&&(s||e.slice(c,c+i)===t)){a.push(e.slice(l,c)),l=c+i;continue}if("/"===d){n=c;continue}}"["===d?o++:"]"===d&&o--}var m=0===a.length?e:e.substring(l),h=m.startsWith("!");return{modifiers:a,hasImportantModifier:h,baseClassName:h?m.substring(1):m,maybePostfixModifierPosition:n&&n>l?n-l:void 0}}}var q=/\s+/;function Q(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];var r,i,n,a=function(e){var s=t[0],c=t.slice(1).reduce(function(e,t){return t(e)},s());return r=function(e){return l({cache:V(e.cacheSize),splitModifiers:U(e)},z(e))}(c),i=r.cache.get,n=r.cache.set,a=o,o(e)};function o(e){var t=i(e);if(t)return t;var s=function(e,t){var s=t.splitModifiers,r=t.getClassGroupId,i=t.getConflictingClassGroupIds,n=new Set;return e.trim().split(q).map(function(e){var t=s(e),i=t.modifiers,n=t.hasImportantModifier,a=t.baseClassName,o=t.maybePostfixModifierPosition,l=r(o?a.substring(0,o):a),c=Boolean(o);if(!l){if(!o)return{isTailwindClass:!1,originalClassName:e};if(!(l=r(a)))return{isTailwindClass:!1,originalClassName:e};c=!1}var d=function(e){if(e.length<=1)return e;var t=[],s=[];return e.forEach(function(e){"["===e[0]?(t.push.apply(t,s.sort().concat([e])),s=[]):s.push(e)}),t.push.apply(t,s.sort()),t}(i).join(":");return{isTailwindClass:!0,modifierId:n?d+"!":d,classGroupId:l,originalClassName:e,hasPostfixModifier:c}}).reverse().filter(function(e){if(!e.isTailwindClass)return!0;var t=e.modifierId,s=e.classGroupId,r=e.hasPostfixModifier,a=t+s;return!n.has(a)&&(n.add(a),i(s,r).forEach(function(e){return n.add(t+e)}),!0)}).reverse().map(function(e){return e.originalClassName}).join(" ")}(e,r);return n(e,s),s}return function(){return a(D.apply(null,arguments))}}function K(e){var t=function(t){return t[e]||[]};return t.isThemeGetter=!0,t}var Z=/^\[(?:([a-z-]+):)?(.+)\]$/i,Y=/^\d+\/\d+$/,J=new Set(["px","full","screen"]),X=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ee=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,te=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function se(e){return le(e)||J.has(e)||Y.test(e)||re(e)}function re(e){return ge(e,"length",xe)}function ie(e){return ge(e,"size",ve)}function ne(e){return ge(e,"position",ve)}function ae(e){return ge(e,"url",fe)}function oe(e){return ge(e,"number",le)}function le(e){return!Number.isNaN(Number(e))}function ce(e){return e.endsWith("%")&&le(e.slice(0,-1))}function de(e){return ye(e)||ge(e,"number",ye)}function me(e){return Z.test(e)}function he(){return!0}function ue(e){return X.test(e)}function pe(e){return ge(e,"",be)}function ge(e,t,s){var r=Z.exec(e);return!!r&&(r[1]?r[1]===t:s(r[2]))}function xe(e){return ee.test(e)}function ve(){return!1}function fe(e){return e.startsWith("url(")}function ye(e){return Number.isInteger(Number(e))}function be(e){return te.test(e)}function je(){var e=K("colors"),t=K("spacing"),s=K("blur"),r=K("brightness"),i=K("borderColor"),n=K("borderRadius"),a=K("borderSpacing"),o=K("borderWidth"),l=K("contrast"),c=K("grayscale"),d=K("hueRotate"),m=K("invert"),h=K("gap"),u=K("gradientColorStops"),p=K("gradientColorStopPositions"),g=K("inset"),x=K("margin"),v=K("opacity"),f=K("padding"),y=K("saturate"),b=K("scale"),j=K("sepia"),w=K("skew"),N=K("space"),k=K("translate"),S=function(){return["auto",me,t]},C=function(){return[me,t]},E=function(){return["",se]},I=function(){return["auto",le,me]},T=function(){return["","0",me]},A=function(){return[le,oe]},M=function(){return[le,me]};return{cacheSize:500,theme:{colors:[he],spacing:[se],blur:["none","",ue,me],brightness:A(),borderColor:[e],borderRadius:["none","","full",ue,me],borderSpacing:C(),borderWidth:E(),contrast:A(),grayscale:T(),hueRotate:M(),invert:T(),gap:C(),gradientColorStops:[e],gradientColorStopPositions:[ce,re],inset:S(),margin:S(),opacity:A(),padding:C(),saturate:A(),scale:A(),sepia:T(),skew:M(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",me]}],container:["container"],columns:[{columns:[ue]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[me])}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",de]}],basis:[{basis:S()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",me]}],grow:[{grow:T()}],shrink:[{shrink:T()}],order:[{order:["first","last","none",de]}],"grid-cols":[{"grid-cols":[he]}],"col-start-end":[{col:["auto",{span:["full",de]},me]}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":[he]}],"row-start-end":[{row:["auto",{span:[de]},me]}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",me]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",me]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat(["start","end","center","between","around","evenly","stretch"])}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[f]}],px:[{px:[f]}],py:[{py:[f]}],ps:[{ps:[f]}],pe:[{pe:[f]}],pt:[{pt:[f]}],pr:[{pr:[f]}],pb:[{pb:[f]}],pl:[{pl:[f]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[N]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[N]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",me,t]}],"min-w":[{"min-w":["min","max","fit",me,se]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[ue]},ue,me]}],h:[{h:[me,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",me,se]}],"max-h":[{"max-h":[me,t,"min","max","fit"]}],"font-size":[{text:["base",ue,re]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",oe]}],"font-family":[{font:[he]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",me]}],"line-clamp":[{"line-clamp":["none",le,oe]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",me,se]}],"list-image":[{"list-image":["none",me]}],"list-style-type":[{list:["none","disc","decimal",me]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(["solid","dashed","dotted","double","none"],["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",se]}],"underline-offset":[{"underline-offset":["auto",me,se]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",me]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",me]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[ne])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ie]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ae]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[u]}],"gradient-via":[{via:[u]}],"gradient-to":[{to:[u]}],rounded:[{rounded:[n]}],"rounded-s":[{"rounded-s":[n]}],"rounded-e":[{"rounded-e":[n]}],"rounded-t":[{"rounded-t":[n]}],"rounded-r":[{"rounded-r":[n]}],"rounded-b":[{"rounded-b":[n]}],"rounded-l":[{"rounded-l":[n]}],"rounded-ss":[{"rounded-ss":[n]}],"rounded-se":[{"rounded-se":[n]}],"rounded-ee":[{"rounded-ee":[n]}],"rounded-es":[{"rounded-es":[n]}],"rounded-tl":[{"rounded-tl":[n]}],"rounded-tr":[{"rounded-tr":[n]}],"rounded-br":[{"rounded-br":[n]}],"rounded-bl":[{"rounded-bl":[n]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(["solid","dashed","dotted","double","none"],["hidden"])}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:[""].concat(["solid","dashed","dotted","double","none"])}],"outline-offset":[{"outline-offset":[me,se]}],"outline-w":[{outline:[se]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:E()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[se]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ue,pe]}],"shadow-color":[{shadow:[he]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",ue,me]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[m]}],saturate:[{saturate:[y]}],sepia:[{sepia:[j]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[j]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",me]}],duration:[{duration:M()}],ease:[{ease:["linear","in","out","in-out",me]}],delay:[{delay:M()}],animate:[{animate:["none","spin","ping","pulse","bounce",me]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[de,me]}],"translate-x":[{"translate-x":[k]}],"translate-y":[{"translate-y":[k]}],"skew-x":[{"skew-x":[w]}],"skew-y":[{"skew-y":[w]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",me]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",me]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",me]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[se,oe]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var we=Q(je);function Ne(...e){return we(function(){for(var e,t,s=0,r="",i=arguments.length;s<i;s++)(e=arguments[s])&&(t=O(e))&&(r&&(r+=" "),r+=t);return r}(e))}const ke=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]};var Se={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},Ce=(e,t)=>{const s=v.forwardRef((s,r)=>{var i,n=s,{color:a="currentColor",size:o=24,strokeWidth:m=2,absoluteStrokeWidth:h,children:u}=n,p=d(n,["color","size","strokeWidth","absoluteStrokeWidth","children"]);return v.createElement("svg",l(c(l({ref:r},Se),{width:o,height:o,stroke:a,strokeWidth:h?24*Number(m)/Number(o):m,className:`lucide lucide-${i=e,i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`}),p),[...t.map(([e,t])=>v.createElement(e,t)),...(Array.isArray(u)?u:[u])||[]])});return s.displayName=`${e}`,s};const Ee=Ce("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ie=Ce("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Te=Ce("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]]),Ae=Ce("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Me=Ce("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Re=Ce("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Pe=Ce("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Le=Ce("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),$e=Ce("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),_e=Ce("Bot",[["rect",{width:"18",height:"10",x:"3",y:"11",rx:"2",key:"1ofdy3"}],["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}],["path",{d:"M12 7v4",key:"xawao1"}],["line",{x1:"8",x2:"8",y1:"16",y2:"16",key:"h6x27f"}],["line",{x1:"16",x2:"16",y1:"16",y2:"16",key:"5lty7f"}]]),Oe=Ce("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),De=Ce("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),Be=Ce("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ze=Ce("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Fe=Ce("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),He=Ce("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),We=Ce("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ge=Ce("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]),Ve=Ce("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Ue=Ce("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),qe=Ce("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Qe=Ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Ke=Ce("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Ze=Ce("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ye=Ce("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Je=Ce("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]),Xe=Ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),et=Ce("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),tt=Ce("Folder",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}]]),st=Ce("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),rt=Ce("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]]),it=Ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),nt=Ce("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),at=Ce("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]),ot=Ce("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),lt=Ce("Layout",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"9",x2:"9",y1:"21",y2:"9",key:"wpwpyp"}]]),ct=Ce("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),dt=Ce("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),mt=Ce("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),ht=Ce("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),ut=Ce("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),pt=Ce("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),gt=Ce("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),xt=Ce("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),vt=Ce("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),ft=Ce("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),yt=Ce("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),bt=Ce("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),jt=Ce("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),wt=Ce("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Nt=Ce("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}]]),kt=Ce("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),St=Ce("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Ct=Ce("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Et=Ce("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),It=Ce("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Tt=Ce("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),At=Ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Mt=Ce("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Rt=Ce("Rows",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}]]),Pt=Ce("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Lt=Ce("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),$t=Ce("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),_t=Ce("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Ot=Ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Dt=Ce("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Bt=Ce("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),zt=Ce("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),Ft=Ce("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),Ht=Ce("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Wt=Ce("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Gt=Ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Vt=Ce("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Ut=Ce("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),qt=Ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Qt=Ce("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Kt=Ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Zt=Ce("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),Yt=Ce("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),Jt=Ce("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),Xt=Ce("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),es=Ce("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ts=Ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ss=Ce("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),rs=Ce("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),is=Ce("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),ns={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg",xl:"px-8 py-4 text-xl"},as={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"},os={primary:"platform-button-primary",secondary:"platform-button-secondary",outline:"platform-button-outline",ghost:"platform-button-ghost",danger:"platform-button-danger",success:"platform-button-success"},ls={glass:{initial:{background:"var(--glass-bg)",backdropFilter:"blur(20px)",border:"1px solid var(--glass-border)",boxShadow:"0 8px 32px var(--glass-bg)"},hover:{background:"var(--button-secondary-hover)",backdropFilter:"blur(25px)",borderColor:"var(--primary)",boxShadow:"0 16px 48px var(--glass-border)",y:-4}},neumorphism:{initial:{background:"var(--primary)",color:"var(--background)",boxShadow:"8px 8px 16px var(--neumorphism-dark), -8px -8px 16px var(--neumorphism-light)"},hover:{y:-2,boxShadow:"12px 12px 24px var(--neumorphism-dark), -12px -12px 24px var(--neumorphism-light)"},tap:{y:0,boxShadow:"inset 4px 4px 8px var(--neumorphism-dark), inset -4px -4px 8px var(--neumorphism-light)"}},neon:{initial:{background:"var(--primary)",color:"var(--background)",boxShadow:"0 0 10px var(--primary), 0 0 20px var(--primary)"},hover:{boxShadow:"0 0 20px var(--primary), 0 0 40px var(--primary)",filter:"brightness(1.2)",y:-2}}},cs=v.memo(e=>{var t=e,{variant:s="primary",size:r="md",rounded:i="md",loading:n=!1,isLoading:a=!1,icon:o,leftIcon:m,rightIcon:g,iconPosition:x="left",animationType:v="none",children:y,className:b,disabled:j}=t,w=d(t,["variant","size","rounded","loading","isLoading","icon","leftIcon","rightIcon","iconPosition","animationType","children","className","disabled"]);const[N,k]=f.useState(!1),[S,C]=f.useState(!1),E=n||a,I=o||m,T=g,A=(e=>h({boxShadow:e?"0 0 30px rgba(139, 69, 19, 0.5), 0 0 60px rgba(160, 82, 45, 0.3)":"0 0 20px rgba(139, 69, 19, 0.3), 0 0 40px rgba(160, 82, 45, 0.2)",config:{tension:300,friction:30}}))(N),M=(e=>h({boxShadow:e?"0 0 20px rgba(34, 197, 94, 0.6), 0 0 40px rgba(217, 70, 239, 0.4)":"0 0 10px rgba(34, 197, 94, 0.4), 0 0 20px rgba(217, 70, 239, 0.2)",filter:e?"brightness(1.2)":"brightness(1)",config:{tension:400,friction:25}}))(S),R=s in ls,P=R?ls[s]:null,L=Ne("platform-button-base",!R&&os[s],ns[r],as[i],E&&"platform-button-loading",j&&"platform-button-disabled",b),$=R?{initial:"initial",whileHover:"hover",whileTap:"tap",variants:P||{},onHoverStart:()=>k(!0),onHoverEnd:()=>k(!1),onTapStart:()=>C(!0),onTap:()=>C(!1),transition:{duration:.3,ease:[.4,0,.2,1]}}:{whileHover:j||E?{}:{scale:1.02,transition:{duration:.2}},whileTap:j||E?{}:{scale:.98,transition:{duration:.1}}};return u.jsxs(p.button,c(l(c(l({className:L,disabled:j||E},$),{style:(()=>{switch(v){case"mocha-glow":return A;case"neon-pulse":return M;default:return{}}})()}),w),{children:["glass-shimmer"===v&&u.jsx(p.div,{className:"absolute inset-0 rounded-lg opacity-20",style:{background:"linear-gradient(90deg, transparent, var(--glass-border), transparent)",backgroundSize:"200% 100%"},animate:{backgroundPosition:["-200% 0","200% 0"]},transition:{duration:2,repeat:1/0,ease:"linear"}}),E&&u.jsx(p.div,{className:"platform-button-spinner",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),!E&&I&&"left"===x&&u.jsx(p.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1},className:"platform-button-icon-left",children:I}),u.jsx(p.span,{className:Ne("platform-button-content",E&&"opacity-0"),initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:y}),!E&&T&&"right"===x&&u.jsx(p.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{delay:.1},className:"platform-button-icon-right",children:T}),R&&u.jsx(p.div,{className:"absolute inset-0 rounded-lg overflow-hidden",initial:{scale:0,opacity:0},whileTap:{scale:1,opacity:[0,.3,0]},transition:{duration:.6,ease:[.4,0,.2,1]},style:{background:"radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%)"}})]}))});cs.displayName="UnifiedButton";const ds={Square:Ft,Bot:_e,Zap:ss,MessageCircle:pt,Languages:at,Wand2:Xt,FileText:Ye,Edit3:Ct,FolderOpen:et,Upload:qt,Search:$t,Smile:zt,Settings:Ot,Eye:Ze,EyeOff:Ke,Mic:vt,Paperclip:kt,Send:_t,FileTextIcon:Ye,Grid:rt},ms=({buttons:e,groups:t,onClick:s,className:r,activeButtonId:i,compactMode:n="normal"})=>{const a=v.useRef(null),o=Array.isArray(e)&&e.length>0,d=Array.isArray(t)&&t.length>0;if(!o&&!d)return null;const m=o?e:t.flatMap(e=>e.buttons.map(t=>c(l({},t),{serviceId:e.serviceId})));return u.jsx("div",{className:Ne("chat-buttons-compact",n,r),children:u.jsx("div",{ref:a,className:"chat-buttons-compact-grid",children:m.map(e=>{const t=ds[e.icon]||Ft,r=e.serviceId?`${e.serviceId}-${e.id}`:e.id,n=i===r;return u.jsxs("button",{type:"button",onClick:()=>s(e,e.serviceId),className:Ne("chat-button-compact",n&&"active",e.disabled&&"disabled"),title:e.description,disabled:e.disabled,children:[u.jsx(t,{className:"chat-button-icon"}),u.jsx("span",{className:"chat-button-label",children:e.name})]},r)})})})},hs=({contextButtons:e,onRemoveContext:t,className:s=""})=>{if(0===e.length)return null;const r=e=>{switch(e){case"project":return u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:u.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"})});case"document":return u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[u.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),u.jsx("polyline",{points:"14 2 14 8 20 8"}),u.jsx("line",{x1:"16",x2:"8",y1:"13",y2:"13"}),u.jsx("line",{x1:"16",x2:"8",y1:"17",y2:"17"}),u.jsx("line",{x1:"10",x2:"8",y1:"9",y2:"9"})]});case"file":return u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[u.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),u.jsx("polyline",{points:"14 2 14 8 20 8"})]});case"image":return u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[u.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),u.jsx("circle",{cx:"9",cy:"9",r:"2"}),u.jsx("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]});case"prompt":return u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[u.jsx("path",{d:"M12 20h9"}),u.jsx("path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"})]});default:return u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:u.jsx("circle",{cx:"12",cy:"12",r:"10"})})}},i=e=>{switch(e){case"project":return"bg-blue-100 text-blue-700 border-blue-200";case"document":return"bg-green-100 text-green-700 border-green-200";case"file":default:return"bg-gray-100 text-gray-700 border-gray-200";case"image":return"bg-purple-100 text-purple-700 border-purple-200";case"prompt":return"bg-orange-100 text-orange-700 border-orange-200"}};return u.jsx("div",{className:`flex flex-wrap gap-2 mb-3 ${s}`,children:e.map(e=>u.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border text-sm font-medium transition-colors ${i(e.type)}`,title:`${e.type}: ${e.title}`,children:[r(e.type),u.jsx("span",{className:"truncate max-w-[120px]",children:e.title}),e.removable&&u.jsx("button",{onClick:()=>t(e.id),className:"ml-1 p-0.5 rounded-full hover:bg-black/10 transition-colors",title:"Удалить из контекста",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3 h-3",children:[u.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),u.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]})})]},e.id))})},us={creative:{temperature:1.2,top_p:.9,max_tokens:2e3,frequency_penalty:.1,presence_penalty:.1,model:"gpt-5-nano"},analytical:{temperature:.3,top_p:.8,max_tokens:1500,frequency_penalty:0,presence_penalty:0,model:"gpt-5-nano"},balanced:{temperature:.7,top_p:.9,max_tokens:1e3,frequency_penalty:0,presence_penalty:0,model:"gpt-5-nano"},precise:{temperature:.1,top_p:.7,max_tokens:800,frequency_penalty:-.1,presence_penalty:0,model:"gpt-5-nano"}};function ps(e){const t=[];return void 0!==e.temperature&&t.push(`T: ${e.temperature}`),void 0!==e.top_p&&t.push(`P: ${e.top_p}`),void 0!==e.max_tokens&&t.push(`Max: ${e.max_tokens}`),void 0!==e.frequency_penalty&&0!==e.frequency_penalty&&t.push(`Freq: ${e.frequency_penalty}`),void 0!==e.presence_penalty&&0!==e.presence_penalty&&t.push(`Pres: ${e.presence_penalty}`),t.join(", ")}const gs=({promptId:e,promptTitle:t,settings:s,onRemove:r,onOpenPrompt:i,className:n=""})=>{const a=ps(s);return u.jsxs("div",{className:`prompt-settings-button ${n}`,children:[u.jsxs("button",{className:"prompt-settings-button-content",onClick:i,title:`Открыть промпт: ${t}`,children:[u.jsx("div",{className:"prompt-settings-button-icon",children:u.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),u.jsx("polyline",{points:"14,2 14,8 20,8"}),u.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),u.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),u.jsx("polyline",{points:"10,9 9,9 8,9"})]})}),u.jsxs("div",{className:"prompt-settings-button-text",children:[u.jsx("div",{className:"prompt-settings-button-title",children:t}),u.jsx("div",{className:"prompt-settings-button-settings",children:a})]})]}),u.jsx("button",{className:"prompt-settings-button-remove",onClick:r,title:"Удалить настройки промпта",children:u.jsxs("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})},xs=({className:t,onInputResize:s})=>{var r;const{state:n,sendMessage:a,updateSettings:o}=i(),[l,c]=v.useState(""),[d,h]=v.useState(!1),[p,g]=v.useState([]),[x,f]=v.useState(null),[y,b]=v.useState(null),[j,w]=v.useState([]),[N]=v.useState(null),k=v.useRef(null),[S,C]=v.useState(!1),E=v.useRef(null),[I,R]=v.useState(0),[P]=v.useState("ai-assistant"),[L,$]=v.useState([]),[O,D]=v.useState({attachedItems:[],userLocation:"workspace"}),[B,z]=v.useState(null),F=v.useRef(null),H=v.useRef(null),W=v.useRef(null),[G,V]=v.useState(!1),U=v.useRef(null),[q,Q]=v.useState(!1),K=v.useMemo(()=>{var e;return(null==(e=n.activeChat)?void 0:e.messages)||[]},[null==(r=n.activeChat)?void 0:r.messages]),Z=v.useMemo(()=>L.find(e=>e.id===P),[L,P]),Y=v.useMemo(()=>(null==Z?void 0:Z.models)?Z.models.map(e=>({id:e.id,name:e.name,description:e.description,icon:"Brain",color:"low"===e.cost?"green":"medium"===e.cost?"yellow":"red",action:`select-model-${e.id}`,isEnabled:!0})):[],[Z]),J=v.useCallback(()=>{if(q)return void console.log("Прокрутка уже выполняется, игнорируем нажатие");console.log("Кнопка прокрутки нажата!"),Q(!0),V(!1);const e=H.current;e?(e.scrollTop=e.scrollHeight,setTimeout(()=>{e.scrollTop=e.scrollHeight},10)):F.current&&F.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),setTimeout(()=>{Q(!1)},1e3)},[q]);v.useLayoutEffect(()=>{if(!1===n.settings.autoScroll)return;const e=H.current;if(!e)return;const t=requestAnimationFrame(()=>{const t=requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight,setTimeout(()=>{e.scrollTop=e.scrollHeight},10)});return()=>cancelAnimationFrame(t)});return()=>cancelAnimationFrame(t)},[K.length,n.settings.autoScroll]),v.useEffect(()=>{const e=U.current;return()=>{e&&clearTimeout(e)}},[]),v.useEffect(()=>{console.log("Состояние стрелки изменилось:",G)},[G]),v.useEffect(()=>{if(!E.current)return void R(0);const e=E.current,t=()=>R(e.offsetHeight);t();const s=new ResizeObserver(t);return s.observe(e),()=>{s.disconnect()}},[S,n.settings.hideChatFunctionButtons,p.length]),v.useEffect(()=>{const e=H.current;if(e){const t=I>0&&!S?Math.max(0,I-75):0;e.style.setProperty("--chat-buttons-panel-height",`${t}px`)}},[I,S]),v.useEffect(()=>{if(!S&&I>0){const e=H.current;e&&(e.scrollTop=e.scrollHeight)}},[S,I]),v.useEffect(()=>{const e=T.getChatButtonsGrouped(),t=j.map(e=>({serviceId:"boss-ai",serviceName:"Boss Ai",serviceIcon:"Brain",buttons:[{id:e.id,name:e.name,description:e.description,icon:e.icon,color:"blue",action:e.id,isEnabled:!0}]}));g([...e.bottom,...t])},[n.services,j]),v.useEffect(()=>{const e=A.getAvailableModes();w(e)},[]),v.useEffect(()=>{(()=>{try{const e=T.getActiveServices().filter(e=>{const t=e.config.chatButtons&&e.config.chatButtons.length>0,s=e.config.chatFunctions&&e.config.chatFunctions.length>0,r=e.config.tools&&e.config.tools.some(e=>e.isChatFunction),i=!!e.config.chatApiBaseUrl;return t||s||r||i});$(e.map(e=>{var t;return{id:e.config.id,name:e.config.name,description:e.config.description,icon:e.config.icon,isActive:e.config.isActive,models:(null==(t=e.config.configuration)?void 0:t.models)||[]}}))}catch(e){console.error("Ошибка получения сервисов:",e)}})()},[n.services]),v.useEffect(()=>{var e;null==(e=W.current)||e.focus()},[]),v.useEffect(()=>{const e=document.querySelector(".chat-input-dynamic-height");if(e){const t=Math.max(256,Math.min(800,n.layout.chatInputHeight));e.style.height=`${t}px`}},[n.layout.chatInputHeight]),v.useEffect(()=>{const e=document.querySelector(".chat-container");e&&e.style.setProperty("--chat-width",`${n.layout.chatWidth}px`)},[n.layout.chatWidth]),v.useEffect(()=>{const e=document.querySelector(".chat-input-dynamic-height");if(e){const t=Math.max(256,Math.min(800,n.layout.chatInputHeight));e.style.setProperty("--chat-input-height-value",`${t}px`)}},[n.layout.chatInputHeight]),v.useEffect(()=>{const e=e=>{var t;const s=e;if(null==(t=s.detail)?void 0:t.body){const e=s.detail.body;l.trim()?c(t=>t+"\n\n"+e):c(e),s.detail.settings&&z({id:s.detail.id,title:s.detail.title,settings:s.detail.settings}),setTimeout(()=>{var e;null==(e=W.current)||e.focus()},100),console.log("Inserted prompt into chat:",s.detail.title,s.detail.settings?"with settings":"")}};return window.addEventListener("chat:insert-prompt",e),()=>window.removeEventListener("chat:insert-prompt",e)},[l]),v.useEffect(()=>{const e=e=>{const t=e;if(t.detail){const{title:e,content:s,contractType:r}=t.detail;M.attachContext({id:`contract-${r}-${Date.now()}`,type:"document",title:e,content:s,icon:"📄",removable:!0,source:"manual",metadata:{contractType:r}}),_.success("Документ прикреплен",`Договор "${e}" добавлен в чат`),console.log("Attached document to chat:",e,r)}};return window.addEventListener("chat:attach-document",e),()=>window.removeEventListener("chat:attach-document",e)},[]);const X=v.useCallback(()=>{z(null)},[]),ee=v.useCallback(()=>{B&&window.dispatchEvent(new CustomEvent("prompts:open",{detail:{promptId:B.id}}))},[B]);v.useEffect(()=>M.subscribe(e=>{D(e)}),[]);const te=v.useCallback(e=>{M.detachContext(e)},[]),se=v.useCallback(t=>m(e,null,function*(){if(t.preventDefault(),!l.trim())return;const e=l.trim();if(N)try{const t=yield A.processRequest(N.id,e);a(e),a(`🤖 ${t.response}`),t.suggestions.length>0&&a(`💡 Предложения: ${t.suggestions.join(", ")}`)}catch(s){console.error("Ошибка обработки через Boss Ai:",s),a(e)}else a(e),requestAnimationFrame(()=>{J()});c(""),h(!1),J()}),[l,a,N,J]),re=v.useCallback(e=>{const t=e.target.value;c(t),h(!1),s&&s(e)},[s]),ie=v.useCallback(()=>{const e=new CustomEvent("widgets:toggle",{detail:"voice-widget"});window.dispatchEvent(e)},[]),ne=v.useCallback(()=>{var e;null==(e=k.current)||e.click()},[]),ae=v.useCallback(()=>{const e=!n.settings.hideChatFunctionButtons;o("hideChatFunctionButtons",e),_.info("Кнопки функций",e?"Кнопки функций скрыты":"Кнопки функций показаны")},[n.settings.hideChatFunctionButtons,o]),oe=v.useCallback(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),se(e))},[se]),le=(t,s)=>m(e,null,function*(){try{const e=`${s}-${t.id}`;if(x===e&&(null==y?void 0:y.buttonId)===e)return f(null),void b(null);const r=(e=>{var t;const s=e.name.toLowerCase(),r=(null==(t=e.description)?void 0:t.toLowerCase())||"";return s.includes("briefly")||s.includes("summary")||r.includes("кратк")?"📝 Режим кратких ответов - введите запрос":s.includes("improve")||r.includes("улучш")?"✨ Режим улучшения - введите текст для улучшения":s.includes("in-depth")||s.includes("research")||r.includes("глубок")?"🔍 Режим глубокого исследования - опишите тему":s.includes("content")||s.includes("generation")||r.includes("генерац")?"✍️ Режим генерации контента - опишите что создать":s.includes("legal")||r.includes("юрид")?"⚖️ Юридическая консультация - опишите вопрос":s.includes("contract")||s.includes("создан")||r.includes("договор")?"📄 Создание договора - укажите тип и детали":s.includes("task")||s.includes("создан")||r.includes("задач")?"✅ Создание задачи - опишите задачу":`🎯 Режим "${e.name}" - ${e.description||"введите запрос"}`})(t);return f(e),void b({buttonId:e,placeholder:r})}catch(e){const r=e instanceof Error?e.message:"Неизвестная ошибка";console.error("Ошибка выполнения чат кнопки:",e),a(`❌ Ошибка выполнения функции: ${t.name}`),_.error("Ошибка выполнения команды",`Не удалось выполнить команду "${t.name}". ${r}`,{metadata:{button:t.name,action:t.action,serviceId:s,error:r,timestamp:(new Date).toISOString()}}),f(null)}}),ce=v.useCallback(()=>{C(!S)},[S]),de=v.useCallback(e=>{try{const t=10485760,s=["image/","text/","application/pdf"],r=e.filter(e=>{const r=e.size<=t,i=s.some(t=>e.type.startsWith(t));return r&&i});r.length!==e.length&&_.warning("Некоторые файлы не загружены","Проверьте размер (макс. 10MB) и тип файлов"),r.length>0&&_.success("Файлы загружены",`Загружено ${r.length} файлов`)}catch(t){console.error("Ошибка загрузки файлов:",t),_.error("Ошибка загрузки","Не удалось загрузить файлы")}},[]),me=v.useCallback(e=>{const t=e.target.files;t&&t.length>0&&de(Array.from(t)),k.current&&(k.current.value="")},[de]);return u.jsxs("div",{className:Ne("flex flex-col h-full chat-panel liquid-glass-panel relative",t),children:[u.jsx("div",{className:"py-2 px-4 liquid-glass-block flex items-center justify-between relative overflow-hidden chat-header",children:u.jsx("div",{className:"flex items-center space-x-2 relative z-10",children:N?u.jsxs(u.Fragment,{children:[u.jsxs("h3",{className:"font-semibold text-sm",children:["🎯 ",N.name]}),u.jsx("span",{className:"text-xs text-text-secondary",children:N.description})]}):n.layout.activeService?u.jsxs(u.Fragment,{children:[u.jsxs("h3",{className:"font-semibold text-sm",children:["Сервис: ",n.layout.activeService]}),u.jsx("span",{className:"text-xs text-text-secondary",children:"Обработка через выбранный сервис"})]}):u.jsxs("div",{className:"flex items-center space-x-4 relative z-10",children:[u.jsx("h3",{className:"font-bold text-base",children:"⚡ Boss AI"}),u.jsxs("span",{className:"text-xs text-text-secondary",children:["Интеллектуальная ОС с AI от"," ",u.jsx("a",{href:"https://t.me/Borislav_Barsukov",target:"_blank",rel:"noopener noreferrer",className:"text-text-secondary hover:underline transition-colors",children:"@Borislav_Barsukov"})]})]})})}),u.jsxs("div",{className:Ne("flex-1 p-6 space-y-6 chat-messages overflow-y-auto chat-scrollbar",p.length>0&&!n.settings.hideChatFunctionButtons&&"chat-messages-with-buttons"),onScroll:e=>{const t=e.currentTarget,s=t.scrollHeight-t.scrollTop<=t.clientHeight+5;U.current&&clearTimeout(U.current),V(!s),console.log("Scroll event:",{scrollTop:t.scrollTop,scrollHeight:t.scrollHeight,clientHeight:t.clientHeight,isAtBottom:s,showScrollButton:!s})},ref:H,children:[0===K.length?u.jsx("div",{className:"flex flex-col items-center justify-center h-full text-center chat-interactive",children:u.jsx("div",{className:"flex flex-col gap-4 justify-center items-center animate-scale-in",children:Y.length>0&&!n.settings.hideChatFunctionButtons&&u.jsxs("div",{className:"w-full max-w-2xl",children:[u.jsxs("div",{className:"text-sm text-text-secondary mb-3",children:["Выберите режим для ",null==Z?void 0:Z.name,":"]}),u.jsx(ms,{buttons:Y,onClick:le})]})})}):K.map(e=>{return u.jsx("div",{className:Ne("flex mb-2 animate-fade-in chat-interactive","user"===e.sender?"justify-end":"justify-start"),children:u.jsx("div",{className:Ne("max-w-xs lg:max-w-md px-4 py-0.5 rounded-xl transition-all duration-300 shadow-xl backdrop-blur-sm relative","hover:shadow-2xl transform-gpu","user"===e.sender?"message-user":"system"===e.sender?"message-system":"message-assistant"),children:u.jsxs("div",{className:"relative z-10",children:[u.jsxs("div",{className:Ne("flex items-center mb-0 opacity-80 text-[10px] font-semibold","user"===e.sender?"flex-row-reverse justify-end gap-2 text-right":"justify-between"),children:[u.jsx("span",{children:"user"===e.sender?"U":"system"===e.sender?"Boss Ai":"AI"}),n.settings.showTimestamps&&u.jsx("span",{children:(t=e.timestamp,new Intl.DateTimeFormat("ru-RU",{hour:"2-digit",minute:"2-digit"}).format(t))})]}),u.jsx("p",{className:Ne("text-xs leading-tight whitespace-pre-wrap font-medium","user"===e.sender&&"text-right"),children:e.content})]})})},e.id);var t}),d&&u.jsxs("div",{className:"flex items-end space-x-4 mb-6 animate-fade-in",role:"status","aria-live":"polite","aria-label":"AI печатает сообщение",children:[u.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 shadow-lg backdrop-blur-sm bg-gradient-to-br from-surface to-card-bg text-text shadow-border",children:"AI"}),u.jsx("div",{className:"px-4 py-2 rounded-lg border shadow-lg typing-indicator",children:u.jsxs("div",{className:"flex space-x-1","aria-hidden":"true",children:[u.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce typing-dot"}),u.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce delay-100 typing-dot"}),u.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce delay-200 typing-dot"})]})})]}),u.jsx("div",{ref:F})]}),u.jsxs("div",{className:"relative flex flex-col chat-input-container chat-input-dynamic-height chat-input-absolute","data-chat-input-height":Math.max(256,Math.min(800,n.layout.chatInputHeight)),children:[u.jsx("button",{onClick:J,className:`chat-scroll-button chat-scroll-button-input absolute w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold cursor-pointer z-50 backdrop-blur-sm transition-all duration-200 ${G?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none is-hidden"} ${q?"opacity-50 cursor-not-allowed":""}`,title:q?"Прокрутка выполняется...":"Прокрутить вниз",disabled:q,children:"↓"}),u.jsx("div",{className:"select-none w-full relative z-50 pointer-events-auto m-0 p-0 chat-resize-handle absolute top-0 left-0 right-0",onMouseDown:s,title:"Изменить высоту поля ввода"}),p.length>0&&!n.settings.hideChatFunctionButtons&&u.jsx("div",{ref:E,className:"chat-buttons-panel-collapse "+(S?"chat-buttons-panel-collapsed":"chat-buttons-panel-expanded"),children:u.jsxs("div",{className:"px-6 pt-2 pb-6 mb-2",children:[u.jsx(ms,{groups:p,onClick:le,activeButtonId:x}),u.jsx("div",{className:"w-full gradient-divider-wide mt-4 cursor-pointer hover:opacity-50 transition-opacity duration-200 relative flex items-center justify-end",onClick:ce,title:S?"Показать выбор режима":"Скрыть выбор режима",children:u.jsx("span",{className:"text-xs text-white hover:text-gray-100 transition-colors duration-200 pointer-events-none pr-4",children:S?"Показать выбор режима":"Скрыть выбор режима"})})]})}),p.length>0&&!n.settings.hideChatFunctionButtons&&S&&u.jsx("div",{className:"px-6 pt-1 pb-1",children:u.jsx("div",{className:"w-full gradient-divider-wide cursor-pointer hover:opacity-50 transition-opacity duration-200 relative flex items-center justify-end",onClick:ce,title:"Показать выбор режима",children:u.jsx("span",{className:"text-xs text-white hover:text-gray-100 transition-colors duration-200 pointer-events-none pr-4",children:"Показать выбор режима"})})}),u.jsx("div",{className:"flex-1 flex flex-col relative",children:u.jsxs("form",{onSubmit:se,className:"flex-1 flex flex-col relative z-10",children:[u.jsx(hs,{contextButtons:O.attachedItems,onRemoveContext:te,className:"px-6 pt-4"}),B&&u.jsx("div",{className:"px-6 pt-2",children:u.jsx(gs,{promptId:B.id,promptTitle:B.title,settings:B.settings,onRemove:X,onOpenPrompt:ee})}),u.jsx("div",{className:"flex-1 relative",children:u.jsxs("div",{className:"relative h-full",children:[u.jsx("textarea",{ref:W,value:l,onChange:re,onKeyPress:oe,placeholder:(null==y?void 0:y.placeholder)||"Введите сообщение или используйте голосовой ввод",className:Ne("w-full h-full pr-24 pl-6 pt-6 pb-6 backdrop-blur-sm border-2 border-border/50 rounded-3xl focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500/50 transition-all duration-300 shadow-xl resize-none chat-textarea relative z-10 bg-surface/80",y&&"active-mode"),disabled:!1,rows:4}),u.jsxs("div",{className:"absolute right-2 flex items-center gap-3 z-30 pointer-events-auto chat-input-tools-bottom",children:[u.jsx("div",{className:"input-tools",children:u.jsx(ms,{compactMode:"ultra-compact",buttons:[{id:"attach-file",name:"Файл",icon:"Paperclip",description:"Прикрепить файл",action:"attach",isEnabled:!0},{id:"prompts",name:"Промпты",icon:"Grid",description:"Заготовленные промпты",action:"prompts",isEnabled:!0},{id:"web-search",name:"Поиск",icon:"Search",description:"Поиск в интернете",action:"web-search",isEnabled:!0},{id:"toggle-panel",name:n.settings.hideChatFunctionButtons?"Показать":"Скрыть",icon:n.settings.hideChatFunctionButtons?"EyeOff":"Eye",description:n.settings.hideChatFunctionButtons?"Показать кнопки функций":"Скрыть кнопки функций",action:"toggle-panel",isEnabled:!0},{id:"voice-input",name:"Голос",icon:"Mic",description:"Голосовой ввод",action:"voice",isEnabled:!0}],onClick:e=>{switch(e.action){case"attach":ne();break;case"prompts":{const e=new CustomEvent("prompts:open");window.dispatchEvent(e),_.info("Заготовленные промпты","Открыта панель с готовыми шаблонами");break}case"web-search":{const e=new CustomEvent("web-search:open");window.dispatchEvent(e),_.info("Поиск в интернете","Открыт поиск в интернете");break}case"toggle-panel":ae();break;case"voice":ie()}}})}),u.jsx(cs,{type:"button",variant:"primary",size:"sm",title:"Отправить",className:Ne("chat-send-button rounded-lg p-0 w-[44px] h-[44px] min-w-[44px] min-h-[44px] leading-none flex items-center justify-center",!l.trim()&&"opacity-50 cursor-not-allowed"),disabled:!l.trim(),onClick:()=>{l.trim()&&(a(l),c(""),J())},children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[u.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),u.jsx("path",{d:"M22 2 11 13"})]})})]})]})})]})}),u.jsx("input",{ref:k,type:"file",multiple:!0,accept:"image/*,text/*,application/pdf",onChange:me,className:"hidden","aria-label":"Выберите файлы для загрузки"})]})]})},vs=new class{constructor(e){this.errorHandlers=[],this.errorCount=0,this.errors=[],this.config=e,this.sessionId=this.generateSessionId(),this.setupGlobalErrorHandlers()}registerErrorHandler(e){this.errorHandlers.push(e)}unregisterErrorHandler(e){const t=this.errorHandlers.indexOf(e);t>-1&&this.errorHandlers.splice(t,1)}handleError(e,t){if(this.errorCount>=this.config.maxErrorsPerSession)return;this.errorCount++;const s={id:this.generateErrorId(),message:e.message,stack:e.stack,component:null==t?void 0:t.component,service:null==t?void 0:t.service,timestamp:new Date,severity:this.determineSeverity(e,t),userAgent:navigator.userAgent,url:window.location.href,userId:null==t?void 0:t.userId,sessionId:this.sessionId};this.errors.push(s),this.config.enableConsoleLogging&&this.logToConsole(s,t),this.config.enableUserNotifications&&this.notifyUser(s),this.config.enableRemoteLogging&&this.reportToRemote(s),this.errorHandlers.forEach(s=>{try{s(e,t)}catch(r){console.error("Error in error handler:",r)}})}handlePromiseRejection(e){const t=e.reason instanceof Error?e.reason:new Error(String(e.reason));this.handleError(t,{component:"Promise",action:"rejection"})}handleResourceError(e){const t=e.target,s=new Error(`Failed to load resource: ${t.tagName}`);this.handleError(s,{component:"Resource",action:"load",metadata:{tagName:t.tagName,src:t.src||t.href}})}getErrors(){return[...this.errors]}getErrorsByService(e){return this.errors.filter(t=>t.service===e)}getErrorsByComponent(e){return this.errors.filter(t=>t.component===e)}getErrorsBySeverity(e){return this.errors.filter(t=>t.severity===e)}clearErrors(){this.errors=[],this.errorCount=0}getErrorStats(){const e={total:this.errors.length,bySeverity:{},byService:{},byComponent:{}};return this.errors.forEach(t=>{e.bySeverity[t.severity]=(e.bySeverity[t.severity]||0)+1,t.service&&(e.byService[t.service]=(e.byService[t.service]||0)+1),t.component&&(e.byComponent[t.component]=(e.byComponent[t.component]||0)+1)}),e}setupGlobalErrorHandlers(){this.config.enableErrorBoundary&&(window.addEventListener("error",e=>{this.handleError(e.error,{component:"Global",action:"unhandled"})}),window.addEventListener("unhandledrejection",e=>{this.handlePromiseRejection(e)}),window.addEventListener("error",e=>{e.target!==window&&this.handleResourceError(e)},!0))}determineSeverity(e,t){return"TypeError"===e.name||"ReferenceError"===e.name?"critical":(null==t?void 0:t.service)?"high":(null==t?void 0:t.component)?"medium":"low"}logToConsole(e,t){const s=`[ErrorHandlingService] ${e.severity.toUpperCase()}: ${e.message}`;switch(e.severity){case"critical":case"high":console.error(s,e,t);break;case"medium":console.warn(s,e,t);break;case"low":console.info(s,e,t)}}notifyUser(e){"critical"===e.severity&&console.warn("Critical error occurred:",e.message)}reportToRemote(e){return m(this,null,function*(){if(this.config.remoteEndpoint&&this.config.apiKey)try{yield fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},body:JSON.stringify(e)})}catch(t){console.error("Failed to report error to remote server:",t)}})}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateErrorId(){return`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}({enableConsoleLogging:!0,enableRemoteLogging:!1,enableUserNotifications:!0,enableErrorBoundary:!0,maxErrorsPerSession:100});class fs extends v.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){const s={component:"ErrorBoundary",action:"componentDidCatch",metadata:{componentStack:t.componentStack,errorBoundary:!0}};vs.handleError(e,s),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:u.jsx("div",{className:"error-boundary",children:u.jsxs("div",{className:"error-boundary__container",children:[u.jsx("div",{className:"error-boundary__icon",children:"⚠️"}),u.jsx("h2",{className:"error-boundary__title",children:"Что-то пошло не так"}),u.jsx("p",{className:"error-boundary__message",children:"Произошла ошибка в приложении. Мы уже работаем над её исправлением."}),u.jsxs("div",{className:"error-boundary__actions",children:[u.jsx("button",{className:"error-boundary__button error-boundary__button--primary",onClick:()=>window.location.reload(),children:"Перезагрузить страницу"}),u.jsx("button",{className:"error-boundary__button error-boundary__button--secondary",onClick:()=>this.setState({hasError:!1,error:void 0,errorInfo:void 0}),children:"Попробовать снова"})]}),!1]})}):this.props.children}}const ys=({notification:e,onClose:t})=>{const s=(e=>{switch(e){case"success":return{container:"bg-green-50 border-green-200 text-green-800",icon:"text-green-400",button:"bg-green-100 hover:bg-green-200 text-green-800"};case"error":return{container:"bg-red-50 border-red-200 text-red-800",icon:"text-red-400",button:"bg-red-100 hover:bg-red-200 text-red-800"};case"warning":return{container:"bg-yellow-50 border-yellow-200 text-yellow-800",icon:"text-yellow-400",button:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800"};case"info":return{container:"bg-primary border-primary text-background",icon:"text-background",button:"bg-primary hover:bg-primary/80 text-background"}}})(e.type);return u.jsx(p.div,{initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.95},transition:{duration:.3,ease:[.25,.46,.45,.94]},className:Ne("max-w-sm w-full p-4 rounded-lg border shadow-lg",s.container),children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx("div",{className:Ne("flex-shrink-0",s.icon),children:(e=>{switch(e){case"success":return u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"warning":return u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":return u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}})(e.type)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"text-sm font-medium mb-1",children:e.title}),u.jsx("p",{className:"text-sm opacity-90",children:e.message}),e.actions&&e.actions.length>0&&u.jsx("div",{className:"mt-3 flex space-x-2",children:e.actions.map((e,t)=>u.jsx("button",{type:"button",onClick:e.action,className:Ne("px-3 py-1 text-xs font-medium rounded transition-colors duration-200",s.button),children:e.label},t))})]}),u.jsx("button",{type:"button",onClick:()=>t(e.id),className:Ne("flex-shrink-0 p-1 rounded transition-colors duration-200",s.button),"aria-label":"Закрыть уведомление",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},bs=()=>{const[e,t]=v.useState([]);return v.useEffect(()=>_.subscribe(t),[]),u.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:u.jsx(g,{children:e.map(e=>u.jsx(ys,{notification:e,onClose:e=>_.hide(e)},e.id))})})},js=()=>{const[e,t]=v.useState("regulations"),[s,r]=v.useState(null),[i,n]=v.useState(""),a=[{id:"1",title:"Обработка входящих лидов",category:"leads",priority:"high",status:"active",lastUpdated:"2025-01-15",content:"Регламент обработки входящих лидов определяет стандарты работы с потенциальными клиентами для обеспечения высокого качества сервиса и максимальной конверсии.\n\nЦЕЛИ:\n- Обеспечить быструю реакцию на входящие заявки\n- Квалифицировать лидов по стандарту BANT\n- Максимизировать конверсию лид → клиент\n- Поддерживать высокий уровень клиентского сервиса",steps:["Время реакции: 5 минут (в рабочее время)","Квалификация по BANT (Budget, Authority, Need, Timeline)","Назначение ответственного менеджера","Создание задачи в CRM","Отправка welcome-письма","Планирование следующего контакта"],metrics:{compliance:95,efficiency:88,satisfaction:92}},{id:"2",title:"Поддержка клиентов",category:"support",priority:"high",status:"active",lastUpdated:"2025-01-14",content:"Стандарты поддержки клиентов обеспечивают быстрое и качественное решение вопросов, повышая удовлетворенность и удержание клиентов.\n\nПРИОРИТЕТЫ ОТВЕТОВ:\n- Критический (система не работает): 30 минут\n- Высокий (функция не работает): 4 часа\n- Средний (вопрос по использованию): 24 часа\n- Низкий (улучшение, идея): 7 дней",steps:["Автоматическая классификация тикета по приоритету","Назначение на специалиста соответствующего уровня","Первичный ответ в течение SLA","Диагностика и решение проблемы","Подтверждение решения с клиентом","Закрытие тикета и сбор обратной связи"],metrics:{compliance:98,efficiency:85,satisfaction:89}},{id:"3",title:"Разработка новых функций",category:"development",priority:"medium",status:"active",lastUpdated:"2025-01-13",content:"Процесс разработки новых функций обеспечивает качественную и своевременную доставку функциональности, соответствующей потребностям клиентов.\n\nЭТАПЫ РАЗРАБОТКИ:\n1. Сбор и анализ требований\n2. Техническое проектирование\n3. Разработка и тестирование\n4. Code review и QA\n5. Развертывание и мониторинг",steps:["Сбор запросов от клиентов и команды","Приоритизация по RICE (Reach, Impact, Confidence, Effort)","Создание технического задания","Разработка в спринтах по 2 недели","Code review (обязательно)","Тестирование (покрытие >80%)","Поэтапный rollout","Мониторинг и сбор метрик"],metrics:{compliance:90,efficiency:82,satisfaction:87}},{id:"4",title:"Воронки продаж",category:"sales",priority:"high",status:"active",lastUpdated:"2025-01-12",content:"Автоматизированные воронки продаж обеспечивают систематический подход к конверсии лидов в клиентов с максимальной эффективностью.\n\nСТАДИИ ВОРОНКИ:\n1. Лид (новый контакт)\n2. Квалифицирован (BANT пройден)\n3. Демо назначено\n4. Предложение отправлено\n5. Переговоры\n6. Закрыт (выигран/проигран)",steps:["Автоматическая квалификация лида","Назначение ответственного менеджера","Планирование демонстрации","Подготовка персонализированного предложения","Проведение переговоров","Закрытие сделки или возврат в nurture","Анализ результатов и оптимизация"],metrics:{compliance:93,efficiency:91,satisfaction:88}},{id:"5",title:"Маркетинг-кампании",category:"marketing",priority:"medium",status:"active",lastUpdated:"2025-01-11",content:"Процесс создания и запуска маркетинговых кампаний обеспечивает эффективное привлечение и удержание клиентов.\n\nТИПЫ КАМПАНИЙ:\n- Email-рассылки\n- Таргетированная реклама\n- Контент-маркетинг\n- Вебинары и мероприятия\n- Партнерские программы",steps:["Определение целей и KPI кампании","Сегментация целевой аудитории","Создание креативов и контента","Настройка каналов доставки","A/B тестирование элементов","Запуск и мониторинг","Анализ результатов и оптимизация"],metrics:{compliance:87,efficiency:79,satisfaction:85}}].filter(e=>e.title.toLowerCase().includes(i.toLowerCase())||e.content.toLowerCase().includes(i.toLowerCase())),o=e=>{switch(e){case"leads":return u.jsx(Wt,{className:"w-5 h-5"});case"support":return u.jsx(gt,{className:"w-5 h-5"});case"development":return u.jsx(Ot,{className:"w-5 h-5"});case"sales":return u.jsx(Vt,{className:"w-5 h-5"});case"marketing":return u.jsx(Pe,{className:"w-5 h-5"});default:return u.jsx(Ye,{className:"w-5 h-5"})}},l=e=>{switch(e){case"leads":return"Лиды";case"support":return"Поддержка";case"development":return"Разработка";case"sales":return"Продажи";case"marketing":return"Маркетинг";default:return"Общее"}},c=e=>{switch(e){case"high":return"text-red-400 bg-red-900/20 border-red-500/30";case"medium":return"text-yellow-400 bg-yellow-900/20 border-yellow-500/30";case"low":return"text-green-400 bg-green-900/20 border-green-500/30";default:return"text-gray-400 bg-gray-900/20 border-gray-500/30"}},d=e=>{switch(e){case"active":return"text-green-400 bg-green-900/20";case"draft":return"text-yellow-400 bg-yellow-900/20";default:return"text-gray-400 bg-gray-900/20"}},m=(e,t=150)=>e.length<=t?e:e.substring(0,t)+"...";return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Регламенты работы"}),u.jsx("p",{className:"text-gray-300",children:"Стандарты и процессы для эффективной работы команды"})]}),u.jsx("div",{className:"mb-6",children:u.jsxs("div",{className:"relative max-w-md",children:[u.jsx("input",{type:"text",placeholder:"Поиск регламентов...",value:i,onChange:e=>n(e.target.value),className:"w-full px-4 py-3 pl-10 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500"}),u.jsx(Ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"})]})}),u.jsx("div",{className:"flex space-x-1 mb-8 bg-white/10 rounded-lg p-1",children:[{id:"regulations",label:"Регламенты",icon:Ye},{id:"templates",label:"Шаблоны",icon:$e},{id:"compliance",label:"Соответствие",icon:Bt}].map(s=>u.jsxs("button",{onClick:()=>t(s.id),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors "+(e===s.id?"bg-purple-500 text-white":"text-gray-300 hover:text-white hover:bg-white/10"),children:[u.jsx(s.icon,{className:"w-4 h-4"}),u.jsx("span",{children:s.label})]},s.id))}),"regulations"===e&&u.jsx("div",{className:"space-y-6",children:a.map(e=>u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl border border-white/10 hover:bg-white/10 transition-all duration-300",children:[u.jsxs("div",{onClick:()=>{return t=e.id,void r(s===t?null:t);var t},className:"p-6 cursor-pointer",children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center text-white",children:o(e.category)}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:e.title}),u.jsx("p",{className:"text-sm text-gray-400",children:l(e.category)})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c(e.priority)}`,children:"high"===e.priority?"Высокий":"medium"===e.priority?"Средний":"Низкий"}),u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d(e.status)}`,children:"active"===e.status?"Активен":"draft"===e.status?"Черновик":"Архив"})]})]}),u.jsx("div",{className:"mb-4",children:u.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:m(e.content)})}),u.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[e.metrics.compliance,"%"]}),u.jsx("div",{className:"text-xs text-gray-400",children:"Соответствие"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[e.metrics.efficiency,"%"]}),u.jsx("div",{className:"text-xs text-gray-400",children:"Эффективность"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[e.metrics.satisfaction,"%"]}),u.jsx("div",{className:"text-xs text-gray-400",children:"Удовлетворенность"})]})]}),u.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[u.jsxs("span",{children:["Обновлено: ",e.lastUpdated]}),u.jsxs("span",{children:[e.steps.length," шагов"]}),u.jsx("span",{className:"text-purple-400 font-medium",children:s===e.id?"Свернуть ▼":"Развернуть ▶"})]})]}),s===e.id&&u.jsx("div",{className:"border-t border-white/10 p-6 bg-black/10",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Полное описание"}),u.jsx("div",{className:"bg-black/20 rounded-lg p-4",children:u.jsx("p",{className:"text-gray-300 whitespace-pre-wrap",children:e.content})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Шаги выполнения"}),u.jsx("div",{className:"space-y-3",children:e.steps.map((e,t)=>u.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-black/20 rounded-lg",children:[u.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-sm font-semibold flex-shrink-0",children:t+1}),u.jsx("span",{className:"text-gray-300",children:e})]},t))})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Детальные метрики"}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{className:"text-center p-4 bg-green-900/20 border border-green-500/30 rounded-lg",children:[u.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[e.metrics.compliance,"%"]}),u.jsx("div",{className:"text-sm text-gray-400",children:"Соответствие"})]}),u.jsxs("div",{className:"text-center p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:[u.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[e.metrics.efficiency,"%"]}),u.jsx("div",{className:"text-sm text-gray-400",children:"Эффективность"})]}),u.jsxs("div",{className:"text-center p-4 bg-purple-900/20 border border-purple-500/30 rounded-lg",children:[u.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[e.metrics.satisfaction,"%"]}),u.jsx("div",{className:"text-sm text-gray-400",children:"Удовлетворенность"})]})]})]})]})})]},e.id))}),"templates"===e&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Готовые шаблоны процессов"}),u.jsx("p",{className:"text-gray-300 mb-6",children:"Используйте готовые шаблоны для быстрого создания стандартизированных процессов"})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{name:"Шаблон обработки лида",description:"Полная процедура работы с новым лидом от первого контакта до квалификации",category:"leads",usage:95,steps:["Получение заявки (время реакции: 5 мин)","Первичный контакт и знакомство","Квалификация по BANT","Назначение ответственного менеджера","Создание карточки в CRM","Отправка welcome-письма","Планирование следующего контакта"],content:"ШАБЛОН ОБРАБОТКИ ЛИДА\n\nЦЕЛЬ: Максимизировать конверсию лид → клиент\n\nВРЕМЯ РЕАКЦИИ: 5 минут (в рабочее время)\n\nПРОЦЕСС:\n1. Получение заявки\n   - Проверить источник лида\n   - Зафиксировать время поступления\n   - Оценить приоритет\n\n2. Первичный контакт\n   - Позвонить в течение 5 минут\n   - Представиться и узнать цель обращения\n   - Задать уточняющие вопросы\n\n3. Квалификация по BANT\n   - Budget (бюджет): есть ли выделенный бюджет?\n   - Authority (полномочия): принимает ли решения?\n   - Need (потребность): какая проблема решается?\n   - Timeline (сроки): когда нужно решение?\n\n4. Назначение менеджера\n   - Выбрать подходящего специалиста\n   - Передать всю информацию\n   - Установить сроки следующего контакта\n\n5. CRM и документирование\n   - Создать карточку лида\n   - Заполнить все поля\n   - Добавить заметки и комментарии\n\n6. Welcome-письмо\n   - Отправить приветственное письмо\n   - Приложить полезные материалы\n   - Указать контакты менеджера\n\n7. Планирование\n   - Запланировать следующий контакт\n   - Подготовить материалы для демо\n   - Настроить напоминания"},{name:"Шаблон поддержки клиента",description:"Стандартная процедура решения проблем клиентов с учетом приоритетов",category:"support",usage:88,steps:["Классификация тикета по приоритету","Назначение на специалиста","Первичный ответ в SLA","Диагностика проблемы","Решение и тестирование","Подтверждение с клиентом","Закрытие и обратная связь"],content:"ШАБЛОН ПОДДЕРЖКИ КЛИЕНТА\n\nПРИОРИТЕТЫ SLA:\n- Критический: 30 минут\n- Высокий: 4 часа\n- Средний: 24 часа\n- Низкий: 7 дней\n\nПРОЦЕСС:\n1. Классификация тикета\n   - Определить тип проблемы\n   - Оценить влияние на бизнес\n   - Установить приоритет\n   - Назначить SLA\n\n2. Назначение специалиста\n   - Выбрать эксперта по теме\n   - Учесть загрузку команды\n   - Уведомить о новом тикете\n   - Передать контекст\n\n3. Первичный ответ\n   - Подтвердить получение\n   - Уточнить детали проблемы\n   - Дать временную оценку\n   - Предложить временное решение\n\n4. Диагностика\n   - Воспроизвести проблему\n   - Проверить логи и метрики\n   - Изучить похожие случаи\n   - Определить корневую причину\n\n5. Решение\n   - Разработать фикс\n   - Протестировать решение\n   - Подготовить инструкции\n   - Задокументировать процесс\n\n6. Подтверждение\n   - Проверить с клиентом\n   - Убедиться в решении\n   - Собрать обратную связь\n   - Предложить улучшения\n\n7. Закрытие\n   - Обновить статус тикета\n   - Добавить в базу знаний\n   - Отправить итоговое письмо\n   - Запланировать follow-up"},{name:"Шаблон разработки функции",description:"Чек-лист для создания новых возможностей продукта",category:"development",usage:92,steps:["Сбор и анализ требований","Техническое проектирование","Разработка в спринтах","Code review и QA","Тестирование и отладка","Развертывание","Мониторинг и метрики"],content:"ШАБЛОН РАЗРАБОТКИ ФУНКЦИИ\n\nЭТАПЫ РАЗРАБОТКИ:\n1. Сбор требований\n2. Техническое проектирование\n3. Разработка и тестирование\n4. Code review и QA\n5. Развертывание и мониторинг\n\nПРОЦЕСС:\n1. СБОР ТРЕБОВАНИЙ\n   - Интервью с заказчиком\n   - Анализ пользовательских историй\n   - Приоритизация по RICE\n   - Создание технического задания\n   - Оценка трудозатрат\n\n2. ТЕХНИЧЕСКОЕ ПРОЕКТИРОВАНИЕ\n   - Архитектурное решение\n   - Выбор технологий\n   - Диаграммы и схемы\n   - API дизайн\n   - План миграции данных\n\n3. РАЗРАБОТКА\n   - Создание ветки feature\n   - Разработка в спринтах (2 недели)\n   - Ежедневные стендапы\n   - Промежуточные демо\n   - Документирование кода\n\n4. CODE REVIEW И QA\n   - Обязательный code review\n   - Автоматические тесты (>80%)\n   - Ручное тестирование\n   - Performance тестирование\n   - Security аудит\n\n5. ТЕСТИРОВАНИЕ\n   - Unit тесты\n   - Integration тесты\n   - E2E тесты\n   - User acceptance тесты\n   - Нагрузочное тестирование\n\n6. РАЗВЕРТЫВАНИЕ\n   - Подготовка к релизу\n   - Поэтапный rollout\n   - Feature flags\n   - Rollback план\n   - Уведомления пользователей\n\n7. МОНИТОРИНГ\n   - Настройка метрик\n   - Алерты и уведомления\n   - Сбор обратной связи\n   - Анализ использования\n   - Планирование улучшений"},{name:"Шаблон продажной встречи",description:"Структура проведения демонстрации и переговоров",category:"sales",usage:85,steps:["Подготовка к встрече","Установление раппорта","Выявление потребностей","Демонстрация решения","Работа с возражениями","Закрытие сделки","Планирование следующих шагов"],content:"ШАБЛОН ПРОДАЖНОЙ ВСТРЕЧИ\n\nСТРУКТУРА ВСТРЕЧИ (60-90 минут):\n1. Подготовка (5 мин)\n2. Установление раппорта (10 мин)\n3. Выявление потребностей (20 мин)\n4. Демонстрация (30 мин)\n5. Работа с возражениями (15 мин)\n6. Закрытие (10 мин)\n\nПРОЦЕСС:\n1. ПОДГОТОВКА К ВСТРЕЧЕ\n   - Изучить профиль клиента\n   - Подготовить персонализированную демо\n   - Проверить технику\n   - Подготовить материалы\n   - Настроить CRM\n\n2. УСТАНОВЛЕНИЕ РАППОРТА\n   - Представиться и поблагодарить\n   - Кратко рассказать о компании\n   - Узнать о роли собеседника\n   - Установить повестку встречи\n   - Создать комфортную атмосферу\n\n3. ВЫЯВЛЕНИЕ ПОТРЕБНОСТЕЙ\n   - Какие задачи решаете сейчас?\n   - Какие проблемы возникают?\n   - Как оцениваете текущее решение?\n   - Какие критерии важны при выборе?\n   - Какие сроки у проекта?\n\n4. ДЕМОНСТРАЦИЯ РЕШЕНИЯ\n   - Показать релевантные функции\n   - Связать с выявленными потребностями\n   - Продемонстрировать ROI\n   - Показать интеграции\n   - Ответить на вопросы\n\n5. РАБОТА С ВОЗРАЖЕНИЯМИ\n   - Выслушать полностью\n   - Уточнить детали\n   - Признать правомерность\n   - Предложить решение\n   - Проверить понимание\n\n6. ЗАКРЫТИЕ СДЕЛКИ\n   - Резюмировать ценность\n   - Уточнить следующие шаги\n   - Обсудить условия\n   - Зафиксировать договоренности\n   - Назначить следующую встречу\n\n7. ПЛАНИРОВАНИЕ\n   - Отправить материалы\n   - Обновить CRM\n   - Запланировать follow-up\n   - Подготовить предложение\n   - Координировать с командой"},{name:"Шаблон маркетинговой кампании",description:"План создания и запуска эффективной маркетинговой кампании",category:"marketing",usage:78,steps:["Определение целей и KPI","Сегментация аудитории","Создание контента","Настройка каналов","A/B тестирование","Запуск и мониторинг","Анализ и оптимизация"],content:"ШАБЛОН МАРКЕТИНГОВОЙ КАМПАНИИ\n\nТИПЫ КАМПАНИЙ:\n- Email-рассылки\n- Таргетированная реклама\n- Контент-маркетинг\n- Вебинары и мероприятия\n- Партнерские программы\n\nПРОЦЕСС:\n1. ОПРЕДЕЛЕНИЕ ЦЕЛЕЙ\n   - Бизнес-цели кампании\n   - KPI и метрики успеха\n   - Бюджет и ресурсы\n   - Временные рамки\n   - Критерии успеха\n\n2. СЕГМЕНТАЦИЯ АУДИТОРИИ\n   - Анализ целевой аудитории\n   - Создание персон\n   - Сегментация по интересам\n   - Выбор каналов коммуникации\n   - Персонализация сообщений\n\n3. СОЗДАНИЕ КОНТЕНТА\n   - Креативная концепция\n   - Копирайтинг\n   - Дизайн материалов\n   - Видео и изображения\n   - Landing pages\n\n4. НАСТРОЙКА КАНАЛОВ\n   - Email-платформа\n   - Рекламные кабинеты\n   - Социальные сети\n   - Веб-сайт\n   - CRM интеграция\n\n5. A/B ТЕСТИРОВАНИЕ\n   - Тестирование заголовков\n   - Варианты дизайна\n   - Время отправки\n   - Call-to-action\n   - Целевые страницы\n\n6. ЗАПУСК И МОНИТОРИНГ\n   - Поэтапный запуск\n   - Отслеживание метрик\n   - Настройка алертов\n   - Ежедневные отчеты\n   - Быстрые корректировки\n\n7. АНАЛИЗ И ОПТИМИЗАЦИЯ\n   - Сбор данных\n   - Анализ результатов\n   - Выявление паттернов\n   - Планирование улучшений\n   - Документирование learnings"},{name:"Шаблон онбординга клиента",description:"Процедура введения нового клиента в продукт и процессы",category:"support",usage:90,steps:["Приветствие и знакомство","Настройка аккаунта","Обучение основам","Настройка интеграций","Планирование внедрения","Первые результаты","Долгосрочная поддержка"],content:"ШАБЛОН ОНБОРДИНГА КЛИЕНТА\n\nЦЕЛЬ: Максимизировать time-to-value и удержание клиентов\n\nПРОЦЕСС (30-60 дней):\n1. ПРИВЕТСТВИЕ И ЗНАКОМСТВО\n   - Персональное приветствие\n   - Знакомство с командой\n   - Обзор процесса онбординга\n   - Установление каналов связи\n   - Определение ролей и ответственности\n\n2. НАСТРОЙКА АККАУНТА\n   - Создание пользователей\n   - Настройка прав доступа\n   - Конфигурация системы\n   - Импорт данных\n   - Тестирование доступа\n\n3. ОБУЧЕНИЕ ОСНОВАМ\n   - Вводная сессия (2-4 часа)\n   - Демонстрация ключевых функций\n   - Практические упражнения\n   - Q&A сессия\n   - Материалы для самостоятельного изучения\n\n4. НАСТРОЙКА ИНТЕГРАЦИЙ\n   - Анализ существующих систем\n   - Планирование интеграций\n   - Настройка API подключений\n   - Тестирование данных\n   - Документирование процессов\n\n5. ПЛАНИРОВАНИЕ ВНЕДРЕНИЯ\n   - Roadmap внедрения\n   - Определение этапов\n   - Назначение ответственных\n   - Установление чекпоинтов\n   - Планирование ресурсов\n\n6. ПЕРВЫЕ РЕЗУЛЬТАТЫ\n   - Запуск пилотного проекта\n   - Сбор обратной связи\n   - Анализ метрик\n   - Корректировка процессов\n   - Празднование успехов\n\n7. ДОЛГОСРОЧНАЯ ПОДДЕРЖКА\n   - Регулярные check-in встречи\n   - Расширенное обучение\n   - Оптимизация процессов\n   - Планирование роста\n   - Стратегическое партнерство"}].map((e,t)=>u.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl border border-white/10 hover:bg-white/10 transition-all duration-300",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center text-white",children:o(e.category)}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:e.name}),u.jsx("p",{className:"text-sm text-gray-400",children:l(e.category)})]})]}),u.jsx("p",{className:"text-gray-300 mb-4",children:e.description}),u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-white mb-2",children:"Основные этапы:"}),u.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[e.steps.slice(0,3).map((e,t)=>u.jsxs("li",{className:"flex items-start",children:[u.jsx("span",{className:"text-blue-400 mr-2",children:"•"}),e]},t)),e.steps.length>3&&u.jsxs("li",{className:"text-gray-400 text-xs",children:["+",e.steps.length-3," этапов..."]})]})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(Vt,{className:"w-4 h-4 text-green-400"}),u.jsxs("span",{className:"text-sm text-gray-300",children:[e.usage,"% использования"]})]}),u.jsx("button",{className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg hover:from-blue-600 hover:to-cyan-600 transition-all duration-300",children:"Использовать"})]})]})},t))})]}),"compliance"===e&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Общее соответствие"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-900/20 border border-green-500/30 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-medium",children:"Соответствие регламентам"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Средний показатель по всем процессам"})]}),u.jsx("div",{className:"text-2xl font-bold text-green-400",children:"94%"})]}),u.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-medium",children:"Эффективность процессов"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Скорость выполнения задач"})]}),u.jsx("div",{className:"text-2xl font-bold text-blue-400",children:"87%"})]}),u.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-900/20 border border-purple-500/30 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-medium",children:"Удовлетворенность команды"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Оценка удобства процессов"})]}),u.jsx("div",{className:"text-2xl font-bold text-purple-400",children:"91%"})]})]})]}),u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Области для улучшения"}),u.jsx("div",{className:"space-y-4",children:[{area:"Маркетинг-кампании",issue:"Низкая эффективность email-рассылок",priority:"high",action:"Оптимизировать шаблоны писем"},{area:"Поддержка клиентов",issue:"Долгое время ответа на сложные вопросы",priority:"medium",action:"Добавить больше FAQ и автоматизацию"},{area:"Разработка",issue:"Частые изменения требований",priority:"medium",action:"Улучшить процесс сбора требований"}].map((e,t)=>u.jsxs("div",{className:"p-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[u.jsxs("div",{className:"flex items-start justify-between mb-2",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-medium",children:e.area}),u.jsx("div",{className:"text-sm text-gray-400",children:e.issue})]}),u.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("high"===e.priority?"text-red-400 bg-red-900/20":"text-yellow-400 bg-yellow-900/20"),children:"high"===e.priority?"Высокий":"Средний"})]}),u.jsx("div",{className:"text-sm text-yellow-300",children:e.action})]},t))})]})]})]})})},ws=()=>{const[e,t]=v.useState("scripts"),[s,r]=v.useState(null),[i,n]=v.useState(!1),a=[{id:"1",name:"Холодный звонок B2B",type:"cold_call",industry:"B2B",duration:300,successRate:25,content:"Добрый день, [Имя]! Меня зовут [Ваше имя] из Boss AI.\nМы помогаем компаниям автоматизировать продажи и маркетинг\nс помощью искусственного интеллекта.\n\nУ вас сейчас есть 2 минуты, чтобы я рассказал, как мы помогли\n[Компания-аналог] увеличить конверсию на 47%?\n\n[Пауза для ответа]\n\nОтлично! Вот что Boss AI может для вас сделать:\n\n1. AI-ассистент обработает 80% рутинных запросов автоматически\n2. CRM с умным скорингом покажет, на каких лидов тратить время\n3. Воронки продаж автоматизируют follow-up и напоминания\n4. Аналитика в реальном времени покажет, где теряются клиенты\n\nВ среднем наши клиенты видят:\n- +35% конверсия лид→клиент\n- -50% время на рутину\n- +25% средний чек (за счет допродаж)\n\nРезультат: рост выручки на 40-60% за первые 3 месяца.\n\n[Работа с возражениями]\n\nОтлично! Я вижу, что Boss AI может реально помочь вашему бизнесу.\nПредлагаю так: мы дадим вам 14 дней бесплатного доступа ко всем функциям.\nНаш специалист настроит систему под ваши процессы, и вы увидите результаты.\nЕсли не понравится - просто перестанете пользоваться. Риска ноль.\n\nКогда вам удобно начать - в понедельник или среду?",tips:["Используйте имя клиента в начале разговора","Создайте срочность, но не давите","Фокусируйтесь на выгодах, а не на функциях","Слушайте больше, чем говорите","Всегда предлагайте следующий шаг"],objections:["Дорого → ROI расчет","Нам ничего не нужно → Вопрос о росте на 40%","Уже используем конкурента → Сравнение преимуществ","Нет времени → 2 минуты демо","Нужно подумать → Ограниченное предложение"],isActive:!0,createdAt:"2025-01-15"},{id:"2",name:"Теплый лид (входящая заявка)",type:"warm_lead",industry:"Все",duration:1800,successRate:60,content:"Тема: Ваша заявка на Boss AI - начнем прямо сейчас!\n\nПривет, [Имя]!\n\nСпасибо за интерес к Boss AI! 🚀\n\nЯ [Ваше имя], и я помогу вам начать. Вот что дальше:\n\n1. Я забронировал для вас 30-минутную персональную демонстрацию\n2. Мы покажем, как Boss AI решит именно ваши задачи\n3. Вы получите персональное предложение со скидкой 20%\n\nВыберите удобное время: [Ссылка на календарь]\n\nИли напишите мне в WhatsApp: [Номер]\n\nP.S. Первые 10 клиентов этого месяца получают бонус:\nбесплатная настройка системы ($2,000 value) 🎁\n\nДо встречи!\n[Ваше имя]\n[Должность]\nBoss AI",tips:["Отвечайте в течение 5 минут","Персонализируйте каждое письмо","Предлагайте конкретные следующие шаги","Используйте социальные доказательства","Создавайте срочность"],objections:[],isActive:!0,createdAt:"2025-01-15"},{id:"3",name:"Демонстрация продукта",type:"demo",industry:"Все",duration:1800,successRate:40,content:"Структура демонстрации (30 минут):\n\nМИНУТЫ 1-5: ЗНАКОМСТВО\n- Представление и благодарность за время\n- Уточнение задач и болевых точек клиента\n- Постановка целей демонстрации\n- Согласование формата\n\nМИНУТЫ 6-20: ДЕМОНСТРАЦИЯ\n1. AI-ассистент (5 мин)\n   - Показ живого диалога\n   - Решение реальной задачи клиента\n   - Объяснение принципов работы\n\n2. CRM и воронки (5 мин)\n   - Импорт данных клиента\n   - Настройка воронки под их процесс\n   - AI-скоринг лидов\n\n3. Маркетинг-автоматизация (5 мин)\n   - Email-кампании\n   - Лид-магниты\n   - Аналитика\n\nМИНУТЫ 21-25: ВОПРОСЫ И ВОЗРАЖЕНИЯ\n- Активное слушание\n- Уточняющие вопросы\n- Работа с сомнениями\n- Дополнительные функции\n\nМИНУТЫ 26-30: ЗАКРЫТИЕ\n- Резюме ценности для клиента\n- Предложение тарифа\n- Следующие шаги\n- Согласование сроков",tips:["Готовьтесь к каждому демо индивидуально","Используйте реальные данные клиента","Показывайте, а не рассказывайте","Задавайте вопросы каждые 2-3 минуты","Всегда заканчивайте конкретным предложением"],objections:[],isActive:!0,createdAt:"2025-01-15"}],o=e=>{switch(e){case"cold_call":return u.jsx(It,{className:"w-5 h-5"});case"warm_lead":return u.jsx(mt,{className:"w-5 h-5"});case"demo":return u.jsx(Tt,{className:"w-5 h-5"});case"objection_handling":return u.jsx(Ee,{className:"w-5 h-5"});case"closing":return u.jsx(Wt,{className:"w-5 h-5"});default:return u.jsx(gt,{className:"w-5 h-5"})}},l=e=>{switch(e){case"cold_call":return"Холодный звонок";case"warm_lead":return"Теплый лид";case"demo":return"Демонстрация";case"objection_handling":return"Работа с возражениями";case"closing":return"Закрытие сделки";default:return"Скрипт"}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Скрипты продаж"}),u.jsx("p",{className:"text-gray-300",children:"Готовые скрипты для всех этапов продаж"})]}),u.jsx("div",{className:"flex space-x-1 mb-8 bg-white/10 rounded-lg p-1",children:[{id:"scripts",label:"Скрипты",icon:gt},{id:"templates",label:"Шаблоны",icon:Et},{id:"analytics",label:"Аналитика",icon:Vt}].map(s=>u.jsxs("button",{type:"button",onClick:()=>t(s.id),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors "+(e===s.id?"bg-purple-500 text-white":"text-gray-300 hover:text-white hover:bg-white/10"),children:[u.jsx(s.icon,{className:"w-4 h-4"}),u.jsx("span",{children:s.label})]},s.id))}),"scripts"===e&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsx("div",{className:"space-y-4",children:a.map(e=>u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10 hover:bg-white/10 transition-all duration-300",children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center text-white",children:o(e.type)}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:e.name}),u.jsxs("p",{className:"text-sm text-gray-400",children:[l(e.type)," • ",e.industry]})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(Ht,{className:"w-4 h-4 text-yellow-400 fill-current"}),u.jsxs("span",{className:"text-sm text-gray-300",children:[e.successRate,"%"]})]}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(We,{className:"w-4 h-4 text-gray-400"}),u.jsxs("span",{className:"text-sm text-gray-300",children:[Math.floor(e.duration/60),"м"]})]})]})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("button",{type:"button",onClick:()=>(e=>{r(e),n(!0),setTimeout(()=>n(!1),100*e.duration)})(e),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-300",children:[u.jsx(Tt,{className:"w-4 h-4"}),u.jsx("span",{children:"Воспроизвести"})]}),u.jsxs("button",{type:"button",onClick:()=>(e=>{navigator.clipboard.writeText(e.content)})(e),className:"flex items-center space-x-2 px-4 py-2 bg-white/10 text-white rounded-lg hover:bg-white/20 transition-colors",children:[u.jsx(Ve,{className:"w-4 h-4"}),u.jsx("span",{children:"Копировать"})]})]}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(ze,{className:"w-5 h-5 text-green-400"}),u.jsx("span",{className:"text-sm text-green-400",children:"Активен"})]})]})]},e.id))}),u.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:s?u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"text-xl font-semibold text-white",children:s.name}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),u.jsx("span",{className:"text-sm text-gray-300",children:i?"Воспроизведение...":"Готов к воспроизведению"})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Содержание скрипта"}),u.jsx("div",{className:"bg-black/20 rounded-lg p-4 max-h-64 overflow-y-auto",children:u.jsx("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap",children:s.content})})]}),s.tips.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Советы по использованию"}),u.jsx("ul",{className:"space-y-2",children:s.tips.map((e,t)=>u.jsxs("li",{className:"flex items-start space-x-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-400 mt-1 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-gray-300",children:e})]},t))})]}),s.objections.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Работа с возражениями"}),u.jsx("div",{className:"space-y-2",children:s.objections.map((e,t)=>u.jsx("div",{className:"bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-3",children:u.jsx("span",{className:"text-sm text-yellow-300",children:e})},t))})]})]})]}):u.jsxs("div",{className:"text-center py-12",children:[u.jsx(gt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Выберите скрипт"}),u.jsx("p",{className:"text-gray-400",children:"Нажмите на скрипт слева, чтобы увидеть его содержимое"})]})})]}),"templates"===e&&u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{name:"Email для холодных лидов",description:"Шаблон для email-рассылок по холодной базе",industry:"B2B",successRate:15},{name:"Скрипт для демо-звонка",description:"Структура демонстрации продукта",industry:"Все",successRate:40},{name:"Работа с возражениями",description:"Ответы на типовые возражения клиентов",industry:"Все",successRate:60},{name:"Закрытие сделки",description:"Техники закрытия и получения согласия",industry:"Все",successRate:35},{name:"Follow-up после встречи",description:"Письмо после демонстрации или встречи",industry:"Все",successRate:25},{name:"Реактивация клиентов",description:"Возврат неактивных клиентов",industry:"Все",successRate:20}].map((e,t)=>u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10 hover:bg-white/10 transition-all duration-300",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center text-white",children:u.jsx(Et,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:e.name}),u.jsx("p",{className:"text-sm text-gray-400",children:e.industry})]})]}),u.jsx("p",{className:"text-gray-300 mb-4",children:e.description}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(Ht,{className:"w-4 h-4 text-yellow-400 fill-current"}),u.jsxs("span",{className:"text-sm text-gray-300",children:[e.successRate,"% успеха"]})]}),u.jsx("button",{type:"button",className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg hover:from-blue-600 hover:to-cyan-600 transition-all duration-300",children:"Использовать"})]})]},t))}),"analytics"===e&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Эффективность скриптов"}),u.jsx("div",{className:"space-y-4",children:[{name:"Холодный звонок B2B",successRate:25,usage:45,revenue:125e3},{name:"Теплый лид",successRate:60,usage:30,revenue:18e4},{name:"Демонстрация",successRate:40,usage:25,revenue:95e3}].map((e,t)=>u.jsxs("div",{className:"flex items-center justify-between p-4 bg-black/20 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-medium",children:e.name}),u.jsxs("div",{className:"text-sm text-gray-400",children:[e.usage,"% использования"]})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("div",{className:"text-green-400 font-semibold",children:[e.successRate,"%"]}),u.jsxs("div",{className:"text-sm text-gray-400",children:["$",e.revenue.toLocaleString()]})]})]},t))})]}),u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Рекомендации"}),u.jsx("div",{className:"space-y-4",children:["Улучшить скрипт холодных звонков - добавить больше персонализации","Создать A/B тест для email-шаблонов","Добавить больше социальных доказательств в демо","Обучить команду работе с возражениями","Автоматизировать follow-up после встреч"].map((e,t)=>u.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[u.jsx(Ee,{className:"w-5 h-5 text-yellow-400 mt-0.5 flex-shrink-0"}),u.jsx("span",{className:"text-sm text-yellow-300",children:e})]},t))})]})]})]})})},Ns={sm:"p-3",md:"p-4",lg:"p-6",xl:"p-8"},ks={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"},Ss={none:"shadow-none",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg",xl:"shadow-xl"},Cs={default:"platform-card",glass:"platform-card-glass",solid:"platform-card-solid",elevated:"platform-card-elevated",outlined:"platform-card-outlined"},Es=v.memo(e=>{var t=e,{variant:s="default",size:r="md",hover:i=!0,clickable:n=!1,rounded:a="lg",shadow:o="md",children:m,className:h}=t,g=d(t,["variant","size","hover","clickable","rounded","shadow","children","className"]);const x=Ne("platform-card-base",Cs[s],Ns[r],ks[a],Ss[o],i&&"platform-card-hover",n&&"platform-card-clickable",h),v=l(l({initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"}},i&&{whileHover:{y:-2,scale:1.01,transition:{duration:.2}}}),n&&{whileTap:{scale:.98,transition:{duration:.1}}});return u.jsx(p.div,c(l(l({className:x},v),g),{children:m}))});Es.displayName="UnifiedCard";const Is={sm:"h-1",md:"h-2",lg:"h-3"},Ts={sm:"w-1",md:"w-2",lg:"w-3"},As={small:{value:1,label:"Маленький",size:"0.875rem"},medium:{value:2,label:"Средний",size:"1rem"},large:{value:3,label:"Большой",size:"1.125rem"}};v.memo(e=>{var t=e,{variant:s="default",size:r="md",orientation:i="horizontal",showValue:n=!0,showLabels:a=!1,labels:o=[],value:c=0,onChange:m,onValueChange:h,min:p=0,max:g=100,step:x=1,className:f}=t,y=d(t,["variant","size","orientation","showValue","showLabels","labels","value","onChange","onValueChange","min","max","step","className"]);const[b,j]=v.useState(!1),[w,N]=v.useState(c),k=v.useRef(null),S=void 0!==c?c:w,C=m||h,E=v.useCallback(e=>{const t=(e-Number(p))/(Number(g)-Number(p))*100;k.current&&k.current.style.setProperty("--percent",`${t}%`)},[p,g]);v.useEffect(()=>{E(S)},[S,E]);const I=v.useCallback(e=>{N(e),null==C||C(e)},[C]),T=v.useCallback(e=>{if(!k.current)return;const t=k.current.getBoundingClientRect(),s="touches"in e?e.touches[0].clientX:e.clientX,r="touches"in e?e.touches[0].clientY:e.clientY;let n;if("horizontal"===i){const e=s-t.left;n=Math.max(0,Math.min(100,e/t.width*100))}else{const e=r-t.top;n=Math.max(0,Math.min(100,e/t.height*100))}const a=Number(p)+n/100*(Number(g)-Number(p)),o=Math.round(a/Number(x))*Number(x),l=Math.max(Number(p),Math.min(Number(g),o));I(l)},[p,g,x,i,I]),A=v.useCallback(e=>{const t=Object.keys(As).find(t=>As[t].value===e);t&&I(As[t].value)},[I]),M=(()=>{if("fontSize"!==s)return null;const e=Object.keys(As).find(e=>As[e].value===S);return e?As[e]:As.medium})(),R=Ne("appearance-none outline-none cursor-pointer transition-all duration-200","horizontal"===i?Is[r]:Ts[r],"vertical"===i&&"writing-mode: bt-lr; -webkit-appearance: slider-vertical",(()=>{switch(s){case"rainbow":return"rainbow-slider";case"hue":return"theme-selector-hue-strip";case"brightness":return"theme-selector-brightness-strip";case"fontSize":return"font-size-slider";default:return"platform-slider"}})(),f);return u.jsxs("div",{className:"space-y-4",children:["fontSize"===s&&M&&u.jsxs("div",{className:"p-4 rounded-lg border font-size-preview","data-font-size":M.size,children:[u.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Предварительный просмотр:"}),u.jsxs("div",{className:"font-medium",children:["Размер шрифта: ",M.label]}),u.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Заголовок H1, обычный текст и мелкий текст"})]}),a&&o.length>0&&u.jsx("div",{className:Ne("flex text-sm text-muted-foreground","vertical"===i?"flex-col h-32 justify-between":"justify-between"),children:o.map((e,t)=>u.jsx("span",{children:e},t))}),u.jsxs("div",{className:"relative",children:["fontSize"===s&&u.jsx("div",{className:"w-full h-2 bg-black dark:bg-black rounded-full relative",children:u.jsx("div",{className:"absolute top-0 h-2 bg-primary rounded-full transition-all duration-200","data-width":(S-1)/2*100})}),u.jsx("input",l({ref:k,type:"range",min:p,max:g,step:x,value:S,onChange:e=>{const t=Number(e.target.value);"fontSize"===s?A(t):I(t)},onMouseDown:()=>j(!0),onMouseUp:()=>j(!1),onTouchStart:()=>j(!0),onTouchEnd:()=>j(!1),className:R,"data-percent":(S-Number(p))/(Number(g)-Number(p))*100},y)),"fontSize"===s&&u.jsx("div",{className:"absolute inset-0 cursor-pointer",onMouseDown:T,onMouseMove:e=>{b&&T(e)},onMouseUp:()=>j(!1),onMouseLeave:()=>j(!1),onTouchStart:T,onTouchMove:T,onTouchEnd:()=>j(!1)}),"fontSize"===s&&u.jsx("div",{className:Ne("font-size-slider-thumb",b?"scale-110 shadow-xl":"hover:scale-105"),"data-position":(S-1)/2})]}),n&&u.jsxs("div",{className:"flex justify-between items-center text-sm",children:[u.jsx("span",{className:"text-muted-foreground",children:"fontSize"===s&&M?M.label:`${S}${"hue"===s?"°":"brightness"===s?"%":""}`}),"rainbow"===s&&u.jsxs("div",{className:"text-xs text-muted-foreground",children:["HSL: ",Math.round(S/100*360),", 100%, 50%"]})]})]})}).displayName="UnifiedSlider";const Ms={active:"platform-service-active",inactive:"platform-service-inactive",loading:"platform-service-loading",error:"platform-service-error"},Rs={sm:"p-3",md:"p-4",lg:"p-6"},Ps=v.memo(({id:e,title:t,description:s,icon:r,status:i="inactive",variant:n="default",size:a="md",hover:o=!0,actions:l=[],onToggle:c,onConfigure:d,className:m,children:h})=>{const p="active"===i,g="loading"===i,x="error"===i;return u.jsxs(Es,{variant:n,size:a,hover:o,clickable:!!c,className:Ne("platform-service",Ms[i],Rs[a],m),onClick:()=>{c&&!g&&c(!p)},children:[u.jsx("div",{className:"platform-service-header-standard",children:u.jsxs("div",{className:"platform-service-header-content",children:[u.jsx("div",{className:"platform-service-icon",children:r}),u.jsxs("div",{className:"platform-service-content",children:[u.jsx("h3",{className:"platform-service-title",children:t}),s&&u.jsx("p",{className:"platform-service-description",children:s})]}),u.jsxs("div",{className:"platform-service-status",children:[g&&u.jsx("div",{className:"platform-service-spinner"}),x&&u.jsx("div",{className:"platform-service-error-icon",children:"⚠️"}),p&&!g&&!x&&u.jsx("div",{className:"platform-service-active-icon",children:"✓"})]})]})}),h&&u.jsx("div",{className:"platform-service-body",children:h}),(l.length>0||d)&&u.jsxs("div",{className:"platform-service-actions",children:[l.map(e=>u.jsx(cs,{variant:e.variant||"secondary",size:"sm",onClick:t=>{t.stopPropagation(),e.onClick()},disabled:e.disabled||g,children:e.label},e.id)),d&&u.jsx(cs,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),d&&!g&&d()},disabled:g,children:"Настроить"})]})]})});Ps.displayName="UnifiedService";const Ls={glass:{initial:{background:"var(--glass-bg)",backdropFilter:"blur(20px)",border:"1px solid var(--glass-border)",boxShadow:"0 8px 32px var(--glass-bg)"},hover:{background:"var(--button-secondary-hover)",backdropFilter:"blur(25px)",borderColor:"var(--primary)",boxShadow:"0 16px 48px var(--glass-border)",y:-8,scale:1.02}},neumorphism:{initial:{background:"var(--primary)",boxShadow:"8px 8px 16px var(--neumorphism-dark), -8px -8px 16px var(--neumorphism-light)"},hover:{y:-4,boxShadow:"12px 12px 24px var(--neumorphism-dark), -12px -12px 24px var(--neumorphism-light)",scale:1.01}},solid:{initial:{background:"var(--surface)",border:"1px solid var(--border)",boxShadow:"0 4px 16px var(--glass-bg)"},hover:{background:"var(--surface-hover)",borderColor:"var(--primary)",boxShadow:"0 8px 24px var(--glass-border)",y:-4,scale:1.01}},gradient:{initial:{background:"linear-gradient(135deg, var(--glass-bg), var(--neumorphism-light))",border:"1px solid var(--glass-border)",boxShadow:"0 8px 32px var(--glass-bg)"},hover:{background:"linear-gradient(135deg, var(--button-secondary-hover), var(--neumorphism-light))",borderColor:"var(--primary)",boxShadow:"0 16px 48px var(--glass-border)",y:-6,scale:1.02}}},$s={sm:"p-3",md:"p-4",lg:"p-6"};v.memo(e=>{var t=e,{variant:s="glass",size:r="md",hover:i=!0,animationType:n="none",children:a,className:o}=t,m=d(t,["variant","size","hover","animationType","children","className"]);const h=$s[r],g={initial:"initial",whileHover:i?"hover":void 0,variants:Ls[s],animate:"float"===n?{y:[0,-10,0],transition:{duration:3,repeat:1/0,ease:"easeInOut"}}:void 0,transition:{duration:.3,ease:[.4,0,.2,1]}};return u.jsxs(p.div,c(l(c(l({},g),{className:Ne("relative rounded-xl overflow-hidden transition-all duration-300",h,o),style:{}}),m),{children:["glass-shimmer"===n&&u.jsx(p.div,{className:"absolute inset-0 opacity-20",style:{background:"linear-gradient(90deg, transparent, var(--glass-border), transparent)",backgroundSize:"200% 100%"},animate:{backgroundPosition:["-200% 0","200% 0"]},transition:{duration:3,repeat:1/0,ease:"linear"}}),"gradient"===s&&u.jsx(p.div,{className:"absolute inset-0 opacity-0",whileHover:{opacity:.1},style:{background:"linear-gradient(135deg, var(--primary), var(--secondary))"}}),u.jsx("div",{className:"relative z-10",children:a}),u.jsx(p.div,{className:"absolute inset-0 rounded-xl overflow-hidden pointer-events-none",initial:{scale:0,opacity:0},whileTap:{scale:1,opacity:[0,.1,0]},transition:{duration:.6,ease:[.4,0,.2,1]},style:{background:"radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%)"}})]}))}).displayName="AnimatedCard",v.memo(e=>{var t=e,{variant:s="fade",direction:r="up",delay:i=0,duration:n=.5,stagger:a=.1,children:o,className:m}=t,h=d(t,["variant","direction","delay","duration","stagger","children","className"]);const g=((e,t,s)=>{const r={fade:{initial:{opacity:0},animate:{opacity:1,transition:{duration:.5,ease:[.4,0,.2,1]}},exit:{opacity:0,transition:{duration:.3,ease:[.4,0,.2,1]}}},slide:{initial:{opacity:0,x:"left"===t?-100:"right"===t?100:0,y:"up"===t?-100:"down"===t?100:0},animate:{opacity:1,x:0,y:0,transition:{duration:.6,ease:[.4,0,.2,1]}},exit:{opacity:0,x:"left"===t?-100:"right"===t?100:0,y:"up"===t?-100:"down"===t?100:0,transition:{duration:.4,ease:[.4,0,.2,1]}}},scale:{initial:{opacity:0,scale:.8,rotate:-5},animate:{opacity:1,scale:1,rotate:0,transition:{duration:.5,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:.8,rotate:5,transition:{duration:.3,ease:[.4,0,.2,1]}}},stagger:{initial:{},animate:{transition:{staggerChildren:s||.1,delayChildren:.1}}}};return r[e]||r.fade})(s,r,a),x=((e,t)=>{const s={fade:{initial:{opacity:0},animate:{opacity:1,transition:{duration:.4,ease:[.4,0,.2,1]}}},slide:{initial:{opacity:0,x:"left"===t?-50:"right"===t?50:0,y:"up"===t?-50:"down"===t?50:0},animate:{opacity:1,x:0,y:0,transition:{duration:.4,ease:[.4,0,.2,1]}}},scale:{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0,transition:{duration:.4,ease:[.4,0,.2,1]}}},stagger:{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1,transition:{duration:.4,ease:[.4,0,.2,1]}}}};return s[e]||s.fade})(s,r),v={initial:"initial",animate:"animate",exit:"exit",variants:g,transition:{duration:n,delay:i,ease:[.4,0,.2,1]}};return"stagger"===s?u.jsx(p.div,c(l(c(l({},v),{className:Ne("relative",m)}),h),{children:f.Children.map(o,(e,t)=>u.jsx(p.div,{variants:x,className:"relative",children:e},t))})):u.jsx(p.div,c(l(c(l({},v),{className:Ne("relative",m)}),h),{children:o}))});const _s={subtle:{scale:1.02,duration:.2},medium:{scale:1.05,duration:.3},strong:{scale:1.1,duration:.4}};v.memo(({children:e,variant:t="ripple",intensity:s="medium",duration:r=.3,delay:i=0,disabled:n=!1,className:a,onClick:o,onHover:d,tooltip:m,tooltipPosition:h="top"})=>{const[x,f]=v.useState([]),[y,b]=v.useState(!1),j=v.useRef(null),w=v.useRef(0),N=_s[s];return u.jsxs("div",{ref:j,className:Ne("relative inline-block",a),onMouseEnter:()=>{n||null==d||d(!0)},onMouseLeave:()=>{n||null==d||d(!1)},onMouseDown:e=>{if(!n&&"ripple"===t&&j.current){const t=j.current.getBoundingClientRect(),s=e.clientX-t.left,r=e.clientY-t.top,i={id:w.current++,x:s,y:r};f(e=>[...e,i]),setTimeout(()=>{f(e=>e.filter(e=>e.id!==i.id))},600)}},onMouseUp:()=>{},onClick:()=>{n||null==o||o()},onMouseOver:()=>m&&b(!0),onMouseOut:()=>m&&b(!1),children:[u.jsxs(p.div,c(l({},(()=>{const e={duration:r,ease:"easeInOut"};switch(t){case"ripple":return{whileHover:{scale:N.scale,transition:e},whileTap:{scale:.98,transition:{duration:.1}}};case"glow":return{whileHover:{scale:N.scale,boxShadow:"0 0 20px rgba(139, 69, 19, 0.4), 0 0 40px rgba(160, 82, 45, 0.2)",transition:e}};case"bounce":return{whileHover:{y:-4,scale:N.scale,transition:{duration:r,type:"spring",stiffness:400,damping:10}}};case"scale":return{whileHover:{scale:N.scale,transition:e},whileTap:{scale:.95,transition:{duration:.1}}};case"rotate":return{whileHover:{rotate:5,scale:N.scale,transition:e}};case"shimmer":return{whileHover:{scale:N.scale,backgroundPosition:["0% 0%","100% 0%"],transition:{duration:r,ease:"easeInOut"}}};case"pulse":return{animate:{scale:[1,N.scale,1],transition:{duration:2,repeat:1/0,ease:"easeInOut"}}};case"float":return{animate:{y:[0,-8,0],transition:{duration:3,repeat:1/0,ease:"easeInOut"}},whileHover:{y:-12,scale:N.scale,transition:e}};default:return{}}})()),{className:Ne("relative overflow-hidden",{"cursor-pointer":!n,"cursor-not-allowed opacity-50":n}),style:{backgroundImage:"shimmer"===t?"linear-gradient(90deg, transparent, rgba(139, 69, 19, 0.2), transparent)":void 0,backgroundSize:"shimmer"===t?"200% 100%":void 0},children:[e,"ripple"===t&&u.jsx("div",{className:"absolute inset-0 pointer-events-none",children:x.map(e=>u.jsx(p.div,{className:"absolute rounded-full bg-white/30",style:{left:e.x-10,top:e.y-10,width:20,height:20},initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6,ease:"easeOut"}},e.id))})]})),u.jsx(g,{children:y&&m&&u.jsxs(p.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},className:Ne("absolute z-[9999999] px-2 py-1 text-xs text-white bg-neutral-800 rounded shadow-lg whitespace-nowrap",{top:"bottom-full left-1/2 transform -translate-x-1/2 mb-2",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-2",left:"right-full top-1/2 transform -translate-y-1/2 mr-2",right:"left-full top-1/2 transform -translate-y-1/2 ml-2"}[h]),children:[m,u.jsx("div",{className:Ne("absolute w-2 h-2 bg-neutral-800 transform rotate-45",{"top-full left-1/2 -translate-x-1/2 -mt-1":"top"===h,"bottom-full left-1/2 -translate-x-1/2 -mb-1":"bottom"===h,"right-full top-1/2 -translate-y-1/2 -mr-1":"left"===h,"left-full top-1/2 -translate-y-1/2 -ml-1":"right"===h})})]})})]})}),v.memo(({name:e,description:t,value:s,onChange:r})=>u.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"checkbox",checked:s,onChange:e=>r(e.target.checked),className:"sr-only","aria-label":e}),u.jsx("div",{className:"w-5 h-5 rounded border-2 transition-all duration-200 flex items-center justify-center "+(s?"boolean-checkbox-checked":"boolean-checkbox-unchecked"),children:s&&u.jsx("svg",{className:"w-3 h-3 boolean-checkbox-icon",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-sm font-medium text-text-primary",children:e}),t&&u.jsx("div",{className:"text-xs text-text-secondary mt-1",children:t})]})]}));const Os=v.memo(({value:e,options:t,onChange:s,placeholder:r,className:i})=>{const n=t.find(t=>String(t.value)===String(e)),a=v.useCallback(e=>{s(e.value)},[s]),o=(null==n?void 0:n.label)||r||"Выберите опцию";return u.jsxs("div",{className:Ne("space-y-2",i),children:[u.jsx("label",{className:"block text-sm font-medium setting-label",children:r||"Выберите опцию"}),u.jsx("div",{className:"flex flex-wrap gap-2",role:"radiogroup","aria-label":o,children:t.map(t=>{const s=String(t.value)===String(e);return u.jsx("button",{type:"button",role:"radio",onClick:()=>a(t),className:Ne("px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200","border focus:outline-none focus:ring-2 focus:border-transparent","hover:scale-105 active:scale-95",s?"bg-primary text-background border-primary shadow-lg":"bg-input-bg text-input-text border-input-border hover:bg-surface-hover"),"aria-checked":s,"aria-label":`${o}: ${t.label}`,tabIndex:s?0:-1,children:t.label},String(t.value))})})]})});Os.displayName="ButtonSelect";const Ds=v.memo(({value:e,onChange:t})=>{const[s,r]=v.useState(!1),i=v.useMemo(()=>({small:{value:1,label:"Маленький",size:"0.875rem"},medium:{value:2,label:"Средний",size:"1rem"},large:{value:3,label:"Большой",size:"1.125rem"}}),[]),n=i[e]||i.medium,a=v.useCallback(e=>{const s=Object.keys(i).find(t=>i[t].value===e);s&&t(s)},[t,i]),o=v.useCallback(e=>{const t=e.currentTarget.getBoundingClientRect(),s=("touches"in e?e.touches[0].clientX:e.clientX)-t.left,r=Math.max(0,Math.min(100,s/t.width*100));let i;i=r<33?1:r<66?2:3,a(i)},[a]);return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"p-4 rounded-lg border font-size-preview",style:{"--font-size-preview":n.size},children:[u.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Предварительный просмотр:"}),u.jsxs("div",{className:"font-medium",children:["Размер шрифта: ",n.label]}),u.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Заголовок H1, обычный текст и мелкий текст"})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[u.jsx("span",{children:"Маленький"}),u.jsx("span",{children:"Средний"}),u.jsx("span",{children:"Большой"})]}),u.jsx("div",{className:"relative",children:u.jsxs("div",{className:"w-full h-2 bg-black dark:bg-black rounded-full relative",children:[u.jsx("div",{className:"absolute top-0 h-2 bg-primary rounded-full transition-all duration-200",style:{left:"0%",width:(n.value-1)/2*100+"%"}}),u.jsx("div",{className:Ne("font-size-slider-thumb",s?"scale-110 shadow-xl":"hover:scale-105"),style:{"--font-size-position":(n.value-1)/2},onMouseDown:e=>{r(!0),o(e)},onTouchStart:e=>{r(!0),o(e)}}),u.jsx("div",{className:"absolute inset-0 cursor-pointer",onMouseDown:o,onMouseMove:e=>{s&&o(e)},onMouseUp:()=>r(!1),onMouseLeave:()=>r(!1),onTouchStart:o,onTouchMove:o,onTouchEnd:()=>r(!1)})]})})]})]})});Ds.displayName="FontSizeSlider",v.memo(({name:e,value:t,min:s=0,max:r=100,step:i=1,onChange:n})=>{const a=v.useRef(null),o=v.useCallback(e=>{const t=(e-s)/(r-s)*100;a.current&&a.current.style.setProperty("--percent",`${t}%`)},[s,r]);return v.useEffect(()=>{o(Number(t))},[t,s,r,o]),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("label",{className:"block text-sm font-medium number-setting-label",children:e}),u.jsx("span",{className:"px-2 py-0.5 rounded-md text-xs shadow-sm number-setting-value","aria-live":"polite",children:String(t)})]}),u.jsx("input",{ref:a,type:"range",value:Number(t),min:s,max:r,step:i,onChange:e=>{const t=Number(e.target.value);o(t),n(t)},className:"slider-brand w-full h-2 appearance-none rounded-lg outline-none cursor-pointer border focus:ring-2 number-setting-slider","aria-label":e}),u.jsxs("div",{className:"flex justify-between text-xs number-setting-range",children:[u.jsx("span",{children:s}),u.jsx("span",{children:r})]})]})}),v.memo(({name:e,value:t,placeholder:s,onChange:r})=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm font-medium text-setting-label",children:e}),u.jsx("input",{type:"text",value:t,onChange:e=>r(e.target.value),className:"w-full px-3 py-2.5 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-200 text-setting-input","aria-label":e,placeholder:s||`Введите ${e.toLowerCase()}`})]}));const Bs=v.memo(({theme:e,onThemeChange:t,className:s=""})=>{const r=v.useCallback(e=>{t(e)},[t]);return u.jsxs("div",{className:Ne("space-y-4",s),children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h3",{className:"text-lg font-semibold text-text mb-1",children:"Тема"}),u.jsx("p",{className:"text-sm text-text-secondary",children:"Выберите светлую или темную тему"})]}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>r("light"),className:Ne("flex-1 p-3 rounded-lg border-2 transition-all duration-200","bg-card text-text border-primary","light"===e?"ring-2 ring-primary shadow-lg":"hover:bg-surface"),children:u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx("div",{className:"w-4 h-4 bg-black rounded"}),u.jsx("span",{className:"font-medium",children:"Светлая"})]})}),u.jsx("button",{onClick:()=>r("dark"),className:Ne("flex-1 p-3 rounded-lg border-2 transition-all duration-200","bg-black text-white border-black","dark"===e?"ring-2 ring-white shadow-lg":"hover:bg-gray-800"),children:u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx("div",{className:"w-4 h-4 bg-white rounded"}),u.jsx("span",{className:"font-medium",children:"Темная"})]})})]}),u.jsx("div",{className:"text-center text-xs text-text-secondary",children:"light"===e?"Белый фон, черный текст":"Черный фон, белый текст"})]})});Bs.displayName="ThemeSelector";const zs=new class{constructor(){this.errors=[],this.maxErrors=$.MAX_ERRORS_IN_STORAGE,this.retentionDays=$.ERROR_RETENTION_DAYS,this.loadErrorsFromStorage(),this.cleanupOldErrors()}logError(e,t,s){const r={id:this.generateErrorId(),timestamp:new Date,type:this.determineErrorType(e),code:this.determineErrorCode(e),message:e.message||L.GENERIC,stack:e.stack,componentStack:null==t?void 0:t.componentStack,userAgent:navigator.userAgent,url:window.location.href,userId:this.getCurrentUserId(),metadata:c(l({},s),{errorBoundary:null==t?void 0:t.errorBoundary,props:null==t?void 0:t.props,state:null==t?void 0:t.state})};return this.errors.unshift(r),this.trimErrors(),this.saveErrorsToStorage(),this.sendToExternalService(r),console.error("Error logged:",r),r.id}getErrorStats(){const e=new Date((new Date).getTime()-24*this.retentionDays*60*60*1e3),t=this.errors.filter(t=>t.timestamp>=e),s=t.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{}),r=t.reduce((e,t)=>(e[t.code]=(e[t.code]||0)+1,e),{});return{totalErrors:t.length,errorsByType:s,errorsByCode:r,recentErrors:t.slice(0,10)}}getAllErrors(){return[...this.errors]}clearErrors(){this.errors=[],this.saveErrorsToStorage()}exportErrors(){return JSON.stringify(this.errors,null,2)}generateErrorId(){return`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}determineErrorType(e){return"TypeError"===e.name||"ReferenceError"===e.name?R.CLIENT:"NetworkError"===e.name||e.message.includes("fetch")?R.NETWORK:e.message.includes("auth")?R.AUTHENTICATION:e.message.includes("permission")?R.AUTHORIZATION:R.UNKNOWN}determineErrorCode(e){return e.message.includes("timeout")?P.NETWORK_TIMEOUT:e.message.includes("offline")?P.NETWORK_OFFLINE:e.message.includes("file")?P.FILE_UPLOAD_FAILED:e.message.includes("message")?P.MESSAGE_SEND_FAILED:P.INVALID_INPUT}getCurrentUserId(){try{const e=localStorage.getItem("barsukov-user");return e?JSON.parse(e).id:void 0}catch(e){return}}trimErrors(){this.errors.length>this.maxErrors&&(this.errors=this.errors.slice(0,this.maxErrors))}cleanupOldErrors(){const e=new Date;e.setDate(e.getDate()-this.retentionDays),this.errors=this.errors.filter(t=>t.timestamp>=e),this.saveErrorsToStorage()}loadErrorsFromStorage(){try{const e=localStorage.getItem("barsukov-error-log");if(e){const t=JSON.parse(e);this.errors=t.map(e=>c(l({},e),{timestamp:new Date(e.timestamp)}))}}catch(e){console.warn("Failed to load errors from storage:",e)}}saveErrorsToStorage(){try{localStorage.setItem("barsukov-error-log",JSON.stringify(this.errors))}catch(e){console.warn("Failed to save errors to storage:",e)}}sendToExternalService(e){}};class Fs extends v.Component{constructor(e){super(e),this.scheduleRetry=()=>{const{retryDelay:e=2e3}=this.props;this.setState({isRetrying:!0}),this.retryTimeout=setTimeout(()=>{this.handleRetry()},e)},this.handleRetry=()=>{this.setState(e=>({hasError:!1,error:void 0,errorInfo:void 0,retryCount:e.retryCount+1,isRetrying:!1}))},this.handleReload=()=>{window.location.reload()},this.handleReportError=()=>{const{error:e}=this.state;if(!e)return;const t=zs.exportErrors(),s=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(s),i=document.createElement("a");i.href=r,i.download=`error-report-${Date.now()}.json`,i.click(),URL.revokeObjectURL(r),_.success("Отчет об ошибке","Отчет об ошибке сохранен. Отправьте его в службу поддержки.")},this.state={hasError:!1,retryCount:0,isRetrying:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){const{errorBoundaryName:s,onError:r}=this.props;zs.logError(e,{componentStack:t.componentStack||"",errorBoundary:null!=s?s:"Unknown"}),!1!==this.props.showNotification&&_.showErrorBoundaryNotification(e,{componentStack:t.componentStack||"",errorBoundary:null!=s?s:"Unknown"}),this.setState({error:e,errorInfo:t}),null==r||r(e,t),this.props.autoRetry&&this.state.retryCount<3&&this.scheduleRetry()}componentWillUnmount(){this.retryTimeout&&clearTimeout(this.retryTimeout)}render(){const{hasError:e,error:t,errorInfo:s,isRetrying:r}=this.state,{fallback:i,className:n,errorBoundaryName:a}=this.props;return e?i||u.jsx("div",{className:Ne("min-h-screen flex items-center justify-center p-4",n),children:u.jsxs("div",{className:"max-w-lg w-full p-6 rounded-lg border text-center",children:[u.jsx("div",{className:"mb-4",children:u.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),u.jsx("h2",{className:"text-xl font-bold mb-2 error-title-text",children:"Произошла ошибка"}),a&&u.jsxs("p",{className:"text-sm text-text mb-4",children:["Компонент: ",a]}),u.jsx("p",{className:"text-sm mb-4 error-message-text",children:(null==t?void 0:t.message)||L.GENERIC}),r&&u.jsx("div",{className:"mb-4",children:u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),u.jsx("span",{className:"text-sm",children:"Попытка восстановления..."})]})}),!1,u.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[u.jsx("button",{onClick:this.handleRetry,disabled:r,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 error-button-primary disabled:opacity-50",children:r?"Восстановление...":"Попробовать снова"}),u.jsx("button",{onClick:this.handleReload,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 error-button-secondary",children:"Перезагрузить страницу"}),u.jsx("button",{onClick:this.handleReportError,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 error-button-secondary",children:"Сохранить отчет"})]})]})}):this.props.children}}class Hs extends v.Component{constructor(){super(...arguments),this.handleError=(e,t)=>{var s,r;console.error(`Settings Error${this.props.settingName?` in ${this.props.settingName}`:""}:`,e,t),null==(r=(s=this.props).onError)||r.call(s,e,t)}}render(){const{children:e,settingName:t,className:s}=this.props;return u.jsx(Fs,{errorBoundaryName:"Settings"+(t?`: ${t}`:""),onError:this.handleError,className:Ne("settings-error-boundary",s),showNotification:!0,autoRetry:!1,fallback:u.jsx("div",{className:Ne("p-3 rounded-lg border border-yellow-200 bg-yellow-50",s),children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("h3",{className:"text-sm font-medium text-yellow-800",children:["Ошибка настройки",t?`: ${t}`:""]}),u.jsx("p",{className:"text-sm text-yellow-600 mt-1",children:"Не удалось загрузить настройку. Проверьте корректность данных."})]})]})}),children:e})}}const Ws=v.memo(({item:e,onChange:t,className:s})=>{var r,i,n;const a=null==e?void 0:e.value,o="boolean"==typeof a&&a,l="string"==typeof a?a:"",c="number"==typeof a?a:0,d=v.useCallback(()=>u.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"checkbox",checked:o,onChange:s=>t(e.id,s.target.checked),className:"sr-only","aria-label":e.name}),u.jsx("div",{className:Ne("w-5 h-5 rounded border-2 transition-all duration-200 flex items-center justify-center setting-checkbox",o&&"checked"),children:o&&u.jsx("svg",{className:"w-3 h-3 setting-checkbox-icon",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),u.jsx("span",{className:"text-sm transition-colors duration-200 setting-description",children:e.name})]}),[o,e.id,e.name,t]),m=v.useCallback(()=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm font-medium setting-label",children:e.name}),u.jsx(Os,{value:l,options:e.options||[],onChange:s=>t(e.id,s),placeholder:e.placeholder})]}),[l,e.name,e.options,e.placeholder,e.id,t]),h=v.useRef(null),p=null!=(r=e.min)?r:0,g=null!=(i=e.max)?i:100,x=null!=(n=e.step)?n:1,f=v.useCallback(e=>{const t=(e-p)/(g-p)*100;h.current&&h.current.style.setProperty("--percent",`${t}%`)},[p,g]);v.useEffect(()=>{f(c)},[c,f]);const y=v.useCallback(()=>u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("label",{className:"block text-sm font-medium setting-label",children:e.name}),u.jsx("span",{className:"px-2 py-0.5 rounded-md text-xs shadow-sm setting-slider-value","aria-live":"polite",children:String(c)})]}),u.jsx("input",{ref:h,type:"range",value:c,min:p,max:g,step:x,onChange:s=>{const r=Number(s.target.value);f(r),t(e.id,r)},className:"slider-brand w-full h-2 appearance-none rounded-lg outline-none cursor-pointer border focus:ring-2 setting-slider-base","aria-label":e.name}),u.jsxs("div",{className:"flex justify-between text-xs setting-muted",children:[u.jsx("span",{children:p}),u.jsx("span",{children:g})]})]}),[c,e.name,p,g,x,e.id,t,f]),b=v.useCallback(()=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm font-medium setting-label",children:e.name}),u.jsx("input",{type:"color",value:l,onChange:s=>t(e.id,s.target.value),className:"w-12 h-10 rounded border-2 border-border cursor-pointer","aria-label":e.name,title:`Выберите цвет для ${e.name}`})]}),[l,e.name,e.id,t]),j=v.useCallback(()=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm font-medium setting-label",children:e.name}),u.jsx("input",{type:"text",value:l,onChange:s=>t(e.id,s.target.value),className:"w-full px-3 py-2.5 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-200 setting-input-base","aria-label":e.name,placeholder:e.placeholder||`Введите ${e.name.toLowerCase()}`})]}),[l,e.name,e.placeholder,e.id,t]),w=v.useCallback(()=>{switch(e.type){case"boolean":return d();case"select":return m();case"number":return y();case"color":return b();case"font-size-slider":return u.jsx(Ds,{value:"string"==typeof e.value?e.value:"medium",onChange:e.onChange});case"theme-selector":return u.jsx(Bs,{theme:"string"==typeof e.value?e.value:"light",onThemeChange:e.onChange});case"rainbow-theme-system":case"unified-rainbow-theme":case"theme-buttons":return u.jsx(Bs,{theme:"string"==typeof e.value?e.value:"dark",onThemeChange:e.onChange});default:return j()}},[e.type,e.value,e.onChange,d,m,y,b,j]);return e?u.jsx(Hs,{settingName:e.name,children:u.jsxs("div",{className:Ne("setting-item-container",s),children:[u.jsxs("div",{className:"mb-3",children:[u.jsx("h4",{className:"text-sm font-medium mb-1 setting-label",children:e.name}),e.description&&u.jsx("p",{className:"text-xs leading-relaxed setting-description",children:e.description})]}),u.jsx("div",{className:"mt-3",children:w()})]})}):(console.error("SettingItem: item is undefined"),null)}),Gs=class e{constructor(){this.currentAccentSet={primary:"#ff0000",secondary:"#ff8000",tertiary:"#ffff00",name:"rainbow-red-orange-yellow"},this.accentSets=[{primary:"#ff0000",secondary:"#ff8000",tertiary:"#ffff00",name:"rainbow-red-orange-yellow"},{primary:"#ff8000",secondary:"#ffff00",tertiary:"#00ff00",name:"rainbow-orange-yellow-green"},{primary:"#ffff00",secondary:"#00ff00",tertiary:"#000000",name:"rainbow-yellow-green-black"},{primary:"#00ff00",secondary:"#000000",tertiary:"#8000ff",name:"rainbow-green-black-purple"},{primary:"#000000",secondary:"#8000ff",tertiary:"#ff0000",name:"rainbow-black-purple-red"},{primary:"#8000ff",secondary:"#ff0000",tertiary:"#ff8000",name:"rainbow-purple-red-orange"}],this.initializeAccentColors()}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeAccentColors(){this.applyAccentColors(this.currentAccentSet)}applyAccentColors(e){const t=document.documentElement;t.style.setProperty("--dynamic-accent-primary",e.primary),t.style.setProperty("--dynamic-accent-secondary",e.secondary),t.style.setProperty("--dynamic-accent-tertiary",e.tertiary),t.style.setProperty("--accent-primary",e.primary),t.style.setProperty("--accent-secondary",e.secondary),t.style.setProperty("--accent-tertiary",e.tertiary)}setAccentSet(e){const t=this.accentSets.find(t=>t.name===e);t&&(this.currentAccentSet=t,this.applyAccentColors(t),this.saveAccentSet(e))}getCurrentAccentSet(){return this.currentAccentSet}getAllAccentSets(){return this.accentSets}cycleAccentSets(){const e=(this.accentSets.findIndex(e=>e.name===this.currentAccentSet.name)+1)%this.accentSets.length,t=this.accentSets[e];this.setAccentSet(t.name)}setRandomAccentSet(){const e=Math.floor(Math.random()*this.accentSets.length),t=this.accentSets[e];this.setAccentSet(t.name)}saveAccentSet(e){try{localStorage.setItem("barsukov-accent-set",e)}catch(t){console.warn("Не удалось сохранить акцентные цвета:",t)}}loadAccentSet(){try{return localStorage.getItem("barsukov-accent-set")}catch(e){return console.warn("Не удалось загрузить акцентные цвета:",e),null}}restoreAccentSet(){const e=this.loadAccentSet();e&&this.setAccentSet(e)}startAutoCycle(e=1e4){setInterval(()=>{this.cycleAccentSets()},e)}getAccentColor(e){return this.currentAccentSet[e]}createAccentGradient(e="diagonal"){const{primary:t,secondary:s,tertiary:r}=this.currentAccentSet;switch(e){case"horizontal":return`linear-gradient(90deg, ${t}, ${s}, ${r})`;case"vertical":return`linear-gradient(180deg, ${t}, ${s}, ${r})`;default:return`linear-gradient(135deg, ${t}, ${s}, ${r})`}}}.getInstance();v.memo(({isVisible:e,message:t,type:s,duration:r=3e3,onComplete:i,className:n=""})=>{const[a,o]=v.useState(!1);return v.useEffect(()=>{if(e){o(!0);const e=setTimeout(()=>{o(!1),null==i||i()},r);return()=>clearTimeout(e)}},[e,r,i]),a?u.jsxs("div",{className:Ne("fixed top-4 right-4 z-50 flex items-center space-x-3 px-4 py-3 rounded-lg border shadow-lg backdrop-blur-sm",(()=>{switch(s){case"loading":return"bg-black/10 border-black/20";case"success":return"bg-green-500/10 border-green-500/20";case"error":return"bg-red-500/10 border-red-500/20"}})(),n),children:[(()=>{switch(s){case"loading":return u.jsx(dt,{className:"w-5 h-5 animate-spin text-text"});case"success":return u.jsx(ze,{className:"w-5 h-5 text-green-500"});case"error":return u.jsx(es,{className:"w-5 h-5 text-red-500"})}})(),u.jsx("span",{className:"text-sm font-medium text-primary",children:t})]}):null}).displayName="ProgressIndicator";const Vs=({text:t,isMuted:s,onToggleMute:r})=>{const[i,n]=v.useState(!1),[a,o]=v.useState("auto"),l=v.useCallback(t=>m(e,null,function*(){if(!s&&t.trim()){n(!0);try{window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),yield new Promise(e=>setTimeout(e,100));const e=new SpeechSynthesisUtterance(t);e.lang="ru-RU",e.rate=.9,e.pitch=1.1,e.volume=.8;const s=window.speechSynthesis.getVoices();let r=null;r="auto"===a?s.find(e=>e.lang.startsWith("ru")&&(e.name.includes("Google")||e.name.includes("Microsoft")||e.name.includes("Yandex")))||s.find(e=>e.lang.startsWith("ru")):s.find(e=>e.name===a),r&&(e.voice=r),e.onstart=()=>n(!1),e.onend=()=>n(!1),e.onerror=()=>n(!1),window.speechSynthesis.speak(e)}catch(e){console.error("Ошибка TTS:",e),n(!1)}}}),[s,a]);return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>l(t),disabled:i||s,className:"flex items-center gap-2 px-3 py-2 rounded-lg transition-all duration-200 "+(i?"bg-yellow-600 text-white cursor-not-allowed":s?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 hover:scale-105"),children:i?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),u.jsx("span",{className:"text-sm",children:"Озвучивание..."})]}):s?u.jsxs(u.Fragment,{children:[u.jsx(Jt,{className:"w-4 h-4"}),u.jsx("span",{className:"text-sm",children:"Звук отключен"})]}):u.jsxs(u.Fragment,{children:[u.jsx(Yt,{className:"w-4 h-4"}),u.jsx("span",{className:"text-sm",children:"Озвучить"})]})}),u.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-3 py-2 rounded-lg transition-all duration-200 "+(s?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"),children:[s?u.jsx(Jt,{className:"w-4 h-4"}):u.jsx(Yt,{className:"w-4 h-4"}),u.jsx("span",{className:"text-sm",children:s?"Включить":"Отключить"})]}),u.jsx("div",{className:"text-xs text-slate-400 max-w-xs",children:"💡 Для лучшего качества используйте Yandex SpeechKit или Google Cloud TTS"})]})},Us=[{id:"user-input",title:"👤 Пользователь задает вопрос",description:"Пользователь вводит вопрос через чат, голос или загружает документ",technicalDetails:"Nginx Load Balancer → Redis Queue → Worker Pool",userFriendlyExplanation:"Представьте, что вы заходите в умную юридическую контору и рассказываете о своей проблеме. Система сразу понимает, что вам нужно, и направляет к нужному специалисту.",visualElement:"💬",position:{x:50,y:20},connections:["intelligent-router"],voiceScript:"Вы начинаете диалог с AI-юристом. Система анализирует ваш запрос и выбирает лучший способ помочь."},{id:"intelligent-router",title:"🧭 Умный маршрутизатор",description:"AI анализирует сложность вопроса и выбирает подходящую модель",technicalDetails:"Intelligent Router → GPT-5 Nano/Mini/Standard",userFriendlyExplanation:"Как опытный адвокат, который сразу понимает: нужна ли быстрая справка или серьезная консультация. Простые вопросы решаются быстро, сложные получают больше внимания.",visualElement:"⚡",position:{x:50,y:40},connections:["gpt5-nano","gpt5-mini","gpt5-standard"],voiceScript:"Система определяет сложность вашего вопроса. Простые вопросы решаются за секунды, сложные получают глубокий анализ."},{id:"gpt5-nano",title:"⚡ GPT-5 Nano (80% вопросов)",description:"Быстрые ответы на простые вопросы",technicalDetails:"1-2 секунды, низкая стоимость, высокая скорость",userFriendlyExplanation:'Как младший юрист, который быстро отвечает на стандартные вопросы: "Как оформить договор?", "Какие документы нужны?"',visualElement:"🚀",position:{x:20,y:60},connections:["response-generator"],voiceScript:"Для простых вопросов используется быстрая модель - как младший юрист, который знает все стандартные ответы."},{id:"gpt5-mini",title:"🚀 GPT-5 Mini (15% вопросов)",description:"Средние задачи с балансом скорости и качества",technicalDetails:"2-3 секунды, средняя стоимость, хорошее качество",userFriendlyExplanation:"Как опытный юрист, который разбирается в нюансах и может дать развернутый совет по сложным ситуациям.",visualElement:"⚖️",position:{x:50,y:60},connections:["response-generator"],voiceScript:"Для более сложных вопросов включается опытный юрист, который может разобрать нюансы вашей ситуации."},{id:"gpt5-standard",title:"🎯 GPT-5 Standard (5% вопросов)",description:"Сложные рассуждения и максимальное качество",technicalDetails:"3-5 секунд, высокая стоимость, максимальное качество",userFriendlyExplanation:"Как главный партнер юридической фирмы, который берется за самые сложные дела и дает экспертное мнение.",visualElement:"👨‍⚖️",position:{x:80,y:60},connections:["response-generator"],voiceScript:"Для самых сложных вопросов включается главный эксперт - как партнер юридической фирмы с многолетним опытом."},{id:"raptor-engine",title:"🌳 RAPTOR Engine",description:"Локальная обработка документов и поиск",technicalDetails:"Рекурсивная кластеризация, древовидная организация",userFriendlyExplanation:"Как умная библиотека, которая мгновенно находит нужные документы и связывает их между собой. Работает локально - ваши данные никуда не передаются.",visualElement:"🌲",position:{x:20,y:80},connections:["local-processing"],voiceScript:"RAPTOR - это как умная библиотека, которая мгновенно находит нужные документы. Все работает локально, ваши данные в безопасности."},{id:"local-processing",title:"🏠 Локальная обработка",description:"OCR, эмбеддинги и поиск работают локально",technicalDetails:"BGE-M3, Tesseract 5, Qdrant - все локально",userFriendlyExplanation:"Все ваши документы обрабатываются прямо на вашем сервере. Никто не видит ваши данные - полная конфиденциальность.",visualElement:"🔒",position:{x:20,y:100},connections:["security"],voiceScript:"Все ваши документы обрабатываются локально. Это как иметь личного секретаря, который работает только для вас."},{id:"security",title:"🛡️ Безопасность 152-ФЗ",description:"Полное соответствие требованиям защиты данных",technicalDetails:"PII анонимизация, шифрование, аудит доступа",userFriendlyExplanation:"Система полностью соответствует российскому законодательству о персональных данных. Ваша информация под надежной защитой.",visualElement:"🛡️",position:{x:20,y:120},connections:["response-generator"],voiceScript:"Ваши данные защищены по всем стандартам. Система соответствует 152-ФЗ и работает как швейцарский банк."},{id:"response-generator",title:"📝 Генератор ответов",description:"Форматирование и отправка ответа пользователю",technicalDetails:"Структурированный вывод, контекстная адаптация",userFriendlyExplanation:"AI оформляет ответ в понятном виде и отправляет вам. Как опытный юрист, который объясняет сложные вещи простыми словами.",visualElement:"📄",position:{x:50,y:100},connections:["user-output"],voiceScript:"AI оформляет ответ и отправляет вам. Как опытный юрист, который объясняет сложные вещи простыми словами."},{id:"user-output",title:"✅ Готовый ответ",description:"Пользователь получает структурированный ответ",technicalDetails:"Персонализированный формат, обратная связь",userFriendlyExplanation:"Вы получаете четкий, понятный ответ с рекомендациями. Система запоминает ваш вопрос для будущих улучшений.",visualElement:"🎉",position:{x:50,y:120},connections:[],voiceScript:"Готово! Вы получили профессиональный юридический совет. Система запомнила ваш вопрос для будущих улучшений."}],qs=()=>{var e;const[t,s]=v.useState(0),[r,i]=v.useState(!1),[n,a]=v.useState(!1),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[m,h]=v.useState(""),[x,f]=v.useState([]),y=window.speechSynthesis,b=v.useCallback(e=>{if(n)return;y.speaking&&y.cancel();const t=new SpeechSynthesisUtterance(e);t.lang="ru-RU",t.rate=.9,t.pitch=1.1,t.volume=.8;const s=y.getVoices().find(e=>e.lang.startsWith("ru")&&(e.name.includes("Google")||e.name.includes("Microsoft")));s&&(t.voice=s),y.speak(t)},[n,y]),j=v.useCallback(()=>{t<Us.length-1&&(s(t+1),b(Us[t+1].voiceScript))},[t,b]);v.useEffect(()=>{if(o&&!r){const e=setTimeout(()=>{j()},3e3);return()=>clearTimeout(e)}},[t,o,r,j]);const w=()=>{if(m.trim()){const e={role:"user",content:m};f([...x,e]),h(""),setTimeout(()=>{const e={role:"assistant",content:`Отлично! Я помогу вам разобраться с ${m}. Давайте посмотрим на архитектуру системы...`};f(t=>[...t,e])},1e3)}},N=Us[t];return u.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 overflow-hidden",children:[u.jsxs("div",{className:"p-6 border-b border-slate-700",children:[u.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"🎯 Интерактивный гид по архитектуре AI-Юриста"}),u.jsx("p",{className:"text-slate-300 mb-4",children:"Понятное объяснение сложных технологий простыми словами"}),u.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:u.jsxs("p",{className:"text-sm text-blue-300",children:["💬 ",u.jsx("strong",{children:"Общайтесь через чат!"})," Задавайте вопросы о любом компоненте системы, и AI-Юрист подробно объяснит, как это работает."]})})]}),u.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[u.jsx("div",{className:"w-80 bg-slate-800 border-r border-slate-700 p-6 overflow-y-auto",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm text-slate-300",children:"Прогресс"}),u.jsxs("span",{className:"text-sm text-slate-300",children:[t+1,"/",Us.length]})]}),u.jsx("div",{className:"w-full bg-slate-600 rounded-full h-2",children:u.jsx("div",{className:`bg-blue-500 progress-bar-fill progress-bar progress-${Math.round((t+1)/Us.length*100)}`})})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("button",{onClick:()=>{t>0&&(s(t-1),b(Us[t-1].voiceScript))},disabled:0===t,className:"w-full flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors",children:[u.jsx(Ae,{className:"w-4 h-4"}),"Предыдущий"]}),u.jsxs("button",{onClick:j,disabled:t===Us.length-1,className:"w-full flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors",children:["Следующий",u.jsx(Me,{className:"w-4 h-4"})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsxs("button",{onClick:()=>{i(!r),r?y.cancel():b(Us[t].voiceScript)},className:"flex items-center gap-2 px-3 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:[r?u.jsx(St,{className:"w-4 h-4"}):u.jsx(Tt,{className:"w-4 h-4"}),r?"Пауза":"Играть"]}),u.jsx(Vs,{text:(null==(e=Us[t])?void 0:e.voiceScript)||"",isMuted:n,onToggleMute:()=>{a(!n),n||y.cancel()}})]}),u.jsxs("button",{onClick:()=>{l(!o),i(!o)},className:"w-full flex items-center gap-2 px-4 py-2 rounded-lg transition-colors "+(o?"bg-green-600 hover:bg-green-700":"bg-slate-700 hover:bg-slate-600"),children:[u.jsx(ss,{className:"w-4 h-4"}),o?"Автоплей включен":"Включить автоплей"]}),u.jsxs("button",{onClick:()=>{s(0),i(!1),l(!1),y.cancel()},className:"w-full flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors",children:[u.jsx(Mt,{className:"w-4 h-4"}),"Сбросить"]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h3",{className:"text-sm font-semibold text-slate-300",children:"Шаги:"}),Us.map((e,r)=>u.jsxs("button",{onClick:()=>{s(r),b(e.voiceScript)},className:"w-full text-left p-3 rounded-lg transition-colors "+(r===t?"bg-blue-600 text-white":"bg-slate-700 hover:bg-slate-600 text-slate-300"),children:[u.jsx("div",{className:"text-sm font-medium",children:e.title}),u.jsx("div",{className:"text-xs opacity-75",children:e.description})]},e.id))]})]})}),u.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:u.jsx("div",{className:"relative h-full bg-slate-800 rounded-lg overflow-hidden",children:u.jsxs("div",{className:"relative w-full h-full",children:[Us.map((e,s)=>u.jsx(p.div,{initial:{opacity:0,scale:.8},animate:{opacity:s<=t?1:.3,scale:s===t?1.1:1,x:8*e.position.x,y:4*e.position.y},transition:{duration:.5,delay:.1*s},className:"absolute transform -translate-x-1/2 -translate-y-1/2 "+(s===t?"z-10":"z-0"),children:u.jsxs("div",{className:`\n                                        p-4 rounded-lg border-2 transition-all duration-300\n                                        ${s===t?"bg-blue-600 border-blue-400 shadow-lg shadow-blue-500/50":"bg-slate-700 border-slate-600"}\n                                    `,children:[u.jsx("div",{className:"text-2xl mb-2",children:e.visualElement}),u.jsx("div",{className:"text-sm font-semibold text-white mb-1",children:e.title}),u.jsx("div",{className:"text-xs text-slate-300",children:e.description})]})},e.id)),u.jsx(g,{children:t>0&&u.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:u.jsx(Me,{className:"w-8 h-8 text-blue-400 animate-pulse"})})})]})})}),u.jsx("div",{className:"w-80 bg-slate-800 border-l border-slate-700 p-6",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:N.title}),u.jsx("p",{className:"text-sm text-slate-300 mb-3",children:N.userFriendlyExplanation}),u.jsxs("div",{className:"text-xs text-slate-400",children:[u.jsx("strong",{children:"Технически:"})," ",N.technicalDetails]})]}),u.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[u.jsxs("h3",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[u.jsx(pt,{className:"w-4 h-4"}),"Чат с AI-гидом"]}),u.jsx("div",{className:"space-y-2 mb-4 max-h-40 overflow-y-auto",children:x.map((e,t)=>u.jsx("div",{className:"text-xs p-2 rounded "+("user"===e.role?"bg-blue-600 text-white ml-4":"bg-slate-600 text-slate-300 mr-4"),children:e.content},t))}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"Задайте вопрос...",className:"flex-1 px-3 py-2 bg-slate-600 text-white text-sm rounded border border-slate-500 focus:outline-none focus:border-blue-500",onKeyPress:e=>"Enter"===e.key&&w()}),u.jsx("button",{onClick:w,className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded transition-colors",children:"Отправить"})]}),u.jsxs("button",{onClick:()=>{d(!c)},className:"w-full mt-2 flex items-center gap-2 px-3 py-2 rounded transition-colors "+(c?"bg-red-600 hover:bg-red-700":"bg-slate-600 hover:bg-slate-500"),children:[c?u.jsx(xt,{className:"w-4 h-4"}):u.jsx(vt,{className:"w-4 h-4"}),c?"Остановить запись":"Голосовой ввод"]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Быстрые действия:"}),u.jsx("button",{className:"w-full text-left p-2 bg-slate-600 hover:bg-slate-500 rounded text-sm transition-colors",children:"🤔 Объясни проще"}),u.jsx("button",{className:"w-full text-left p-2 bg-slate-600 hover:bg-slate-500 rounded text-sm transition-colors",children:"💡 Покажи пример"}),u.jsx("button",{className:"w-full text-left p-2 bg-slate-600 hover:bg-slate-500 rounded text-sm transition-colors",children:"🔍 Подробнее"})]})]})})]})]})},Qs=v.forwardRef(({zoom:e,isLoading:t,isRendered:s},r)=>u.jsxs("div",{className:"diagram-container",children:[t&&u.jsxs("div",{className:"diagram-loading",children:[u.jsx("div",{className:"loading-spinner"}),u.jsx("div",{className:"loading-text",children:"Загрузка диаграммы..."})]}),u.jsx("div",{ref:r,className:"mermaid-container","data-zoom":e}),!t&&!s&&u.jsxs("div",{className:"diagram-placeholder",children:[u.jsx("div",{className:"placeholder-icon",children:"📊"}),u.jsx("div",{className:"placeholder-text",children:"Диаграмма не загружена"})]})]}));Qs.displayName="DiagramContainer";const Ks=({zoom:e,isFullscreen:t,showLegend:s,showMinimap:r,onZoomIn:i,onZoomOut:n,onResetZoom:a,onToggleFullscreen:o,onToggleLegend:l,onToggleMinimap:c,onDownload:d,onRerender:m,onResetControls:h})=>u.jsx("div",{className:"diagram-controls",children:u.jsxs("div",{className:"controls-group",children:[u.jsx("h3",{children:"Управление"}),u.jsxs("div",{className:"zoom-controls",children:[u.jsx("button",{onClick:n,className:"control-button",title:"Уменьшить",children:u.jsx(is,{className:"w-4 h-4"})}),u.jsxs("span",{className:"zoom-level",children:[Math.round(100*e),"%"]}),u.jsx("button",{onClick:i,className:"control-button",title:"Увеличить",children:u.jsx(rs,{className:"w-4 h-4"})}),u.jsx("button",{onClick:a,className:"control-button",title:"Сбросить зум",children:u.jsx(Mt,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"main-controls",children:[u.jsx("button",{onClick:o,className:"control-button "+(t?"active":""),title:"Полноэкранный режим",children:u.jsx(ut,{className:"w-4 h-4"})}),u.jsx("button",{onClick:d,className:"control-button",title:"Скачать диаграмму",children:u.jsx(Qe,{className:"w-4 h-4"})}),u.jsx("button",{onClick:m,className:"control-button",title:"Перерендерить",children:"🔄"})]}),u.jsxs("div",{className:"display-controls",children:[u.jsxs("label",{className:"control-checkbox",children:[u.jsx("input",{type:"checkbox",checked:s,onChange:l}),u.jsx("span",{children:"Показать легенду"})]}),u.jsxs("label",{className:"control-checkbox",children:[u.jsx("input",{type:"checkbox",checked:r,onChange:c}),u.jsx("span",{children:"Показать мини-карту"})]})]}),u.jsx("button",{onClick:h,className:"reset-button",title:"Сбросить все настройки",children:"Сбросить настройки"})]})}),Zs=({error:e,onRetry:t})=>u.jsxs("div",{className:"diagram-error",children:[u.jsxs("div",{className:"error-content",children:[u.jsx("div",{className:"error-icon",children:(e=>{switch(e){case"render":return"🎨";case"load":return"📥";case"validation":return"✅";case"network":return"🌐";default:return"⚠️"}})(e.type)}),u.jsxs("div",{className:"error-details",children:[u.jsx("h3",{className:"error-title",children:(e=>{switch(e){case"render":return"Ошибка рендеринга";case"load":return"Ошибка загрузки";case"validation":return"Ошибка валидации";case"network":return"Сетевая ошибка";default:return"Неизвестная ошибка"}})(e.type)}),u.jsx("p",{className:"error-message",children:e.message}),e.details&&u.jsxs("details",{className:"error-details-expanded",children:[u.jsx("summary",{children:"Технические детали"}),u.jsx("pre",{className:"error-stack",children:e.details})]}),u.jsxs("div",{className:"error-timestamp",children:["Время: ",new Date(e.timestamp).toLocaleString()]})]})]}),u.jsxs("div",{className:"error-actions",children:[u.jsx("button",{onClick:t,className:"retry-button",children:"🔄 Попробовать снова"}),u.jsx("button",{onClick:()=>window.location.reload(),className:"reload-button",children:"🔄 Обновить страницу"}),u.jsx("button",{onClick:()=>{navigator.clipboard&&navigator.clipboard.writeText(`\nОшибка: ${e.message}\nТип: ${e.type}\nВремя: ${new Date(e.timestamp).toLocaleString()}\nДетали: ${e.details||"Нет"}\n              `)},className:"copy-button",children:"📋 Скопировать отчет"})]})]}),Ys=()=>u.jsxs("div",{className:"diagram-legend",children:[u.jsx("h3",{children:"Легенда"}),u.jsxs("div",{className:"legend-section",children:[u.jsx("h4",{children:"Статус компонентов"}),u.jsxs("div",{className:"legend-items",children:[u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-dot implemented"}),u.jsx("span",{children:"Реализованные компоненты"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-dot missing"}),u.jsx("span",{children:"Требуют доработки"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-dot raptor"}),u.jsx("span",{children:"RAPTOR Engine"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-dot gpt5"}),u.jsx("span",{children:"GPT-5 Integration"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-dot graph"}),u.jsx("span",{children:"GraphRAG система"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-dot hyde"}),u.jsx("span",{children:"HyDE система"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-dot monitoring"}),u.jsx("span",{children:"Мониторинг"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-dot database"}),u.jsx("span",{children:"Базы данных"})]})]})]}),u.jsxs("div",{className:"legend-section",children:[u.jsx("h4",{children:"Типы соединений"}),u.jsxs("div",{className:"legend-items",children:[u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-line data"}),u.jsx("span",{children:"Поток данных"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-line control"}),u.jsx("span",{children:"Управление"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-line cache"}),u.jsx("span",{children:"Кэширование"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-line monitoring"}),u.jsx("span",{children:"Мониторинг"})]})]})]}),u.jsxs("div",{className:"legend-section",children:[u.jsx("h4",{children:"Архитектурные слои"}),u.jsxs("div",{className:"legend-items",children:[u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"🚪"}),u.jsx("span",{children:"Система входа"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"🌳"}),u.jsx("span",{children:"RAPTOR Engine"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"🚀"}),u.jsx("span",{children:"GPT-5 Integration"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"🔍"}),u.jsx("span",{children:"Поисковая система"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"🕸️"}),u.jsx("span",{children:"GraphRAG + HyDE"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"📄"}),u.jsx("span",{children:"Обработка документов"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"⚡"}),u.jsx("span",{children:"Кэширование"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"📊"}),u.jsx("span",{children:"Мониторинг"})]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("div",{className:"legend-icon",children:"🗄️"}),u.jsx("span",{children:"Базы данных"})]})]})]})]}),Js={id:"gpt5-integration",name:"GPT-5 Integration",description:"Интеллектуальная маршрутизация и адаптивные модели GPT-5",position:{x:1,y:1},dependencies:["raptor-engine"],isVisible:!0,isExpanded:!0,mermaidCode:'\n    %% ================ GPT-5 INTEGRATION ================ %%\n    subgraph GPT5_SYSTEM["🚀 GPT-5 SYSTEM"]\n        ENHANCED_QPROC --\x3e INTELLIGENT_ROUTER["🚀 Intelligent Router<br>• Анализ сложности запросов<br>• Выбор оптимальной модели<br>• Управление бюджетом<br>• Адаптивная маршрутизация"]\n\n        INTELLIGENT_ROUTER --\x3e GPT5_NANO["⚡ GPT-5 Nano<br>• 80% запросов<br>• Простые вопросы<br>• Быстрые ответы<br>• Время: 1-2 сек"]\n\n        INTELLIGENT_ROUTER --\x3e GPT5_MINI["🚀 GPT-5 Mini<br>• 15% запросов<br>• Средние задачи<br>• Баланс скорости/качества<br>• Время: 2-3 сек"]\n\n        INTELLIGENT_ROUTER --\x3e GPT5_STANDARD["🎯 GPT-5 Standard<br>• 5% запросов<br>• Сложные рассуждения<br>• Максимальное качество<br>• Время: 3-5 сек"]\n\n        GPT5_NANO --\x3e RESPONSE_GENERATOR["📝 Генератор ответов<br>• Форматирование ответов<br>• Структурированный вывод<br>• Контекстная адаптация"]\n\n        GPT5_MINI --\x3e RESPONSE_GENERATOR\n        GPT5_STANDARD --\x3e RESPONSE_GENERATOR\n\n        RESPONSE_GENERATOR --\x3e RESULT_CACHE["💾 Result Cache<br>• Кэш ответов GPT-5<br>• TTL настройки<br>• Инвалидация<br>• Статистика попаданий"]\n    end\n\n    %% Стилизация\n    classDef gpt5 fill:#a78bfa,stroke:#8b5cf6,stroke-width:2px\n    class GPT5_NANO,GPT5_MINI,GPT5_STANDARD,INTELLIGENT_ROUTER gpt5\n  '},Xs={id:"input-system",name:"Система входа",description:"Пользовательские интерфейсы и балансировщик нагрузки",position:{x:0,y:0},dependencies:[],isVisible:!0,isExpanded:!0,mermaidCode:'\n    %% ================ СИСТЕМА ВХОДА ================ %%\n    USER(("👤 Пользователь")) --\x3e|"Сообщение/Голос/Файл"| NGINX_LB["⚖️ Nginx Load Balancer<br>• Распределение нагрузки<br>• Health checks<br>• SSL termination<br>• Rate limiting"]\n\n    NGINX_LB --\x3e BOT["🤖 Telegram Бот<br>• Redis FSM<br>• Rate limiting<br>• Голосовые команды"]\n    NGINX_LB --\x3e WEB_SERVICE["🌐 Веб-сервис<br>• Next.js 14<br>• WebSockets<br>• PWA поддержка"]\n    NGINX_LB --\x3e MOBILE_APP["📱 Мобильное приложение<br>• React Native<br>• Push-уведомления<br>• Оффлайн-режим"]\n\n    BOT --\x3e REDIS_QUEUE["📬 Redis Queue<br>• Очередь запросов<br>• Приоритизация<br>• Rate limiting"]\n    WEB_SERVICE --\x3e REDIS_QUEUE\n    MOBILE_APP --\x3e REDIS_QUEUE\n\n    REDIS_QUEUE --\x3e WORKER_POOL["⚙️ Worker Pool<br>• Параллельная обработка<br>• Автоматическое масштабирование<br>• Мониторинг состояния"]\n\n    WORKER_POOL --\x3e ROUTER["🧭 Маршрутизатор<br>FastAPI + Pydantic v2<br>• Idempotency keys<br>• Умная валидация"]\n\n    %% Стилизация\n    classDef implemented fill:#d1fae5,stroke:#10b981,stroke-width:2px,color:#111827\n    class USER,NGINX_LB,BOT,WEB_SERVICE,MOBILE_APP,REDIS_QUEUE,WORKER_POOL,ROUTER implemented\n  '},er={id:"raptor-engine",name:"RAPTOR Engine",description:"Рекурсивная кластеризация и древовидная организация данных",position:{x:0,y:1},dependencies:["input-system"],isVisible:!0,isExpanded:!0,mermaidCode:'\n    %% ================ RAPTOR ENGINE ================ %%\n    subgraph RAPTOR_SYSTEM["🌳 RAPTOR ENGINE"]\n        ROUTER --\x3e ENHANCED_QPROC["🧠 Расширенный обработчик<br>• SlangDictionary<br>• ContextAnalyzer<br>• SynonymExpander<br>• LegalTerminologyManager"]\n\n        ENHANCED_QPROC --\x3e RAPTOR_ENGINE["🌳 RAPTOR Engine<br>• Рекурсивная кластеризация<br>• Древовидная организация<br>• Генерация абстракций<br>• Оптимизированный поиск"]\n\n        RAPTOR_ENGINE --\x3e RAPTOR_TREE["🌳 RAPTOR Tree<br>• Иерархическая структура<br>• Рекурсивные узлы<br>• Абстракции по уровням"]\n\n        RAPTOR_ENGINE --\x3e RAPTOR_CLUSTERING["🔗 RAPTOR Clustering<br>• K-means кластеризация<br>• Семантическое группирование<br>• Адаптивные пороги"]\n    end\n\n    %% Стилизация\n    classDef raptor fill:#fbbf24,stroke:#f59e0b,stroke-width:3px\n    class RAPTOR_ENGINE,RAPTOR_TREE,RAPTOR_CLUSTERING raptor\n  '},tr=()=>{const[t,s]=v.useState(null),[r,i]=v.useState(!0),{zoom:n,isFullscreen:a,zoomIn:o,zoomOut:l,resetZoom:c,toggleFullscreen:d}=(()=>{const[e,t]=v.useState(1),[s,r]=v.useState(!1);return{zoom:e,isFullscreen:s,zoomIn:v.useCallback(()=>{t(e=>Math.min(e+.1,2))},[]),zoomOut:v.useCallback(()=>{t(e=>Math.max(e-.1,.5))},[]),resetZoom:v.useCallback(()=>{t(1)},[]),setZoomLevel:v.useCallback(e=>{t(Math.max(.5,Math.min(2,e)))},[]),toggleFullscreen:v.useCallback(()=>{r(e=>!e)},[]),zoomToFit:v.useCallback(()=>{t(1)},[])}})(),{showLegend:h,showMinimap:p,toggleLegend:g,toggleMinimap:x,resetControls:y}=(()=>{const[e,t]=v.useState(!0),[s,r]=v.useState(!0),[i,n]=v.useState(!0),[a,o]=v.useState(!1),[l,c]=v.useState(!0);return{showLegend:e,showMinimap:s,autoLayout:i,showGrid:a,showConnections:l,toggleLegend:v.useCallback(()=>{t(e=>!e)},[]),toggleMinimap:v.useCallback(()=>{r(e=>!e)},[]),toggleAutoLayout:v.useCallback(()=>{n(e=>!e)},[]),toggleGrid:v.useCallback(()=>{o(e=>!e)},[]),toggleConnections:v.useCallback(()=>{c(e=>!e)},[]),resetControls:v.useCallback(()=>{t(!0),r(!0),n(!0),o(!1),c(!0)},[])}})(),b=v.useMemo(()=>{if(r)return'\n        flowchart TD\n        %% ====== ЧИТАЕМОСТЬ/ЦВЕТА ГРУПП ======\n        classDef input fill:#a7f3d0,stroke:#059669,stroke-width:2px,color:#111827\n        classDef infra fill:#0b1f3b,stroke:#60a5fa,stroke-width:2px,color:#eaf2ff\n        classDef service fill:#0f172a,stroke:#374151,stroke-width:2px,color:#f8fafc\n        classDef queue fill:#0c1f16,stroke:#22c55e,stroke-width:2px,color:#dcfce7\n        classDef raptor fill:#f59e0b,stroke:#b45309,stroke-width:2px,color:#111827\n        classDef gpt5 fill:#2b0b3b,stroke:#8b5cf6,stroke-width:2px,color:#f5eaff\n        %% ================ СИСТЕМА ВХОДА ================ %%\n        USER(("👤 Пользователь")) --\x3e|"Сообщение/Голос/Файл"| NGINX_LB["⚖️ Nginx Load Balancer<br>• Распределение нагрузки<br>• Health checks<br>• SSL termination<br>• Rate limiting"]\n\n        NGINX_LB --\x3e BOT["🤖 Telegram Бот<br>• Redis FSM<br>• Rate limiting<br>• Голосовые команды"]\n        NGINX_LB --\x3e WEB_SERVICE["🌐 Веб-сервис<br>• Next.js 14<br>• WebSockets<br>• PWA поддержка"]\n        NGINX_LB --\x3e MOBILE_APP["📱 Мобильное приложение<br>• React Native<br>• Push-уведомления<br>• Оффлайн-режим"]\n\n        BOT --\x3e REDIS_QUEUE["📬 Redis Queue<br>• Очередь запросов<br>• Приоритизация<br>• Rate limiting"]\n        WEB_SERVICE --\x3e REDIS_QUEUE\n        MOBILE_APP --\x3e REDIS_QUEUE\n\n        REDIS_QUEUE --\x3e WORKER_POOL["⚙️ Worker Pool<br>• Параллельная обработка<br>• Автоматическое масштабирование<br>• Мониторинг состояния"]\n\n        WORKER_POOL --\x3e ROUTER["🧭 Маршрутизатор<br>FastAPI + Pydantic v2<br>• Idempotency keys<br>• Умная валидация"]\n\n        %% ================ RAPTOR ENGINE ================ %%\n        subgraph RAPTOR_SYSTEM["🌳 RAPTOR ENGINE"]\n            ROUTER --\x3e ENHANCED_QPROC["🧠 Расширенный обработчик<br>• SlangDictionary<br>• ContextAnalyzer<br>• SynonymExpander<br>• LegalTerminologyManager"]\n\n            ENHANCED_QPROC --\x3e RAPTOR_ENGINE["🌳 RAPTOR Engine<br>• Рекурсивная кластеризация<br>• Древовидная организация<br>• Генерация абстракций<br>• Оптимизированный поиск"]\n\n            RAPTOR_ENGINE --\x3e RAPTOR_TREE["🌳 RAPTOR Tree<br>• Иерархическая структура<br>• Рекурсивные узлы<br>• Абстракции по уровням"]\n\n            RAPTOR_ENGINE --\x3e RAPTOR_CLUSTERING["🔗 RAPTOR Clustering<br>• K-means кластеризация<br>• Семантическое группирование<br>• Адаптивные пороги"]\n        end\n\n        %% ================ GPT-5 INTEGRATION ================ %%\n        subgraph GPT5_SYSTEM["🚀 GPT-5 SYSTEM"]\n            ENHANCED_QPROC --\x3e INTELLIGENT_ROUTER["🚀 Intelligent Router<br>• Анализ сложности запросов<br>• Выбор оптимальной модели<br>• Управление бюджетом<br>• Адаптивная маршрутизация"]\n\n            INTELLIGENT_ROUTER --\x3e GPT5_NANO["⚡ GPT-5 Nano<br>• 80% запросов<br>• Простые вопросы<br>• Быстрые ответы<br>• Время: 1-2 сек"]\n\n            INTELLIGENT_ROUTER --\x3e GPT5_MINI["🚀 GPT-5 Mini<br>• 15% запросов<br>• Средние задачи<br>• Баланс скорости/качества<br>• Время: 2-3 сек"]\n\n            INTELLIGENT_ROUTER --\x3e GPT5_STANDARD["🎯 GPT-5 Standard<br>• 5% запросов<br>• Сложные рассуждения<br>• Максимальное качество<br>• Время: 3-5 сек"]\n\n            GPT5_NANO --\x3e RESPONSE_GENERATOR["📝 Генератор ответов<br>• Форматирование ответов<br>• Структурированный вывод<br>• Контекстная адаптация"]\n\n            GPT5_MINI --\x3e RESPONSE_GENERATOR\n            GPT5_STANDARD --\x3e RESPONSE_GENERATOR\n\n            RESPONSE_GENERATOR --\x3e RESULT_CACHE["💾 Result Cache<br>• Кэш ответов GPT-5<br>• TTL настройки<br>• Инвалидация<br>• Статистика попаданий"]\n        end\n\n        %% ================ ДАННЫЕ И МОНИТОРИНГ ================ %%\n        subgraph DATA["🗄️ ДАННЫЕ"]\n            POSTGRES[(🐘 PostgreSQL)]\n            QDRANT[(🔍 Qdrant Vector DB)]\n            MINIO[(🗄️ MinIO S3)]\n        end\n\n        subgraph MON["📊 МОНИТОРИНГ"]\n            SIGNOZ["🔍 SigNoz"]\n        end\n\n        %% Связи с данными и метриками\n        ENHANCED_QPROC --\x3e|"метаданные"| POSTGRES\n        ENHANCED_QPROC --\x3e|"векторы"| QDRANT\n        ENHANCED_QPROC --\x3e|"файлы"| MINIO\n        RESPONSE_GENERATOR --\x3e|"метрики"| SIGNOZ\n        WORKER_POOL --\x3e|"метрики"| SIGNOZ\n\n        %% ================ СТИЛИЗАЦИЯ ================ %%\n        %% ====== НАЗНАЧЕНИЕ КЛАССОВ ======\n        class USER input\n        class NGINX_LB input\n        class BOT,WEB_SERVICE,MOBILE_APP,WORKER_POOL,ROUTER input\n        class REDIS_QUEUE input\n        class RESULT_CACHE queue\n        class RAPTOR_ENGINE,RAPTOR_TREE,RAPTOR_CLUSTERING raptor\n        class GPT5_NANO,GPT5_MINI,GPT5_STANDARD,INTELLIGENT_ROUTER gpt5\n        class POSTGRES,QDRANT,MINIO db\n        class SIGNOZ monitor\n      ';if(t){const e=[Xs,er,Js].find(e=>e.id===t);if(console.log("Selected module:",t,"Found module:",e),null==e?void 0:e.mermaidCode){const t=`flowchart TD\n${e.mermaidCode}`;return console.log("Generated diagram code:",t),t}return""}return""},[r,t]),{diagramRef:j,isLoading:w,error:N,performance:k,isRendered:S,forceRerender:C}=(t=>{const[s,r]=v.useState(!0),[i,n]=v.useState(null),[a,o]=v.useState(null),[l,c]=v.useState(!1),d=v.useRef(null),h=v.useRef(0),u=v.useRef(!1),p=v.useRef(""),g=v.useRef(null),x=v.useCallback(()=>m(e,null,function*(){return window.mermaid?Promise.resolve():new Promise((e,t)=>{const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js",s.onload=()=>{window.mermaid?(window.mermaid.initialize({startOnLoad:!1,theme:"dark",flowchart:{useMaxWidth:!0,htmlLabels:!0,curve:"basis",padding:12,nodeSpacing:40,rankSpacing:60},themeVariables:{primaryColor:"#0b1220",primaryTextColor:"#f8fafc",primaryBorderColor:"#1f2937",lineColor:"#93c5fd",secondaryColor:"#111827",tertiaryColor:"#0f172a",textColor:"#f8fafc",fontFamily:"Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial",clusterBkg:"#0b1220",clusterBorder:"#1f2937",nodeBorder:"#334155",nodeTextColor:"#f8fafc",noteBkg:"#0b1220",noteTextColor:"#e2e8f0"},themeCSS:"\n              .label, .nodeLabel { font-size: 14px; line-height: 1.35; fill: #f8fafc; font-weight: 600; }\n              .edgeLabel { font-size: 12px; fill: #e2e8f0; font-weight: 600; }\n              .edgeLabel rect { fill: #0b1220; stroke: #1f2937; rx: 4px; ry: 4px; opacity: 0.95; }\n              .cluster text { font-size: 13px; fill: #cbd5e1; }\n              .node rect, .node polygon { rx: 10px; ry: 10px; }\n              .edgePath .path { stroke-width: 2.2px; }\n              .marker, .arrowheadPath { fill: #93c5fd; stroke: #93c5fd; }\n              /* Raptor: чёрный текст на оранжевом */\n              .node.raptor .label, .node.raptor .nodeLabel { fill: #111827 !important; }\n              /* Input: чёрный текст на светло-зелёном фоне */\n              .node.input .label, .node.input .nodeLabel { fill: #111827 !important; }\n              /* Service: текст ярче на тёмном */\n              .node.service .label, .node.service .nodeLabel { fill: #f8fafc !important; }\n              /* DB: тёмный текст на светлом */\n              .node.db .label, .node.db .nodeLabel { fill: #0f172a !important; }\n              /* Monitor: светлый текст */\n              .node.monitor .label, .node.monitor .nodeLabel { fill: #f8fafc !important; }\n            "}),e()):t(new Error("Failed to load Mermaid"))},s.onerror=()=>t(new Error("Failed to load Mermaid script")),document.head.appendChild(s)})}),[]),f=v.useCallback(()=>m(e,null,function*(){var e,s;if(!t||!d.current)return;if(u.current)return void console.log("Diagram render already in progress, skipping...");if(p.current===t&&l)return void console.log("Diagram code unchanged, skipping render...");u.current=!0,r(!0),n(null);const i=()=>{var e;try{return(null==(e=window.performance)?void 0:e.now())||Date.now()}catch(t){return Date.now()}},a=i();try{if(d.current&&(d.current.innerHTML=""),yield x(),!window.mermaid)throw new Error("Mermaid not loaded");const{svg:r}=yield window.mermaid.render(`diagram-${Date.now()}-${h.current}`,t);d.current&&(d.current.innerHTML=r,c(!0),h.current=0,p.current=t,d.current.style.setProperty("--zoom-level","1"));const n=i()-a;o({renderTime:n,loadTime:n,memoryUsage:(null==(s=null==(e=window.performance)?void 0:e.memory)?void 0:s.usedJSHeapSize)||0,nodeCount:(r.match(/<g class="node"/g)||[]).length,connectionCount:(r.match(/<path class="path"/g)||[]).length})}catch(m){console.error("Diagram render error:",m);const e={type:"render",message:`Ошибка рендеринга диаграммы: ${m instanceof Error?m.message:"Неизвестная ошибка"}`,details:m instanceof Error?m.stack:void 0,timestamp:Date.now()};n(e),h.current<3?(h.current++,setTimeout(()=>{f()},1e3*h.current)):d.current&&(d.current.innerHTML='\n            <div class="diagram-error">\n              <div class="error-icon">⚠️</div>\n              <div class="error-message">Ошибка загрузки диаграммы</div>\n              <div class="error-details">Попробуйте обновить страницу</div>\n              <button onclick="window.location.reload()" class="retry-button">\n                Обновить страницу\n              </button>\n            </div>\n          ')}finally{r(!1),u.current=!1}}),[t,x,l]);v.useEffect(()=>(t&&(g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{f()},300)),()=>{g.current&&clearTimeout(g.current)}),[t,f]);const y=v.useCallback(()=>{c(!1),h.current=0,p.current="",u.current=!1,f()},[f]),b=v.useCallback(()=>{d.current&&(d.current.innerHTML=""),c(!1),n(null),o(null),p.current="",u.current=!1,g.current&&(clearTimeout(g.current),g.current=null)},[]);return{diagramRef:d,isLoading:s,error:i,performance:a,isRendered:l,forceRerender:y,clearDiagram:b}})(b);f.useEffect(()=>{j.current&&j.current.style.setProperty("--zoom-level",n.toString())},[n]);const E=e=>{s(e),i(!1)};return u.jsxs("div",{className:"modular-architecture-diagram "+(a?"fullscreen":""),children:[u.jsx(Ks,{zoom:n,isFullscreen:a,showLegend:h,showMinimap:p,onZoomIn:o,onZoomOut:l,onResetZoom:c,onToggleFullscreen:d,onToggleLegend:g,onToggleMinimap:x,onDownload:()=>{var e;const t=null==(e=j.current)?void 0:e.querySelector("svg");if(t){const e=(new XMLSerializer).serializeToString(t),s=new Blob([e],{type:"image/svg+xml"}),r=URL.createObjectURL(s),i=document.createElement("a");i.href=r,i.download="ai-lawyer-architecture.svg",i.click(),URL.revokeObjectURL(r)}},onRerender:C,onResetControls:y}),u.jsxs("div",{className:"diagram-content",children:[u.jsxs("div",{className:"modules-panel",children:[u.jsx("h3",{children:"Модули архитектуры"}),u.jsxs("div",{className:"modules-list",children:[u.jsx("button",{onClick:()=>{s(null),i(!0)},className:"module-button "+(r?"active":""),children:"🏗️ Полная архитектура"}),u.jsx("button",{onClick:()=>E("input-system"),className:"module-button "+("input-system"===t?"active":""),children:"🚪 Система входа"}),u.jsx("button",{onClick:()=>E("raptor-engine"),className:"module-button "+("raptor-engine"===t?"active":""),children:"🌳 RAPTOR Engine"}),u.jsx("button",{onClick:()=>E("gpt5-integration"),className:"module-button "+("gpt5-integration"===t?"active":""),children:"🚀 GPT-5 Integration"})]})]}),u.jsxs("div",{className:"diagram-area",children:[u.jsx(Qs,{ref:j,zoom:n,isLoading:w,isRendered:S}),N&&u.jsx(Zs,{error:N,onRetry:C}),k&&u.jsx("div",{className:"performance-info",children:u.jsxs("small",{children:["Рендер: ",k.renderTime.toFixed(0),"мс | Узлы: ",k.nodeCount," | Связи: ",k.connectionCount]})})]}),h&&u.jsx("div",{className:"legend-panel",children:u.jsx(Ys,{})})]})]})},sr=()=>{const[e,t]=v.useState("interactive-guide"),[s,r]=v.useState(null);v.useEffect(()=>{const e=e=>{const s=e.detail;t(s)};return window.addEventListener("ai-lawyer:switch-tab",e),()=>{window.removeEventListener("ai-lawyer:switch-tab",e)}},[]);const[i,n]=v.useState(null),a=e=>{r(s===e?null:e)},o=()=>u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-2xl font-bold mb-4",children:"⚖️ Юридические консультации"}),u.jsx("p",{className:"text-lg text-text-secondary mb-6",children:"Получите быстрые и точные ответы на ваши юридические вопросы с помощью GPT-5 и RAPTOR Engine"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[u.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[u.jsx(Lt,{className:"w-5 h-5 text-primary"}),"GPT-5 Nano (80%)"]}),u.jsx("p",{className:"text-text-secondary mb-4",children:"Простые вопросы с быстрым ответом. Оптимизированная обработка"}),u.jsxs("ul",{className:"space-y-2 text-sm",children:[u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Быстрые консультации"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Простые правовые вопросы"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Анализ документов"})]})]})]}),u.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[u.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[u.jsx(We,{className:"w-5 h-5 text-primary"}),"GPT-5 Mini (15%)"]}),u.jsx("p",{className:"text-text-secondary mb-4",children:"Средние задачи с оптимальным качеством. Сбалансированная обработка"}),u.jsxs("ul",{className:"space-y-2 text-sm",children:[u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Генерация документов"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Средние правовые задачи"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Баланс скорости/качества"})]})]})]}),u.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[u.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[u.jsx(jt,{className:"w-5 h-5 text-primary"}),"GPT-5 Standard (5%)"]}),u.jsx("p",{className:"text-text-secondary mb-4",children:"Сложные рассуждения с максимальным качеством. RAPTOR Engine обработка"}),u.jsxs("ul",{className:"space-y-2 text-sm",children:[u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"RAPTOR Engine"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"GraphRAG + HyDE"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Максимальное качество"})]})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-blue-500/10 border border-primary/20 rounded-lg p-6",children:[u.jsx("h3",{className:"text-xl font-semibold mb-4",children:"🚀 Уникальные технологии"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-primary mb-2",children:"RAPTOR Engine"}),u.jsx("p",{className:"text-sm text-text-secondary",children:"Рекурсивная обработка для древовидной организации поиска - революционная технология для структурирования юридических документов"})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-primary mb-2",children:"Intelligent Router"}),u.jsx("p",{className:"text-sm text-text-secondary",children:"Умный роутинг с анализом сложности, выбором оптимальной модели и управлением бюджетом"})]})]})]}),u.jsx("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-6",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(Ie,{className:"w-5 h-5 text-warning mt-1 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-warning mb-2",children:"Важно!"}),u.jsx("p",{className:"text-sm",children:"AI-юрист предоставляет предварительные консультации. Для сложных дел и судебных споров рекомендуется дополнительная консультация с живым юристом."})]})]})}),u.jsxs("div",{className:"text-center space-y-4",children:[u.jsxs("div",{className:"bg-gradient-to-r from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-lg p-6 mb-6",children:[u.jsx("h3",{className:"text-xl font-semibold mb-4",children:"🚀 Почему выбирают нас?"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-3xl font-bold text-green-500",children:"Экономично"}),u.jsx("div",{className:"text-sm text-text-secondary",children:"Оптимизированная стоимость"}),u.jsx("div",{className:"text-xs text-text-secondary",children:"умная маршрутизация запросов"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-3xl font-bold text-blue-500",children:"Мгновенно"}),u.jsx("div",{className:"text-sm text-text-secondary",children:"Скорость ответа"}),u.jsx("div",{className:"text-xs text-text-secondary",children:"в разы быстрее"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-3xl font-bold text-purple-500",children:"97%"}),u.jsx("div",{className:"text-sm text-text-secondary",children:"Точность RAPTOR"}),u.jsx("div",{className:"text-xs text-text-secondary",children:"выше чем у юристов"})]})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[u.jsxs("button",{onClick:()=>a("consultation"),className:"sidebar-service-item max-w-[300px] "+("consultation"===s?"active":""),children:[u.jsx(gt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Начать консультацию"})})]}),u.jsxs("button",{onClick:()=>a("document-analysis"),className:"sidebar-service-item max-w-[300px] "+("document-analysis"===s?"active":""),children:[u.jsx(Ye,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Анализ документа"})})]}),u.jsxs("button",{onClick:()=>a("contract-generation"),className:"sidebar-service-item max-w-[300px] "+("contract-generation"===s?"active":""),children:[u.jsx(Lt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Генерация договора"})})]})]}),u.jsx("p",{className:"text-sm text-text-secondary",children:"💰 Значительная экономия на юридических услугах благодаря автоматизации"})]})]});return u.jsx(Ps,{id:"ai-lawyer-service",title:"AI-Юрист",icon:u.jsx("span",{className:"text-green-500",children:"⚖️"}),status:"active",hover:!1,children:u.jsx("div",{className:"h-full",children:u.jsxs("div",{className:"flex-1 overflow-y-auto sidebar-scrollbar h-full "+("interactive-guide"===e?"min-h-[400px] max-h-[80vh]":"min-h-0 max-h-none"),children:[(()=>{switch(e){case"consultation":default:return o();case"documents":return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-2xl font-bold mb-4",children:"📄 Документы и шаблоны"}),u.jsx("p",{className:"text-lg text-text-secondary mb-6",children:"Создание, управление и генерация юридических документов"})]}),u.jsxs("div",{className:"bg-gradient-to-r from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-lg p-6",children:[u.jsx("h3",{className:"text-xl font-semibold mb-4",children:"⚡ Быстрое создание"}),u.jsx("p",{className:"text-sm text-text-secondary mb-4",children:"Выберите тип документа и создайте его за несколько кликов"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[u.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+("supply"===i?"border-primary bg-primary/10":"border-border hover:border-primary/50 hover:bg-surface/50"),onClick:()=>n("supply"===i?null:"supply"),children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl mb-2",children:"📦"}),u.jsx("h4",{className:"font-semibold text-sm",children:"Договор поставки"}),u.jsx("p",{className:"text-xs text-text-secondary",children:"Товары и услуги"})]})}),u.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+("employment"===i?"border-primary bg-primary/10":"border-border hover:border-primary/50 hover:bg-surface/50"),onClick:()=>n("employment"===i?null:"employment"),children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl mb-2",children:"👥"}),u.jsx("h4",{className:"font-semibold text-sm",children:"Трудовой договор"}),u.jsx("p",{className:"text-xs text-text-secondary",children:"Работник и работодатель"})]})}),u.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+("rent"===i?"border-primary bg-primary/10":"border-border hover:border-primary/50 hover:bg-surface/50"),onClick:()=>n("rent"===i?null:"rent"),children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl mb-2",children:"🏠"}),u.jsx("h4",{className:"font-semibold text-sm",children:"Договор аренды"}),u.jsx("p",{className:"text-xs text-text-secondary",children:"Недвижимость"})]})}),u.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+("services"===i?"border-primary bg-primary/10":"border-border hover:border-primary/50 hover:bg-surface/50"),onClick:()=>n("services"===i?null:"services"),children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl mb-2",children:"🔧"}),u.jsx("h4",{className:"font-semibold text-sm",children:"Договор услуг"}),u.jsx("p",{className:"text-xs text-text-secondary",children:"Выполнение работ"})]})})]}),u.jsx("div",{className:"text-center",children:u.jsxs("button",{onClick:()=>a("contract-generation"),className:"sidebar-service-item max-w-[300px] "+("contract-generation"===s?"active":""),children:[u.jsx(Lt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Создать документ"})})]})})]})]});case"compliance":return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-2xl font-bold mb-4",children:"🛡️ 152-ФЗ и комплаенс"}),u.jsx("p",{className:"text-lg text-text-secondary mb-6",children:"Обеспечение соответствия требованиям законодательства о персональных данных"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[u.jsx("h3",{className:"text-xl font-semibold mb-4",children:'152-ФЗ "О персональных данных"'}),u.jsxs("ul",{className:"space-y-3",children:[u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Аудит обработки ПД"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Политика конфиденциальности"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Согласие на обработку ПД"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"Уведомление в Роскомнадзор"})]})]})]}),u.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[u.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Другие требования"}),u.jsxs("ul",{className:"space-y-3",children:[u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"GDPR (ЕС)"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"CCPA (Калифорния)"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"LGPD (Бразилия)"})]}),u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),u.jsx("span",{children:"PIPEDA (Канада)"})]})]})]})]}),u.jsx("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-6",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(Ie,{className:"w-5 h-5 text-warning mt-1 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-warning mb-2",children:"Штрафы за нарушения"}),u.jsx("p",{className:"text-sm",children:"Нарушение 152-ФЗ может повлечь штрафы до 75 000 рублей для ИП и до 300 000 рублей для организаций."})]})]})}),u.jsx("div",{className:"text-center",children:u.jsxs("button",{onClick:()=>a("compliance-check"),className:"sidebar-service-item max-w-[300px] "+("compliance-check"===s?"active":""),children:[u.jsx($t,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Проверить соответствие"})})]})})]});case"pricing":return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-2xl font-bold mb-4",children:"💰 Тарифы"}),u.jsx("p",{className:"text-lg text-text-secondary mb-6",children:"Выберите подходящий тариф для ваших потребностей"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[u.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Базовый"}),u.jsxs("div",{className:"text-3xl font-bold mb-4",children:["₽5,000",u.jsx("span",{className:"text-lg font-normal",children:"/мес"})]}),u.jsxs("ul",{className:"space-y-3 mb-6",children:[u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"10 консультаций"})]}),u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"5 документов"})]}),u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"Email поддержка"})]})]}),u.jsx("button",{className:"w-full bg-primary text-white py-2 rounded-lg font-semibold hover:bg-primary/90 transition-colors",children:"Выбрать"})]}),u.jsxs("div",{className:"bg-surface rounded-lg p-6 border-2 border-primary relative",children:[u.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-primary text-white px-3 py-1 rounded-full text-sm font-medium",children:"Популярный"}),u.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Профессиональный"}),u.jsxs("div",{className:"text-3xl font-bold mb-4",children:["₽15,000",u.jsx("span",{className:"text-lg font-normal",children:"/мес"})]}),u.jsxs("ul",{className:"space-y-3 mb-6",children:[u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"50 консультаций"})]}),u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"25 документов"})]}),u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"Приоритетная поддержка"})]}),u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"Аудит 152-ФЗ"})]})]}),u.jsx("button",{className:"w-full bg-primary text-white py-2 rounded-lg font-semibold hover:bg-primary/90 transition-colors",children:"Выбрать"})]}),u.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[u.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Корпоративный"}),u.jsxs("div",{className:"text-3xl font-bold mb-4",children:["₽50,000",u.jsx("span",{className:"text-lg font-normal",children:"/мес"})]}),u.jsxs("ul",{className:"space-y-3 mb-6",children:[u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"Безлимитные консультации"})]}),u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"Безлимитные документы"})]}),u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"Персональный менеджер"})]}),u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx(ze,{className:"w-4 h-4 text-green-500"}),u.jsx("span",{children:"Интеграция с вашими системами"})]})]}),u.jsx("button",{className:"w-full bg-primary text-white py-2 rounded-lg font-semibold hover:bg-primary/90 transition-colors",children:"Связаться"})]})]})]});case"architecture":return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-2xl font-bold mb-4",children:"🏗️ Архитектура AI-Юриста"}),u.jsx("p",{className:"text-lg text-text-secondary mb-6",children:"Революционная техническая архитектура с GPT-5, RAPTOR Engine и передовыми технологиями"})]}),u.jsx(tr,{})]});case"interactive-guide":return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-2xl font-bold mb-4",children:"🎯 Интерактивный гид"}),u.jsx("p",{className:"text-lg text-text-secondary mb-6",children:"Пошаговое руководство по использованию AI-Юриста"})]}),u.jsx(qs,{})]})}})(),s&&u.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-lg p-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"💬 Общайтесь через чат!"}),u.jsx("p",{className:"text-text-secondary mb-4",children:"Используйте чат справа для общения с AI-Юристом. Просто напишите ваш запрос, и система поможет вам."}),u.jsxs("div",{className:"bg-surface/50 rounded-lg p-4 border border-border",children:[u.jsxs("p",{className:"text-sm text-text-secondary",children:[u.jsx("strong",{children:"Активная функция:"})," ","consultation"===s?"Консультация":"document-analysis"===s?"Анализ документа":"contract-generation"===s?"Генерация договора":"template-preview"===s?"Просмотр шаблона":"template-edit"===s?"Редактирование шаблона":"template-create"===s?"Создание шаблона":"start-guide"===s?"Интерактивный гид":"quick-demo"===s?"Быстрая демонстрация":"Функция"]}),u.jsxs("p",{className:"text-xs text-text-secondary mt-2",children:['💡 Напишите в чате: "',(l=s,{consultation:"Опишите вашу юридическую ситуацию или задайте вопрос...","document-analysis":"Загрузите документ для анализа или вставьте текст...","contract-generation":"Опишите тип договора и основные условия...","compliance-check":"Опишите процесс обработки персональных данных...","legal-research":"Опишите правовую проблему для исследования...","risk-assessment":"Опишите ситуацию для оценки правовых рисков...","template-preview":"Выберите шаблон для предварительного просмотра...","template-edit":"Выберите шаблон для редактирования...","template-create":"Опишите тип нового шаблона и его назначение...","start-guide":"Начните интерактивное путешествие по архитектуре AI-Юриста...","quick-demo":"Запустите быструю демонстрацию возможностей системы..."}[l]||"Введите ваш запрос..."),'"']})]})]})]})})});var l},rr=(e,t)=>{const s=e[t];return s?"function"==typeof s?s():Promise.resolve(s):new Promise((e,s)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})},ir="promptsManager",nr=new class{constructor(){this.modules=new Map,this.quickAccess=new Set,this.loadQuickAccess(),this.loadSystemModules().catch(e=>{console.error("Failed to load system modules in constructor:",e)})}loadUserModules(){return m(this,null,function*(){try{console.log("[PromptManager] Loading user modules...");const t=Object.keys(localStorage).filter(e=>e.startsWith(`${ir}:module:`));for(const s of t)try{const e=localStorage.getItem(s);if(e){const t=JSON.parse(e);this.modules.set(t.id,t),console.log(`[PromptManager] User module ${t.id} loaded successfully`)}}catch(e){console.warn(`Failed to load user module from ${s}:`,e)}console.log(`[PromptManager] User modules loaded. Total modules: ${this.modules.size}`)}catch(e){console.error("Failed to load user modules:",e)}})}loadSystemModules(){return m(this,null,function*(){try{console.log("[PromptManager] Loading system modules...");const s=["ai-assistant","business","creative","education","productivity"];for(const r of s)try{console.log(`[PromptManager] Loading module: ${r}`);try{const e=yield rr(Object.assign({"./system/ai-assistant.json":()=>o(()=>import("./ai-assistant-28dbcdbf.js"),[]),"./system/business.json":()=>o(()=>import("./business-9faa3aea.js"),[]),"./system/creative.json":()=>o(()=>import("./creative-302b7a2d.js"),[]),"./system/education.json":()=>o(()=>import("./education-629b4108.js"),[]),"./system/productivity.json":()=>o(()=>import("./productivity-d788e687.js"),[])}),`./system/${r}.json`),t=e.default||e;this.modules.set(r,t),console.log(`[PromptManager] Module ${r} loaded successfully via import`)}catch(e){console.log(`[PromptManager] Import failed for ${r}, trying fetch...`);const t=yield fetch(`/src/data/prompts/system/${r}.json`);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);{const e=yield t.json();this.modules.set(r,e),console.log(`[PromptManager] Module ${r} loaded successfully via fetch`)}}}catch(t){console.warn(`Failed to load system module ${r}:`,t)}console.log(`[PromptManager] System modules loaded. Total modules: ${this.modules.size}`)}catch(t){console.error("Failed to load system modules:",t)}})}ensureModulesLoaded(){return m(this,null,function*(){0===this.modules.size&&(console.log("[PromptManager] No modules loaded, waiting for system modules..."),yield new Promise(e=>setTimeout(e,100)),0===this.modules.size&&(console.log("[PromptManager] Still no modules, retrying load..."),yield this.loadSystemModules())),yield this.loadUserModules()})}loadQuickAccess(){try{const e=localStorage.getItem(`${ir}:quickAccess`);if(console.log("[PromptManager] Loading quick access from localStorage:",e),e){const t=JSON.parse(e);this.quickAccess=new Set(t),console.log("[PromptManager] Loaded quick access IDs:",[...this.quickAccess])}else console.log("[PromptManager] No quick access data found in localStorage")}catch(e){console.warn("Failed to load quick access:",e)}}saveQuickAccess(){try{const e=[...this.quickAccess];console.log("[PromptManager] Saving quick access to localStorage:",e),localStorage.setItem(`${ir}:quickAccess`,JSON.stringify(e)),console.log("[PromptManager] Quick access saved successfully")}catch(e){console.warn("Failed to save quick access:",e)}}loadModule(e){return m(this,null,function*(){if(this.modules.has(e))return this.modules.get(e);try{const t=localStorage.getItem(`${ir}:module:${e}`);if(t){const s=JSON.parse(t);return this.modules.set(e,s),s}}catch(t){console.warn(`Failed to load module ${e}:`,t)}throw new Error(`Module ${e} not found`)})}saveModule(e){return m(this,null,function*(){if(this.modules.set(e.id,e),"user"===e.source)try{localStorage.setItem(`${ir}:module:${e.id}`,JSON.stringify(e))}catch(t){console.warn(`Failed to save module ${e.id}:`,t)}})}deleteModule(e){return m(this,null,function*(){const t=this.modules.get(e);if(t&&"user"===t.source){this.modules.delete(e);try{localStorage.removeItem(`${ir}:module:${e}`)}catch(s){console.warn(`Failed to delete module ${e}:`,s)}}})}listModules(e){return m(this,null,function*(){const t=Array.from(this.modules.values());return e?t.filter(t=>t.source===e):t})}searchPrompts(e,t){return m(this,null,function*(){var s;const r=[],i=e.toLowerCase();for(const e of this.modules.values())if(!((null==t?void 0:t.source)&&e.source!==t.source||(null==t?void 0:t.moduleId)&&e.id!==t.moduleId))for(const n of e.prompts)if((!(null==t?void 0:t.categoryId)||n.categoryId===t.categoryId)&&(!(null==t?void 0:t.folderId)||n.folderId===t.folderId)&&(void 0===(null==t?void 0:t.system)||n.system===t.system)&&(!(null==t?void 0:t.tags)||t.tags.some(e=>n.tags.includes(e)))&&`${n.title} ${n.body} ${n.description||""} ${n.tags.join(" ")}`.toLowerCase().includes(i)){const t=e.categories.find(e=>e.id===n.categoryId),a=n.folderId?e.folders.find(e=>e.id===n.folderId):void 0;let o=0;n.title.toLowerCase().includes(i)&&(o+=10),n.tags.some(e=>e.toLowerCase().includes(i))&&(o+=5),n.body.toLowerCase().includes(i)&&(o+=3),(null==(s=n.description)?void 0:s.toLowerCase().includes(i))&&(o+=2),r.push({prompt:n,module:e,category:t,folder:a,relevance:o})}return r.sort((e,t)=>t.relevance-e.relevance)})}getPrompt(e){return m(this,null,function*(){console.log(`[PromptManager] getPrompt called for ID: ${e}`),console.log("[PromptManager] Available modules:",Array.from(this.modules.keys()));for(const t of this.modules.values()){console.log(`[PromptManager] Searching in module: ${t.id}, prompts: ${t.prompts.length}`);const s=t.prompts.find(t=>t.id===e);if(s)return console.log(`[PromptManager] Found prompt in module ${t.id}: ${s.title}`),s}return console.log(`[PromptManager] Prompt not found: ${e}`),null})}getAllPrompts(){return m(this,null,function*(){yield this.ensureModulesLoaded();const e=[];for(const t of this.modules.values())e.push(...t.prompts);return e})}createPrompt(e){return m(this,null,function*(){const t=this.modules.get(e.moduleId);if(!t)throw new Error(`Module ${e.moduleId} not found`);const s=c(l({},e),{id:this.generateId("prompt"),metadata:{author:"User",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usage:0,rating:0}});return t.prompts.push(s),yield this.saveModule(t),s})}updatePrompt(e,t){return m(this,null,function*(){for(const s of this.modules.values()){const r=s.prompts.findIndex(t=>t.id===e);if(-1!==r){const e=s.prompts[r],i=c(l(l({},e),t),{metadata:c(l({},e.metadata),{updatedAt:(new Date).toISOString()})});return s.prompts[r]=i,yield this.saveModule(s),i}}throw new Error(`Prompt ${e} not found`)})}deletePrompt(e){return m(this,null,function*(){for(const t of this.modules.values()){const s=t.prompts.findIndex(t=>t.id===e);if(-1!==s)return t.prompts.splice(s,1),yield this.saveModule(t),this.quickAccess.delete(e),void this.saveQuickAccess()}throw new Error(`Prompt ${e} not found`)})}getCategories(e){return m(this,null,function*(){yield this.ensureModulesLoaded(),console.log(`[PromptManager] getCategories called. ModuleId: ${e}, Total modules: ${this.modules.size}`);const t=[];for(const s of this.modules.values())e&&s.id!==e||(console.log(`[PromptManager] Processing module ${s.id} with ${s.categories.length} categories`),t.push(...s.categories));return console.log(`[PromptManager] Returning ${t.length} categories`),t.sort((e,t)=>e.order-t.order)})}getFolders(e){return m(this,null,function*(){yield this.ensureModulesLoaded(),console.log(`[PromptManager] getFolders called. CategoryId: ${e}, Total modules: ${this.modules.size}`);const t=[];for(const s of this.modules.values()){console.log(`[PromptManager] Processing module ${s.id} with ${s.folders.length} folders`);for(const r of s.folders)e&&r.categoryId!==e||t.push(r)}return console.log(`[PromptManager] Returning ${t.length} folders`),t.sort((e,t)=>e.order-t.order)})}getPromptsInCategory(e){return m(this,null,function*(){const t=[];for(const s of this.modules.values())for(const r of s.prompts)r.categoryId!==e||r.folderId||t.push(r);return t.sort((e,t)=>e.order-t.order)})}getPromptsInFolder(e){return m(this,null,function*(){const t=[];for(const s of this.modules.values())for(const r of s.prompts)r.folderId===e&&t.push(r);return t.sort((e,t)=>e.order-t.order)})}addToQuickAccess(e){return m(this,null,function*(){console.log(`[PromptManager] Adding to quick access: ${e}`),this.quickAccess.add(e),console.log("[PromptManager] Quick access Set after add:",[...this.quickAccess]),this.saveQuickAccess()})}removeFromQuickAccess(e){return m(this,null,function*(){console.log(`[PromptManager] Removing from quick access: ${e}`),this.quickAccess.delete(e),console.log("[PromptManager] Quick access Set after remove:",[...this.quickAccess]),this.saveQuickAccess()})}getQuickAccess(){return m(this,null,function*(){console.log("[PromptManager] getQuickAccess called, quickAccess Set:",[...this.quickAccess]);const e=[];for(const t of this.quickAccess){console.log(`[PromptManager] Looking for prompt with ID: ${t}`);const s=yield this.getPrompt(t);s?(console.log(`[PromptManager] Found prompt: ${s.title} (${s.id})`),e.push(s)):console.log(`[PromptManager] Prompt not found for ID: ${t}`)}return console.log(`[PromptManager] getQuickAccess returning ${e.length} prompts:`,e.map(e=>({id:e.id,title:e.title}))),e})}generateId(e){return`${e}_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}createUserModule(e,t){return m(this,null,function*(){const s={id:this.generateId("module"),name:e,version:"1.0.0",description:t,source:"user",categories:[],folders:[],prompts:[],metadata:{author:"User",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),tags:[],dependencies:[]}};return yield this.saveModule(s),s})}restoreSystemPrompts(){return m(this,null,function*(){try{const e=["ai-assistant","business"];for(const t of e)this.modules.delete(t);yield this.loadSystemModules(),console.log("System prompts restored successfully")}catch(e){throw console.error("Failed to restore system prompts:",e),e}})}ensureBossAIGenerationCategory(){return m(this,null,function*(){let e=(yield this.getCategories()).find(e=>"Boss AI Generation"===e.title);if(!e){let t=Array.from(this.modules.values()).find(e=>"Boss AI Generation"===e.name);t||(t=yield this.createUserModule("Boss AI Generation","Автоматически сгенерированные промпты")),e={id:this.generateId("category"),title:"Boss AI Generation",description:"Автоматически сгенерированные промпты",order:999,icon:"🤖",color:"#8B5CF6",system:!1,moduleId:t.id},t.categories.push(e),yield this.saveModule(t)}return e})}ensureGeneratedCategory(){return m(this,null,function*(){let e=(yield this.getCategories()).find(e=>"Сгенерированные"===e.title);if(!e){let t=Array.from(this.modules.values()).find(e=>"Сгенерированные"===e.name);t||(t=yield this.createUserModule("Сгенерированные","Улучшенные и сгенерированные промпты")),e={id:this.generateId("category"),title:"Сгенерированные",description:"Улучшенные и сгенерированные промпты",order:998,icon:"✨",color:"#10b981",system:!1,moduleId:t.id},t.categories.push(e),yield this.saveModule(t)}return e})}generatePrompt(e){return m(this,null,function*(){try{const t=yield this.ensureBossAIGenerationCategory(),s=`Сгенерированный промпт: ${e.slice(0,50)}...`,r=`Промпт для: ${e}\n\nИнструкции:\n1. ${e}\n2. Будь точным и полезным\n3. Предоставь детальный ответ\n\nКонтекст: Пользователь запросил помощь с: ${e}`;return yield this.createPrompt({title:s,body:r,description:`Автоматически сгенерированный промпт для: ${e}`,tags:["автогенерация","boss-ai","пользовательский"],categoryId:t.id,order:Date.now(),system:!1,moduleId:t.moduleId})}catch(t){throw console.error("Failed to generate prompt:",t),t}})}improvePrompt(e,t){return m(this,null,function*(){try{const s=`${e}\n\nДополнительные инструкции:\n- Будь максимально точным и конкретным\n- Предоставь пошаговое решение\n- Включи примеры если необходимо\n- Учитывай контекст: ${t||"общий"}\n\nФормат ответа:\n1. Анализ задачи\n2. Пошаговое решение\n3. Примеры и пояснения\n4. Рекомендации`,r=["Добавить конкретные примеры","Уточнить формат ответа","Включить критерии качества","Добавить контекстные ограничения"],i="Промпт был улучшен для большей точности и структурированности. Добавлены четкие инструкции по формату ответа и критериям качества.",n=yield this.ensureGeneratedCategory();return{improvedPrompt:s,suggestions:r,explanation:i,savedPrompt:yield this.createPrompt({title:`Улучшенный промпт: ${e.slice(0,50)}...`,body:s,description:"Автоматически улучшенный промпт",tags:["улучшенный","ai-генерация","пользовательский"],categoryId:n.id,order:Date.now(),system:!1,moduleId:n.moduleId})}}catch(s){throw console.error("Failed to improve prompt:",s),s}})}validateImprovedPrompt(e,t){return m(this,null,function*(){try{let s=e,r="Промпт готов к использованию!";return t&&(s=`${e}\n\nДополнительные требования пользователя:\n${t}\n\nУчти эти требования при выполнении задачи.`,r="Промпт обновлен с учетом ваших дополнений!"),{isValid:!0,finalPrompt:s,message:r}}catch(s){throw console.error("Failed to validate improved prompt:",s),s}})}createUserCategory(e,t,s,r){return m(this,null,function*(){try{const i=(yield this.getCategories()).find(t=>t.title===e);if(i)return console.log(`[PromptManager] Category "${e}" already exists, returning existing one`),i;let n=Array.from(this.modules.values()).find(e=>"Пользовательские"===e.name);n||(n=yield this.createUserModule("Пользовательские","Пользовательские категории и промпты"));const a={id:this.generateId("category"),title:e,description:t||`Пользовательская категория: ${e}`,order:Date.now(),icon:s||"📁",color:r||"#6b7280",system:!1,moduleId:n.id};return n.categories.push(a),yield this.saveModule(n),console.log(`[PromptManager] Created new category: "${e}"`),a}catch(i){throw console.error("Failed to create user category:",i),i}})}createPromptInCategory(e,t,s,r,i,n){return m(this,null,function*(){try{const a=(yield this.getCategories()).find(t=>t.id===e);if(!a)throw new Error("Category not found");const o=[...i||["пользовательский"]];if(n){const e=`project:${n}`;o.includes(e)||o.push(e)}return yield this.createPrompt({title:t,body:s,description:r||`Пользовательский промпт: ${t}`,tags:o,categoryId:e,order:Date.now(),system:!1,moduleId:a.moduleId})}catch(a){throw console.error("Failed to create prompt in category:",a),a}})}movePromptToCategory(e,t){return m(this,null,function*(){try{const s=yield this.getPrompt(e);if(!s)throw new Error("Prompt not found");const r=(yield this.getCategories()).find(e=>e.id===t);if(!r)throw new Error("Category not found");s.originalCategoryId||(s.originalCategoryId=s.categoryId),s.categoryId=t,s.folderId=void 0,yield this.updatePrompt(e,{categoryId:t,folderId:void 0,originalCategoryId:s.originalCategoryId}),console.log(`[PromptManager] Moved prompt "${s.title}" to category "${r.title}"`)}catch(s){throw console.error("Failed to move prompt to category:",s),s}})}deleteCategory(e){return m(this,null,function*(){try{const t=(yield this.getCategories()).find(t=>t.id===e);if(!t)throw new Error("Category not found");if(t.system)throw new Error("Cannot delete system categories");if("Избранное"===t.title)throw new Error("Cannot delete favorites category");const s=Array.from(this.modules.values()).find(e=>e.id===t.moduleId);if(!s)throw new Error("Module not found");const r=s.prompts.filter(t=>t.categoryId===e);for(const e of r)yield this.deletePrompt(e.id);const i=s.categories.findIndex(t=>t.id===e);-1!==i&&(s.categories.splice(i,1),yield this.saveModule(s)),console.log(`[PromptManager] Deleted category "${t.title}" and ${r.length} prompts`)}catch(t){throw console.error("Failed to delete category:",t),t}})}mergeGeneratedCategories(){return m(this,null,function*(){try{const t=(yield this.getCategories()).filter(e=>"Сгенерированные"===e.title||"Boss AI Generation"===e.title);if(t.length<=1)return void console.log("[PromptManager] No duplicate generated categories found");console.log(`[PromptManager] Found ${t.length} generated categories, merging...`);const s=t.find(e=>"Сгенерированные"===e.title)||t[0],r=t.filter(e=>e.id!==s.id);for(const i of r)try{const e=Array.from(this.modules.values()).find(e=>e.id===i.moduleId);if(e){const t=e.prompts.filter(e=>e.categoryId===i.id);for(const e of t)e.categoryId=s.id,e.moduleId=s.moduleId;const r=e.categories.findIndex(e=>e.id===i.id);-1!==r&&(e.categories.splice(r,1),yield this.saveModule(e))}console.log(`[PromptManager] Merged category "${i.title}" into "${s.title}"`)}catch(e){console.error(`Failed to merge category ${i.id}:`,e)}console.log(`[PromptManager] Merge completed. Kept category: ${s.title}`)}catch(e){throw console.error("Failed to merge generated categories:",e),e}})}},ar=({settings:e,onChange:t,className:s=""})=>{const[r,i]=v.useState(e||{}),[n,a]=v.useState(""),[o,d]=v.useState(!1),[m,h]=v.useState({valid:!0,errors:[]});v.useEffect(()=>{e&&i(e)},[e]);const p=(e,s)=>{const n=c(l({},r),{[e]:s});i(n);const a=function(e){const t=[];return void 0!==e.temperature&&(e.temperature<0||e.temperature>2)&&t.push("Temperature должен быть от 0.0 до 2.0"),void 0!==e.top_p&&(e.top_p<0||e.top_p>1)&&t.push("Top_p должен быть от 0.0 до 1.0"),void 0!==e.max_tokens&&e.max_tokens<1&&t.push("Max_tokens должен быть больше 0"),void 0!==e.frequency_penalty&&(e.frequency_penalty<-2||e.frequency_penalty>2)&&t.push("Frequency_penalty должен быть от -2.0 до 2.0"),void 0!==e.presence_penalty&&(e.presence_penalty<-2||e.presence_penalty>2)&&t.push("Presence_penalty должен быть от -2.0 до 2.0"),{valid:0===t.length,errors:t}}(n);h(a),a.valid&&t(n)},g=Object.keys(r).length>0;return u.jsxs("div",{className:`gpt-settings-panel ${s}`,children:[u.jsxs("div",{className:"gpt-settings-header",children:[u.jsx("h4",{className:"gpt-settings-title",children:"Настройки GPT"}),g&&u.jsx("button",{className:"gpt-settings-clear",onClick:()=>{i({}),a(""),t(void 0)},title:"Очистить настройки",children:"✕"})]}),u.jsxs("div",{className:"gpt-settings-presets",children:[u.jsx("label",{className:"gpt-settings-label",children:"Предустановка:"}),u.jsxs("select",{className:"gpt-settings-select",value:n,onChange:e=>(e=>{if(""===e)i({}),a(""),t(void 0);else{const s=us[e];i(s),a(e),t(s)}})(e.target.value),children:[u.jsx("option",{value:"",children:"Без предустановки"}),u.jsx("option",{value:"creative",children:"Креативная"}),u.jsx("option",{value:"analytical",children:"Аналитическая"}),u.jsx("option",{value:"balanced",children:"Сбалансированная"}),u.jsx("option",{value:"precise",children:"Точная"})]})]}),u.jsxs("div",{className:"gpt-settings-basic",children:[u.jsxs("div",{className:"gpt-settings-row",children:[u.jsxs("label",{className:"gpt-settings-label",children:["Temperature:",u.jsx("span",{className:"gpt-settings-value",children:r.temperature||1})]}),u.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:r.temperature||1,onChange:e=>p("temperature",parseFloat(e.target.value)),className:"gpt-settings-slider"})]}),u.jsxs("div",{className:"gpt-settings-row",children:[u.jsxs("label",{className:"gpt-settings-label",children:["Top P:",u.jsx("span",{className:"gpt-settings-value",children:r.top_p||1})]}),u.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:r.top_p||1,onChange:e=>p("top_p",parseFloat(e.target.value)),className:"gpt-settings-slider"})]}),u.jsxs("div",{className:"gpt-settings-row",children:[u.jsxs("label",{className:"gpt-settings-label",children:["Max Tokens:",u.jsx("span",{className:"gpt-settings-value",children:r.max_tokens||1e3})]}),u.jsx("input",{type:"range",min:"100",max:"4000",step:"100",value:r.max_tokens||1e3,onChange:e=>p("max_tokens",parseInt(e.target.value)),className:"gpt-settings-slider"})]})]}),u.jsxs("div",{className:"gpt-settings-advanced",children:[u.jsxs("button",{className:"gpt-settings-toggle",onClick:()=>d(!o),children:[o?"Скрыть":"Показать"," расширенные настройки"]}),o&&u.jsxs("div",{className:"gpt-settings-advanced-content",children:[u.jsxs("div",{className:"gpt-settings-row",children:[u.jsxs("label",{className:"gpt-settings-label",children:["Frequency Penalty:",u.jsx("span",{className:"gpt-settings-value",children:r.frequency_penalty||0})]}),u.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:r.frequency_penalty||0,onChange:e=>p("frequency_penalty",parseFloat(e.target.value)),className:"gpt-settings-slider"})]}),u.jsxs("div",{className:"gpt-settings-row",children:[u.jsxs("label",{className:"gpt-settings-label",children:["Presence Penalty:",u.jsx("span",{className:"gpt-settings-value",children:r.presence_penalty||0})]}),u.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:r.presence_penalty||0,onChange:e=>p("presence_penalty",parseFloat(e.target.value)),className:"gpt-settings-slider"})]})]})]}),!m.valid&&u.jsx("div",{className:"gpt-settings-errors",children:m.errors.map((e,t)=>u.jsx("div",{className:"gpt-settings-error",children:e},t))}),g&&u.jsxs("div",{className:"gpt-settings-preview",children:[u.jsx("span",{className:"gpt-settings-preview-label",children:"Настройки:"}),u.jsx("span",{className:"gpt-settings-preview-value",children:ps(r)})]})]})},or=()=>{var t;const{state:s}=i(),[r,n]=v.useState([]),[a,o]=v.useState([]),[d,h]=v.useState([]),[p,g]=v.useState([]),[x,y]=v.useState(!1),[b,j]=v.useState(""),[w,N]=v.useState(!1),[k,S]=v.useState(!1),[C,E]=v.useState(""),[I,T]=v.useState(""),[A,M]=v.useState(""),[R,P]=v.useState({level:"categories",categoryId:void 0,folderId:void 0,promptId:void 0}),[L,$]=v.useState(null),[_,O]=v.useState(null),[D,B]=v.useState({}),z=v.useCallback(()=>{if(_){const e=s.workspaceItems.find(e=>e.id===_&&"folder"===e.type);return(null==e?void 0:e.title)||null}return null},[s.workspaceItems,_]);f.useEffect(()=>{const e=e=>{var t;const s=e;console.log("PromptsService received workspace:navigate event:",s.detail),(null==(t=s.detail)?void 0:t.projectId)&&(O(s.detail.projectId),console.log("Set activeProjectId to:",s.detail.projectId))};return window.addEventListener("workspace:navigate",e),()=>window.removeEventListener("workspace:navigate",e)},[]),f.useEffect(()=>{const e=e=>{var t;const s=e;(null==(t=s.detail)?void 0:t.promptId)&&U(s.detail.promptId)};return window.addEventListener("prompts:open",e),()=>window.removeEventListener("prompts:open",e)},[]);const F=v.useCallback(()=>m(e,null,function*(){try{console.log("[PromptsService] Loading data...");const[t,s,r]=yield Promise.all([nr.getCategories(),nr.getFolders(),nr.getQuickAccess()]);console.log("[PromptsService] Initial data loaded:",{categories:t.length,folders:s.length,quick:r.length,quickIds:r.map(e=>e.id)});let i=t;try{yield nr.mergeGeneratedCategories(),i=yield nr.getCategories()}catch(e){console.error("Failed to merge generated categories:",e)}let a=[...i];if(!i.find(e=>"Избранное"===e.title))try{yield nr.createUserCategory("Избранное"),a=yield nr.getCategories()}catch(e){console.error("Failed to create favorites category:",e)}if(console.log("[PromptsService] Final data loaded:",{categories:a.length,folders:s.length,quick:r.length,quickIds:r.map(e=>e.id)}),n(a),o(s),g(r),R.categoryId){const e=a.find(e=>e.id===R.categoryId);if(console.log("[PromptsService] Current category:",null==e?void 0:e.title),"Избранное"===(null==e?void 0:e.title)){const e=yield nr.getAllPrompts();console.log(`[PromptsService] Total prompts loaded: ${e.length}`),console.log(`[PromptsService] Quick access items: ${r.length}`,r.map(e=>e.id));const t=e.filter(e=>r.some(t=>t.id===e.id));console.log(`[PromptsService] Filtered favorite prompts: ${t.length}`),console.log("[PromptsService] Favorite prompts details:",t.map(e=>({id:e.id,title:e.title}))),h(t)}else{const e=yield nr.getPromptsInCategory(R.categoryId);h(e)}}else if(R.folderId){const e=yield nr.getPromptsInFolder(R.folderId);h(e)}}catch(e){console.error("Failed to load data:",e)}}),[R.categoryId,R.folderId]),H=v.useCallback(()=>m(e,null,function*(){try{const e={};for(const t of r)if("Избранное"===t.title){const s=(yield nr.getAllPrompts()).filter(e=>p.some(t=>t.id===e.id));e[t.id]=s.length,console.log(`[PromptsService] Favorites count: ${s.length} (quick: ${p.length})`)}else{const s=yield nr.getPromptsInCategory(t.id);e[t.id]=s.length}B(e)}catch(e){console.error("Failed to load category counts:",e)}}),[r,p]);f.useEffect(()=>{console.log("[PromptsService] Component mounted, loading data..."),F()},[F]),f.useEffect(()=>{console.log("[PromptsService] State updated:",{categories:r.length,quick:p.length,prompts:d.length,navigation:R})},[r,p,d,R]),f.useEffect(()=>{r.length>0&&H()},[r,H]);const W=v.useMemo(()=>r.sort((e,t)=>e.order-t.order).map(e=>({id:e.id,title:e.title})),[r]),G=t=>m(e,null,function*(){console.log(`[PromptsService] Navigating to category: ${t}`),P({level:"category",categoryId:t,folderId:void 0,promptId:void 0}),$(null);try{const e=r.find(e=>e.id===t);if(console.log(`[PromptsService] Current category: ${null==e?void 0:e.title}`),"Избранное"===(null==e?void 0:e.title)){console.log("[PromptsService] Loading favorites, quick state:",p.map(e=>({id:e.id,title:e.title})));const e=yield nr.getAllPrompts();console.log(`[PromptsService] Total prompts for favorites: ${e.length}`),console.log(`[PromptsService] Quick access items: ${p.length}`,p.map(e=>e.id));const t=e.filter(e=>p.some(t=>t.id===e.id));console.log(`[PromptsService] Filtered favorite prompts: ${t.length}`),console.log("[PromptsService] Favorite prompts details:",t.map(e=>({id:e.id,title:e.title}))),h(t),console.log(`[PromptsService] Loaded ${t.length} favorite prompts`)}else{const s=yield nr.getPromptsInCategory(t);h(s),console.log(`[PromptsService] Loaded ${s.length} prompts for category: ${null==e?void 0:e.title}`)}}catch(e){console.error("Failed to load category prompts:",e)}}),V=t=>m(e,null,function*(){P({level:"folder",categoryId:R.categoryId,folderId:t,promptId:void 0}),$(null);try{const e=yield nr.getPromptsInFolder(t);h(e)}catch(e){console.error("Failed to load folder prompts:",e)}}),U=t=>m(e,null,function*(){try{const e=yield nr.getPrompt(t);e&&(P({level:"prompt",categoryId:e.categoryId,folderId:e.folderId,promptId:t}),$(e))}catch(e){console.error("Failed to load prompt:",e)}}),q=v.useMemo(()=>R.categoryId?r.find(e=>e.id===R.categoryId):null,[r,R.categoryId]),Q=v.useMemo(()=>R.folderId?a.find(e=>e.id===R.folderId):null,[a,R.folderId]),K=v.useMemo(()=>"category"===R.level&&R.categoryId?a.filter(e=>e.categoryId===R.categoryId).sort((e,t)=>e.order-t.order):[],[a,R]),Z=v.useMemo(()=>{if("categories"===R.level)return[];let e=d;return R.categoryId&&(e=e.filter(e=>e.categoryId===R.categoryId)),R.folderId?e=e.filter(e=>e.folderId===R.folderId):"category"===R.level&&(e=e.filter(e=>!e.folderId)),e.sort((e,t)=>e.title.localeCompare(t.title))},[d,R]),Y=t=>m(e,null,function*(){if(confirm("Удалить этот промпт?"))try{yield nr.deletePrompt(t),yield F(),(null==L?void 0:L.id)===t&&($(null),m(e,null,function*(){if("prompt"===R.level){if(R.folderId){P({level:"folder",categoryId:R.categoryId,folderId:R.folderId,promptId:void 0});const e=yield nr.getPromptsInFolder(R.folderId);h(e)}else{P({level:"category",categoryId:R.categoryId,folderId:void 0,promptId:void 0});const e=yield nr.getPromptsInCategory(R.categoryId);h(e)}$(null)}else if("folder"===R.level){P({level:"category",categoryId:R.categoryId,folderId:void 0,promptId:void 0});const e=yield nr.getPromptsInCategory(R.categoryId);h(e)}else"category"===R.level&&(P({level:"categories",categoryId:void 0,folderId:void 0,promptId:void 0}),h([]))}))}catch(s){console.error("Failed to delete prompt:",s),alert("Ошибка при удалении промпта")}}),J=()=>m(e,null,function*(){if(C.trim())try{yield nr.createUserCategory(C.trim()),E(""),N(!1),yield F(),alert("Категория создана!")}catch(e){console.error("Failed to create category:",e),alert("Ошибка при создании категории")}}),X=t=>m(e,null,function*(){try{const e=p.some(e=>e.id===t);console.log(`[PromptsService] Toggling quick access for prompt ${t}, currently in quick: ${e}`),console.log("[PromptsService] Current quick state:",p.map(e=>({id:e.id,title:e.title}))),e?(yield nr.removeFromQuickAccess(t),console.log(`[PromptsService] Removed prompt ${t} from quick access`)):(yield nr.addToQuickAccess(t),console.log(`[PromptsService] Added prompt ${t} to quick access`));const s=yield nr.getQuickAccess();console.log(`[PromptsService] Updated quick access: ${s.length} items`),console.log("[PromptsService] Updated quick access details:",s.map(e=>({id:e.id,title:e.title}))),g(s),yield H();const i=r.find(e=>e.id===R.categoryId);if("Избранное"===(null==i?void 0:i.title)){const e=(yield nr.getAllPrompts()).filter(e=>s.some(t=>t.id===e.id));h(e),console.log(`[PromptsService] Updated favorites list: ${e.length} prompts`),console.log("[PromptsService] Updated favorites details:",e.map(e=>({id:e.id,title:e.title})))}setTimeout(()=>{g([...s])},100),console.log(`[PromptsService] Toggled quick access for prompt ${t}, isInQuick: ${!e}`)}catch(e){console.error("Failed to toggle quick access:",e),alert("Ошибка при добавлении в избранное. Попробуйте еще раз.")}}),ee=e=>{window.dispatchEvent(new CustomEvent("chat:insert-prompt",{detail:{id:e.id,body:e.body,title:e.title,settings:e.settings}})),console.log(`Промпт "${e.title}" отправлен в чат${e.settings?" с настройками":""}`)},te=e=>{const t=e.replace("project:","");window.dispatchEvent(new CustomEvent("workspace:navigate",{detail:{projectName:t}}))},se=()=>{const e=[];return"categories"===R.level?e.push({label:"Все категории",count:r.length}):"category"===R.level&&q?(e.push({label:"Все категории",count:r.length}),e.push({label:q.title,count:Z.length+K.length})):"folder"===R.level&&Q?(e.push({label:"Все категории",count:r.length}),e.push({label:(null==q?void 0:q.title)||"",count:0}),e.push({label:Q.title,count:Z.length})):"prompt"===R.level&&L&&(e.push({label:"Все категории",count:r.length}),e.push({label:(null==q?void 0:q.title)||"",count:0}),Q&&e.push({label:Q.title,count:0}),e.push({label:L.title,count:0})),e};return u.jsx(Ps,{id:"prompts-service",title:"Промпты",icon:"🗂",status:"inactive",children:u.jsx("div",{className:"flex gap-4 h-full",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"mb-4",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{className:"platform-input flex-1",placeholder:"✨ Улучшить промпт...",value:b,onChange:e=>j(e.target.value),disabled:x}),u.jsx("button",{className:"prompts-action-button primary",onClick:()=>m(e,null,function*(){if(b.trim()){y(!0);try{const e=yield nr.improvePrompt(b);window.dispatchEvent(new CustomEvent("chat:improve-prompt",{detail:{originalPrompt:b,improvedPrompt:e.improvedPrompt,suggestions:e.suggestions,explanation:e.explanation}})),yield F(),j(""),alert('Промпт улучшен, сохранен в категорию "Сгенерированные" и отправлен в чат!')}catch(e){console.error("Failed to improve prompt:",e),alert("Ошибка при улучшении промпта")}finally{y(!1)}}}),disabled:x||!b.trim(),title:"Улучшить промпт и отправить в чат",children:x?"Улучшаю...":"Улучшить"})]})}),u.jsxs("div",{className:"prompts-management-bar",children:[u.jsx("div",{className:"prompts-breadcrumbs",children:se().map((e,t)=>u.jsxs(f.Fragment,{children:[t>0&&u.jsx("span",{className:"prompts-breadcrumb-item",children:"/"}),u.jsx("span",{className:`${t===se().length-1?"prompts-breadcrumb-current":"prompts-breadcrumb-item"} ${t<se().length-1?"clickable":""}`,onClick:()=>{0===t?(P({level:"categories",categoryId:void 0,folderId:void 0,promptId:void 0}),$(null)):1===t&&"categories"!==R.level?G(R.categoryId):2===t&&"prompt"===R.level&&R.folderId&&V(R.folderId)},children:e.label}),e.count>0&&u.jsx("span",{className:"prompts-breadcrumb-count",children:e.count})]},t))}),u.jsxs("div",{className:"prompts-actions",children:[u.jsxs("button",{className:"prompt-favorite-button "+(R.categoryId&&"Избранное"===(null==(t=r.find(e=>e.id===R.categoryId))?void 0:t.title)?"favorited":""),onClick:()=>{const e=r.find(e=>"Избранное"===e.title);e&&G(e.id)},title:`Открыть избранные промпты (${p.length})`,children:[u.jsx("span",{children:"★"}),p.length>0&&u.jsx("span",{className:"favorite-count",children:p.length})]}),u.jsx("button",{className:"prompts-action-button",onClick:()=>m(e,null,function*(){try{yield nr.restoreSystemPrompts(),yield F(),alert("Системные промпты восстановлены!")}catch(e){console.error("Failed to restore system prompts:",e),alert("Ошибка при восстановлении системных промптов")}}),title:"Восстановить системные промпты",children:u.jsxs("svg",{className:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),u.jsx("path",{d:"M21 3v5h-5"}),u.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),u.jsx("path",{d:"M3 21v-5h5"})]})}),"categories"===R.level&&u.jsxs("button",{className:"create-document-button",onClick:()=>N(!0),title:"Создать категорию",children:[u.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M12 5v14"}),u.jsx("path",{d:"M5 12h14"})]}),u.jsx("span",{children:"Создать категорию"})]}),"category"===R.level&&u.jsxs("button",{className:"create-document-button",onClick:()=>S(!0),title:"Создать промпт",children:[u.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),u.jsx("polyline",{points:"14,2 14,8 20,8"}),u.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),u.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),u.jsx("polyline",{points:"10,9 9,9 8,9"})]}),u.jsx("span",{children:"Создать промпт"})]})]})]}),w&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-surface rounded-lg p-6 w-96 max-w-full mx-4",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Создать категорию"}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("input",{className:"platform-input w-full",placeholder:"Название категории",value:C,onChange:e=>E(e.target.value),onKeyPress:e=>"Enter"===e.key&&J()}),u.jsxs("div",{className:"flex gap-2 justify-end",children:[u.jsx("button",{className:"prompts-action-button",onClick:()=>{N(!1),E("")},children:"Отмена"}),u.jsx("button",{className:"prompts-action-button primary",onClick:J,disabled:!C.trim(),children:"Создать"})]})]})]})}),k&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-surface rounded-lg p-6 w-96 max-w-full mx-4 max-h-[80vh] overflow-y-auto",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Создать промпт"}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("input",{className:"platform-input w-full",placeholder:"Название промпта",value:I,onChange:e=>T(e.target.value)}),u.jsx("textarea",{className:"platform-input w-full min-h-[200px] resize-none",placeholder:"Текст промпта",value:A,onChange:e=>M(e.target.value)}),u.jsxs("div",{className:"flex gap-2 justify-end",children:[u.jsx("button",{className:"prompts-action-button",onClick:()=>{S(!1),T(""),M("")},children:"Отмена"}),u.jsx("button",{className:"prompts-action-button primary",onClick:()=>m(e,null,function*(){if(I.trim()&&A.trim())try{const e=R.categoryId;if(!e)return void alert("Выберите категорию для создания промпта");const t=z();console.log("Creating prompt with project:",t,"activeProjectId:",_),yield nr.createPromptInCategory(e,I.trim(),A.trim(),void 0,void 0,t||void 0),T(""),M(""),S(!1),yield F(),alert("Промпт создан!"+(t?` Тег проекта "${t}" добавлен.`:" (проект не определен)"))}catch(e){console.error("Failed to create prompt:",e),alert("Ошибка при создании промпта")}}),disabled:!I.trim()||!A.trim(),children:"Создать"})]})]})]})}),L&&u.jsxs("div",{className:"prompt-detail-view",children:[u.jsxs("div",{className:"prompt-detail-header",children:[u.jsx("h2",{className:"prompt-detail-title",children:"Промпт"}),u.jsxs("div",{className:"prompt-detail-actions",children:[u.jsx("button",{className:"prompt-favorite-button "+(p.some(e=>e.id===L.id)?"favorited":""),onClick:()=>X(L.id),title:p.some(e=>e.id===L.id)?"Убрать из избранного":"Добавить в избранное",children:u.jsx("span",{children:p.some(e=>e.id===L.id)?"★":"☆"})}),u.jsxs("button",{className:"copy-button",onClick:()=>{return t=L,m(e,null,function*(){try{yield navigator.clipboard.writeText(t.body),console.log(`Промпт "${t.title}" скопирован в буфер обмена`)}catch(e){console.error("Failed to copy prompt text:",e);const s=document.createElement("textarea");s.value=t.body,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),console.log(`Промпт "${t.title}" скопирован в буфер обмена (fallback)`)}});var t},title:"Копировать текст промпта",children:[u.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),u.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]}),u.jsx("span",{children:"Копировать"})]}),u.jsxs("button",{className:"chat-send-button",onClick:()=>ee(L),title:"Отправить в чат",children:[u.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),u.jsx("path",{d:"M22 2 11 13"})]}),u.jsx("span",{className:"text-sm",children:"В чат"})]}),u.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button",onClick:()=>Y(L.id),title:"Удалить промпт",children:u.jsx("span",{className:"platform-button-content",children:u.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 6h18"}),u.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),u.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),u.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),u.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]})]}),u.jsxs("div",{className:"prompt-detail-content",children:[u.jsxs("div",{className:"prompt-detail-section",children:[u.jsx("label",{className:"prompt-detail-section-label",children:"Название"}),u.jsx("div",{className:"prompt-detail-section-content prompt-title",children:u.jsx("input",{className:"w-full bg-transparent border-none outline-none text-base font-medium",value:L.title,onChange:t=>m(e,null,function*(){try{yield nr.updatePrompt(L.id,{title:t.target.value}),$(c(l({},L),{title:t.target.value}))}catch(e){console.error("Failed to update prompt title:",e)}}),placeholder:"Введите название промпта..."})})]}),u.jsxs("div",{className:"prompt-detail-section",children:[u.jsx("label",{className:"prompt-detail-section-label",children:"Текст промпта"}),u.jsx("div",{className:"prompt-detail-section-content prompt-body",children:u.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none resize-none",value:L.body,onChange:t=>m(e,null,function*(){try{yield nr.updatePrompt(L.id,{body:t.target.value}),$(c(l({},L),{body:t.target.value}))}catch(e){console.error("Failed to update prompt body:",e)}}),placeholder:"Введите текст промпта..."})})]}),u.jsxs("div",{className:"prompt-detail-section",children:[u.jsx("label",{className:"prompt-detail-section-label",children:"Теги"}),u.jsxs("div",{className:"prompt-detail-section-content prompt-tags",children:[u.jsx("div",{className:"prompt-detail-tags-list",children:L.tags.map((t,s)=>u.jsxs("div",{className:"prompt-detail-tag-item",children:[u.jsx("span",{className:"prompt-detail-tag "+(t.startsWith("project:")?"project-tag":""),onClick:t.startsWith("project:")?()=>te(t):void 0,title:t.startsWith("project:")?`Перейти в проект: ${t.replace("project:","")}`:void 0,children:t.startsWith("project:")?t.replace("project:",""):t}),u.jsx("button",{className:"prompt-detail-tag-remove",onClick:()=>m(e,null,function*(){try{const e=L.tags.filter((e,t)=>t!==s);yield nr.updatePrompt(L.id,{tags:e}),$(c(l({},L),{tags:e}))}catch(e){console.error("Failed to remove tag:",e)}}),title:"Удалить тег",children:"×"})]},s))}),u.jsx("input",{className:"w-full mt-2 bg-transparent border-none outline-none text-sm",placeholder:"Добавить тег и нажать Enter...",onKeyPress:t=>m(e,null,function*(){if("Enter"===t.key){const s=t.target,r=s.value.trim();if(r&&!L.tags.includes(r))try{const e=[...L.tags,r];yield nr.updatePrompt(L.id,{tags:e}),$(c(l({},L),{tags:e})),s.value=""}catch(e){console.error("Failed to update prompt tags:",e)}}})})]})]})]}),u.jsx(ar,{settings:L.settings,onChange:t=>m(e,null,function*(){try{yield nr.updatePrompt(L.id,{settings:t}),$(c(l({},L),{settings:t}))}catch(e){console.error("Failed to update prompt settings:",e)}})})]}),u.jsxs("div",{className:"prompts-main-content",children:["categories"===R.level&&u.jsxs("div",{className:"space-y-4",children:[u.jsx("h2",{className:"text-lg font-semibold",children:"Категории"}),u.jsx("div",{className:"space-y-2",children:W.map(t=>{const s=D[t.id]||0,i=r.find(e=>e.id===t.id),n=i&&!i.system&&"Избранное"!==i.title;return u.jsxs("div",{className:"flex items-center justify-between p-3 bg-transparent rounded-lg hover:bg-hover transition-colors",children:[u.jsx("button",{className:"flex-1 text-left",onClick:()=>G(t.id),children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"category-name",children:t.title}),u.jsx("span",{className:"category-count",children:s})]})}),n&&u.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button ml-2",onClick:s=>{var i;s.stopPropagation(),i=t.id,m(e,null,function*(){const e=r.find(e=>e.id===i);if(e)if(e.system)alert("Нельзя удалять системные категории");else if("Избранное"!==e.title){if(confirm(`Удалить категорию "${e.title}" и все промпты в ней?`))try{yield nr.deleteCategory(i),yield F()}catch(t){console.error("Failed to delete category:",t),alert("Ошибка при удалении категории")}}else alert('Нельзя удалять категорию "Избранное"')})},title:"Удалить категорию",children:u.jsx("span",{className:"platform-button-content",children:u.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 6h18"}),u.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),u.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),u.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),u.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]},t.id)})})]}),"category"===R.level&&u.jsxs("div",{className:"space-y-4",children:[K.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-text mb-3",children:"Папки"}),u.jsx("div",{className:"space-y-2",children:K.map(t=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-transparent rounded-lg hover:bg-hover transition-colors",children:[u.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>V(t.id),children:[u.jsxs("h3",{className:"prompt-title",children:["📁 ",t.title]}),u.jsxs("p",{className:"prompt-text",children:[d.filter(e=>e.folderId===t.id).length," промптов"]})]}),u.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button",onClick:()=>{return s=t.id,m(e,null,function*(){if(confirm("Удалить эту папку и все промпты в ней?"))try{const e=yield nr.getPromptsInFolder(s);for(const t of e)yield nr.deletePrompt(t.id);yield F()}catch(e){console.error("Failed to delete folder:",e),alert("Ошибка при удалении папки")}});var s},title:"Удалить папку",children:u.jsx("span",{className:"platform-button-content",children:u.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 6h18"}),u.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),u.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),u.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),u.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]},t.id))})]}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-sm font-medium text-text mb-3",children:["Промпты (",Z.length,")"]}),u.jsx("div",{className:"space-y-2",children:Z.map(e=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-transparent rounded-lg hover:bg-hover transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[u.jsx("div",{className:"prompt-favorite-indicator",onClick:t=>{t.stopPropagation(),X(e.id)},title:p.some(t=>t.id===e.id)?"Убрать из избранного":"Добавить в избранное",children:u.jsx("span",{className:p.some(t=>t.id===e.id)?"":"not-favorited",children:p.some(t=>t.id===e.id)?"★":"☆"})}),u.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>U(e.id),children:[u.jsx("h3",{className:"prompt-title truncate",title:e.title,children:e.title}),u.jsx("p",{className:"prompt-text line-clamp-2",children:e.body||"Пустой промпт"}),e.tags.length>0&&u.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.tags.slice(0,2).map((e,t)=>u.jsx("span",{className:"prompt-tags "+(e.startsWith("project:")?"cursor-pointer hover:bg-primary/20":""),onClick:e.startsWith("project:")?()=>te(e):void 0,title:e.startsWith("project:")?`Перейти в проект: ${e.replace("project:","")}`:void 0,children:e.startsWith("project:")?e.replace("project:",""):e},t)),e.tags.length>2&&u.jsxs("span",{className:"prompt-text",children:["+",e.tags.length-2]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{className:"chat-send-button",onClick:()=>ee(e),title:"Отправить в чат",children:[u.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),u.jsx("path",{d:"M22 2 11 13"})]}),u.jsx("span",{className:"text-sm",children:"В чат"})]}),u.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button",onClick:()=>Y(e.id),title:"Удалить промпт",children:u.jsx("span",{className:"platform-button-content",children:u.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 6h18"}),u.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),u.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),u.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),u.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]})]},e.id))})]})]}),"folder"===R.level&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("h3",{className:"text-sm font-medium text-text mb-3",children:["Промпты в папке (",Z.length,")"]}),u.jsx("div",{className:"space-y-2",children:Z.map(e=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-transparent rounded-lg border border-border hover:bg-hover transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[u.jsx("div",{className:"prompt-favorite-indicator",onClick:t=>{t.stopPropagation(),X(e.id)},title:p.some(t=>t.id===e.id)?"Убрать из избранного":"Добавить в избранное",children:u.jsx("span",{className:p.some(t=>t.id===e.id)?"":"not-favorited",children:p.some(t=>t.id===e.id)?"★":"☆"})}),u.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>U(e.id),children:[u.jsx("h3",{className:"prompt-title truncate",title:e.title,children:e.title}),u.jsx("p",{className:"prompt-text line-clamp-2",children:e.body||"Пустой промпт"}),e.tags.length>0&&u.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.tags.slice(0,2).map((e,t)=>u.jsx("span",{className:"prompt-tags "+(e.startsWith("project:")?"cursor-pointer hover:bg-primary/20":""),onClick:e.startsWith("project:")?()=>te(e):void 0,title:e.startsWith("project:")?`Перейти в проект: ${e.replace("project:","")}`:void 0,children:e.startsWith("project:")?e.replace("project:",""):e},t)),e.tags.length>2&&u.jsxs("span",{className:"prompt-text",children:["+",e.tags.length-2]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{className:"chat-send-button",onClick:()=>ee(e),title:"Отправить в чат",children:[u.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),u.jsx("path",{d:"M22 2 11 13"})]}),u.jsx("span",{className:"text-sm",children:"В чат"})]}),u.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button",onClick:()=>Y(e.id),title:"Удалить промпт",children:u.jsx("span",{className:"platform-button-content",children:u.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 6h18"}),u.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),u.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),u.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),u.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]})]},e.id))})]})]})]})})})};class lr{static hexToHsl(e){const t=parseInt(e.slice(1,3),16)/255,s=parseInt(e.slice(3,5),16)/255,r=parseInt(e.slice(5,7),16)/255,i=Math.max(t,s,r),n=Math.min(t,s,r);let a=0,o=0;const l=(i+n)/2;if(i!==n){const e=i-n;switch(o=l>.5?e/(2-i-n):e/(i+n),i){case t:a=(s-r)/e+(s<r?6:0);break;case s:a=(r-t)/e+2;break;case r:a=(t-s)/e+4}a/=6}return{h:360*a,s:100*o,l:100*l}}static hslToHex(e,t,s){const r=e/360,i=t/100,n=s/100,a=(e,t,s)=>(s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e);let o,l,c;if(0===i)o=l=c=n;else{const e=n<.5?n*(1+i):n+i-n*i,t=2*n-e;o=a(t,e,r+1/3),l=a(t,e,r),c=a(t,e,r-1/3)}const d=e=>{const t=Math.round(255*e).toString(16);return 1===t.length?"0"+t:t};return`#${d(o)}${d(l)}${d(c)}`}static getLuminance(e){const t=this.hexToRgb(e);if(!t)return 0;const{r:s,g:r,b:i}=t,[n,a,o]=[s,r,i].map(e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*n+.7152*a+.0722*o}static hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}static generateSurfaceColor(e){const t=this.hexToHsl(e);return t.l>50?this.hslToHex(t.h,t.s,Math.max(t.l-5,10)):this.hslToHex(t.h,t.s,Math.min(t.l+5,90))}static generateBorderColor(e,t){return`rgba(${t?"0,0,0":"255,255,255"}, ${t?.12:.1})`}static generateButtonColors(e,t){const s=this.hexToHsl(e),r=this.hexToHsl(t).l>50;return{primary:e,secondary:this.hslToHex(s.h,s.s,r?Math.min(s.l+20,90):Math.max(s.l-20,10)),hover:this.hslToHex(s.h,s.s,r?Math.max(s.l-10,20):Math.min(s.l+10,80))}}static generateColorScheme(e){const t=this.hexToHsl(e),s=t.l>50,r=this.hslToHex(t.h,Math.min(t.s+10,100),Math.max(t.l-40,5)),i=t.l>90,n=i?"#111827":"#e5e7eb",a=i?"#6b7280":"#9ca3af";return{primary:e,background:r,surface:this.generateSurfaceColor(r),text:n,textSecondary:a,border:this.generateBorderColor(r,s),success:"#10b981",error:"#ef4444"}}static createCustomThemeVariables(e){const t=this.generateColorScheme(e),s=this.hexToHsl(e).l>50;return{"--primary":t.primary,"--background":t.background,"--surface":t.surface,"--text":t.text,"--text-secondary":t.textSecondary,"--border":t.border,"--focus-ring":e,"--focus-border":e,"--selection-bg":s?"#f3f4f6":"#374151","--selection-text":t.text,"--highlight-bg":s?"#f3f4f6":"#374151","--highlight-text":t.text,"--gradient-divider":`linear-gradient(to right, transparent, ${e}, transparent)`,"--gradient-divider-light":`linear-gradient(to right, transparent, ${e}30, transparent)`}}static getContrastIconColor(e){return this.getLuminance(e)>.5?"#111827":"#e5e7eb"}static getContrastIconColorForAccent(e,t=!0){const s=this.getLuminance(e);return t?s>.9?"#111827":"#e5e7eb":s<.1?"#e5e7eb":"#111827"}static getCustomVariablesToRemove(){return["--primary","--background","--surface","--text","--text-secondary","--border","--focus-ring","--focus-border","--selection-bg","--selection-text","--highlight-bg","--highlight-text","--gradient-divider","--gradient-divider-light"]}}class cr{static applyDarkAccent(e){const t=document.documentElement;let s;if(0===e.darkAccentHue&&0===e.lightAccentHue&&50===e.darkBrightness&&50===e.lightBrightness)s="#ffffff";else{const t=50,r=Math.round(t*(e.darkBrightness/100));s=this.hslToHex(e.darkAccentHue,100,r)}if(e.brightnessOverlay){const s=Math.round(e.darkBrightness/100*4),r=Math.round(e.darkBrightness/100*10);t.style.setProperty("--background",`hsl(0, 0%, ${s}%)`),t.style.setProperty("--surface",`hsl(0, 0%, ${r}%)`)}else t.style.removeProperty("--background"),t.style.removeProperty("--surface");const r=lr.getContrastIconColorForAccent(s,!0);t.style.setProperty("--accent-color",s,"important"),t.style.setProperty("--accent",s,"important"),t.style.setProperty("--focus-ring",s,"important"),t.style.setProperty("--icon-accent",r,"important"),t.style.setProperty("--icon-primary","#e5e7eb","important"),t.style.setProperty("--icon-secondary","#d1d5db","important"),t.style.setProperty("--icon-muted","#9ca3af","important"),t.style.setProperty("--border-active",s,"important"),t.style.setProperty("--selection-bg",`${s}20`,"important"),t.style.setProperty("--slider-active",s,"important"),t.style.setProperty("--slider-thumb",s,"important"),t.style.setProperty("--indicator-border",s,"important"),t.style.setProperty("--indicator-shadow",s,"important"),t.style.setProperty("--indicator-bg","#ffffff","important"),t.classList.remove("theme-accent-light"),t.classList.add("theme-accent-dark")}static applyLightAccent(e){const t=document.documentElement;let s;if(0===e.darkAccentHue&&0===e.lightAccentHue&&50===e.darkBrightness&&50===e.lightBrightness)s="#000000";else{const t=20,r=Math.round(t*(e.lightBrightness/100));s=this.hslToHex(e.lightAccentHue,100,r)}if(e.brightnessOverlay){const s=Math.round(100-e.lightBrightness/100*20),r=Math.round(98-e.lightBrightness/100*10);t.style.setProperty("--background",`hsl(0, 0%, ${s}%)`),t.style.setProperty("--surface",`hsl(0, 0%, ${r}%)`)}else t.style.removeProperty("--background"),t.style.removeProperty("--surface");t.style.setProperty("--accent-color",s,"important"),t.style.setProperty("--accent",s,"important"),t.style.setProperty("--focus-ring",s,"important"),t.style.setProperty("--icon-accent",s,"important"),t.style.setProperty("--icon-primary","#111827","important"),t.style.setProperty("--icon-secondary","#6b7280","important"),t.style.setProperty("--icon-muted","#9ca3af","important"),t.style.setProperty("--border-active",s,"important"),t.style.setProperty("--selection-bg",`${s}20`,"important"),t.style.setProperty("--slider-active",s,"important"),t.style.setProperty("--slider-thumb",s,"important"),t.style.setProperty("--indicator-border",s,"important"),t.style.setProperty("--indicator-shadow",s,"important"),t.classList.remove("theme-accent-dark"),t.classList.add("theme-accent-light")}static applyCustomAccent(e){const t=document.documentElement;let s;if(0===e.darkAccentHue&&0===e.lightAccentHue&&50===e.darkBrightness&&50===e.lightBrightness)s="#ffffff";else{const t=50;s=this.hslToHex(e.darkAccentHue,100,t)}t.style.removeProperty("--global-brightness");const r=lr.getContrastIconColorForAccent(s,!1);t.style.setProperty("--accent-color",s,"important"),t.style.setProperty("--accent",s,"important"),t.style.setProperty("--focus-ring",s,"important"),t.style.setProperty("--icon-accent",r,"important"),t.style.setProperty("--icon-primary",r,"important"),t.style.setProperty("--icon-secondary",r,"important"),t.style.setProperty("--icon-muted",r,"important"),t.style.setProperty("--border-active",s,"important"),t.style.setProperty("--selection-bg",`${s}20`,"important"),t.style.setProperty("--slider-active",s,"important"),t.style.setProperty("--slider-thumb",s,"important"),t.style.setProperty("--indicator-border",s,"important"),t.style.setProperty("--indicator-shadow",s,"important"),t.style.setProperty("--indicator-bg","#ffffff","important"),t.classList.remove("theme-accent-light","theme-accent-dark"),t.classList.add("theme-accent-custom")}static resetAccentColors(){const e=document.documentElement;e.style.removeProperty("--accent-color"),e.style.removeProperty("--accent"),e.style.removeProperty("--button-primary"),e.style.removeProperty("--focus-ring"),e.style.removeProperty("--icon-accent"),e.style.removeProperty("--icon-primary"),e.style.removeProperty("--icon-secondary"),e.style.removeProperty("--icon-muted"),e.style.removeProperty("--border-active"),e.style.removeProperty("--selection-bg"),e.style.removeProperty("--slider-active"),e.style.removeProperty("--slider-thumb"),e.style.removeProperty("--indicator-border"),e.style.removeProperty("--indicator-shadow"),e.classList.remove("theme-accent-dark","theme-accent-light","theme-accent-custom")}static hslToHex(e,t,s){e/=360,t/=100,s/=100;const r=(1-Math.abs(2*s-1))*t,i=r*(1-Math.abs(6*e%2-1)),n=s-r/2;let a=0,o=0,l=0;0<=e&&e<1/6?(a=r,o=i,l=0):1/6<=e&&e<2/6?(a=i,o=r,l=0):2/6<=e&&e<.5?(a=0,o=r,l=i):.5<=e&&e<4/6?(a=0,o=i,l=r):4/6<=e&&e<5/6?(a=i,o=0,l=r):5/6<=e&&e<1&&(a=r,o=0,l=i);const c=e=>{const t=Math.round(255*(e+n)).toString(16);return 1===t.length?"0"+t:t};return"#"+c(a)+c(o)+c(l)}}class dr{static loadState(){const e={};try{const t=localStorage.getItem(this.STORAGE_KEYS.DARK_ACCENT_HUE),s=localStorage.getItem(this.STORAGE_KEYS.LIGHT_ACCENT_HUE),r=localStorage.getItem(this.STORAGE_KEYS.DARK_BRIGHTNESS),i=localStorage.getItem(this.STORAGE_KEYS.LIGHT_BRIGHTNESS),n=localStorage.getItem(this.STORAGE_KEYS.ENABLED),a=localStorage.getItem(this.STORAGE_KEYS.BRIGHTNESS_OVERLAY);t&&(e.darkAccentHue=parseInt(t)),s&&(e.lightAccentHue=parseInt(s)),r&&(e.darkBrightness=parseInt(r)),i&&(e.lightBrightness=parseInt(i)),null!==n&&(e.isEnabled="true"===n),null!==a&&(e.brightnessOverlay="true"===a)}catch(t){console.warn("Failed to load accent colors from localStorage:",t)}return e}static saveState(e){try{localStorage.setItem(this.STORAGE_KEYS.DARK_ACCENT_HUE,e.darkAccentHue.toString()),localStorage.setItem(this.STORAGE_KEYS.LIGHT_ACCENT_HUE,e.lightAccentHue.toString()),localStorage.setItem(this.STORAGE_KEYS.DARK_BRIGHTNESS,e.darkBrightness.toString()),localStorage.setItem(this.STORAGE_KEYS.LIGHT_BRIGHTNESS,e.lightBrightness.toString()),localStorage.setItem(this.STORAGE_KEYS.ENABLED,e.isEnabled.toString()),localStorage.setItem(this.STORAGE_KEYS.BRIGHTNESS_OVERLAY,e.brightnessOverlay.toString())}catch(t){console.warn("Failed to save accent colors to localStorage:",t)}}}dr.STORAGE_KEYS={DARK_ACCENT_HUE:"darkAccentHue",LIGHT_ACCENT_HUE:"lightAccentHue",DARK_BRIGHTNESS:"darkBrightness",LIGHT_BRIGHTNESS:"lightBrightness",ENABLED:"accentColorsEnabled",BRIGHTNESS_OVERLAY:"brightnessOverlay"};class mr{constructor(){this.state={darkAccentHue:0,lightAccentHue:0,darkBrightness:50,lightBrightness:50,isEnabled:!1,brightnessOverlay:!0},this.loadFromStorage()}static getInstance(){return mr.instance||(mr.instance=new mr),mr.instance}getDarkAccentHue(){return this.state.darkAccentHue}getLightAccentHue(){return this.state.lightAccentHue}getDarkBrightness(){return this.state.darkBrightness}getLightBrightness(){return this.state.lightBrightness}getState(){return l({},this.state)}getBrightnessOverlay(){return this.state.brightnessOverlay}setDarkAccentHue(e){this.state.darkAccentHue=Math.max(0,Math.min(360,e)),this.saveToStorage(),this.applyAccentColorsIfCurrentTheme("dark")}setLightAccentHue(e){this.state.lightAccentHue=Math.max(0,Math.min(360,e)),this.saveToStorage(),this.applyAccentColorsIfCurrentTheme("light")}setDarkBrightness(e){this.state.darkBrightness=Math.max(0,Math.min(100,e)),this.saveToStorage(),this.applyAccentColorsIfCurrentTheme("dark")}setLightBrightness(e){this.state.lightBrightness=Math.max(0,Math.min(100,e)),this.saveToStorage(),this.applyAccentColorsIfCurrentTheme("light")}setEnabled(e){this.state.isEnabled=e,this.saveToStorage(),this.applyAccentColors()}setBrightnessOverlay(e){this.state.brightnessOverlay=e,this.saveToStorage(),this.applyAccentColors()}setAccentColor(e){const t=this.hexToHsl(e);if(!t)return;const s=t.h;this.state.darkAccentHue=s,this.state.lightAccentHue=s,this.saveToStorage(),this.applyAccentColors()}setDarkContrastAccent(){this.state.darkAccentHue=210,this.saveToStorage(),this.applyAccentColors()}applyAccentColors(){const e=document.documentElement.getAttribute("data-theme");cr.resetAccentColors(),this.state.isEnabled&&("dark"===e?cr.applyDarkAccent(this.state):"light"===e?cr.applyLightAccent(this.state):"custom"===e&&cr.applyCustomAccent(this.state))}hexToHsl(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t)return null;const s=parseInt(t[1],16)/255,r=parseInt(t[2],16)/255,i=parseInt(t[3],16)/255,n=Math.max(s,r,i),a=Math.min(s,r,i);let o=0,l=0;const c=(n+a)/2;if(n!==a){const e=n-a;switch(l=c>.5?e/(2-n-a):e/(n+a),n){case s:o=(r-i)/e+(r<i?6:0);break;case r:o=(i-s)/e+2;break;case i:o=(s-r)/e+4}o/=6}return{h:Math.round(360*o),s:Math.round(100*l),l:Math.round(100*c)}}reset(){this.state={darkAccentHue:0,lightAccentHue:0,darkBrightness:50,lightBrightness:50,isEnabled:!1,brightnessOverlay:!0},this.saveToStorage(),this.applyAccentColors()}loadFromStorage(){const e=dr.loadState();this.state=l(l({},this.state),e)}saveToStorage(){dr.saveState(this.state)}applyAccentColorsIfCurrentTheme(e){document.documentElement.getAttribute("data-theme")===e&&this.applyAccentColors()}}const hr=mr.getInstance();class ur{constructor(){this.currentTheme="dark"}static getInstance(){return ur.instance||(ur.instance=new ur),ur.instance}getThemeColors(e){switch(e){case"dark":return{primary:"#ffffff",background:"#000000",surface:"#1a1a1a",text:"#ffffff",textSecondary:"#ffffff",border:"rgba(255,255,255,0.1)"};case"light":return{primary:"#000000",background:"#ffffff",surface:"#ffffff",text:"#000000",textSecondary:"#000000",border:"rgba(0,0,0,0.1)"};case"custom":return{primary:"#000000",background:"#000000",surface:"#1a1a1a",text:"#ffffff",textSecondary:"#ffffff",border:"rgba(255,255,255,0.10)"};default:return this.getThemeColors("dark")}}applyTheme(e){this.currentTheme=e;const t=this.getThemeColors(e);document.documentElement.setAttribute("data-theme",e),this.setCSSVariables(t)}setCSSVariables(e){const t=document.documentElement;t.style.setProperty("--background",e.background),t.style.setProperty("--surface",e.surface),t.style.setProperty("--text",e.text),t.style.setProperty("--text-secondary",e.textSecondary),t.style.setProperty("--border",e.border),t.style.setProperty("--secondary",this.mixColors(e.primary,e.background,.8)),t.style.setProperty("--accent",this.mixColors(e.primary,e.background,.6)),t.style.setProperty("--text-muted",this.mixColors(e.text,e.background,.6)),t.style.setProperty("--border-light",this.mixColors(e.border,"transparent",.5)),t.style.setProperty("--border-strong",this.mixColors(e.border,"transparent",2)),t.style.setProperty("--border-active",this.mixColors(e.primary,"transparent",.6)),t.style.setProperty("--surface-hover",this.mixColors(e.surface,e.primary,.1)),t.style.setProperty("--icon-primary",e.text),t.style.setProperty("--icon-secondary",e.textSecondary),t.style.setProperty("--icon-accent",e.primary)}mixColors(e,t,s){return e}getCurrentTheme(){return this.currentTheme}setCustomColor(e){if("custom"===this.currentTheme){const t=document.documentElement,s=t.style.getPropertyValue("--background")||"#0a0a0a";t.style.setProperty("--secondary",this.mixColors(e,s,.8)),t.style.setProperty("--accent",this.mixColors(e,s,.6)),t.style.setProperty("--icon-accent",e)}}}const pr=ur.getInstance(),gr=class e{constructor(){this.settings={},this.listeners=new Map,this.loadSettings()}static getInstance(){return e.instance||(e.instance=new e),e.instance}loadSettings(){try{const t=localStorage.getItem("barsukov-settings"),s=localStorage.getItem("barsukov-settings-version");if(t){const r=JSON.parse(t);s!==e.SETTINGS_VERSION&&(console.log("Выполняется миграция настроек..."),this.migrateSettings(r,s)),this.settings=l(l({},this.getDefaultSettings()),r),this.saveSettings()}else this.settings=this.getDefaultSettings(),this.saveSettings()}catch(t){console.error("Ошибка загрузки настроек:",t),this.settings=this.getDefaultSettings(),this.saveSettings()}}migrateSettings(t,s){if(!s){const e=this.getDefaultSettings();Object.keys(e).forEach(s=>{s in t||(t[s]=e[s])})}localStorage.setItem("barsukov-settings-version",e.SETTINGS_VERSION)}saveSettings(){try{localStorage.setItem("barsukov-settings",JSON.stringify(this.settings))}catch(e){console.error("Ошибка сохранения настроек:",e)}}getDefaultSettings(){return{theme:"dark",customColor:"#000000",accentsEnabled:!1,accentColor:"#000000",useColoredText:!1,textColor:"#000000",sidebarCollapsed:!1,sidebarWidth:280,notifications:!0,animations:!0,chatWidth:350,chatInputHeight:300,workspaceLayout:"grid",autoSave:!0,showTimestamps:!0,enableVoice:!0,enableFileUpload:!0,maxMessages:100,autoScroll:!0,brightnessOverlay:!0,hideChatFunctionButtons:!1}}getSetting(e){return this.settings[e]}validateSetting(e,t){const s={theme:e=>["dark","light","custom"].includes(e),customColor:e=>"string"==typeof e&&/^#[0-9A-Fa-f]{6}$/.test(e),accentColor:e=>"string"==typeof e&&/^#[0-9A-Fa-f]{6}$/.test(e),textColor:e=>"string"==typeof e&&/^#[0-9A-Fa-f]{6}$/.test(e),sidebarWidth:e=>"number"==typeof e&&e>=200&&e<=500,chatWidth:e=>"number"==typeof e&&e>=250&&e<=2e3,chatInputHeight:e=>"number"==typeof e&&e>=256&&e<=1200,maxMessages:e=>"number"==typeof e&&e>=50&&e<=1e3,workspaceLayout:e=>["grid","list","compact"].includes(e)}[e];return!s||s(t)}setSetting(e,t){return m(this,null,function*(){if(!this.validateSetting(e,t))throw new Error(`Некорректное значение для настройки ${e}: ${t}`);if(this.settings[e]=t,this.saveSettings(),this.notifyListeners(e,t),"theme"===e){const e=this.settings.theme||"dark";pr.applyTheme(e)}if("customColor"===e&&"custom"===this.settings.theme){const e=this.settings.customColor;pr.setCustomColor(e)}"brightnessOverlay"===e&&hr.setBrightnessOverlay(t)})}getAllSettings(){return l({},this.settings)}resetSettings(){this.settings=this.getDefaultSettings(),this.saveSettings(),this.notifyAllListeners()}subscribe(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{var s;null==(s=this.listeners.get(e))||s.delete(t)}}notifyListeners(e,t){var s;null==(s=this.listeners.get(e))||s.forEach(e=>e(t))}notifyAllListeners(){this.listeners.forEach((e,t)=>{e.forEach(e=>e(this.settings[t]))})}getUserPreferences(){return{theme:this.getSetting("theme")||"dark",sidebarCollapsed:this.getSetting("sidebarCollapsed")||!1,notifications:this.getSetting("notifications")||!0,animations:this.getSetting("animations")||!0,sounds:this.getSetting("sounds")||!0}}updateUserPreferences(e){Object.entries(e).forEach(([e,t])=>{this.setSetting(e,t)})}getSettingsCategories(){return[{id:"appearance",name:"Внешний вид",description:"Тема и шрифты",icon:"appearance",items:[{id:"theme",name:"Тема",description:"Схема",type:"theme-buttons",value:this.getSetting("theme"),onChange:e=>this.setSetting("theme",e)},{id:"animations",name:"Анимации",description:"Плавно",type:"boolean",value:this.getSetting("animations"),onChange:e=>this.setSetting("animations",e)},{id:"autoSave",name:"Автосохранение",description:"Авто",type:"boolean",value:this.getSetting("autoSave"),onChange:e=>this.setSetting("autoSave",e)},{id:"customColor",name:"Кастомный цвет",description:"Свой",type:"color",value:this.getSetting("customColor"),onChange:e=>this.setSetting("customColor",e)},{id:"accentsEnabled",name:"Акцентные цвета",description:"Акценты",type:"boolean",value:this.getSetting("accentsEnabled"),onChange:e=>this.setSetting("accentsEnabled",e)},{id:"accentColor",name:"Цвет акцентов",description:"Цвет",type:"color",value:this.getSetting("accentColor"),onChange:e=>this.setSetting("accentColor",e)},{id:"useColoredText",name:"Цветной текст",description:"Цветной",type:"boolean",value:this.getSetting("useColoredText"),onChange:e=>this.setSetting("useColoredText",e)},{id:"textColor",name:"Цвет текста",description:"Текст",type:"color",value:this.getSetting("textColor"),onChange:e=>this.setSetting("textColor",e)},{id:"sidebarCollapsed",name:"Свернутый сайдбар",description:"Свернуть",type:"boolean",value:this.getSetting("sidebarCollapsed"),onChange:e=>this.setSetting("sidebarCollapsed",e)},{id:"sidebarWidth",name:"Ширина сайдбара",description:"Пиксели",type:"number",value:this.getSetting("sidebarWidth"),min:256,max:500,step:10,onChange:e=>this.setSetting("sidebarWidth",e)},{id:"workspaceLayout",name:"Макет рабочего пространства",description:"Макет",type:"select",value:this.getSetting("workspaceLayout"),options:[{label:"Сетка",value:"grid"},{label:"Список",value:"list"},{label:"Компактный",value:"compact"}],onChange:e=>this.setSetting("workspaceLayout",e)}]},{id:"chat",name:"Чат",description:"Чат",icon:"chat",items:[{id:"chatWidth",name:"Ширина чата",description:"Пиксели",type:"number",value:this.getSetting("chatWidth"),min:250,max:2e3,step:10,onChange:e=>this.setSetting("chatWidth",e)},{id:"chatInputHeight",name:"Высота поля ввода",description:"Пиксели",type:"number",value:this.getSetting("chatInputHeight"),min:256,max:1200,step:10,onChange:e=>this.setSetting("chatInputHeight",e)},{id:"showTimestamps",name:"Показывать время",description:"Время",type:"boolean",value:this.getSetting("showTimestamps"),onChange:e=>this.setSetting("showTimestamps",e)},{id:"autoScroll",name:"Автопрокрутка",description:"Прокрутка",type:"boolean",value:this.getSetting("autoScroll"),onChange:e=>this.setSetting("autoScroll",e)},{id:"maxMessages",name:"Максимум сообщений",description:"Максимум",type:"number",value:this.getSetting("maxMessages"),min:50,max:1e3,step:50,onChange:e=>this.setSetting("maxMessages",e)},{id:"enableVoice",name:"Голосовые сообщения",description:"Голос",type:"boolean",value:this.getSetting("enableVoice"),onChange:e=>this.setSetting("enableVoice",e)},{id:"enableFileUpload",name:"Загрузка файлов",description:"Файлы",type:"boolean",value:this.getSetting("enableFileUpload"),onChange:e=>this.setSetting("enableFileUpload",e)},{id:"hideChatFunctionButtons",name:"Скрыть кнопки функций",description:"Скрыть кнопки функций в чате",type:"boolean",value:this.getSetting("hideChatFunctionButtons"),onChange:e=>this.setSetting("hideChatFunctionButtons",e)}]},{id:"notifications",name:"Уведомления",description:"Уведомления",icon:"notifications",items:[{id:"notifications",name:"Уведомления",description:"Включить",type:"boolean",value:this.getSetting("notifications"),onChange:e=>this.setSetting("notifications",e)}]}]}exportSettings(){return JSON.stringify(this.settings,null,2)}importSettings(e){try{const t=JSON.parse(e);return this.settings=l(l({},this.getDefaultSettings()),t),this.saveSettings(),this.notifyAllListeners(),!0}catch(t){return console.error("Ошибка импорта настроек:",t),!1}}};gr.SETTINGS_VERSION="1.0.0";const xr=gr.getInstance();class vr{constructor(){this.themes=new Map,this.currentTheme="dark",this.initializeDefaultThemes()}static getInstance(){return vr.instance||(vr.instance=new vr),vr.instance}initializeDefaultThemes(){this.themes.set("light",this.createThemeConfig("light","#111827","#ffffff","Светлая")),this.themes.set("dark",this.createThemeConfig("dark","#e5e7eb","#0a0a0a","Темная"))}createThemeConfig(e,t,s,r){const i=lr.getLuminance(s)>.5,n=i?"#000000":"#ffffff";return{id:e,name:r,colors:{primary:t,secondary:lr.generateButtonColors(t,s).secondary,accent:lr.generateButtonColors(t,s).secondary,background:s,surface:lr.generateSurfaceColor(s),text:n,textSecondary:i?"#6b7280":"#9ca3af",border:lr.generateBorderColor(s,i),success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#10b981"},isCustom:!1}}getThemes(){return Array.from(this.themes.values())}getTheme(e){return this.themes.get(e)}createCustomTheme(e){const t=lr.generateColorScheme(e),s={id:"custom",name:"Цветная",colors:c(l({},t),{text:"#ffffff",secondary:lr.generateButtonColors(e,t.background).secondary,accent:lr.generateButtonColors(e,t.background).secondary,warning:"#f59e0b",info:t.success}),isCustom:!0};return this.themes.set("custom",s),s}applyColoredText(e){document.documentElement.style.setProperty("--text",e)}resetColoredText(){const e=document.documentElement,t=e.getAttribute("data-theme")||"dark",s=this.getTheme(t);s&&e.style.setProperty("--text",s.colors.text)}applyTheme(e,t,s,r,i,n){const a=document.documentElement;a.classList.add("theme-transitioning"),requestAnimationFrame(()=>{a.getAttribute("data-theme")!==e&&a.setAttribute("data-theme",e),"custom"===e&&t?this.applyCustomTheme(t):this.applyStandardTheme(e),setTimeout(()=>{a.classList.remove("theme-transitioning"),s&&r?this.applyColoredText(r):this.resetColoredText(),i&&n?(hr.setAccentColor(n),hr.applyAccentColors()):hr.getState().isEnabled&&hr.applyAccentColors()},500)})}applyCustomTheme(e){const t=document.documentElement,s=lr.createCustomThemeVariables(e);Object.entries(s).forEach(([e,s])=>{t.style.setProperty(e,s)})}applyStandardTheme(e){const t=document.documentElement;lr.getCustomVariablesToRemove().forEach(e=>{t.style.removeProperty(e)}),t.setAttribute("data-theme",e)}getCurrentTheme(){return this.currentTheme}resetCustomTheme(){this.themes.delete("custom"),"custom"===this.currentTheme&&(this.currentTheme="dark",this.applyTheme("dark"))}}vr.getInstance();const fr=()=>{const{updateSettings:t}=i(),[s,r]=v.useState(!1),[n,a]=v.useState(!1),[o,l]=v.useState(!1),[c,d]=v.useState(""),h=v.useRef(null),u=xr.getAllSettings(),p=v.useCallback((s,i)=>m(e,null,function*(){try{l(!0),yield xr.setSetting(s,i),t(s,i),r(!0)}catch(e){console.error("Ошибка изменения настройки:",e)}finally{l(!1)}}),[t]),g=v.useCallback(()=>{r(!1),a(!0),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>a(!1),2e3)},[]),x=v.useCallback(()=>m(e,null,function*(){if(confirm("Вы уверены, что хотите сбросить все настройки к значениям по умолчанию?"))try{l(!0),xr.resetSettings(),r(!1),window.location.reload()}catch(e){console.error("Ошибка сброса настроек:",e)}finally{l(!1)}}),[]),f=v.useCallback(()=>{try{const e=xr.exportSettings(),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`barsukov-settings-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(s)}catch(e){console.error("Ошибка экспорта настроек:",e)}},[]),y=v.useCallback(e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s){const e=new FileReader;e.onload=e=>{var t;try{const s=null==(t=e.target)?void 0:t.result;xr.importSettings(s)?(r(!1),setTimeout(()=>window.location.reload(),100)):alert("Ошибка импорта настроек. Проверьте формат файла.")}catch(s){console.error("Ошибка импорта:",s),alert("Ошибка импорта настроек")}},e.readAsText(s)}},[]),b=v.useCallback(e=>{d(e)},[]),j=v.useCallback((e,t)=>{const s=u[e];xr.setSetting(e,t),setTimeout(()=>{xr.setSetting(e,s)},3e3)},[u]);return v.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]),{settings:u,hasUnsavedChanges:s,showSaveSuccess:n,isLoading:o,searchQuery:c,handleSettingChange:p,updateSetting:p,handleSave:g,handleReset:x,handleExport:f,handleImport:y,searchSettings:b,previewChanges:j}},yr=({title:e,description:t,children:s,className:r})=>u.jsxs("div",{className:Ne("p-4 settings-card",r),children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:e}),t&&u.jsx("p",{className:"text-xs text-text-secondary mt-1",children:t})]}),u.jsx("div",{className:"space-y-3",children:s})]}),br=({service:e,onSettingChange:t,className:s})=>{const r=e.config.settings||{},i=(s,r)=>{const i=`${e.config.id}.${s}`;return"boolean"==typeof r?u.jsx(Ws,{item:{id:i,name:s,description:`Настройка для ${e.config.name}`,type:"boolean",value:r,onChange:e=>t(i,e)},onChange:t},i):"string"==typeof r?u.jsx(Ws,{item:{id:i,name:s,description:`Настройка для ${e.config.name}`,type:"string",value:r,onChange:e=>t(i,e)},onChange:t},i):"number"==typeof r?u.jsx(Ws,{item:{id:i,name:s,description:`Настройка для ${e.config.name}`,type:"number",value:r,min:0,max:100,step:1,onChange:e=>t(i,e)},onChange:t},i):Array.isArray(r)?u.jsx(Ws,{item:{id:i,name:s,description:`Настройка для ${e.config.name}`,type:"select",value:r[0]||"",options:r.map((e,t)=>({value:e,label:"string"==typeof e?e:`Опция ${t+1}`})),onChange:e=>t(i,e)},onChange:t},i):null};return 0===Object.keys(r).length?null:u.jsx("div",{className:Ne("service-settings",s),children:u.jsx(yr,{title:e.config.name,description:"Настройки сервиса",className:"mb-6",children:u.jsx("div",{className:"space-y-4",children:Object.entries(r).map(([e,t])=>u.jsx("div",{children:i(e,t)},e))})})})},jr=v.createContext(null),wr=({children:e})=>{const[t,s]=v.useState([]);v.useEffect(()=>((()=>{const e=T.getAllServices().filter(e=>e.config.settings&&Object.keys(e.config.settings).length>0);s(e)})(),T.onServiceRegistered(e=>{e.config.settings&&Object.keys(e.config.settings).length>0&&s(t=>[...t,e])}),T.onServiceUnregistered(e=>{s(t=>t.filter(t=>t.config.id!==e))}),()=>{}),[]);const r={serviceSettings:t,registerServiceSettings:e=>{s(t=>t.some(t=>t.config.id===e.config.id)?t.map(t=>t.config.id===e.config.id?e:t):[...t,e])},unregisterServiceSettings:e=>{s(t=>t.filter(t=>t.config.id!==e))},getServiceSettings:e=>t.find(t=>t.config.id===e)||null};return u.jsx(jr.Provider,{value:r,children:e})},Nr=({showAdvanced:e,searchQuery:t})=>(fr(),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:u.jsx(Ze,{className:"w-4 h-4 text-primary dark:text-white"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-text",children:"Расширенные настройки"}),u.jsx("p",{className:"text-sm text-text-secondary",children:"Продвинутые параметры для опытных пользователей"})]})]}),u.jsx("div",{className:"p-4 rounded-lg bg-yellow-500/10 border border-yellow-500/20",children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(Ie,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-yellow-500 mb-1",children:"Внимание"}),u.jsx("div",{className:"text-sm text-text-secondary",children:"Изменение этих настроек может повлиять на работу платформы. Будьте осторожны при изменении значений."})]})]})}),u.jsx(yr,{title:"Отладка",description:"Настройки для разработчиков и отладки",className:"mb-6",children:u.jsx("div",{className:"space-y-4",children:u.jsx("div",{className:"text-sm text-text-secondary",children:"Настройки отладки будут добавлены в будущих версиях."})})}),u.jsx(yr,{title:"API",description:"Настройки API и интеграций",className:"mb-6",children:u.jsx("div",{className:"space-y-4",children:u.jsx("div",{className:"text-sm text-text-secondary",children:"Настройки API будут добавлены в будущих версиях."})})}),u.jsx(yr,{title:"Экспериментальные функции",description:"Функции в разработке (могут быть нестабильными)",className:"mb-6",children:u.jsx("div",{className:"space-y-4",children:u.jsx("div",{className:"text-sm text-text-secondary",children:"Экспериментальные функции будут добавлены в будущих версиях."})})})]})),kr=({showAdvanced:e,searchQuery:t})=>{const{settings:s,updateSetting:r}=fr(),i=[{id:"animations",name:"Анимации",description:"Плавно",type:"boolean",value:s.animations,onChange:e=>n("animations",e)}],n=(e,t)=>{r(e,t)};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:u.jsx(wt,{className:"w-4 h-4 text-primary dark:text-white"})}),u.jsx("div",{children:u.jsx("h2",{className:"text-lg font-semibold text-text",children:"Внешний вид"})})]}),u.jsx(yr,{title:"Тема",className:"mb-6",children:u.jsx(Ws,{item:{id:"theme",name:"Цветовая тема",description:"Схема",type:"select",value:s.theme||"dark",options:[{value:"light",label:"Светлая"},{value:"dark",label:"Темная"}],onChange:e=>n("theme",e)},onChange:n})}),u.jsx(yr,{title:"Анимации",className:"mb-6",children:u.jsx(Ws,{item:i[0],onChange:n})}),e&&u.jsx(yr,{title:"Дополнительные настройки",description:"Дополнительно",className:"mb-6",children:u.jsx("div",{className:"text-sm text-text-secondary",children:"Дополнительные настройки внешнего вида будут добавлены в будущих версиях."})})]})},Sr=({showAdvanced:e,searchQuery:t})=>{const{settings:s,updateSetting:r}=fr(),i=(e,t)=>{r(e,t)},n=[{key:"animations",label:"Анимации",type:"boolean",value:s.animations,icon:ss,onChange:e=>i("animations",e)},{key:"autoSave",label:"Автосохранение",type:"boolean",value:s.autoSave,icon:Pt,onChange:e=>i("autoSave",e)},{key:"useColoredText",label:"Цветной текст",type:"boolean",value:s.useColoredText,icon:Ut,onChange:e=>i("useColoredText",e)}];return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:u.jsx(Le,{className:"w-4 h-4 text-primary dark:text-white"})}),u.jsx("div",{children:u.jsx("h2",{className:"text-lg font-semibold text-text",children:"Поведение"})})]}),u.jsx(yr,{title:"Звуки и уведомления",className:"mb-6",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.filter(e=>["sounds","notifications"].includes(e.key)).map(e=>u.jsxs("div",{className:"flex items-center space-x-3 p-3 settings-card hover:bg-surface-hover transition-colors",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx(e.icon,{className:"w-4 h-4 text-text-secondary"})}),u.jsx("div",{className:"flex-1 min-w-0",children:u.jsx("div",{className:"text-sm font-medium text-text",children:e.label})}),u.jsx("div",{className:"flex-shrink-0",children:u.jsx(Ws,{item:{id:e.key,name:"",description:"",type:"boolean",value:e.value||!1,onChange:t=>e.onChange(t)},onChange:i,className:"!p-0"})})]},e.key))})}),u.jsxs(yr,{title:"Автосохранение",className:"mb-6",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.filter(e=>"autoSave"===e.key).map(e=>u.jsxs("div",{className:"flex items-center space-x-3 p-3 settings-card hover:bg-surface-hover transition-colors",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx(e.icon,{className:"w-4 h-4 text-text-secondary"})}),u.jsx("div",{className:"flex-1 min-w-0",children:u.jsx("div",{className:"text-sm font-medium text-text",children:e.label})}),u.jsx("div",{className:"flex-shrink-0",children:u.jsx(Ws,{item:{id:e.key,name:"",description:"",type:"boolean",value:e.value||!1,onChange:t=>e.onChange(t)},onChange:i,className:"!p-0"})})]},e.key))}),u.jsx("div",{className:"mt-4",children:u.jsx(Ws,{item:{id:"autoSaveInterval",name:"Интервал автосохранения",type:"select",value:s.autoSaveInterval||5e3,options:[{value:1e3,label:"1 секунда"},{value:5e3,label:"5 секунд"},{value:1e4,label:"10 секунд"},{value:3e4,label:"30 секунд"},{value:6e4,label:"1 минута"}],onChange:e=>i("autoSaveInterval",e)},onChange:i})})]}),e&&u.jsx(yr,{title:"Дополнительные настройки",className:"mb-6",children:u.jsx("div",{className:"text-sm text-text-secondary",children:"Дополнительные настройки поведения будут добавлены в будущих версиях."})})]})},Cr=({items:e,onSettingChange:t})=>u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(e=>u.jsxs("div",{className:"flex items-center space-x-3 p-3 settings-card hover:bg-surface-hover transition-colors",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx(e.icon,{className:"w-4 h-4 text-text-secondary dark:text-white"})}),u.jsx("div",{className:"flex-1 min-w-0",children:u.jsx("div",{className:"text-sm font-medium text-text",children:e.label})}),u.jsx("div",{className:"flex-shrink-0",children:u.jsx(Ws,{item:{id:e.key,name:"",description:"",type:"boolean",value:e.value||!1,onChange:s=>t(e.key,s)},onChange:t,className:"!p-0"})})]},e.key))}),Er=({showAdvanced:e,searchQuery:t})=>{const{settings:s,updateSetting:r}=fr(),i=[{key:"sidebarCollapsed",title:"Свернутый сайдбар",description:"Свернуть боковую панель по умолчанию - скрывает левую панель навигации",type:"boolean",value:s.sidebarCollapsed,icon:Nt},{key:"chatVisible",title:"Видимость чата",description:"Показывать панель чата по умолчанию - отображает правую панель чата",type:"boolean",value:s.chatVisible,icon:gt},{key:"workspaceLayout",title:"Макет рабочего пространства",description:"Сетка или список для проектов",type:"boolean",value:"grid"===s.workspaceLayout,icon:ft}],n=(e,t)=>{r(e,t)};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx(ft,{className:"w-4 h-4 text-primary dark:text-white"}),u.jsx("h2",{className:"text-base font-medium text-text",children:"Макет"})]}),u.jsxs(yr,{title:"Размеры панелей",className:"mb-4",children:[u.jsx(Ws,{item:{id:"chatWidth",name:"Ширина чата",description:"Ширина панели чата в пикселях",type:"number",value:s.chatWidth||400,min:250,max:2e3,step:10,onChange:e=>n("chatWidth",e)},onChange:n}),u.jsx(Ws,{item:{id:"chatInputHeight",name:"Высота поля ввода",description:"Высота поля ввода чата в пикселях",type:"number",value:s.chatInputHeight||300,min:256,max:800,step:10,onChange:e=>n("chatInputHeight",e)},onChange:n}),u.jsx(Ws,{item:{id:"sidebarWidth",name:"Ширина сайдбара",description:"Ширина боковой панели в пикселях",type:"number",value:s.sidebarWidth||300,min:256,max:600,step:10,onChange:e=>n("sidebarWidth",e)},onChange:n})]}),u.jsx(yr,{title:"Видимость панелей",className:"mb-4",children:u.jsx(Cr,{items:i,onSettingChange:n})}),e&&u.jsx(yr,{title:"Дополнительные настройки",className:"mb-6",children:u.jsx("div",{className:"text-sm text-text-secondary",children:"Дополнительные настройки макета будут добавлены в будущих версиях."})})]})},Ir=({showAdvanced:e,searchQuery:t})=>u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:u.jsx(Ot,{className:"w-4 h-4 text-primary dark:text-white"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-text",children:"Система"}),u.jsx("p",{className:"text-sm text-text-secondary",children:"Системные настройки и информация"})]})]}),u.jsx(yr,{title:"Информация о системе",description:"Информация о платформе и версии",className:"mb-6",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 settings-card",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(nt,{className:"w-4 h-4 text-text-secondary"}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-text",children:"Версия платформы"}),u.jsx("div",{className:"text-xs text-text-secondary",children:"1.0.0"})]})]}),u.jsx("div",{className:"text-sm text-text-secondary",children:"v1.0.0"})]}),u.jsxs("div",{className:"flex items-center justify-between p-3 settings-card",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Ue,{className:"w-4 h-4 text-text-secondary"}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-text",children:"Размер данных"}),u.jsx("div",{className:"text-xs text-text-secondary",children:"Настройки и кэш"})]})]}),u.jsx("div",{className:"text-sm text-text-secondary",children:"~2.5 MB"})]})]})}),u.jsx(yr,{title:"Безопасность",description:"Настройки безопасности и приватности",className:"mb-6",children:u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex items-center justify-between p-3 settings-card",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Bt,{className:"w-4 h-4 text-text-secondary"}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-text",children:"Шифрование данных"}),u.jsx("div",{className:"text-xs text-text-secondary",children:"Все данные зашифрованы"})]})]}),u.jsx("div",{className:"text-sm text-green-500",children:"Активно"})]})})}),u.jsx(yr,{title:"Производительность",description:"Настройки производительности системы",className:"mb-6",children:u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex items-center justify-between p-3 settings-card",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Ot,{className:"w-4 h-4 text-text-secondary"}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-text",children:"Кэширование"}),u.jsx("div",{className:"text-xs text-text-secondary",children:"Включено для ускорения работы"})]})]}),u.jsx("div",{className:"text-sm text-green-500",children:"Включено"})]})})}),e&&u.jsx(yr,{title:"Дополнительные настройки",description:"Расширенные системные параметры",className:"mb-6",children:u.jsx("div",{className:"text-sm text-text-secondary",children:"Дополнительные системные настройки будут добавлены в будущих версиях."})})]}),Tr=({selectedCategory:e,showAdvanced:t,searchQuery:s})=>{const{serviceSettings:r}=v.useContext(jr)||(console.warn("useServiceSettings используется вне ServiceSettingsProvider, возвращаем значения по умолчанию"),{serviceSettings:[],registerServiceSettings:()=>{},getServiceSettings:()=>null});return u.jsx("div",{className:"p-6",children:(()=>{switch(e){case"appearance":return u.jsx(kr,{category:{id:"appearance",name:"Внешний вид",description:"Настройки темы, шрифтов и отображения",icon:"Palette",items:[]},showAdvanced:t,searchQuery:s});case"interface":return u.jsx(Er,{category:{id:"interface",name:"Интерфейс",description:"Настройки панелей и макета",icon:"Layout",items:[]},showAdvanced:t,searchQuery:s});case"chat":return u.jsx(Sr,{category:{id:"chat",name:"Чат",description:"Настройки чата и сообщений",icon:"MessageSquare",items:[]},showAdvanced:t,searchQuery:s});case"notifications":return u.jsx(Ir,{category:{id:"notifications",name:"Уведомления",description:"Настройки уведомлений и звуков",icon:"Bell",items:[]},showAdvanced:t,searchQuery:s});case"services":return u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-text",children:"Настройки сервисов"}),r.map(e=>u.jsx(br,{service:e,onSettingChange:(e,t)=>{console.log(`Изменение настройки ${e}:`,t)}},e.config.id)),0===r.length&&u.jsx("div",{className:"text-center py-8 text-text-secondary",children:"Нет доступных настроек сервисов"})]});default:return u.jsxs("div",{className:"space-y-6",children:[u.jsx(kr,{category:{id:"appearance",name:"Внешний вид",description:"Настройки темы, шрифтов и отображения",icon:"Palette",items:[]},showAdvanced:t,searchQuery:s}),u.jsx(Er,{category:{id:"interface",name:"Интерфейс",description:"Настройки панелей и макета",icon:"Layout",items:[]},showAdvanced:t,searchQuery:s}),u.jsx(Sr,{category:{id:"chat",name:"Чат",description:"Настройки чата и сообщений",icon:"MessageSquare",items:[]},showAdvanced:t,searchQuery:s}),u.jsx(Ir,{category:{id:"notifications",name:"Уведомления",description:"Настройки уведомлений и звуков",icon:"Bell",items:[]},showAdvanced:t,searchQuery:s}),t&&u.jsx(Nr,{category:{id:"advanced",name:"Расширенные",description:"Продвинутые параметры для опытных пользователей",icon:"Settings",items:[]},showAdvanced:t,searchQuery:s})]})}})()})},Ar=({className:t})=>{const{settingsState:s}=(()=>{const{updateSetting:t}=fr(),{state:s,setActiveSettingsCategory:r}=i(),[n,a]=v.useState(!1),[o,l]=v.useState(""),[c,d]=v.useState(!1),[h,u]=v.useState(!1),p=s.layout.activeSettingsCategory,g=v.useCallback(()=>{a(e=>!e)},[]),x=v.useCallback(e=>{r(e||"all")},[r]),f=v.useCallback((e,s)=>{t(e,s)},[t]);return{settingsState:{searchQuery:o,showAdvanced:n,selectedCategory:p||"all",isExporting:c,isImporting:h},settingsActions:{setSearchQuery:l,toggleAdvanced:g,selectCategory:x,exportSettings:v.useCallback(()=>m(e,null,function*(){d(!0);try{const e=JSON.stringify(s.settings,null,2),t=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download="barsukov-platform-settings.json",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}catch(e){console.error("Ошибка экспорта настроек:",e)}finally{d(!1)}}),[s.settings]),importSettings:v.useCallback(s=>m(e,null,function*(){u(!0);try{const e=yield s.text(),r=JSON.parse(e);Object.entries(r).forEach(([e,s])=>{t(e,s)})}catch(e){console.error("Ошибка импорта настроек:",e)}finally{u(!1)}}),[t]),resetSettings:v.useCallback(()=>{if(confirm("Вы уверены, что хотите сбросить все настройки?")){const e={theme:"light",fontSize:"medium",sidebarCollapsed:!1,sidebarWidth:280};Object.entries(e).forEach(([e,s])=>{t(e,s)})}},[t])},handleSettingChange:f}})();return u.jsx(wr,{children:u.jsxs("div",{className:Ne("settings-container h-full flex flex-col",t),children:[u.jsxs("div",{className:"platform-service-header-standard",children:[u.jsxs("div",{className:"platform-service-header-content",children:[u.jsx("div",{className:"platform-service-icon",children:"⚙️"}),u.jsx("div",{className:"platform-service-content",children:u.jsx("h3",{className:"platform-service-title",children:"Настройки"})})]}),u.jsx("div",{className:"platform-service-status"})]}),u.jsx("div",{className:"settings-content-container flex-1 min-h-0 overflow-y-auto border border-border rounded-lg bg-card-bg",children:u.jsx("div",{className:"p-4",children:u.jsx(Tr,{selectedCategory:s.selectedCategory,showAdvanced:s.showAdvanced,searchQuery:""})})})]})})},Mr=({className:e})=>{const{state:t,toggleSidebar:s,switchSection:r,createWorkspaceItem:n,setActiveSettingsCategory:a,toggleChat:o,dispatch:l}=i(),[c,d]=v.useState("workspace"),[m,h]=v.useState("interactive-guide"),[p,g]=v.useState(!1),x=v.useRef(null),f=v.useRef(null),y=v.useRef(null),[b,j]=v.useState(null),[w,N]=v.useState(""),k=v.useRef(null),S=t.layout.sidebarCollapsed;v.useEffect(()=>{const e=e=>{const t=e.detail;h(t)};return window.addEventListener("ai-lawyer:switch-tab",e),()=>{window.removeEventListener("ai-lawyer:switch-tab",e)}},[]),v.useEffect(()=>{const e=document.querySelector(".sidebar-dynamic-width");if(e){const s=S?60:t.layout.sidebarWidth,r=S?12:20;e.style.setProperty("--sidebar-width",`${s}px`),e.style.setProperty("--sidebar-border-radius",`${r}px`)}},[S,t.layout.sidebarWidth]);const C=v.useMemo(()=>t.workspaceItems,[t.workspaceItems]),E=()=>{const e=`workspace_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;n({id:e,type:"folder",title:"Новое пространство",content:"",path:"/workspaces/",size:0,tags:["workspace"],createdAt:new Date,updatedAt:new Date})},I=e=>{w.trim()&&l({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e,updates:{title:w.trim()}}}),j(null),N("")},T=(e="all")=>{a(e),r("settings")},A=e=>{const s=t.layout.activeWidgetsCategory;if(s.includes(e)){const t=s.filter(t=>t!==e);l({type:"SET_ACTIVE_WIDGETS_CATEGORY",payload:t})}else{const t=[...s,e];l({type:"SET_ACTIVE_WIDGETS_CATEGORY",payload:t})}},M=e=>{t.layout.activeSettingsCategory===e?a("all"):T(e)},R=e=>{r(e)};return v.useEffect(()=>{if(!y.current)return;const e=y.current,t=e.querySelector('[data-workspace-id="'+c+'"]');if(t){const s=t.getBoundingClientRect(),r=e.getBoundingClientRect();(s.top<r.top+8||s.bottom>r.bottom-8)&&t.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}},[c]),u.jsxs("div",{className:Ne("h-full liquid-glass-panel transition-[width] duration-150 flex flex-col sidebar-dynamic-width shadow-2xl overflow-y-auto sidebar-scrollbar animate-sidebar-slide-in sidebar-main-container relative volume-container",S&&"collapsed",e),children:[u.jsxs("div",{className:Ne("flex items-center animate-sidebar-content sidebar-header",S?"p-0 justify-center":"p-3 justify-center"),children:[!S&&u.jsx("div",{className:"flex items-center justify-center w-full",children:u.jsx("div",{onClick:s,className:"w-full h-12 rounded-lg flex items-center justify-center sidebar-logo cursor-pointer hover:scale-105 transition-transform duration-200 bg-transparent border-none",title:"Свернуть панель",children:u.jsx("span",{className:"font-bold text-2xl sidebar-logo-text tracking-widest leading-none boss-ai-text",children:"Boss Ai"})})}),S&&u.jsx("button",{onClick:s,className:"sidebar-logo-button mx-auto",title:"Развернуть панель",children:u.jsx("span",{className:"font-bold text-lg sidebar-logo-text sidebar-service-icon-inverted",children:"B"})})]}),u.jsx("div",{className:Ne("gradient-divider",!S&&"mx-3")}),u.jsxs("div",{className:Ne("sidebar-services-scroll",S?"p-0":"px-0"),children:[u.jsx("div",{className:Ne(S?"p-0":"px-3 py-2"),children:u.jsxs("button",{onClick:e=>{R("prompts"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()});try{window.dispatchEvent(new CustomEvent("prompts:open"))}catch(t){}},className:Ne("sidebar-service-button",S&&"compact","prompts"===t.layout.activeSection&&"active"),title:"Библиотека промптов",children:[u.jsx(Rt,{className:"icon"}),!S&&u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Библиотека промптов"})})]})}),u.jsxs("div",{className:Ne(S?"p-0":"px-3 py-2"),children:[u.jsxs("button",{onClick:e=>{"ai-lawyer"===t.layout.activeSection?R("workspace"):(R("ai-lawyer"),t.layout.chatVisible||o()),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Ne("sidebar-service-button",S&&"compact","ai-lawyer"===t.layout.activeSection&&"active"),title:"AI-Юрист",children:[u.jsx(Lt,{className:"icon"}),!S&&u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"AI-Юрист"})})]}),S&&"ai-lawyer"===t.layout.activeSection&&u.jsxs("div",{className:"sidebar-service-dropdown",children:[u.jsx("button",{onClick:()=>{h("interactive-guide");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"interactive-guide"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","interactive-guide"===m&&"active"),title:"Интерактивный гид",children:u.jsx(Wt,{className:"icon"})}),u.jsx("button",{onClick:()=>{h("consultation");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"consultation"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","consultation"===m&&"active"),title:"Консультация",children:u.jsx(Lt,{className:"icon"})}),u.jsx("button",{onClick:()=>{h("documents");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"documents"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","documents"===m&&"active"),title:"Документы",children:u.jsx(Ye,{className:"icon"})}),u.jsx("button",{onClick:()=>{h("compliance");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"compliance"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","compliance"===m&&"active"),title:"152-ФЗ и комплаенс",children:u.jsx(Bt,{className:"icon"})}),u.jsx("button",{onClick:()=>{h("pricing");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"pricing"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","pricing"===m&&"active"),title:"Тарифы",children:u.jsx(qe,{className:"icon"})}),u.jsx("button",{onClick:()=>{h("architecture");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"architecture"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","architecture"===m&&"active"),title:"Архитектура",children:u.jsx(De,{className:"icon"})})]}),!S&&"ai-lawyer"===t.layout.activeSection&&u.jsxs("div",{className:"sidebar-service-dropdown",children:[u.jsxs("button",{onClick:()=>{h("interactive-guide");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"interactive-guide"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","interactive-guide"===m&&"active"),children:[u.jsx(Wt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Интерактивный гид"})})]}),u.jsxs("button",{onClick:()=>{h("consultation");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"consultation"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","consultation"===m&&"active"),children:[u.jsx(Lt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Консультация"})})]}),u.jsxs("button",{onClick:()=>{h("documents");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"documents"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","documents"===m&&"active"),children:[u.jsx(Ye,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Документы"})})]}),u.jsxs("button",{onClick:()=>{h("compliance");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"compliance"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","compliance"===m&&"active"),children:[u.jsx(Bt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"152-ФЗ и комплаенс"})})]}),u.jsxs("button",{onClick:()=>{h("pricing");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"pricing"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","pricing"===m&&"active"),children:[u.jsx(qe,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Тарифы"})})]}),u.jsxs("button",{onClick:()=>{h("architecture");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"architecture"});window.dispatchEvent(e)},className:Ne("sidebar-service-item","architecture"===m&&"active"),children:[u.jsx(De,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Архитектура"})})]})]})]}),u.jsx("div",{className:Ne(S?"p-0":"px-3 py-2"),children:u.jsxs("div",{className:"relative",ref:f,children:[u.jsxs("button",{onClick:e=>{g(!p);const t=e.currentTarget;requestAnimationFrame(()=>{t&&"function"==typeof t.blur&&t.blur()})},className:Ne("sidebar-service-button",S&&"compact",(p||t.layout.activeWidgetsCategory.length>0)&&"active"),title:"Виджеты",children:[u.jsx(ot,{className:"icon"}),!S&&u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Виджеты"})})]}),S&&p&&u.jsxs("div",{className:"sidebar-service-dropdown",children:[u.jsx("button",{onClick:()=>A("time-widget"),className:Ne("sidebar-service-item",t.layout.activeWidgetsCategory.includes("time-widget")&&"active"),title:"Часы",children:u.jsx(We,{className:"icon"})}),u.jsx("button",{onClick:()=>A("voice-widget"),className:Ne("sidebar-service-item",t.layout.activeWidgetsCategory.includes("voice-widget")&&"active"),title:"Голосовой ввод",children:u.jsx(vt,{className:"icon"})})]}),p&&!S&&u.jsxs("div",{className:"sidebar-service-dropdown",children:[u.jsxs("button",{onClick:()=>{A("time-widget"),window.dispatchEvent(new CustomEvent("widgets:toggle",{detail:"time-widget"}))},className:Ne("sidebar-service-item",t.layout.activeWidgetsCategory.includes("time-widget")&&"active"),children:[u.jsx(We,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Часы"})})]}),u.jsxs("button",{onClick:()=>{A("voice-widget"),window.dispatchEvent(new CustomEvent("widgets:toggle",{detail:"voice-widget"}))},className:Ne("sidebar-service-item",t.layout.activeWidgetsCategory.includes("voice-widget")&&"active"),children:[u.jsx(vt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Голосовой ввод"})})]})]})]})}),u.jsx("div",{className:Ne(S?"p-0":"px-3 py-2"),children:u.jsxs("div",{className:"relative",ref:x,children:[u.jsxs("button",{onClick:e=>{"settings"===t.layout.activeSection?R("workspace"):T("all");const s=e.currentTarget;requestAnimationFrame(()=>{s&&"function"==typeof s.blur&&s.blur()})},className:Ne("sidebar-service-button",S&&"compact","settings"===t.layout.activeSection&&"active"),title:"Настройки",children:[u.jsx(Ge,{className:"icon"}),!S&&u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Настройки"})})]}),S&&"settings"===t.layout.activeSection&&u.jsxs("div",{className:"sidebar-service-dropdown",children:[u.jsx("button",{onClick:()=>M("appearance"),className:Ne("sidebar-service-item","appearance"===t.layout.activeSettingsCategory&&"active"),title:"Внешний вид",children:u.jsx(wt,{className:"icon"})}),u.jsx("button",{onClick:()=>M("interface"),className:Ne("sidebar-service-item","interface"===t.layout.activeSettingsCategory&&"active"),title:"Интерфейс",children:u.jsx(ft,{className:"icon"})}),u.jsx("button",{onClick:()=>M("chat"),className:Ne("sidebar-service-item","chat"===t.layout.activeSettingsCategory&&"active"),title:"Чат",children:u.jsx(gt,{className:"icon"})}),u.jsx("button",{onClick:()=>M("notifications"),className:Ne("sidebar-service-item","notifications"===t.layout.activeSettingsCategory&&"active"),title:"Уведомления",children:u.jsx(Le,{className:"icon"})})]}),"settings"===t.layout.activeSection&&!S&&u.jsxs("div",{className:"sidebar-service-dropdown",children:[u.jsxs("button",{onClick:()=>M("appearance"),className:Ne("sidebar-service-item","appearance"===t.layout.activeSettingsCategory&&"active"),children:[u.jsx(wt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Внешний вид"})})]}),u.jsxs("button",{onClick:()=>M("interface"),className:Ne("sidebar-service-item","interface"===t.layout.activeSettingsCategory&&"active"),children:[u.jsx(ft,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Интерфейс"})})]}),u.jsxs("button",{onClick:()=>M("chat"),className:Ne("sidebar-service-item","chat"===t.layout.activeSettingsCategory&&"active"),children:[u.jsx(gt,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Чат"})})]}),u.jsxs("button",{onClick:()=>M("notifications"),className:Ne("sidebar-service-item","notifications"===t.layout.activeSettingsCategory&&"active"),children:[u.jsx(Le,{className:"icon"}),u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Уведомления"})})]})]})]})}),u.jsx("div",{className:Ne(S?"p-0":"px-3 py-2"),children:u.jsxs("button",{onClick:e=>{"corporate"===t.layout.activeSection?R("workspace"):R("corporate"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Ne("sidebar-service-button",S&&"compact","corporate"===t.layout.activeSection&&"active"),title:"Корпоративный сайт",children:[u.jsx(De,{className:"icon"}),!S&&u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Корпоративный сайт"})})]})}),u.jsx("div",{className:Ne(S?"p-0":"px-3 py-2"),children:u.jsxs("button",{onClick:e=>{"sales-scripts"===t.layout.activeSection?R("workspace"):R("sales-scripts"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Ne("sidebar-service-button",S&&"compact","sales-scripts"===t.layout.activeSection&&"active"),title:"Скрипты продаж",children:[u.jsx(gt,{className:"icon"}),!S&&u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Скрипты продаж"})})]})}),u.jsx("div",{className:Ne(S?"p-0":"px-3 py-2"),children:u.jsxs("button",{onClick:e=>{"regulations"===t.layout.activeSection?R("workspace"):R("regulations"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Ne("sidebar-service-button",S&&"compact","regulations"===t.layout.activeSection&&"active"),title:"Регламенты работы",children:[u.jsx(Ye,{className:"icon"}),!S&&u.jsx("div",{className:"service-content",children:u.jsx("div",{className:"service-title",children:"Регламенты"})})]})})]}),u.jsx("div",{className:Ne("gradient-divider",!S&&"mx-3")}),u.jsxs("nav",{className:Ne("animate-sidebar-content flex-1 min-h-0 sidebar-projects",S?"p-0":"p-3 pt-1"),children:[!S&&u.jsxs("div",{className:"flex items-center justify-between mb-2 mt-2",children:[u.jsx("h3",{className:"text-sm font-medium sidebar-services-title",children:"Проекты"}),u.jsx(cs,{onClick:E,variant:"primary",size:"sm",className:"sidebar-create-button",title:"Создать проект",children:u.jsx("span",{className:"text-sm",children:"+"})})]}),u.jsx("div",{ref:y,className:"sidebar-workspaces-scroll h-full min-h-0",children:u.jsxs("ul",{className:Ne("sidebar-nav",S?"space-y-4":"space-y-5"),children:[S&&u.jsx("li",{children:u.jsx(cs,{onClick:E,variant:"primary",size:"sm",className:"sidebar-create-button w-full",title:"Создать проект",children:u.jsx("span",{className:"text-sm",children:"+"})})}),C.filter(e=>"folder"===e.type).map(e=>{const t=(e=>{switch(e){case"folder":return tt;case"document":return Je;case"note":return gt;case"image":return Ze;default:return lt}})(e.type);return u.jsx("li",{children:u.jsx("div",{"data-workspace-id":e.id,onClick:()=>{d(e.id),R("workspace");try{window.dispatchEvent(new CustomEvent("workspace:navigate",{detail:{projectId:e.id}}))}catch(t){}},className:Ne("sidebar-service-button transition-all duration-200",S&&"compact",c===e.id&&"active"),title:S?e.title:void 0,children:u.jsxs("div",{className:Ne("sidebar-project-btn flex items-center flex-1 text-left",S?"justify-center":"space-x-3"),onDoubleClick:()=>(e=>{S||(j(e.id),N(e.title),setTimeout(()=>{var e,t;null==(e=k.current)||e.focus(),null==(t=k.current)||t.select()},0))})(e),children:[u.jsx(t,{className:"icon"}),S||b!==e.id?!S&&u.jsx("span",{className:"service-content",children:u.jsx("span",{className:"service-title truncate",children:e.title})}):u.jsx("input",{ref:k,type:"text",value:w,onChange:e=>N(e.target.value),onBlur:()=>I(e.id),onKeyDown:t=>{"Enter"===t.key?I(e.id):"Escape"===t.key&&(j(null),N(""))},onClick:e=>e.stopPropagation(),placeholder:"Название проекта","aria-label":"Редактировать название проекта",className:"service-content service-title truncate bg-surface border border-border rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-primary"})]})})},e.id)})]})})]}),u.jsx("div",{className:Ne("gradient-divider",!S&&"mx-3")}),u.jsx("div",{className:Ne("mt-auto sidebar-footer",S?"p-0 collapsed":"p-4"),children:u.jsxs("div",{className:Ne("flex",S?"flex-col space-y-1":"items-center justify-between gap-2"),children:[u.jsx("button",{onClick:()=>r("notifications"),className:Ne("sidebar-footer-button","notifications"===t.layout.activeSection&&"active"),title:"Уведомления",children:u.jsx(Le,{className:"w-4 h-4 icon"})}),u.jsx("button",{onClick:()=>{"settings"===t.layout.activeSection?R("workspace"):T("all")},className:Ne("sidebar-footer-button","settings"===t.layout.activeSection&&"active"),title:"Настройки",children:u.jsx(Ge,{className:"w-4 h-4 icon"})}),u.jsx("button",{onClick:()=>r("profile"),className:Ne("sidebar-footer-button","profile"===t.layout.activeSection&&"active"),title:"Профиль",children:u.jsx(Qt,{className:"w-4 h-4 icon"})})]})})]})},Rr=v.memo(({items:e,activeItem:t,isCollapsed:s,className:r=""})=>u.jsx("ul",{className:Ne("space-y-1",r),children:e.map((e,r)=>{const i=e.icon,n=t===e.id;return u.jsx("li",{className:"animate-interface-stagger",children:u.jsxs("button",{onClick:e.action,className:Ne("w-full flex items-center px-3 py-2.5 rounded-lg transition-all duration-200 group","hover:bg-surface-hover hover:shadow-sm",n?"bg-primary text-button-primary-text shadow-lg":"text-white hover:text-white",s?"justify-center":"justify-start"),title:s?e.name:void 0,style:{animationDelay:.1*r+"s"},children:[u.jsx(i,{className:Ne("transition-all duration-200",s?"w-5 h-5":"w-5 h-5 mr-3",n?"text-button-primary-text":"text-white group-hover:text-white")}),!s&&u.jsx("span",{className:"text-sm font-medium truncate",children:e.name})]})},e.id)})}));Rr.displayName="SidebarMenu";const Pr=v.memo(({isCollapsed:e,onToggle:t,className:s=""})=>u.jsx("button",{onClick:t,className:Ne("absolute -right-3 top-1/2 transform -translate-y-1/2 z-10","w-6 h-6 rounded-full border-2 transition-all duration-200","bg-surface border-border hover:border-primary hover:bg-surface-hover","flex items-center justify-center shadow-lg hover:shadow-xl","text-icon-muted hover:text-primary",s),title:e?"Развернуть сайдбар":"Свернуть сайдбар",children:e?u.jsx(He,{className:"w-4 h-4"}):u.jsx(Fe,{className:"w-4 h-4"})}));Pr.displayName="SidebarToggle",v.memo(({className:e})=>{const{state:t,toggleSidebar:s,switchSection:r}=i(),[n,a]=v.useState("workspace"),o=t.layout.sidebarCollapsed;v.useEffect(()=>{const e=document.querySelector(".sidebar-dynamic-width");if(e&&!e.style.getPropertyValue("--sidebar-width")){const s=o?60:t.layout.sidebarWidth;e.style.setProperty("--sidebar-width",`${s}px`)}},[o,t.layout.sidebarWidth]),v.useEffect(()=>{const e=document.querySelector(".sidebar-dynamic-width");if(e){const s=o?60:t.layout.sidebarWidth;e.style.setProperty("--sidebar-width",`${s}px`)}},[o,t.layout.sidebarWidth]);const l=v.useMemo(()=>[{id:"workspace",name:"Рабочее пространство",icon:tt,action:()=>{a("workspace"),r("workspace")}}],[r]);return u.jsxs("div",{className:Ne("sidebar-container relative flex flex-col h-full transition-all duration-300 ease-in-out","bg-surface border-r border-border",o?"sidebar-collapsed":"sidebar-expanded",e),children:[u.jsx(Pr,{isCollapsed:o,onToggle:s}),!o&&u.jsxs("div",{className:"p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-6 h-6 rounded-lg bg-primary/20 flex items-center justify-center",children:u.jsx("span",{className:"font-bold text-sm text-primary",children:"B"})}),u.jsxs("h2",{className:"text-lg font-semibold text-white",children:[u.jsx("span",{className:"font-bold",children:"oss"})," ",u.jsx("span",{className:"font-bold",children:"Ai"})]})]}),u.jsx("p",{className:"text-xs text-white mt-1",children:"BARSUKOV OS v2.1.0"})]}),u.jsx("div",{className:"flex-1 p-4 space-y-6",children:u.jsx(Rr,{items:l,activeItem:n,isCollapsed:o})}),!o&&u.jsx("div",{className:"p-4 border-t border-border",children:u.jsx("div",{className:"text-xs text-white text-center",children:"© 2024 Boss Ai"})})]})}).displayName="SidebarModular";const Lr=v.memo(({tool:e,serviceId:t,onToolClick:s,iconMap:r,isCollapsed:i,className:n=""})=>{const a=r[e.icon]||r.Folder;return u.jsxs("button",{onClick:()=>{s(t,e.id)},className:Ne("w-full flex items-center px-3 py-2 rounded-md transition-all duration-200 group","hover:bg-surface-hover hover:shadow-sm text-white hover:text-white",i?"justify-center":"justify-start",n),title:i?e.name:void 0,children:[u.jsx(a,{className:Ne("transition-all duration-200",i?"w-4 h-4":"w-4 h-4 mr-2","text-icon-muted group-hover:text-icon-primary")}),!i&&u.jsx("span",{className:"text-xs font-medium truncate",children:e.name})]},e.id)});Lr.displayName="SidebarTool",v.memo(({services:e,expandedServices:t,onToggleExpansion:s,onToolClick:r,iconMap:i,isCollapsed:n,className:a=""})=>{const o=v.useCallback(e=>{s(e)},[s]);return 0===e.length?null:u.jsx("div",{className:Ne("space-y-0.5",a),children:e.map(e=>{const s=t.has(e.config.id),a=i[e.config.icon]||i.Folder;return u.jsxs("div",{className:"animate-interface-stagger",children:[u.jsxs("button",{onClick:()=>o(e.config.id),className:Ne("w-full flex items-center px-3 py-2 rounded-lg transition-all duration-200 group","hover:bg-surface-hover hover:shadow-sm text-white hover:text-white",n?"justify-center":"justify-between"),title:n?e.config.name:void 0,children:[u.jsxs("div",{className:Ne("flex items-center",n?"justify-center":"justify-start"),children:[u.jsx(a,{className:Ne("transition-all duration-200",n?"w-5 h-5":"w-5 h-5 mr-3","text-icon-muted group-hover:text-icon-primary")}),!n&&u.jsx("span",{className:"text-sm font-medium truncate",children:e.config.name})]}),!n&&u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded-full bg-primary/10 text-primary mr-2",children:e.config.tools.length}),s?u.jsx("svg",{className:"w-4 h-4 text-icon-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):u.jsx("svg",{className:"w-4 h-4 text-icon-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),s&&!n&&u.jsx("div",{className:"mt-1 ml-3 mr-4 pr-2 pt-1 pb-1 space-y-0.5 animate-interface-slide-up overflow-visible",children:e.config.tools.map(t=>u.jsx(Lr,{tool:t,serviceId:e.config.id,onToolClick:r,iconMap:i,isCollapsed:n},t.id))})]},e.config.id)})})}).displayName="SidebarServices";const $r=({widget:e,onMinimize:t,onClose:s,isMinimized:r,onDragStart:i})=>{const[n,a]=v.useState(new Date),[o,l]=v.useState(!1),c=v.useRef(null);v.useEffect(()=>{const e=()=>{a(new Date)};return e(),c.current=setInterval(e,1e3),()=>{c.current&&clearInterval(c.current)}},[]);const d=t=>{const s=t.getHours(),r=t.getMinutes(),i=t.getSeconds();if(e.settings.format24h){let t=`${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;return e.settings["show-seconds"]&&(t+=`:${i.toString().padStart(2,"0")}`),t}{const t=s>=12?"PM":"AM";let n=`${s%12||12}:${r.toString().padStart(2,"0")}`;return e.settings["show-seconds"]&&(n+=`:${i.toString().padStart(2,"0")}`),n+=` ${t}`,n}};return r?u.jsx("div",{className:"widget-minimized time-widget-minimized",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onClick:t,children:u.jsxs("div",{className:"widget-minimized-content",children:[u.jsx(We,{size:16,className:"widget-minimized-icon"}),u.jsx("div",{className:"widget-minimized-time",children:d(n)})]})}):u.jsxs("div",{className:"widget-container time-widget-container active","data-testid":"widget-container",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onMouseDown:i,children:[u.jsxs("div",{className:"widget-header",children:[u.jsxs("div",{className:"widget-title",children:[u.jsx(We,{size:16,className:"widget-icon"}),u.jsx("span",{children:"Часы"})]}),u.jsxs("div",{className:Ne("widget-controls",o&&"widget-controls-visible"),children:[u.jsx("button",{onClick:()=>{const e=document.querySelector(".time-widget-container");e&&e.classList.toggle("no-shadow")},className:"widget-control-btn",title:"Убрать тень",children:u.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),u.jsx("path",{d:"M2 17l10 5 10-5"}),u.jsx("path",{d:"M2 12l10 5 10-5"})]})}),u.jsx("button",{onClick:s,className:"widget-control-btn widget-control-close",title:"Закрыть",children:u.jsx(ts,{size:12})})]})]}),u.jsxs("div",{className:"widget-content time-widget-content",children:[u.jsx("div",{className:"time-display",children:u.jsx("div",{className:"time-main",children:d(n)})}),e.settings["show-date"]&&u.jsxs("div",{className:"date-display",children:[u.jsx(Be,{size:14,className:"date-icon"}),u.jsx("span",{className:"date-text",children:(m=n,m.toLocaleDateString("ru-RU",{weekday:"short",day:"numeric",month:"short"}))})]})]})]});var m},_r=({widget:e,onMinimize:t,onClose:s,isMinimized:r,onTranscriptionComplete:i,onDragStart:n})=>{const[a,o]=v.useState(!1),[l,c]=v.useState(!1),[d,m]=v.useState(0),[h,p]=v.useState(""),[g,x]=v.useState(!1),y=v.useRef(null);f.useEffect(()=>{e.settings["auto-start"]&&!r&&j()},[e.settings,r]),f.useEffect(()=>(a&&!l?y.current=setInterval(()=>{m(e=>e+1)},1e3):y.current&&(clearInterval(y.current),y.current=null),()=>{y.current&&clearInterval(y.current)}),[a,l]);const b=e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},j=()=>{o(!0),c(!1),m(0),p("")};return f.useEffect(()=>{if(a&&!l){const t=window.SpeechRecognition||window.webkitSpeechRecognition;if(!t)return console.error("Web Speech API не поддерживается в этом браузере"),void p("Ошибка: Web Speech API не поддерживается");const s=new t;s.continuous=!0,s.interimResults=!0,s.lang="ru-RU",s.maxAlternatives=1,s.onresult=e=>{let t="",s="";if(e.results&&Array.isArray(e.results)&&"number"==typeof e.resultIndex)for(let r=e.resultIndex;r<e.results.length;r++){const i=e.results[r][0].transcript;e.results[r].isFinal?t+=i:s+=i}p(e=>{const r=e.replace(/<span class="interim">.*?<\/span>/g,"")+t;return s?`${r} <span class="interim">${s}</span>`:r})},s.onerror=e=>{console.error("Ошибка распознавания речи:",e.error),p(t=>t+` [Ошибка: ${e.error}]`)},s.onend=()=>{a&&!l&&setTimeout(()=>{try{s.start()}catch(e){console.error("Restart speech recognition failed",e)}},100)};try{s.start()}catch(e){console.error("Ошибка запуска распознавания речи",e),p("Ошибка запуска распознавания речи")}return()=>{try{s.stop()}catch(e){console.error("Ошибка остановки распознавания",e)}}}},[a,l]),r?u.jsx("div",{className:"widget-minimized voice-widget-minimized",onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onClick:t,children:u.jsxs("div",{className:"widget-minimized-content",children:[u.jsx("button",{className:"widget-minimized-mic-btn",onClick:e=>{e.stopPropagation(),a||j()},title:a?"Идёт запись":"Начать запись",children:u.jsx(vt,{size:16,className:Ne("widget-minimized-icon",a&&"recording")})}),a&&u.jsx("div",{className:"widget-minimized-time",children:b(d)})]})}):u.jsxs("div",{className:"widget-container voice-widget-container active",onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onMouseDown:n,children:[u.jsxs("div",{className:"widget-header",children:[u.jsxs("div",{className:"widget-title",children:[u.jsx(vt,{size:16,className:"widget-icon"}),u.jsx("span",{children:"Голосовой ввод"})]}),u.jsxs("div",{className:Ne("widget-controls",g&&"widget-controls-visible"),children:[u.jsx("button",{onClick:()=>{const e=document.querySelector(".voice-widget-container");e&&e.classList.toggle("no-shadow")},className:"widget-control-btn",title:"Убрать тень",children:u.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),u.jsx("path",{d:"M2 17l10 5 10-5"}),u.jsx("path",{d:"M2 12l10 5 10-5"})]})}),u.jsx("button",{onClick:s,className:"widget-control-btn widget-control-close",title:"Закрыть",children:u.jsx(ts,{size:12})})]})]}),u.jsxs("div",{className:"widget-content voice-widget-content",children:[u.jsx("div",{className:"voice-main-controls",children:a?u.jsxs("div",{className:"voice-recording-info",children:[u.jsx("div",{className:"voice-recording-time",children:b(d)}),u.jsx("div",{className:"voice-recording-status",children:l?"Пауза":"Идёт запись..."})]}):u.jsxs("button",{className:"voice-start-btn-small",onClick:j,title:"Начать запись",children:[u.jsx(vt,{size:20}),u.jsx("span",{children:"Запись"})]})}),a&&u.jsxs("div",{className:"voice-recording-controls",children:[u.jsx("button",{className:"voice-control-btn voice-pause-btn",onClick:()=>{c(e=>!e)},title:l?"Возобновить":"Пауза",children:u.jsx(Ft,{size:16})}),u.jsx("button",{className:"voice-control-btn voice-send-btn",onClick:()=>{h.trim()&&(i(h.trim()),p(""),o(!1),c(!1),m(0))},title:"Отправить",disabled:!h.trim(),children:u.jsx(_t,{size:16})})]}),e.settings["show-transcription"]&&h&&u.jsx("div",{className:"voice-transcription",dangerouslySetInnerHTML:{__html:h}})]})]})},Or=({onTranscriptionComplete:e})=>{const{state:t,dispatch:s}=i(),[r,n]=v.useState({}),[a,o]=v.useState({}),d=v.useRef(1e3),m=v.useRef(null),[h,p]=v.useState([{id:"voice-widget",name:"Голосовой ввод",icon:u.jsx(vt,{size:16}),component:_r,isActive:!1},{id:"time-widget",name:"Часы",icon:u.jsx(We,{size:16}),component:$r,isActive:!1}]);v.useEffect(()=>{const e=t.layout.activeWidgetsCategory;e&&0!==e.length?(p(t=>t.map(t=>c(l({},t),{isActive:e.includes(t.id)}))),n(t=>{const s=l({},t);return e.forEach((e,t)=>{s[e]||(s[e]={x:520+t%3*40,y:140+t%3*40})}),s}),o(t=>{const s=l({},t);return e.forEach(e=>{s[e]||(s[e]=d.current++)}),s})):p(e=>e.map(e=>c(l({},e),{isActive:!1})))},[t.layout.activeWidgetsCategory]);const g=e=>{p(t=>t.map(t=>t.id===e?c(l({},t),{isActive:!1}):t));const r=t.layout.activeWidgetsCategory.filter(t=>t!==e);s({type:"SET_ACTIVE_WIDGETS_CATEGORY",payload:r})},x=h.filter(e=>e.isActive),f=(e,t)=>{var s;if(0!==t.button)return;const i={x:t.clientX,y:t.clientY},n=null!=(s=r[e])?s:{x:480,y:120};m.current={id:e,start:i,offset:n},(e=>{o(t=>c(l({},t),{[e]:d.current++}))})(e),window.addEventListener("mousemove",y),window.addEventListener("mouseup",b),t.preventDefault()},y=e=>{if(!m.current)return;const{id:t,start:s,offset:r}=m.current,i=e.clientX-s.x,a=e.clientY-s.y;n(e=>c(l({},e),{[t]:{x:r.x+i,y:r.y+a}}))},b=v.useCallback(()=>{m.current=null,window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",b)},[]);return v.useEffect(()=>()=>{window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",b)},[b]),v.useEffect(()=>{const e=e=>{const t=e.detail;p(e=>e.map(e=>e.id===t?c(l({},e),{isActive:!e.isActive}):e))};return window.addEventListener("widgets:toggle",e),()=>window.removeEventListener("widgets:toggle",e)},[]),u.jsx(u.Fragment,{children:x.map(t=>{var s,i;const n=t.component,o=null!=(s=r[t.id])?s:{x:520,y:140},l=null!=(i=a[t.id])?i:1e3;return u.jsx("div",{className:"widget-wrapper",ref:e=>{e&&(e.style.left=`${o.x}px`,e.style.top=`${o.y}px`,e.style.zIndex=l.toString())},children:u.jsx(n,{widget:{id:t.id,settings:"voice-widget"===t.id?{"auto-start":!1,"show-transcription":!0}:{"show-seconds":!0,"show-date":!0,format24h:!0}},onMinimize:()=>g(t.id),onClose:()=>g(t.id),isMinimized:!1,onTranscriptionComplete:e,onDragStart:e=>f(t.id,e)})},t.id)})})},Dr=v.memo(({item:e,isSelected:t,isChecked:s,isNew:r,onItemClick:i,onItemAction:n,onDocumentCheck:a})=>{const[o,c]=v.useState(!1);return u.jsxs("div",{onClick:()=>{i(e.id)},onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),className:Ne("workspace-item group relative transition-all cursor-pointer rounded-md border p-2","hover:shadow-sm hover:scale-[1.01]",t?"border-primary bg-primary/5":"border-border bg-surface/30",r?"animate-new-item":""),children:[u.jsxs("div",{className:"flex items-center gap-2",children:["document"===e.type&&u.jsx("input",{type:"checkbox",checked:s,onChange:t=>{t.stopPropagation(),a(e.id,t.target.checked)},className:"w-3 h-3 text-primary bg-background border-border rounded",title:"Выбрать документ"}),u.jsx("div",{className:"text-muted-foreground flex-shrink-0",children:(e=>{const t={className:"w-3 h-3"};switch(e){case"document":return u.jsx(Ye,l({},t));case"folder":return u.jsx(tt,l({},t));case"image":return u.jsx(it,l({},t));case"video":return u.jsx(Zt,l({},t));case"audio":return u.jsx(bt,l({},t));case"archive":return u.jsx(Te,l({},t));default:return u.jsx(Je,l({},t))}})(e.type)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h4",{className:"text-xs font-medium truncate text-foreground",children:e.title}),u.jsx("span",{className:"text-[10px] text-muted-foreground ml-2 flex-shrink-0",children:ke(e.size)})]}),e.tags.length>0&&u.jsx("span",{className:"text-[9px] text-primary bg-primary/10 px-1 py-0.5 rounded",children:e.tags[0]})]})]}),o&&u.jsxs("div",{className:"absolute top-1 right-1 flex gap-0.5",children:[u.jsx(cs,{onClick:t=>{t.stopPropagation(),n(e.id,"send-to-chat")},variant:"ghost",size:"sm",className:"w-5 h-5 p-0",title:"Отправить в чат",children:u.jsx(_t,{className:"w-2.5 h-2.5"})}),u.jsx(cs,{onClick:t=>{t.stopPropagation(),n(e.id,"menu")},variant:"ghost",size:"sm",className:"w-5 h-5 p-0",title:"Действия",children:u.jsx(yt,{className:"w-2.5 h-2.5"})})]}),t&&u.jsx("div",{className:"absolute top-0.5 right-0.5 w-1.5 h-1.5 rounded-full bg-primary"})]})});Dr.displayName="CompactWorkspaceItem";const Br=v.memo(({isOpen:e,document:t,onSave:s,onClose:r,className:i=""})=>{const[n,a]=v.useState(""),[o,l]=v.useState(""),[c,d]=v.useState(!1);v.useEffect(()=>{t&&(a(t.title),l(t.content||""),d(!1))},[t]),v.useEffect(()=>{if(t){const e=n!==t.title,s=o!==(t.content||"");d(e||s)}},[n,o,t]);const m=v.useCallback(()=>{t&&c&&(s(t.id,n,o),d(!1))},[t,n,o,c,s]),h=v.useCallback(()=>{c&&!window.confirm("У вас есть несохраненные изменения. Закрыть без сохранения?")||r()},[c,r]),p=v.useCallback(e=>{"Escape"===e.key?h():"s"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),m())},[h,m]);return e&&t?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/50 backdrop-blur-sm",children:u.jsxs("div",{className:Ne("w-full max-w-4xl h-[80vh] bg-background border border-border rounded-xl shadow-2xl flex flex-col",i),onKeyDown:p,children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Редактор документа"}),c&&u.jsx("span",{className:"px-2 py-1 text-xs bg-orange-500/20 text-orange-500 rounded-full",children:"Есть изменения"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("button",{onClick:m,disabled:!c,className:Ne("flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors",c?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-muted text-muted-foreground cursor-not-allowed"),title:"Сохранить (Ctrl+S)",children:[u.jsx(Pt,{className:"w-4 h-4"}),u.jsx("span",{children:"Сохранить"})]}),u.jsxs("button",{onClick:h,className:"flex items-center space-x-2 px-3 py-2 rounded-lg hover:bg-surface-hover transition-colors",title:"Закрыть (Esc)",children:[u.jsx(ts,{className:"w-4 h-4"}),u.jsx("span",{children:"Закрыть"})]})]})]}),u.jsxs("div",{className:"flex-1 flex flex-col p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-sm font-medium text-secondary",children:"Название документа"}),u.jsx("input",{type:"text",value:n,onChange:e=>a(e.target.value),className:"w-full px-3 py-2 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Введите название документа"})]}),u.jsxs("div",{className:"flex-1 flex flex-col space-y-2",children:[u.jsx("label",{className:"text-sm font-medium text-secondary",children:"Содержимое документа"}),u.jsx("textarea",{value:o,onChange:e=>l(e.target.value),className:"flex-1 w-full px-3 py-2 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none",placeholder:"Введите содержимое документа..."})]}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("span",{children:["Символов: ",o.length]}),u.jsxs("span",{children:["Слов: ",o.split(/\s+/).filter(e=>e.length>0).length]}),u.jsxs("span",{children:["Строк: ",o.split("\n").length]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{children:"Ctrl+S для сохранения"}),u.jsx("span",{children:"Esc для закрытия"})]})]})]})]})}):null});Br.displayName="DocumentEditor";const zr=({project:e,items:t,onItemClick:s,onItemSendToChat:r,onItemDelete:i,className:n=""})=>{const[a,o]=v.useState([]),[d,m]=v.useState(!1),[h,p]=v.useState({x:0,y:0}),[g,x]=v.useState("canvas"),f=v.useRef(null);v.useEffect(()=>{const e=t.map((e,t)=>({id:e.id,x:50+t%4*200,y:50+150*Math.floor(t/4),width:180,height:120,type:e.type,title:e.title,content:e.content,isSelected:!1,isDragging:!1}));o(e)},[t]);const y=v.useCallback(e=>{const r=t.find(t=>t.id===e.id);r&&s(r)},[t,s]),b=v.useCallback((e,s)=>{s.stopPropagation();const i=t.find(t=>t.id===e.id);i&&r(i)},[t,r]),j=v.useCallback((e,s)=>{s.stopPropagation();const r=t.find(t=>t.id===e.id);r&&i(r)},[t,i]),w=v.useCallback((e,t)=>{t.preventDefault(),m(!0),p({x:t.clientX-e.x,y:t.clientY-e.y}),o(t=>t.map(t=>t.id===e.id?c(l({},t),{isDragging:!0}):t))},[]),N=v.useCallback(e=>{d&&o(t=>t.map(t=>t.isDragging?c(l({},t),{x:e.clientX-h.x,y:e.clientY-h.y}):t))},[d,h]),k=v.useCallback(()=>{m(!1),o(e=>e.map(e=>c(l({},e),{isDragging:!1})))},[]);v.useEffect(()=>{if(d)return document.addEventListener("mousemove",N),document.addEventListener("mouseup",k),()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",k)}},[d,N,k]);const S=e=>{switch(e){case"document":default:return"📄";case"image":return"🖼️";case"file":return"📁";case"note":return"📝"}},C=e=>{switch(e){case"document":return"bg-blue-100 border-blue-200 text-blue-800";case"image":return"bg-purple-100 border-purple-200 text-purple-800";case"file":default:return"bg-gray-100 border-gray-200 text-gray-800";case"note":return"bg-green-100 border-green-200 text-green-800"}};return u.jsxs("div",{className:Ne("project-canvas-container h-full flex flex-col",n),children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("h2",{className:"text-lg font-semibold text-text",children:["Холст проекта: ",e.title]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("span",{className:"text-sm text-text-secondary",children:[t.length," элементов"]})})]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("div",{className:"flex rounded-lg p-0.5 bg-surface border border-border",children:[u.jsx("button",{onClick:()=>x("canvas"),className:Ne("px-3 py-1.5 text-sm rounded-md transition-colors","canvas"===g?"bg-primary text-primary-foreground":"text-text-secondary hover:text-text"),children:"Холст"}),u.jsx("button",{onClick:()=>x("grid"),className:Ne("px-3 py-1.5 text-sm rounded-md transition-colors","grid"===g?"bg-primary text-primary-foreground":"text-text-secondary hover:text-text"),children:"Сетка"}),u.jsx("button",{onClick:()=>x("list"),className:Ne("px-3 py-1.5 text-sm rounded-md transition-colors","list"===g?"bg-primary text-primary-foreground":"text-text-secondary hover:text-text"),children:"Список"})]})})]}),u.jsx("div",{ref:f,className:"flex-1 relative overflow-auto bg-gradient-to-br from-surface/50 to-surface/30",style:{minHeight:"400px"},children:"canvas"===g?u.jsx("div",{className:"relative w-full h-full",style:{minWidth:"800px",minHeight:"600px"},children:a.map(e=>u.jsxs("div",{className:Ne("absolute cursor-pointer transition-all duration-200 rounded-lg border-2 p-3",C(e.type),e.isDragging?"shadow-2xl scale-105 z-50":"shadow-md hover:shadow-lg",e.isSelected?"ring-2 ring-primary ring-offset-2":""),style:{left:e.x,top:e.y,width:e.width,height:e.height},onClick:()=>y(e),onMouseDown:t=>w(e,t),children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-lg",children:S(e.type)}),u.jsx("span",{className:"font-medium text-sm truncate",children:e.title})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:t=>b(e,t),className:"p-1 rounded hover:bg-black/10 transition-colors",title:"Отправить в чат",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),u.jsx("path",{d:"M22 2 11 13"})]})}),u.jsx("button",{onClick:t=>j(e,t),className:"p-1 rounded hover:bg-red-100 transition-colors",title:"Удалить",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),u.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]})})]})]}),e.content&&u.jsxs("div",{className:"text-xs text-text-secondary line-clamp-3",children:[e.content.substring(0,100),"..."]}),u.jsx("div",{className:"absolute bottom-2 left-2 right-2",children:u.jsx("div",{className:"text-xs text-text-secondary",children:e.type})})]},e.id))}):"grid"===g?u.jsx("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:t.map(e=>u.jsxs("div",{className:Ne("p-4 rounded-lg border-2 cursor-pointer transition-all hover:shadow-lg",C(e.type)),onClick:()=>s(e),children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("span",{className:"text-lg",children:S(e.type)}),u.jsx("span",{className:"font-medium text-sm truncate",children:e.title})]}),e.content&&u.jsxs("div",{className:"text-xs text-text-secondary line-clamp-2",children:[e.content.substring(0,80),"..."]})]},e.id))}):u.jsx("div",{className:"p-4 space-y-2",children:t.map(e=>u.jsx("div",{className:Ne("p-3 rounded-lg border cursor-pointer transition-all hover:shadow-md",C(e.type)),onClick:()=>s(e),children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"text-lg",children:S(e.type)}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-sm",children:e.title}),e.content&&u.jsxs("div",{className:"text-xs text-text-secondary",children:[e.content.substring(0,100),"..."]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:t=>{t.stopPropagation(),r(e)},className:"p-1 rounded hover:bg-black/10 transition-colors",title:"Отправить в чат",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),u.jsx("path",{d:"M22 2 11 13"})]})}),u.jsx("button",{onClick:t=>{t.stopPropagation(),i(e)},className:"p-1 rounded hover:bg-red-100 transition-colors",title:"Удалить",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),u.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]})})]})]})},e.id))})})]})},Fr=v.memo(({item:e,isSelected:t,isChecked:s,isNew:r,viewMode:i,onItemClick:n,onItemAction:a,onDocumentCheck:o})=>{const[c,d]=v.useState(!1),[m,h]=v.useState(!1);return u.jsxs("div",{onClick:()=>{n(e.id)},onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),className:Ne("workspace-item group relative transition-all cursor-pointer rounded-lg border","hover:shadow-md hover:scale-[1.02]",t?"border-primary bg-primary/5":"border-border bg-surface/50",r?"animate-new-item":""),children:[u.jsxs("div",{className:"p-3",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:["document"===e.type&&u.jsx("input",{type:"checkbox",checked:s,onChange:t=>{t.stopPropagation(),o(e.id,t.target.checked)},className:"w-3 h-3 text-primary bg-background border-border rounded",title:"Выбрать документ"}),u.jsx("div",{className:"text-muted-foreground",children:(e=>{const t={className:"w-3 h-3"};switch(e){case"document":return u.jsx(Ye,l({},t));case"folder":return u.jsx(tt,l({},t));case"image":return u.jsx(it,l({},t));case"video":return u.jsx(Zt,l({},t));case"audio":return u.jsx(bt,l({},t));case"archive":return u.jsx(Te,l({},t));default:return u.jsx(Je,l({},t))}})(e.type)}),u.jsx("button",{className:"text-sm hover:bg-surface-hover rounded px-1 py-0.5 transition-colors",onClick:e=>{e.stopPropagation(),h(!m)},title:"Изменить эмодзи",children:e.emoji||"🏷️"}),u.jsx("h4",{className:"text-sm font-medium truncate text-foreground flex-1",children:e.title})]}),m&&u.jsx("div",{className:"absolute top-12 left-2 z-20 p-2 bg-surface border border-border rounded-lg shadow-lg",children:u.jsx("div",{className:"grid grid-cols-5 gap-1",children:["📁","📝","📷","🎵","🎬","🚀","⭐","🔥","💡","✅","🧠","⚙️","🌈","🧪","🏷️"].map(t=>u.jsx("button",{className:"p-1 hover:bg-surface-hover rounded text-xs",onClick:s=>{s.stopPropagation(),a(e.id,`set-emoji:${t}`),h(!1)},children:t},t))})}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[u.jsx("span",{children:ke(e.size)}),"compact"!==i&&u.jsx("span",{children:e.updatedAt.toLocaleDateString()})]}),e.tags.length>0&&u.jsx("div",{className:"mt-2",children:u.jsxs("span",{className:"inline-block px-2 py-1 text-xs rounded-full bg-primary/10 text-primary",children:[e.tags[0],e.tags.length>1&&" +"+(e.tags.length-1)]})})]}),c&&u.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[u.jsx(cs,{onClick:t=>{t.stopPropagation(),a(e.id,"send-to-chat")},variant:"ghost",size:"sm",className:"w-6 h-6 p-0",title:"Отправить в чат",children:u.jsx(_t,{className:"w-3 h-3"})}),u.jsx(cs,{onClick:t=>{t.stopPropagation(),a(e.id,"menu")},variant:"ghost",size:"sm",className:"w-6 h-6 p-0",title:"Действия",children:u.jsx(yt,{className:"w-3 h-3"})})]}),t&&u.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 rounded-full bg-primary"})]})});Fr.displayName="WorkspaceItem";const Hr=({className:e})=>{const{state:t,createWorkspaceItem:s,dispatch:r,sendMessage:n}=i(),[a,o]=v.useState(""),[d,m]=v.useState(new Set),[h,p]=v.useState(new Set),[g,x]=v.useState("compact"),[f,y]=v.useState(new Set),[b,j]=v.useState(new Set),[w,N]=v.useState(null),[k,S]=v.useState(null),[C,E]=v.useState(!1),[I,T]=v.useState(!1),A=v.useRef(null),M=v.useRef(null),R=v.useCallback(e=>t.workspaceItems.find(t=>t.id===e&&"folder"===t.type)||null,[t.workspaceItems]),P=v.useCallback(()=>{setTimeout(()=>{const e=A.current,t=document.activeElement;e&&t&&e.contains(t)||T(!0)},0)},[]);v.useEffect(()=>{if(!I)return;const e=setTimeout(()=>{E(!1),T(!1)},150);return()=>clearTimeout(e)},[I]);const L=t.workspaceItems,$=v.useMemo(()=>L.filter(e=>"folder"===e.type),[L]),_=v.useMemo(()=>L.find(e=>e.id===w&&"folder"===e.type)||null,[L,w]),O=v.useMemo(()=>{if(!_)return $;const e=`/workspaces/${_.id}/`;return L.filter(t=>{var s;return null==(s=t.path)?void 0:s.startsWith(e)})},[L,$,_]),D=v.useMemo(()=>O.filter(e=>e.title.toLowerCase().includes(a.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(a.toLowerCase()))),[O,a]);v.useEffect(()=>{const e=e=>{var t;const s=e;(null==(t=s.detail)?void 0:t.projectId)&&N(s.detail.projectId)};return window.addEventListener("workspace:navigate",e),()=>window.removeEventListener("workspace:navigate",e)},[t.workspaceItems]);const B=()=>{if(!_){const e=`proj_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return s({id:e,type:"folder",title:"Новый проект",path:"/workspaces/",size:0,tags:["project"],createdAt:new Date,updatedAt:new Date}),y(t=>new Set([...t,e])),void setTimeout(()=>y(t=>{const s=new Set(t);return s.delete(e),s}),1e3)}const e=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,t={id:e,type:"document",title:"Новый документ",content:"",path:`/workspaces/${_.id}/`,size:0,tags:[],createdAt:new Date,updatedAt:new Date};s(t),y(t=>new Set([...t,e])),setTimeout(()=>{y(t=>{const s=new Set(t);return s.delete(e),s})},1e3)},z=v.useCallback(e=>{m(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s});const s=t.workspaceItems.find(t=>t.id===e);"folder"===(null==s?void 0:s.type)&&(console.log("Workspace: Setting active project to:",s.id,s.title),N(s.id),window.dispatchEvent(new CustomEvent("workspace:navigate",{detail:{projectId:s.id}})),console.log("Workspace: Sent workspace:navigate event with projectId:",s.id))},[t.workspaceItems]),F=v.useCallback((e,s)=>{const i=t.workspaceItems.find(t=>t.id===e);if(i)switch(s){case s&&s.startsWith("set-emoji:")?s:"":{const t=s.replace("set-emoji:","");r({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e,updates:{emoji:t}}});break}case"download":if("file"===i.type){const e=document.createElement("a");e.href=i.url||"#",e.download=i.name||i.title,e.click()}break;case"edit-document":"document"===i.type&&S({id:i.id,title:i.title,content:i.content||""});break;case"send-to-chat":{const s=t.workspaceItems.find(t=>t.id===e);s&&(window.dispatchEvent(new CustomEvent("workspace:send-to-chat",{detail:{items:[s]}})),j(t=>new Set([...t,e])),setTimeout(()=>{j(t=>{const s=new Set(t);return s.delete(e),s})},1200));break}case"delete":window.confirm(`Вы уверены, что хотите удалить ${"folder"===i.type?"проект":"документ"} "${i.title}"?`)&&r({type:"REMOVE_WORKSPACE_ITEM",payload:e});break;case"share":navigator.clipboard&&i.url&&navigator.clipboard.writeText(i.url).catch(()=>{const e=document.createElement("textarea");e.value=i.url||"",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)})}},[t.workspaceItems,r]),H=v.useCallback(()=>{const e=R(w);if(!e)return;const t=(window.prompt("Новое имя проекта",e.title)||"").trim();t&&window.confirm(`Переименовать проект в "${t}"?`)&&r({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e.id,updates:{title:t,updatedAt:new Date}}})},[w,r,R]),W=v.useCallback(()=>{const e=R(w);if(!e)return;const t=e.url||`${window.location.origin}/workspaces/${e.id}`;navigator.clipboard&&navigator.clipboard.writeText(t).catch(()=>{})},[w,R]),G=v.useCallback(()=>{const e=R(w);e&&window.confirm(`Удалить проект "${e.title}"?`)&&(r({type:"REMOVE_WORKSPACE_ITEM",payload:e.id}),N(null))},[w,r,R]),V=v.useCallback((e,t)=>{const s=(t||"").trim();s&&window.confirm(`Переименовать в "${s}"?`)&&r({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e,updates:{title:s,updatedAt:new Date}}})},[r]),U=v.useCallback((e,t)=>{p(s=>{const r=new Set(s);return t?r.add(e):r.delete(e),r})},[]),q=v.useCallback(()=>{if(0===h.size)return;const e=t.workspaceItems.filter(e=>h.has(e.id)&&"document"===e.type);0!==e.length&&(window.dispatchEvent(new CustomEvent("workspace:send-to-chat",{detail:{items:e}})),e.forEach(e=>{j(t=>new Set([...t,e.id]))}),setTimeout(()=>{j(t=>{const s=new Set(t);return e.forEach(e=>s.delete(e.id)),s})},1200),p(new Set))},[h,t.workspaceItems]),Q=v.useCallback((e,t,s)=>{r({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e,updates:{title:t,content:s,updatedAt:new Date}}}),S(null)},[r]),K=v.useCallback(()=>{S(null)},[]);return u.jsxs("div",{className:Ne("workspace-container liquid-glass-panel flex-1 flex flex-col",e),children:[u.jsx("div",{className:"p-3 liquid-glass-block workspace-header-bg header-with-divider",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"flex items-center gap-2 mr-auto",children:_?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"sidebar-footer-button",title:"Все проекты","aria-label":"Все проекты",onClick:()=>N(null),children:u.jsx(tt,{className:"w-4 h-4 icon"})}),u.jsx("span",{className:"text-xs opacity-60",children:"/"}),u.jsx("span",{className:"text-sm workspace-title-color",children:_.title}),u.jsx("span",{className:"text-xs workspace-subtitle-color",children:D.length})]}):u.jsxs(u.Fragment,{children:[u.jsx("h1",{className:"text-base font-semibold workspace-title-color leading-none",children:"Проекты"}),u.jsx("span",{className:"text-xs workspace-subtitle-color leading-none",children:D.length})]})}),u.jsxs("div",{className:"flex rounded-lg p-0.5 workspace-view-container gap-1",children:[u.jsx("button",{onClick:()=>x("grid"),className:Ne("sidebar-footer-button","grid"===g?"active":""),title:"Сетка","aria-label":"Переключить вид сетка",children:u.jsx(rt,{className:"w-3.5 h-3.5 icon"})}),u.jsx("button",{onClick:()=>x("list"),className:Ne("sidebar-footer-button","list"===g?"active":""),title:"Список","aria-label":"Переключить вид список",children:u.jsx(ct,{className:"w-3.5 h-3.5 icon"})}),u.jsx("button",{onClick:()=>x("compact"),className:Ne("sidebar-footer-button","compact"===g?"active":""),title:"Компактный","aria-label":"Переключить компактный вид",children:u.jsx(ot,{className:"w-3.5 h-3.5 icon"})}),u.jsx("button",{onClick:()=>x("ultra-compact"),className:Ne("sidebar-footer-button","ultra-compact"===g?"active":""),title:"Ультра-компактный","aria-label":"Переключить ультра-компактный вид",children:u.jsx(rt,{className:"w-3.5 h-3.5 icon"})}),u.jsx("button",{onClick:()=>x("canvas"),className:Ne("sidebar-footer-button","canvas"===g?"active":""),title:"Холст","aria-label":"Переключить вид холст",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3.5 h-3.5 icon",children:[u.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),u.jsx("path",{d:"M9 9h6v6H9z"})]})})]}),h.size>0&&u.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-3 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",title:`Отправить ${h.size} документов в чат`,children:[u.jsx(_t,{className:"w-4 h-4"}),u.jsxs("span",{className:"text-sm",children:["Отправить в чат (",h.size,")"]})]}),u.jsxs("div",{className:"flex items-center gap-2",ref:A,children:[u.jsxs("div",{className:Ne("relative flex items-center",C?"w-56":""),children:[!C&&u.jsx("button",{className:"sidebar-footer-button",title:"Поиск","aria-label":"Поиск",onClick:()=>{E(!0),requestAnimationFrame(()=>{var e;return null==(e=M.current)?void 0:e.focus()})},children:u.jsx($t,{className:"w-4 h-4 icon"})}),C&&u.jsxs("div",{className:Ne("flex items-center gap-1 w-full",I?"animate-scale-out":"animate-scale-in animate-slide-in-down"),children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx($t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 workspace-search-icon-color"}),u.jsx("input",{ref:M,type:"text",placeholder:"Поиск файлов...",value:a,onChange:e=>o(e.target.value),onBlur:P,className:"w-full pl-10 pr-8 py-2 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent workspace-input-styles"})]}),u.jsx("button",{className:"sidebar-footer-button",title:"Закрыть поиск","aria-label":"Закрыть поиск",onMouseDown:e=>e.preventDefault(),onClick:()=>T(!0),children:u.jsx(ts,{className:"w-4 h-4 icon"})})]})]}),u.jsxs(cs,{variant:"ghost",size:"sm",className:"sidebar-footer-button",title:"Фильтры","aria-label":"Фильтры",children:[u.jsx(Xe,{className:"w-4 h-4 icon"}),u.jsx("span",{className:"sr-only",children:"Фильтры"})]})]}),_&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(cs,{variant:"ghost",size:"sm",className:"sidebar-footer-button",title:"Переименовать","aria-label":"Переименовать",onClick:H,children:u.jsx(Ct,{className:"w-3.5 h-3.5 icon"})}),u.jsx(cs,{variant:"ghost",size:"sm",className:"sidebar-footer-button",title:"Поделиться","aria-label":"Поделиться",onClick:W,children:u.jsx(Dt,{className:"w-3.5 h-3.5 icon"})}),u.jsx(cs,{variant:"danger",size:"sm",className:"sidebar-footer-button",title:"Удалить","aria-label":"Удалить",onClick:G,children:u.jsx(Gt,{className:"w-3.5 h-3.5 icon"})})]}),u.jsx(cs,{onClick:B,variant:"primary",size:"sm",className:"sidebar-footer-button",title:"Создать",children:u.jsx(At,{className:"w-4 h-4 icon"})})]})}),u.jsx("div",{className:"p-3 backdrop-blur-sm overflow-y-auto main-content-scrollbar bg-background workspace-content-limited flex-1",children:0===D.length?u.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[u.jsx("div",{className:"w-24 h-24 rounded-full flex items-center justify-center mb-6 workspace-empty-icon-bg",children:u.jsx(tt,{className:"w-12 h-12 workspace-empty-icon-color"})}),u.jsx("h3",{className:"text-xl font-semibold mb-2 workspace-empty-title",children:a?"Ничего не найдено":_?"Нет документов":"Нет проектов"}),u.jsx("p",{className:"mb-6 max-w-md workspace-empty-subtitle",children:a?"Попробуйте изменить поисковый запрос":_?"Создайте первый документ в проекте":"Создайте первый проект"}),!a&&u.jsxs("button",{onClick:B,className:"flex items-center space-x-2 px-6 py-3 rounded-lg transition-colors workspace-create-button-styles",children:[u.jsx(At,{className:"w-5 h-5"}),u.jsx("span",{children:_?"Создать документ":"Создать проект"})]})]}):"canvas"===g&&_?u.jsx(zr,{project:_,items:D,onItemClick:e=>z(e.id),onItemSendToChat:e=>{window.dispatchEvent(new CustomEvent("workspace:send-to-chat",{detail:{items:[e]}}))},onItemDelete:e=>{window.confirm(`Вы уверены, что хотите удалить ${"folder"===e.type?"проект":"документ"} "${e.title}"?`)&&r({type:"REMOVE_WORKSPACE_ITEM",payload:e.id})},className:"flex-1"}):u.jsx("div",{className:Ne("workspace-grid grid gap-3","grid"===g&&"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4","list"===g&&"grid-cols-1","compact"===g&&"grid-cols-2 sm:grid-cols-4 lg:grid-cols-6","ultra-compact"===g&&"grid-cols-3 sm:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10"),"data-view-mode":g,children:D.map(e=>{const t={key:e.id,item:e,isSelected:d.has(e.id),isChecked:h.has(e.id),isNew:f.has(e.id)||b.has(e.id),onItemClick:z,onItemAction:F,onDocumentCheck:U};return"ultra-compact"===g?u.jsx(Dr,l({},t)):u.jsx(Fr,c(l({},t),{viewMode:"canvas"===g?"grid":g,onItemRename:V,onEditCancel:()=>{}}))})})}),u.jsx(Br,{isOpen:null!==k,document:k,onSave:Q,onClose:K})]})},Wr={DEFAULT_WIDTH:280,MIN_WIDTH:200,MAX_WIDTH:500,COLLAPSED_WIDTH:60},Gr={DEFAULT_WIDTH:525,MIN_WIDTH:250,MAX_WIDTH:2e3,INPUT_DEFAULT_HEIGHT:300,INPUT_MIN_HEIGHT:200,INPUT_MAX_HEIGHT:800},Vr={DARK:"dark",LIGHT:"light",CUSTOM:"custom"},Ur={SMALL:"small",MEDIUM:"medium",LARGE:"large"},qr=new class{constructor(){this.config={enableSystemCommands:!0,enableServiceRouting:!0,enableContextAnalysis:!0,maxHistoryLength:50,responseTimeout:3e4},this.context={activeService:null,activeSection:"workspace",conversationHistory:[],userPreferences:{},lastActivity:new Date}}processMessage(e,t=null,s="workspace"){return m(this,null,function*(){try{this.updateContext(t,s);const r=M.getContextForAI(),i=yield this.analyzeIntentWithContext(e,r);return this.config.enableSystemCommands&&i.isSystemCommand?yield this.handleSystemCommand(e,i):this.config.enableServiceRouting&&i.shouldRouteToService&&i.serviceId?yield this.routeToService(e,{serviceId:i.serviceId,toolId:i.toolId,shouldRouteToService:i.shouldRouteToService}):yield this.handleGeneralQueryWithContext(e,i,r)}catch(r){return console.error("AI Brain error:",r),{success:!1,message:"Произошла ошибка при обработке сообщения",isSystemResponse:!0}}})}analyzeIntentWithContext(e,t){return m(this,null,function*(){const s=yield this.analyzeIntent(e);return t.attachedItems.length>0&&(s.confidence=Math.min(s.confidence+.2,1),t.attachedItems.some(e=>"document"===e.type)&&(s.serviceId||(s.serviceId="ai-assistant",s.shouldRouteToService=!0))),t.activeProject&&s.keywords.push(`проект:${t.activeProject.title}`),s})}analyzeIntent(e){return m(this,null,function*(){const t=e.toLowerCase(),s=this.extractKeywords(t),r=["настройки","settings","конфигурация","config","помощь","help","справка","команды","выход","exit","закрыть","close","очистить","clear","сброс","reset"].some(e=>t.includes(e)),i=[{service:"chatgpt-service",keywords:["chatgpt","gpt","openai","ии","ai","чат","переписать","rewrite","кратко","summary","перевести","translate"]},{service:"settings",keywords:["настройки","settings","конфигурация","config","тема","theme","цвет","color","интерфейс","interface","уведомления","notifications"]},{service:"whisper-service",keywords:["голос","voice","микрофон","mic","говорить","speak","транскрипция","transcription","записать","record"]},{service:"ai-assistant",keywords:["помощь","help","ассистент","assistant"]}];let n,a,o=!1,l=0;for(const e of i){const s=e.keywords.filter(e=>t.includes(e)).length;if(s>0){const r=s/e.keywords.length;r>l&&(l=r,n=e.service,o=!0,"chatgpt-service"===e.service?a=t.includes("переписать")||t.includes("rewrite")?"text-rewrite":t.includes("кратко")||t.includes("summary")?"summarize-text":t.includes("перевести")||t.includes("translate")?"translate-chatgpt":"chat-completion":"settings"===e.service?a=t.includes("тема")||t.includes("theme")?"toggle-theme":t.includes("интерфейс")||t.includes("interface")?"interface":t.includes("уведомления")||t.includes("notifications")?"notifications":t.includes("чат")||t.includes("chat")?"chat":t.includes("внешний вид")||t.includes("appearance")?"appearance":"open-preferences":"whisper-service"===e.service&&(a=t.includes("голос")||t.includes("voice")||t.includes("микрофон")||t.includes("mic")?"realtime-transcription":t.includes("транскрипция")||t.includes("transcription")?"audio-transcription":t.includes("команда")||t.includes("command")?"voice-commands":"realtime-transcription"))}}return{isSystemCommand:r,shouldRouteToService:o,serviceId:n,toolId:a,confidence:l,keywords:s}})}handleSystemCommand(e,t){return m(this,null,function*(){const t=e.toLowerCase();return t.includes("помощь")||t.includes("help")?{success:!0,message:this.getHelpMessage(),isSystemResponse:!0}:t.includes("очистить")||t.includes("clear")?(this.context.conversationHistory=[],{success:!0,message:"История разговора очищена",isSystemResponse:!0}):t.includes("настройки")||t.includes("settings")?yield this.routeToService(e,{serviceId:"settings",toolId:"open-preferences",shouldRouteToService:!0}):{success:!0,message:"Системная команда обработана",isSystemResponse:!0}})}routeToService(e,t){return m(this,null,function*(){if(!t.serviceId)return{success:!1,message:"Не удалось определить сервис для обработки",isSystemResponse:!0};try{const e=T.getService(t.serviceId);if(!e)return{success:!1,message:`Сервис ${t.serviceId} не найден`,isSystemResponse:!0};if(e.isLoaded||(yield T.loadService(t.serviceId)),t.toolId){const s=yield T.executeTool(t.serviceId,t.toolId);return{success:!0,message:`Сообщение обработано сервисом ${e.config.name}`,data:s,serviceId:t.serviceId,toolId:t.toolId,shouldRouteToService:!0}}const s=T.getChatFunctions().find(e=>e.isChatFunction);if(s){const r=yield T.executeTool(t.serviceId,s.id);return{success:!0,message:`Сообщение обработано сервисом ${e.config.name}`,data:r,serviceId:t.serviceId,toolId:s.id,shouldRouteToService:!0}}return{success:!0,message:`Сообщение получено сервисом ${e.config.name}`,serviceId:t.serviceId,shouldRouteToService:!0}}catch(e){return console.error("Service routing error:",e),{success:!1,message:`Ошибка при обращении к сервису: ${e instanceof Error?e.message:"Unknown error"}`,isSystemResponse:!0}}})}handleGeneralQueryWithContext(e,t,s){return m(this,null,function*(){if(s.attachedItems.length>0||s.activeProject){const t=this.buildContextInfo(s),i=`${e}\n\nКонтекст:\n${t}`;try{const e=T.getService("ai-assistant");if(e&&e.isLoaded)return{success:!0,message:`Запрос обработан с учетом контекста: ${s.contextSummary}`,serviceId:"ai-assistant",shouldRouteToService:!0,data:{enhancedMessage:i,contextInfo:t}}}catch(r){console.error("Ошибка маршрутизации к AI Assistant:",r)}}return yield this.handleGeneralQuery(e,t)})}buildContextInfo(e){const t=[];if(e.activeProject&&t.push(`Активный проект: ${e.activeProject.title}`),e.attachedItems.length>0){const s=e.attachedItems.map(e=>`${e.type}: ${e.title}${e.content?`\nСодержимое: ${e.content.substring(0,200)}...`:""}`).join("\n\n");t.push(`Прикрепленные элементы:\n${s}`)}return t.join("\n\n")}handleGeneralQuery(e,t){return m(this,null,function*(){return"workspace"===this.context.activeSection?{success:!0,message:"Сообщение получено центральным мозгом платформы",isSystemResponse:!0}:this.context.activeService?{success:!0,message:`Сообщение получено сервисом ${this.context.activeService}`,serviceId:this.context.activeService,shouldRouteToService:!0}:{success:!0,message:"Сообщение получено платформой",isSystemResponse:!0}})}updateContext(e,t){this.context.activeService=e,this.context.activeSection=t,this.context.lastActivity=new Date}extractKeywords(e){return e.split(/\s+/).filter(e=>e.length>2)}getHelpMessage(){return'🧠 **BARSUKOV PLATFORM - AI BRAIN**\n\nДоступные команды:\n\n🤖 **ChatGPT сервис**\n- "ChatGPT, помоги с..." - обращение к ChatGPT\n- "Переписать текст" - переписать с помощью GPT\n- "Краткое изложение" - создать краткое изложение\n- "Перевести текст" - перевод с помощью GPT\n\n🎤 **Whisper AI (Голосовой ввод)**\n- "Голосовой ввод" - начать голосовой ввод\n- "Транскрипция" - преобразовать речь в текст\n- "Голосовые команды" - обработать голосовые команды\n- Нажмите микрофон для живого голосового ввода\n\n⚙️ **Настройки**\n- "Настройки" - открыть настройки\n- "Сменить тему" - изменить тему оформления\n- "Настройки интерфейса" - настройки интерфейса\n- "Настройки уведомлений" - настройки уведомлений\n\n📁 **Рабочее пространство**\n- Общие вопросы обрабатываются центральным мозгом\n- Умное хранение всех данных\n- Автоматическая маршрутизация к сервисам\n\n🔧 **Системные команды**\n- "Помощь" - показать это сообщение\n- "Очистить" - очистить историю разговора\n\n💡 **Как это работает:**\n1. Отправляете сообщение в чат\n2. AI-мозг анализирует намерения\n3. Сообщение маршрутизируется к нужному сервису\n4. Получаете ответ от соответствующего сервиса\n\n🎯 **Советы:**\n- Будьте конкретны в запросах\n- Система понимает контекст и намерения\n- Команды работают на русском и английском языках'}addMessageToHistory(e){this.context.conversationHistory.push(e),this.context.conversationHistory.length>this.config.maxHistoryLength&&(this.context.conversationHistory=this.context.conversationHistory.slice(-this.config.maxHistoryLength))}getContext(){return l({},this.context)}updateConfig(e){this.config=l(l({},this.config),e)}clearContext(){this.context={activeService:null,activeSection:"workspace",conversationHistory:[],userPreferences:{},lastActivity:new Date}}},Qr={user:null,layout:{sidebarCollapsed:!1,sidebarWidth:Wr.DEFAULT_WIDTH,chatVisible:!0,chatWidth:Gr.DEFAULT_WIDTH,chatInputHeight:Gr.INPUT_DEFAULT_HEIGHT,workspaceLayout:"grid",activeService:null,activeTool:null,activeSection:"ai-lawyer",activeSettingsCategory:"all",activeWidgetsCategory:[],chatType:"default",expandedTabsHeight:0},services:[],activeChat:null,workspaceItems:[],settings:{theme:Vr.DARK,fontSize:Ur.MEDIUM,animations:!0,sidebarCollapsed:!1,useColoredText:!1,textColor:"#ffffff",accentsEnabled:!1,autoScroll:!0,hideChatFunctionButtons:!1,showTimestamps:!1},isLoading:!0,error:null,isInitialized:!1};function Kr(e,t){switch(t.type){case"SET_USER":return c(l({},e),{user:t.payload});case"SET_LOADING":return c(l({},e),{isLoading:t.payload});case"SET_ERROR":return c(l({},e),{error:t.payload});case"SET_INITIALIZED":return c(l({},e),{isInitialized:t.payload});case"SWITCH_SERVICE":{const s=t.payload,r=e.services.find(e=>e.config.id===s);return(null==r?void 0:r.config.theme)&&E.setTheme(`service-${s}`),c(l({},e),{layout:c(l({},e.layout),{activeService:t.payload,activeTool:null})})}case"SWITCH_TOOL":return c(l({},e),{layout:c(l({},e.layout),{activeTool:t.payload})});case"ADD_MESSAGE":return e.activeChat?c(l({},e),{activeChat:c(l({},e.activeChat),{messages:[...e.activeChat.messages,t.payload],updatedAt:new Date})}):e;case"CREATE_WORKSPACE_ITEM":{const r=t.payload;if(e.workspaceItems.find(e=>e.id===r.id))return e;const i=c(l({},r),{createdAt:r.createdAt instanceof Date?r.createdAt:new Date(r.createdAt),updatedAt:r.updatedAt instanceof Date?r.updatedAt:new Date(r.updatedAt)}),n=[...e.workspaceItems,i];try{localStorage.setItem("barsukov-workspace",JSON.stringify(n))}catch(s){}return c(l({},e),{workspaceItems:n})}case"REMOVE_WORKSPACE_ITEM":{const r=e.workspaceItems.find(e=>e.id===t.payload),i=e.workspaceItems.filter(e=>e.id!==t.payload);try{localStorage.setItem("barsukov-workspace",JSON.stringify(i))}catch(s){}const n=c(l({},e),{workspaceItems:i});return r&&_.info("Проект удалён",r.title,{duration:5e3,actions:[{label:"Отменить",action:()=>{const e=[...n.workspaceItems,r];try{localStorage.setItem("barsukov-workspace",JSON.stringify(e))}catch(s){}window.dispatchEvent(new CustomEvent("workspace:restore",{detail:r}))},variant:"primary"}]}),n}case"UPDATE_SETTINGS":{xr.setSetting(t.payload.key,t.payload.value);const s=c(l({},e),{settings:c(l({},e.settings),{[t.payload.key]:t.payload.value})});return"chatInputHeight"===t.payload.key&&(s.layout=c(l({},s.layout),{chatInputHeight:"number"==typeof t.payload.value?t.payload.value:300})),s}case"UPDATE_WORKSPACE_ITEM":{const{id:r,updates:i}=t.payload,n=e.workspaceItems.map(e=>e.id===r?c(l(l({},e),i),{updatedAt:new Date}):e);try{localStorage.setItem("barsukov-workspace",JSON.stringify(n))}catch(s){}return c(l({},e),{workspaceItems:n})}case"TOGGLE_SIDEBAR":return c(l({},e),{layout:c(l({},e.layout),{sidebarCollapsed:!e.layout.sidebarCollapsed})});case"TOGGLE_CHAT":return c(l({},e),{layout:c(l({},e.layout),{chatVisible:!e.layout.chatVisible})});case"SET_CHAT_TYPE":return c(l({},e),{layout:c(l({},e.layout),{chatType:t.payload})});case"SET_LAYOUT":return c(l({},e),{layout:l(l({},e.layout),t.payload)});case"SWITCH_SECTION":return c(l({},e),{layout:c(l({},e.layout),{activeSection:t.payload})});case"SET_ACTIVE_SETTINGS_CATEGORY":return c(l({},e),{layout:c(l({},e.layout),{activeSettingsCategory:t.payload})});case"SET_ACTIVE_WIDGETS_CATEGORY":return c(l({},e),{layout:c(l({},e.layout),{activeWidgetsCategory:t.payload})});case"SET_EXPANDED_TABS_HEIGHT":return c(l({},e),{layout:c(l({},e.layout),{expandedTabsHeight:t.payload})});case"ADD_SERVICE":{const s=e.services.findIndex(e=>e.config.id===t.payload.config.id);if(s>=0){const r=[...e.services];return r[s]=t.payload,c(l({},e),{services:r})}return c(l({},e),{services:[...e.services,t.payload]})}case"TOGGLE_SERVICE":return c(l({},e),{services:e.services.map(e=>e.config.id===t.payload?c(l({},e),{config:c(l({},e.config),{isActive:!e.config.isActive})}):e)});case"SET_ACTIVE_CHAT":return c(l({},e),{activeChat:t.payload});default:return e}}function Zr({children:e}){var t,s,i,n,a,o,d;const[h,p]=v.useReducer(Kr,Qr);v.useEffect(()=>{const e=e=>{const t=e.detail;t&&p({type:"CREATE_WORKSPACE_ITEM",payload:t})};return window.addEventListener("workspace:restore",e),()=>window.removeEventListener("workspace:restore",e)},[]),v.useEffect(()=>{h.isInitialized||(()=>{m(this,null,function*(){var e,t;try{p({type:"SET_LOADING",payload:!0});const[s,r,i]=yield Promise.all([Promise.resolve(localStorage.getItem("barsukov-user")),Promise.resolve(localStorage.getItem("barsukov-settings")),Promise.resolve(localStorage.getItem("barsukov-workspace"))]);if(s){const e=JSON.parse(s);p({type:"SET_USER",payload:e})}if(r){const e=JSON.parse(r),t={chatWidth:"chatWidth",chatInputHeight:"chatInputHeight",sidebarCollapsed:"sidebarCollapsed",sidebarWidth:"sidebarWidth",workspaceLayout:"workspaceLayout"};Object.entries(e).forEach(([e,s])=>{p({type:"UPDATE_SETTINGS",payload:{key:e,value:s}}),e in t&&p({type:"SET_LAYOUT",payload:{[t[e]]:s}})})}i&&JSON.parse(i).forEach(e=>{const t=c(l({},e),{createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)});p({type:"CREATE_WORKSPACE_ITEM",payload:t})}),yield T.loadAllServices(),T.getSortedServices().forEach(e=>{p({type:"ADD_SERVICE",payload:e})}),p({type:"SET_ACTIVE_CHAT",payload:{id:"default-chat",title:"Основной чат",messages:[],createdAt:new Date,updatedAt:new Date,isActive:!0}});const n=(null==(e=h.settings)?void 0:e.theme)||"light",a=null==(t=h.settings)?void 0:t.customColor;document.documentElement.setAttribute("data-theme",n),"custom"===n&&a?(pr.applyTheme("custom"),pr.setCustomColor(a)):pr.applyTheme(n),p({type:"SET_LOADING",payload:!1}),p({type:"SET_INITIALIZED",payload:!0})}catch(s){console.error("Ошибка инициализации платформы:",s),p({type:"SET_ERROR",payload:"Ошибка загрузки платформы"}),p({type:"SET_LOADING",payload:!1})}})})()},[null==(t=h.settings)?void 0:t.theme,null==(s=h.settings)?void 0:s.customColor]),v.useEffect(()=>{var e,t;const s=(null==(e=h.settings)?void 0:e.theme)||"dark",r=null==(t=h.settings)?void 0:t.customColor;document.documentElement.setAttribute("data-theme",s),"custom"===s&&r?(pr.applyTheme("custom"),pr.setCustomColor(r)):pr.applyTheme(s)},[null==(i=h.settings)?void 0:i.theme,null==(n=h.settings)?void 0:n.customColor]),v.useEffect(()=>{var e;const t=(null==(e=h.settings)?void 0:e.fontSize)||"medium";document.documentElement.setAttribute("data-font-size",t)},[null==(a=h.settings)?void 0:a.fontSize]),v.useEffect(()=>{var e;const t=null==(e=h.settings)?void 0:e.animations;E.queueThemeChange({type:"animation",key:"enabled",value:t?"true":"false"}),document.documentElement.setAttribute("data-animations",t?"on":"off")},[null==(o=h.settings)?void 0:o.animations]),v.useEffect(()=>{try{h.user&&localStorage.setItem("barsukov-user",JSON.stringify(h.user)),localStorage.setItem("barsukov-settings",JSON.stringify(h.settings)),localStorage.setItem("barsukov-workspace",JSON.stringify(h.workspaceItems))}catch(e){console.error("Ошибка сохранения в localStorage:",e)}},[h.user,h.settings,h.workspaceItems]);const g=v.useCallback(e=>{p({type:"SWITCH_SERVICE",payload:e})},[]),x=v.useCallback(e=>{p({type:"SWITCH_TOOL",payload:e})},[]),f=v.useCallback(e=>m(this,null,function*(){const t={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:e,sender:"user",timestamp:new Date,type:"text"};p({type:"ADD_MESSAGE",payload:t}),qr.addMessageToHistory(t);try{const t=yield qr.processMessage(e,h.layout.activeService,h.layout.activeSection),s={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:t.message,sender:t.isSystemResponse?"system":"assistant",timestamp:new Date,type:"text"};p({type:"ADD_MESSAGE",payload:s}),qr.addMessageToHistory(s),t.shouldRouteToService&&t.serviceId&&p({type:"SWITCH_SERVICE",payload:t.serviceId})}catch(s){console.error("AI Brain processing error:",s);const e={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:"Произошла ошибка при обработке сообщения. Попробуйте еще раз.",sender:"system",timestamp:new Date,type:"text"};p({type:"ADD_MESSAGE",payload:e})}}),[h.layout.activeService,h.layout.activeSection]),y=v.useCallback(e=>{h.workspaceItems.find(t=>t.id===e.id)?console.warn("Элемент с таким ID уже существует:",e.id):p({type:"CREATE_WORKSPACE_ITEM",payload:e})},[h.workspaceItems]),b=v.useCallback((e,t)=>{p({type:"UPDATE_SETTINGS",payload:{key:e,value:t}});const s={chatWidth:"chatWidth",sidebarCollapsed:"sidebarCollapsed",sidebarWidth:"sidebarWidth",workspaceLayout:"workspaceLayout"};e in s&&p({type:"SET_LAYOUT",payload:{[s[e]]:t}})},[]),j=v.useCallback(()=>{p({type:"TOGGLE_SIDEBAR"})},[]),w=v.useCallback(()=>{p({type:"TOGGLE_CHAT"})},[]),N=v.useCallback(e=>{p({type:"SET_CHAT_TYPE",payload:e})},[]),k=v.useCallback(e=>{p({type:"SWITCH_SECTION",payload:e}),setTimeout(()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0)},[]),S=v.useCallback(e=>{p({type:"SET_ACTIVE_SETTINGS_CATEGORY",payload:e})},[]),C=v.useCallback(e=>{p({type:"SET_EXPANDED_TABS_HEIGHT",payload:e})},[]),I=v.useCallback(e=>{p({type:"TOGGLE_SERVICE",payload:e}),setTimeout(()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0)},[]),A=v.useCallback((e,t)=>m(this,null,function*(){var s;try{if("settings"===e){if("open-preferences"===t||"appearance"===t||"interface"===t||"chat"===t||"notifications"===t){const e="open-preferences"===t?"appearance":t;return p({type:"SWITCH_SECTION",payload:"settings"}),p({type:"UPDATE_SETTINGS",payload:{key:"selectedSettingsCategory",value:e}}),setTimeout(()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),{success:!0,message:"Открыты настройки",data:{section:e}}}if("toggle-theme"===t){const e="dark"===((null==(s=h.settings)?void 0:s.theme)||"dark")?"light":"dark";return p({type:"UPDATE_SETTINGS",payload:{key:"theme",value:e}}),{success:!0,message:`Тема переключена: ${e}`,data:{theme:e}}}}return yield T.executeTool(e,t)}catch(r){throw console.error("Ошибка выполнения инструмента:",r),r}}),[null==(d=h.settings)?void 0:d.theme]),M=v.useMemo(()=>({state:h,dispatch:p,switchService:g,switchTool:x,sendMessage:f,createWorkspaceItem:y,updateSettings:b,toggleSidebar:j,toggleChat:w,setChatType:N,switchSection:k,setActiveSettingsCategory:S,setExpandedTabsHeight:C,toggleService:I,executeServiceTool:A}),[h,p,g,x,f,y,b,j,w,N,k,S,C,I,A]);return u.jsx(r.Provider,{value:M,children:e})}const Yr=()=>{const[e,t]=v.useState(!1),[s,r]=v.useState("hero");v.useEffect(()=>{const e=()=>{const e=["hero","features","products","pricing","testimonials","contact"],t=window.scrollY+100;for(const s of e){const e=document.getElementById(s);if(e&&e.offsetTop<=t&&e.offsetTop+e.offsetHeight>t){r(s);break}}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);const i=e=>{const s=document.getElementById(e);s&&s.scrollIntoView({behavior:"smooth"}),t(!1)};return u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:[u.jsxs("nav",{className:"fixed top-0 w-full z-50 bg-black/20 backdrop-blur-md border-b border-white/10",children:[u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center h-16",children:[u.jsx("div",{className:"flex items-center",children:u.jsx("div",{className:"flex-shrink-0",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:u.jsx(Oe,{className:"w-5 h-5 text-white"})}),u.jsx("span",{className:"text-xl font-bold text-white",children:"Boss AI"})]})})}),u.jsx("div",{className:"hidden md:block",children:u.jsx("div",{className:"ml-10 flex items-baseline space-x-8",children:[{id:"hero",label:"Главная"},{id:"features",label:"Возможности"},{id:"products",label:"Продукты"},{id:"pricing",label:"Цены"},{id:"testimonials",label:"Отзывы"},{id:"contact",label:"Контакты"}].map(e=>u.jsx("button",{onClick:()=>i(e.id),className:"px-3 py-2 rounded-md text-sm font-medium transition-colors "+(s===e.id?"text-purple-400 bg-purple-900/30":"text-gray-300 hover:text-white hover:bg-white/10"),children:e.label},e.id))})}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("button",{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-2 rounded-lg font-medium hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105",children:"Попробовать бесплатно"}),u.jsx("button",{className:"md:hidden text-white",onClick:()=>t(!e),"aria-label":"Открыть меню",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]})}),e&&u.jsx("div",{className:"md:hidden bg-black/50 backdrop-blur-md border-t border-white/10",children:u.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[{id:"hero",label:"Главная"},{id:"features",label:"Возможности"},{id:"products",label:"Продукты"},{id:"pricing",label:"Цены"},{id:"testimonials",label:"Отзывы"},{id:"contact",label:"Контакты"}].map(e=>u.jsx("button",{onClick:()=>i(e.id),className:"block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10 w-full text-left",children:e.label},e.id))})})]}),u.jsx("section",{id:"hero",className:"pt-20 pb-16 px-4 sm:px-6 lg:px-8",children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsxs("div",{className:"text-center",children:[u.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-white mb-6",children:[u.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Boss AI"}),u.jsx("br",{}),u.jsx("span",{className:"text-white",children:"Платформа будущего"})]}),u.jsx("p",{className:"text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto",children:"Автоматизируйте продажи, маркетинг и бизнес-процессы с помощью искусственного интеллекта. Увеличьте выручку на 40-60% за первые 3 месяца."}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-12",children:[u.jsxs("button",{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 flex items-center space-x-2",children:[u.jsx("span",{children:"Начать бесплатно"}),u.jsx(Me,{className:"w-5 h-5"})]}),u.jsxs("button",{className:"border border-white/30 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-white/10 transition-all duration-300 flex items-center space-x-2",children:[u.jsx(Tt,{className:"w-5 h-5"}),u.jsx("span",{children:"Смотреть демо"})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-8 text-gray-400",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Kt,{className:"w-5 h-5"}),u.jsx("span",{children:"2,000+ клиентов"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Vt,{className:"w-5 h-5"}),u.jsx("span",{children:"+40% рост продаж"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Re,{className:"w-5 h-5"}),u.jsx("span",{children:"Топ-1 AI платформа"})]})]})]})})}),u.jsx("section",{id:"features",className:"py-20 px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Почему выбирают Boss AI?"}),u.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Единственная платформа, которая объединяет AI, CRM, маркетинг и продажи в единую экосистему"})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[{icon:Oe,title:"AI-ассистент 24/7",description:"Интеллектуальный помощник обрабатывает 80% рутинных запросов автоматически"},{icon:Wt,title:"Умная CRM",description:"AI-скоринг лидов, автоматические воронки продаж и персонализированные рекомендации"},{icon:ss,title:"Маркетинг-автоматизация",description:"Email-кампании, лид-магниты, ретаргетинг и A/B тестирование на одной платформе"},{icon:qe,title:"Готовые продукты",description:"Ozon-инструменты, TikTik-аналог и другие готовые решения для быстрого заработка"},{icon:st,title:"Международные платежи",description:"Поддержка РФ и зарубежных рынков с разными ценами и платежными системами"},{icon:Bt,title:"152-ФЗ compliance",description:"Полное соответствие российскому законодательству о защите персональных данных"}].map((e,t)=>u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10 hover:bg-white/10 transition-all duration-300",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center mb-4",children:u.jsx(e.icon,{className:"w-6 h-6 text-white"})}),u.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:e.title}),u.jsx("p",{className:"text-gray-300",children:e.description})]},t))})]})}),u.jsx("section",{id:"products",className:"py-20 px-4 sm:px-6 lg:px-8 bg-black/20",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Наши продукты"}),u.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"От готовых инструментов до полной автоматизации бизнеса"})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"bg-gradient-to-br from-purple-900/50 to-pink-900/50 rounded-2xl p-8 border border-purple-500/30",children:[u.jsxs("div",{className:"flex items-center mb-6",children:[u.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mr-4",children:u.jsx(Oe,{className:"w-8 h-8 text-white"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-bold text-white",children:"Boss AI Platform"}),u.jsx("p",{className:"text-purple-300",children:"Основная платформа"})]})]}),u.jsx("p",{className:"text-gray-300 mb-6",children:"Модульная AI-платформа с CRM, воронками продаж, маркетинг-автоматизацией и готовыми интеграциями. Все в одном месте."}),u.jsx("div",{className:"space-y-3 mb-6",children:["AI-ассистент с умной маршрутизацией","CRM с AI-скорингом лидов","Автоматические воронки продаж","Email и SMS маркетинг","Аналитика в реальном времени","Интеграция с 50+ сервисами"].map((e,t)=>u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ze,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),u.jsx("span",{className:"text-gray-300",children:e})]},t))}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-white",children:"от $49/мес"}),u.jsx("div",{className:"text-sm text-gray-400",children:"14 дней бесплатно"})]}),u.jsx("button",{className:"bg-white text-purple-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Попробовать"})]})]}),u.jsxs("div",{className:"bg-gradient-to-br from-blue-900/50 to-cyan-900/50 rounded-2xl p-8 border border-blue-500/30",children:[u.jsxs("div",{className:"flex items-center mb-6",children:[u.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center mr-4",children:u.jsx(Wt,{className:"w-8 h-8 text-white"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-bold text-white",children:"Ozon-инструменты"}),u.jsx("p",{className:"text-blue-300",children:"Готовые продукты"})]})]}),u.jsx("p",{className:"text-gray-300 mb-6",children:"Набор инструментов для автоматизации работы с Ozon: автоудаление из архива, управление акциями, оптимизация каталога."}),u.jsx("div",{className:"space-y-3 mb-6",children:["Автоудаление из архива","Автоудаление из акций","Раскладчик товаров","AI-рекомендации по позиционированию","Аналитика продаж","Интеграция с Ozon API"].map((e,t)=>u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ze,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),u.jsx("span",{className:"text-gray-300",children:e})]},t))}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-white",children:"от $99"}),u.jsx("div",{className:"text-sm text-gray-400",children:"Разовая покупка"})]}),u.jsx("button",{className:"bg-white text-blue-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Купить"})]})]})]})]})}),u.jsx("section",{id:"pricing",className:"py-20 px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Выберите свой план"}),u.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Гибкие тарифы для бизнеса любого размера"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Базовый"}),u.jsx("p",{className:"text-gray-400",children:"Для малого бизнеса"}),u.jsxs("div",{className:"mt-4",children:[u.jsx("span",{className:"text-4xl font-bold text-white",children:"$49"}),u.jsx("span",{className:"text-gray-400",children:"/мес"})]})]}),u.jsx("div",{className:"space-y-4 mb-8",children:["10 AI-запросов в день","CRM до 100 контактов","Базовые воронки продаж","Email поддержка","Мобильное приложение"].map((e,t)=>u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ze,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),u.jsx("span",{className:"text-gray-300",children:e})]},t))}),u.jsx("button",{className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300",children:"Начать бесплатно"})]}),u.jsxs("div",{className:"bg-gradient-to-br from-purple-900/50 to-pink-900/50 rounded-2xl p-8 border border-purple-500/50 relative",children:[u.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:u.jsx("span",{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-4 py-2 rounded-full text-sm font-semibold",children:"Популярный"})}),u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Профессиональный"}),u.jsx("p",{className:"text-gray-400",children:"Для растущего бизнеса"}),u.jsxs("div",{className:"mt-4",children:[u.jsx("span",{className:"text-4xl font-bold text-white",children:"$149"}),u.jsx("span",{className:"text-gray-400",children:"/мес"})]})]}),u.jsx("div",{className:"space-y-4 mb-8",children:["Безлимитные AI-запросы","CRM до 10,000 контактов","Продвинутые воронки продаж","Email и SMS маркетинг","Приоритетная поддержка","Интеграции с 50+ сервисами","Аналитика и отчеты","Командная работа"].map((e,t)=>u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ze,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),u.jsx("span",{className:"text-gray-300",children:e})]},t))}),u.jsx("button",{className:"w-full bg-white text-purple-600 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Попробовать бесплатно"})]}),u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Корпоративный"}),u.jsx("p",{className:"text-gray-400",children:"Для крупных компаний"}),u.jsxs("div",{className:"mt-4",children:[u.jsx("span",{className:"text-4xl font-bold text-white",children:"$499"}),u.jsx("span",{className:"text-gray-400",children:"/мес"})]})]}),u.jsx("div",{className:"space-y-4 mb-8",children:["Все функции Pro","Белый лейбл","Кастомные интеграции","Выделенный менеджер","SLA 99.9%","Обучение команды","Приоритетная разработка","24/7 поддержка"].map((e,t)=>u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ze,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),u.jsx("span",{className:"text-gray-300",children:e})]},t))}),u.jsx("button",{className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300",children:"Связаться с нами"})]})]})]})}),u.jsx("section",{id:"testimonials",className:"py-20 px-4 sm:px-6 lg:px-8 bg-black/20",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Что говорят наши клиенты"}),u.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Более 2,000 компаний уже увеличили продажи с Boss AI"})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[{name:"Александр Петров",company:"CEO, TechStart",content:"Boss AI помог нам увеличить конверсию на 47% за 3 месяца. AI-ассистент обрабатывает 80% запросов автоматически.",rating:5},{name:"Мария Сидорова",company:"Маркетинг-директор, RetailPro",content:"Лучшая CRM, которую мы использовали. Автоматические воронки продаж экономят нам 15 часов в неделю.",rating:5},{name:"Дмитрий Козлов",company:"Основатель, E-commerce Plus",content:"Ozon-инструменты от Boss AI увеличили наши продажи на 35%. Окупились за первый месяц.",rating:5}].map((e,t)=>u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[u.jsx("div",{className:"flex items-center mb-4",children:[...Array(e.rating)].map((e,t)=>u.jsx(Ht,{className:"w-5 h-5 text-yellow-400 fill-current"},t))}),u.jsxs("p",{className:"text-gray-300 mb-4 italic",children:['"',e.content,'"']}),u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-white",children:e.name}),u.jsx("div",{className:"text-sm text-gray-400",children:e.company})]})]},t))})]})}),u.jsx("section",{id:"contact",className:"py-20 px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"text-center mb-16",children:[u.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Готовы начать?"}),u.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Свяжитесь с нами или начните бесплатный пробный период прямо сейчас"})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-bold text-white mb-6",children:"Свяжитесь с нами"}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:u.jsx(mt,{className:"w-6 h-6 text-white"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-semibold",children:"Email"}),u.jsx("div",{className:"text-gray-400",children:"hello@bossai.ru"})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:u.jsx(It,{className:"w-6 h-6 text-white"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-semibold",children:"Телефон"}),u.jsx("div",{className:"text-gray-400",children:"+7 (495) 123-45-67"})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:u.jsx(ht,{className:"w-6 h-6 text-white"})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-semibold",children:"Адрес"}),u.jsx("div",{className:"text-gray-400",children:"Москва, ул. Тверская, 1"})]})]})]})]}),u.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10",children:u.jsxs("form",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Имя"}),u.jsx("input",{type:"text",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Ваше имя"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Email"}),u.jsx("input",{type:"email",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"your@email.com"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Компания"}),u.jsx("input",{type:"text",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Название компании"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Сообщение"}),u.jsx("textarea",{rows:4,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Расскажите о ваших задачах..."})]}),u.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300",children:"Отправить сообщение"})]})})]})]})}),u.jsx("footer",{className:"bg-black/50 border-t border-white/10 py-12 px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:u.jsx(Oe,{className:"w-5 h-5 text-white"})}),u.jsx("span",{className:"text-xl font-bold text-white",children:"Boss AI"})]}),u.jsx("p",{className:"text-gray-400 mb-4",children:"Платформа будущего для автоматизации бизнеса с помощью искусственного интеллекта."})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-white font-semibold mb-4",children:"Продукты"}),u.jsx("ul",{className:"space-y-2",children:["Boss AI Platform","Ozon-инструменты","TikTok-аналог","Маркетплейс"].map(e=>u.jsx("li",{children:u.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-white font-semibold mb-4",children:"Поддержка"}),u.jsx("ul",{className:"space-y-2",children:["Документация","База знаний","API","Статус системы"].map(e=>u.jsx("li",{children:u.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-white font-semibold mb-4",children:"Компания"}),u.jsx("ul",{className:"space-y-2",children:["О нас","Карьера","Блог","Контакты"].map(e=>u.jsx("li",{children:u.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]})]}),u.jsx("div",{className:"border-t border-white/10 mt-8 pt-8 text-center text-gray-400",children:u.jsx("p",{children:"© 2025 Boss AI. Все права защищены."})})]})})]})},Jr=new class{constructor(){this.widgets=new Map,this.widgetTypes=new Map,this.nextZIndex=1e3,this.isEnabled=!0,this.initializeDefaultWidgets()}initializeDefaultWidgets(){this.registerWidgetType({id:"time-widget",name:"Часы",description:"Отображает текущее время и дату",icon:"Clock",category:"utility",defaultSize:{width:200,height:120},minSize:{width:150,height:80},maxSize:{width:300,height:200},component:()=>null,settings:[{id:"show-seconds",name:"Показывать секунды",type:"boolean",defaultValue:!0,description:"Отображать секунды в часах"},{id:"show-date",name:"Показывать дату",type:"boolean",defaultValue:!0,description:"Отображать дату под временем"},{id:"format24h",name:"24-часовой формат",type:"boolean",defaultValue:!0,description:"Использовать 24-часовой формат времени"}]}),this.registerWidgetType({id:"voice-widget",name:"Голосовой ввод",description:"Быстрый доступ к голосовому вводу",icon:"Mic",category:"input",defaultSize:{width:180,height:100},minSize:{width:120,height:60},maxSize:{width:250,height:150},component:()=>null,settings:[{id:"auto-start",name:"Автозапуск",type:"boolean",defaultValue:!1,description:"Автоматически начинать запись при открытии"},{id:"show-transcription",name:"Показывать транскрипцию",type:"boolean",defaultValue:!0,description:"Отображать транскрибированный текст"}]})}registerWidgetType(e){this.widgetTypes.set(e.id,e)}createWidget(e,t={}){const s=this.widgetTypes.get(e);if(!s)throw new Error(`Widget type ${e} not found`);const r=l({id:`widget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:e,title:s.name,description:s.description,icon:s.icon,serviceId:t.serviceId,position:t.position||{x:100,y:100},size:t.size||l({},s.defaultSize),isMinimized:!1,isVisible:!0,isDraggable:!0,isResizable:!0,zIndex:this.nextZIndex++,settings:this.initializeWidgetSettings(s.settings),component:s.component},t);return this.widgets.set(r.id,r),r}initializeWidgetSettings(e){const t={};return e.forEach(e=>{t[e.id]=e.defaultValue}),t}getWidget(e){return this.widgets.get(e)}getAllWidgets(){return Array.from(this.widgets.values())}getVisibleWidgets(){return Array.from(this.widgets.values()).filter(e=>e.isVisible)}getWidgetTypes(){return Array.from(this.widgetTypes.values())}getWidgetTypesByCategory(e){return Array.from(this.widgetTypes.values()).filter(t=>t.category===e)}updateWidget(e,t){const s=this.widgets.get(e);s&&Object.assign(s,t)}moveWidget(e,t){this.updateWidget(e,{position:t})}resizeWidget(e,t){const s=this.widgets.get(e);if(s){const r=this.widgetTypes.get(s.type);if(r){const s={width:Math.max(r.minSize.width,Math.min(r.maxSize.width,t.width)),height:Math.max(r.minSize.height,Math.min(r.maxSize.height,t.height))};this.updateWidget(e,{size:s})}}}toggleMinimize(e){const t=this.widgets.get(e);t&&this.updateWidget(e,{isMinimized:!t.isMinimized})}toggleVisibility(e){const t=this.widgets.get(e);t&&this.updateWidget(e,{isVisible:!t.isVisible})}bringToFront(e){this.updateWidget(e,{zIndex:this.nextZIndex++})}removeWidget(e){this.widgets.delete(e)}clearAllWidgets(){this.widgets.clear()}setEnabled(e){this.isEnabled=e}isWidgetsEnabled(){return this.isEnabled}exportConfig(){const e={widgets:Array.from(this.widgets.values()).map(e=>({id:e.id,type:e.type,title:e.title,position:e.position,size:e.size,isMinimized:e.isMinimized,isVisible:e.isVisible,settings:e.settings})),widgetTypes:Array.from(this.widgetTypes.values())};return JSON.stringify(e,null,2)}importConfig(e){try{const t=JSON.parse(e);if(t.widgets)for(const e of t.widgets)this.widgetTypes.get(e.type)&&this.createWidget(e.type,e)}catch(t){console.error("Error importing widgets config:",t)}}},Xr=new class{constructor(e){this.metrics=[],this.observer=null,this.reportingInterval=null,this.config=e,this.sessionId=this.generateSessionId(),this.initializeMonitoring()}initializeMonitoring(){"undefined"!=typeof window&&window.performance&&(this.config.enableNavigationTiming&&this.collectNavigationMetrics(),this.config.enableResourceTiming&&this.setupResourceObserver(),this.config.enablePaintTiming&&this.setupPaintObserver(),this.config.enableLayoutTiming&&this.setupLayoutObserver(),this.config.enableScriptTiming&&this.setupScriptObserver(),this.config.enableReporting&&this.setupReporting())}collectNavigationMetrics(){const e=performance.getEntriesByType("navigation")[0];if(e){const t=[{id:this.generateMetricId(),name:"DOMContentLoaded",value:e.domContentLoadedEventEnd-e.domContentLoadedEventStart,unit:"ms",timestamp:new Date,category:"navigation"},{id:this.generateMetricId(),name:"LoadComplete",value:e.loadEventEnd-e.loadEventStart,unit:"ms",timestamp:new Date,category:"navigation"},{id:this.generateMetricId(),name:"FirstByte",value:e.responseStart-e.requestStart,unit:"ms",timestamp:new Date,category:"navigation"},{id:this.generateMetricId(),name:"DOMInteractive",value:e.domInteractive-e.fetchStart,unit:"ms",timestamp:new Date,category:"navigation"}];this.addMetrics(t)}}setupResourceObserver(){window.PerformanceObserver&&(this.observer=new PerformanceObserver(e=>{const t=e.getEntries(),s=[];t.forEach(e=>{this.shouldSample()&&s.push({id:this.generateMetricId(),name:`Resource_${e.name.split("/").pop()}`,value:e.duration,unit:"ms",timestamp:new Date,category:"resource",metadata:{resourceType:e.initiatorType||"unknown",resourceSize:e.transferSize||0}})}),this.addMetrics(s)}),this.observer.observe({entryTypes:["resource"]}))}setupPaintObserver(){window.PerformanceObserver&&new PerformanceObserver(e=>{const t=e.getEntries(),s=[];t.forEach(e=>{this.shouldSample()&&s.push({id:this.generateMetricId(),name:e.name,value:e.startTime,unit:"ms",timestamp:new Date,category:"paint"})}),this.addMetrics(s)}).observe({entryTypes:["paint"]})}setupLayoutObserver(){window.PerformanceObserver&&new PerformanceObserver(e=>{const t=e.getEntries(),s=[];t.forEach(e=>{this.shouldSample()&&s.push({id:this.generateMetricId(),name:"LayoutShift",value:e.value,unit:"count",timestamp:new Date,category:"layout",metadata:{hadRecentInput:e.hadRecentInput}})}),this.addMetrics(s)}).observe({entryTypes:["layout-shift"]})}setupScriptObserver(){window.PerformanceObserver&&new PerformanceObserver(e=>{const t=e.getEntries(),s=[];t.forEach(e=>{this.shouldSample()&&s.push({id:this.generateMetricId(),name:"ScriptExecution",value:e.duration,unit:"ms",timestamp:new Date,category:"script",metadata:{scriptName:e.name}})}),this.addMetrics(s)}).observe({entryTypes:["measure","mark"]})}addCustomMetric(e,t,s,r){if(!this.config.enableCustomMetrics)return;const i={id:this.generateMetricId(),name:e,value:t,unit:s,timestamp:new Date,category:"custom",metadata:r};this.addMetrics([i])}measureFunction(e,t){const s=performance.now(),r=t(),i=performance.now();return this.addCustomMetric(`Function_${e}`,i-s,"ms"),r}measureAsyncFunction(e,t){return m(this,null,function*(){const s=performance.now(),r=yield t(),i=performance.now();return this.addCustomMetric(`AsyncFunction_${e}`,i-s,"ms"),r})}getMetrics(){return[...this.metrics]}getMetricsByCategory(e){return this.metrics.filter(t=>t.category===e)}getMetricsByName(e){return this.metrics.filter(t=>t.name===e)}getPerformanceStats(){var e;const t=this.getMetricsByName("LoadComplete"),s=this.getMetricsByCategory("paint"),r=this.getMetricsByCategory("resource"),i=t.length>0?t.reduce((e,t)=>e+t.value,0)/t.length:0,n=s.length>0?s.reduce((e,t)=>e+t.value,0)/s.length:0,a=(null==(e=performance.memory)?void 0:e.usedJSHeapSize)||0,o=r.sort((e,t)=>e.value-t.value),l=o.slice(-5),c=o.slice(0,5);return{totalMetrics:this.metrics.length,averageLoadTime:i,averageRenderTime:n,memoryUsage:a,slowestResources:l,fastestResources:c}}generateReport(){const e=this.getPerformanceStats();return{sessionId:this.sessionId,timestamp:new Date,metrics:this.metrics,summary:{totalMetrics:e.totalMetrics,averageLoadTime:e.averageLoadTime,averageRenderTime:e.averageRenderTime,memoryUsage:e.memoryUsage,errorCount:0}}}clearMetrics(){this.metrics=[]}stopMonitoring(){this.observer&&(this.observer.disconnect(),this.observer=null),this.reportingInterval&&(clearInterval(this.reportingInterval),this.reportingInterval=null)}addMetrics(e){this.metrics.length>=this.config.maxMetricsPerSession||this.metrics.push(...e)}shouldSample(){return Math.random()<this.config.sampleRate}setupReporting(){this.config.reportingEndpoint&&(this.reportingInterval=setInterval(()=>{const e=this.generateReport();this.sendReport(e)},this.config.reportingInterval))}sendReport(e){return m(this,null,function*(){if(this.config.reportingEndpoint)try{yield fetch(this.config.reportingEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){console.error("Failed to send performance report:",t)}})}generateSessionId(){return`perf_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateMetricId(){return`metric_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}({enableNavigationTiming:!0,enableResourceTiming:!0,enablePaintTiming:!0,enableLayoutTiming:!0,enableScriptTiming:!0,enableCustomMetrics:!0,sampleRate:.1,maxMetricsPerSession:1e3,enableReporting:!1,reportingInterval:6e4}),ei=new class{constructor(e){this.currentSession=null,this.sessions=[],this.events=[],this.reportingInterval=null,this.sessionTimeout=null,this.config=e,this.initializeTracking()}initializeTracking(){this.config.enableTracking&&(this.config.enableSessionTracking&&this.startSession(),this.config.enablePageTracking&&this.setupPageTracking(),this.config.enableServiceTracking&&this.setupServiceTracking(),this.config.enableReporting&&this.setupReporting(),this.setupSessionTimeout())}startSession(){this.currentSession&&this.endSession(),this.currentSession={id:this.generateSessionId(),startTime:new Date,events:[],userAgent:navigator.userAgent,referrer:document.referrer,pageViews:0,interactions:0},this.sessions.push(this.currentSession),this.resetSessionTimeout()}endSession(){this.currentSession&&(this.currentSession.endTime=new Date,this.currentSession.duration=this.currentSession.endTime.getTime()-this.currentSession.startTime.getTime(),this.currentSession=null,this.sessionTimeout&&(clearTimeout(this.sessionTimeout),this.sessionTimeout=null))}trackEvent(e,t,s,r,i){if(!this.config.enableEventTracking||!this.currentSession)return;const n={id:this.generateEventId(),type:e,action:t,component:s,service:r,timestamp:new Date,sessionId:this.currentSession.id,metadata:i};this.events.push(n),this.currentSession.events.push(n),this.currentSession.interactions++,this.currentSession.events.length>=this.config.maxEventsPerSession&&(this.endSession(),this.startSession())}trackPageView(e,t){this.config.enablePageTracking&&(this.trackEvent("page","view",void 0,void 0,l({page:e},t)),this.currentSession&&this.currentSession.pageViews++)}trackServiceUsage(e,t,s){this.config.enableServiceTracking&&this.trackEvent("service",t,void 0,e,s)}trackComponentInteraction(e,t,s){this.trackEvent("component",t,e,void 0,s)}trackError(e,t,s,r){this.trackEvent("error","occurred",t,s,l({errorMessage:e.message,errorStack:e.stack,errorName:e.name},r))}trackPerformance(e,t,s,r){this.trackEvent("performance",e,void 0,void 0,l({value:t,unit:s},r))}getUsageStats(){const e=this.sessions.length,t=this.events.length,s=e>0?this.sessions.reduce((e,t)=>e+(t.duration||0),0)/e:0,r=new Map;this.events.forEach(e=>{e.component&&r.set(e.component,(r.get(e.component)||0)+1)});const i=Array.from(r.entries()).map(([e,t])=>({component:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10),n=new Map;this.events.forEach(e=>{e.service&&n.set(e.service,(n.get(e.service)||0)+1)});const a=Array.from(n.entries()).map(([e,t])=>({service:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10),o=new Map;this.events.forEach(e=>{o.set(e.action,(o.get(e.action)||0)+1)});const l=Array.from(o.entries()).map(([e,t])=>({action:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10),c=new Date,d=new Date(c.getTime()-864e5),m=new Date(c.getTime()-6048e5),h=new Date(c.getTime()-2592e6);return{totalSessions:e,totalEvents:t,averageSessionDuration:s,mostUsedComponents:i,mostUsedServices:a,popularActions:l,userEngagement:{dailyActiveUsers:new Set(this.sessions.filter(e=>e.startTime>=d).map(e=>e.userId).filter(Boolean)).size,weeklyActiveUsers:new Set(this.sessions.filter(e=>e.startTime>=m).map(e=>e.userId).filter(Boolean)).size,monthlyActiveUsers:new Set(this.sessions.filter(e=>e.startTime>=h).map(e=>e.userId).filter(Boolean)).size}}}getEventsByType(e){return this.events.filter(t=>t.type===e)}getEventsByComponent(e){return this.events.filter(t=>t.component===e)}getEventsByService(e){return this.events.filter(t=>t.service===e)}getUserSessions(e){return this.sessions.filter(t=>t.userId===e)}clearData(){this.events=[],this.sessions=[],this.currentSession&&(this.currentSession.events=[])}stopTracking(){this.endSession(),this.reportingInterval&&(clearInterval(this.reportingInterval),this.reportingInterval=null),this.sessionTimeout&&(clearTimeout(this.sessionTimeout),this.sessionTimeout=null)}setupPageTracking(){let e=window.location.href;const t=()=>{window.location.href!==e&&(e=window.location.href,this.trackPageView(e))};window.addEventListener("popstate",t);const s=history.pushState,r=history.replaceState;history.pushState=function(...e){s.apply(history,e),t()},history.replaceState=function(...e){r.apply(history,e),t()}}setupServiceTracking(){}setupReporting(){this.config.reportingEndpoint&&(this.reportingInterval=setInterval(()=>{this.sendReport()},this.config.reportingInterval))}setupSessionTimeout(){this.resetSessionTimeout()}resetSessionTimeout(){this.sessionTimeout&&clearTimeout(this.sessionTimeout),this.sessionTimeout=setTimeout(()=>{this.endSession(),this.startSession()},this.config.sessionTimeout)}sendReport(){return m(this,null,function*(){if(!this.config.reportingEndpoint)return;const e={sessions:this.sessions,events:this.events,stats:this.getUsageStats(),timestamp:new Date};try{yield fetch(this.config.reportingEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){console.error("Failed to send analytics report:",t)}})}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateEventId(){return`event_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}({enableTracking:!0,enableSessionTracking:!0,enableEventTracking:!0,enableUserTracking:!0,enablePageTracking:!0,enableServiceTracking:!0,sessionTimeout:18e5,maxEventsPerSession:1e3,enableReporting:!1,reportingInterval:3e5,enableLocalStorage:!0,enableCookies:!1}),ti=v.memo(()=>{const e=i(),{state:t,updateSettings:s,switchSection:r}=e;v.useEffect(()=>{Jr.registerWidgetType({id:"time-widget",name:"Часы",description:"Отображает текущее время и дату",icon:"Clock",category:"utility",defaultSize:{width:200,height:120},minSize:{width:150,height:80},maxSize:{width:300,height:200},component:$r,settings:[{id:"show-seconds",name:"Показывать секунды",type:"boolean",defaultValue:!0,description:"Отображать секунды в часах"},{id:"show-date",name:"Показывать дату",type:"boolean",defaultValue:!0,description:"Отображать дату под временем"},{id:"format24h",name:"24-часовой формат",type:"boolean",defaultValue:!0,description:"Использовать 24-часовой формат времени"}]}),Jr.registerWidgetType({id:"voice-widget",name:"Голосовой ввод",description:"Быстрый доступ к голосовому вводу",icon:"Mic",category:"input",defaultSize:{width:180,height:100},minSize:{width:120,height:60},maxSize:{width:250,height:150},component:_r,settings:[{id:"auto-start",name:"Автозапуск",type:"boolean",defaultValue:!1,description:"Автоматически начинать запись при открытии"},{id:"show-transcription",name:"Показывать транскрипцию",type:"boolean",defaultValue:!0,description:"Отображать транскрибированный текст"}]}),console.log("Widgets initialized successfully")},[]),v.useEffect(()=>{Gs.restoreAccentSet()},[]),v.useEffect(()=>{ei.startSession(),ei.trackPageView(window.location.href),Xr.addCustomMetric("AppLoad",performance.now(),"ms"),vs.registerErrorHandler((e,t)=>{ei.trackError(e,null==t?void 0:t.component,null==t?void 0:t.service,null==t?void 0:t.metadata)})},[]),v.useEffect(()=>{const e=()=>{"prompts"===t.layout.activeSection?r("workspace"):r("prompts")};return window.addEventListener("prompts:open",e),()=>window.removeEventListener("prompts:open",e)},[t.layout.activeSection,r]);const n=v.useCallback(e=>{e.preventDefault();const r=e.clientX,i=t.layout.chatWidth;let n,a=0;const o=e=>{const o=performance.now();o-a<16||(n&&cancelAnimationFrame(n),n=requestAnimationFrame(()=>{const n=e.clientX-r,l=i-n,c=Math.min(2e3,Math.max(250,l)),d=document.querySelector(".chat-container");if(d){const e=0;if(d.getBoundingClientRect().right-c<e)return}Math.abs(c-t.layout.chatWidth)>1&&(s("chatWidth",c),a=o)}))},l=()=>{n&&cancelAnimationFrame(n),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",l)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",l)},[t.layout.chatWidth,s]),a=v.useCallback(e=>{e.preventDefault();const r=e.clientY,i=t.layout.chatInputHeight;let n,a=0;const o=e=>{const o=performance.now();o-a<16||(n&&cancelAnimationFrame(n),n=requestAnimationFrame(()=>{const n=e.clientY-r,l=i-n,c=Math.min(800,Math.max(200,l));c===l&&Math.abs(c-t.layout.chatInputHeight)>1&&(s("chatInputHeight",c),a=o)}))},l=()=>{n&&cancelAnimationFrame(n),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",l)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",l)},[t.layout.chatInputHeight,s]);return t.isInitialized?t.isLoading?u.jsxs(p.div,{className:"h-screen w-screen flex flex-col items-center justify-center app-loading-screen relative",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:[u.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 z-50 animated-top-bar"}),u.jsxs(p.div,{className:"text-center mb-4",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},"aria-label":"Загрузка Boss Ai",children:[u.jsx("div",{className:"loading-boss-logo",children:"Boss Ai"}),u.jsx("div",{className:"loading-boss-dots"})]})]}):t.error?u.jsx("div",{className:"h-screen flex items-center justify-center error-container",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-warning-500 rounded-full flex items-center justify-center mb-4 mx-auto",children:u.jsx("span",{className:"text-2xl",children:"⚠️"})}),u.jsx("h2",{className:"text-xl font-semibold mb-2 error-title",children:"Ошибка загрузки"}),u.jsx("p",{className:"mb-4 error-message",children:t.error}),u.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 rounded-lg transition-all duration-200 shadow-lg error-button",children:"Перезагрузить"})]})}):u.jsxs(p.div,{className:"min-h-screen w-screen flex app-container",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.6,ease:"easeOut"},children:[u.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 z-50 animated-top-bar"}),u.jsx(p.div,{className:Ne("sidebar-container relative sidebar-dynamic-width",t.layout.sidebarCollapsed&&"collapsed"),initial:{opacity:0,x:-20,scale:.98},animate:{opacity:1,x:0,scale:1},transition:{duration:.8,delay:.1,ease:[.25,.46,.45,.94]},children:u.jsx(Mr,{})}),u.jsxs(p.div,{className:"flex-1 flex h-screen main-content",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[u.jsx(p.div,{className:Ne("flex-1 overflow-x-hidden main-content-scrollbar rounded-2xl expanded-tabs-container","widgets"===t.layout.activeSection&&"service-tabs-expanded"),initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.4},style:{"--expanded-height":`${t.layout.expandedTabsHeight}px`},children:"ai-lawyer"===t.layout.activeSection?u.jsx(sr,{}):"corporate"===t.layout.activeSection?u.jsx(Yr,{}):"sales-scripts"===t.layout.activeSection?u.jsx(ws,{}):"regulations"===t.layout.activeSection?u.jsx(js,{}):u.jsx(Hr,{})}),"settings"===t.layout.activeSection&&u.jsx(p.div,{className:"settings-panel relative rounded-2xl full-height",initial:{opacity:0,x:10,scale:.99},animate:{opacity:1,x:0,scale:1},transition:{duration:.3,delay:.2},style:{width:500},children:u.jsx(Ar,{})}),"prompts"===t.layout.activeSection&&u.jsx(p.div,{className:"prompts-panel relative rounded-2xl full-height",initial:{opacity:0,x:10,scale:.99},animate:{opacity:1,x:0,scale:1},transition:{duration:.3,delay:.2},style:{width:800},children:u.jsx(or,{})}),t.layout.chatVisible&&u.jsxs(p.div,{className:"chat-container relative rounded-2xl h-screen max-h-screen",style:{"--chat-width":`${t.layout.chatWidth}px`},initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},children:[u.jsx(xs,{onInputResize:a}),u.jsx("div",{className:"chat-resizer",onMouseDown:n,title:"Изменить ширину чата"})]})]}),u.jsx(Or,{onTranscriptionComplete:e=>{console.log("Widget transcription:",e)}})]}):u.jsxs(p.div,{className:"h-screen w-screen flex flex-col items-center justify-center app-loading-screen relative",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:[u.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 z-50 animated-top-bar"}),u.jsxs(p.div,{className:"text-center mb-4",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},"aria-label":"Загрузка Boss Ai",children:[u.jsx("div",{className:"loading-boss-logo",children:"Boss Ai"}),u.jsx("div",{className:"loading-boss-dots"})]})]})});ti.displayName="AppContent";const si=v.memo(()=>{const{handleError:e}={handleError:(e,t)=>{console.error("Application error:",e,t)}};return u.jsx(fs,{onError:e,children:u.jsxs(Zr,{children:[u.jsx(g,{mode:"wait",children:u.jsx(ti,{})}),u.jsx(bs,{})]})})});si.displayName="App",document.documentElement.getAttribute("data-theme")||document.documentElement.setAttribute("data-theme","dark"),t.createRoot(document.getElementById("root")).render(u.jsx(f.StrictMode,{children:u.jsx(si,{})}))}},function(){return b||(0,y[r(y)[0]])((b={exports:{}}).exports,b),b.exports});export default j();
