var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,o=(e,t)=>{for(var s in t||(t={}))n.call(t,s)&&a(e,s,t[s]);if(r)for(var s of r(t))i.call(t,s)&&a(e,s,t[s]);return e},l=(e,r)=>t(e,s(r)),c=(e,t)=>{var s={};for(var a in e)n.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&r)for(var a of r(e))t.indexOf(a)<0&&i.call(e,a)&&(s[a]=e[a]);return s},d=(e,t,s)=>new Promise((r,n)=>{var i=e=>{try{o(s.next(e))}catch(t){n(t)}},a=e=>{try{o(s.throw(e))}catch(t){n(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,a);o((s=s.apply(e,t)).next())});import{u as m,j as h,m as u,A as p}from"./ui-06b94bee.js";import{a as x,r as g,R as v}from"./vendor-324528e4.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var f={},y=x;f.createRoot=y.createRoot,f.hydrateRoot=y.hydrateRoot;const b=g.createContext(void 0);function j(){const e=g.useContext(b);return void 0===e?(console.warn("usePlatform called outside PlatformProvider, returning fallback context"),{state:{user:null,authUser:null,authLoading:!1,authError:null,layout:{sidebarCollapsed:!1,sidebarWidth:300,chatVisible:!0,chatWidth:400,chatInputHeight:300,workspaceLayout:"grid",activeService:null,activeTool:null,activeSection:"workspace",activeSettingsCategory:"all",activeWidgetsCategory:[],chatType:"default",expandedTabsHeight:0},services:[],activeChat:null,workspaceItems:[],settings:{theme:"dark",fontSize:"medium",animations:!0,sidebarCollapsed:!1,useColoredText:!1,textColor:"#ffffff",accentsEnabled:!1,autoScroll:!0,hideChatFunctionButtons:!1,showTimestamps:!1},isLoading:!0,error:null,isInitialized:!1},dispatch:()=>{},switchService:()=>{},switchTool:()=>{},sendMessage:()=>d(this,null,function*(){}),createWorkspaceItem:()=>{},updateSettings:()=>{},toggleSidebar:()=>{},toggleChat:()=>{},setChatType:()=>{},switchSection:()=>{},setActiveSettingsCategory:()=>{},setExpandedTabsHeight:()=>{},toggleService:()=>{},executeServiceTool:()=>d(this,null,function*(){return{success:!1}}),loginWithTelegram:()=>d(this,null,function*(){}),logout:()=>d(this,null,function*(){}),checkAuth:()=>d(this,null,function*(){})}):e}const N=new class{constructor(){this.serviceIntegrations=new Map,this.handlers=new Map,this.chatButtons=new Map,this.eventListeners={onMessageReceived:[],onResponseGenerated:[],onHandlerExecuted:[]}}registerServiceIntegration(e){this.serviceIntegrations.set(e.serviceId,e),e.handlers.forEach(e=>{this.handlers.set(e.id,e)}),e.chatButtons.forEach(e=>{this.chatButtons.set(e.id,e)}),console.log(`[ChatIntegration] Сервис ${e.serviceId} зарегистрирован`)}unregisterServiceIntegration(e){const t=this.serviceIntegrations.get(e);t&&(t.handlers.forEach(e=>{this.handlers.delete(e.id)}),t.chatButtons.forEach(e=>{this.chatButtons.delete(e.id)}),this.serviceIntegrations.delete(e),console.log(`[ChatIntegration] Сервис ${e} удален`))}registerHandler(e){this.handlers.set(e.id,e),console.log(`[ChatIntegration] Обработчик ${e.id} зарегистрирован`)}unregisterHandler(e){this.handlers.delete(e),console.log(`[ChatIntegration] Обработчик ${e} удален`)}getHandler(e){return this.handlers.get(e)||null}getAllHandlers(){return Array.from(this.handlers.values())}getServiceHandlers(e){return Array.from(this.handlers.values()).filter(t=>t.serviceId===e)}processMessage(e,t){return d(this,null,function*(){const s=[],r=this.findMatchingHandlers(e);for(const i of r)try{const r=yield this.executeHandler(i.id,e,t);s.push(r)}catch(n){console.error(`[ChatIntegration] Ошибка выполнения обработчика ${i.id}:`,n)}return s})}executeHandler(e,t,s){return d(this,null,function*(){const r=this.handlers.get(e);if(!r)throw new Error(`Обработчик ${e} не найден`);if(!r.isEnabled)throw new Error(`Обработчик ${e} отключен`);const n=Date.now();try{const i=yield r.handler(t,s),a=Date.now()-n;return i.metadata.processingTime=a,i.metadata.handlerId=e,this.eventListeners.onHandlerExecuted.forEach(e=>e(r,i)),this.eventListeners.onResponseGenerated.forEach(e=>e(i)),console.log(`[ChatIntegration] Обработчик ${e} выполнен за ${a}ms`),i}catch(i){throw console.error(`[ChatIntegration] Ошибка в обработчике ${e}:`,i),i}})}registerChatButton(e){this.chatButtons.set(e.id,e),console.log(`[ChatIntegration] Кнопка ${e.id} зарегистрирована`)}unregisterChatButton(e){this.chatButtons.delete(e),console.log(`[ChatIntegration] Кнопка ${e} удалена`)}getChatButtons(e){const t=Array.from(this.chatButtons.values());return e?t.filter(t=>t.serviceId===e):t}onMessageReceived(e){this.eventListeners.onMessageReceived.push(e)}onResponseGenerated(e){this.eventListeners.onResponseGenerated.push(e)}onHandlerExecuted(e){this.eventListeners.onHandlerExecuted.push(e)}syncWithChat(){console.log("[ChatIntegration] Синхронизация с чатом")}exportHandlers(e){return e?this.getServiceHandlers(e):this.getAllHandlers()}importHandlers(e){e.forEach(e=>{this.handlers.set(e.id,e)}),console.log(`[ChatIntegration] Импортировано ${e.length} обработчиков`)}findMatchingHandlers(e){const t=[];for(const s of this.handlers.values()){if(!s.isEnabled)continue;s.triggers.some(t=>e.toLowerCase().includes(t.toLowerCase()))&&t.push(s)}return t.sort((e,t)=>t.priority-e.priority)}},w={},k=function(e,t,s){if(!t||0===t.length)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in w)return;w[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(!!s)for(let s=r.length-1;s>=0;s--){const n=r[s];if(n.href===e&&(!t||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${e}"]${n}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise((t,s)=>{i.addEventListener("load",t),i.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})};class S{constructor(){this.cache=new Map,this.loadingPromises=new Map}get(e){return this.cache.get(e)}set(e,t){this.cache.set(e,t)}isLoading(e){return this.loadingPromises.has(e)}setLoadingPromise(e,t){this.loadingPromises.set(e,t)}getLoadingPromise(e){return this.loadingPromises.get(e)}deleteLoadingPromise(e){this.loadingPromises.delete(e)}clear(){this.cache.clear(),this.loadingPromises.clear()}delete(e){this.cache.delete(e),this.loadingPromises.delete(e)}}const C=new class{constructor(){this.cache=new S,this.basePath="/services/modules/",this.configPath="/services/"}loadServiceConfig(e){return d(this,null,function*(){try{const t=yield fetch(`${this.configPath}${e}.json`);if(!t.ok)throw new Error(`Failed to load service config: ${t.statusText}`);return yield t.json()}catch(t){const s=t instanceof Error?t.message:"Неизвестная ошибка";console.error(`Error loading service config for ${e}:`,s);const r=new Error(`Failed to load service config for ${e}: ${s}`);throw t instanceof Error&&t.stack&&(r.stack=t.stack),r}})}loadServiceModule(e){return d(this,null,function*(){const t=this.cache.get(e);if(t)return t;const s=this.cache.getLoadingPromise(e);if(s)return s;const r=this.loadModuleFromPath(e);this.cache.setLoadingPromise(e,r);try{const t=yield r;return this.cache.set(e,t),this.cache.deleteLoadingPromise(e),t}catch(n){throw this.cache.deleteLoadingPromise(e),n}})}loadModuleFromPath(e){return d(this,null,function*(){try{const t=`${this.basePath}${e}/index.js`;{const e=yield fetch(t);if(!e.ok)throw new Error(`Failed to load module: ${e.statusText}`);const s=yield e.blob(),r=URL.createObjectURL(s);try{return(yield k(()=>import(r),[])).default}finally{URL.revokeObjectURL(r)}}}catch(t){return console.error(`Error loading service module ${e}:`,t),this.createFallbackModule(e)}})}createFallbackModule(e){return{initialize:()=>d(this,null,function*(){console.warn(`Service ${e} is using fallback module`)}),execute:(t,s)=>d(this,null,function*(){return console.warn(`Tool ${t} from service ${e} is not implemented`),{error:"Tool not implemented"}}),cleanup:()=>d(this,null,function*(){})}}preloadService(e){return d(this,null,function*(){try{yield this.loadServiceModule(e)}catch(t){console.warn(`Failed to preload service ${e}:`,t)}})}preloadServices(e){return d(this,null,function*(){const t=e.map(e=>this.preloadService(e));yield Promise.allSettled(t)})}unloadService(e){const t=this.cache.get(e);t&&t.cleanup&&t.cleanup().catch(t=>{console.error(`Error cleaning up service ${e}:`,t)}),this.cache.delete(e)}isServiceLoaded(e){return void 0!==this.cache.get(e)}isServiceLoading(e){return this.cache.isLoading(e)}getLoadedServices(){return Array.from(this.cache.cache.keys())}clearCache(){this.cache.clear()}setBasePath(e){this.basePath=e}setConfigPath(e){this.configPath=e}};const E=new class{constructor(e={}){this.subscriptions=new Map,this.activeRequests=new Map,this.middleware=[],this.isRunningFlag=!1,this.eventBuffer=[],this.requestHandlers=new Map,this.config=o({maxConcurrentRequests:100,defaultTimeout:3e4,eventBufferSize:1e3,enableLogging:!0,enableMetrics:!0},e)}publish(e){if(!this.isRunningFlag)return this.log("ServiceBus не запущен, событие добавлено в буфер"),void this.eventBuffer.push(e);let t=e;for(const s of this.middleware.sort((e,t)=>e.priority-t.priority))if(s.beforeEvent){const r=s.beforeEvent(t);if(null===r)return void this.log(`Событие ${e.id} заблокировано middleware ${s.name}`);t=r}this.deliverEvent(t);for(const s of this.middleware.sort((e,t)=>e.priority-t.priority))s.afterEvent&&s.afterEvent(t);this.log(`Событие ${e.id} опубликовано`)}subscribe(e,t){const s=this.generateId(),r={id:s,eventType:e,handler:t,serviceId:"unknown",createdAt:new Date};return this.subscriptions.set(s,r),this.log(`Подписка ${s} создана для события ${e}`),s}unsubscribe(e){this.subscriptions.get(e)&&(this.subscriptions.delete(e),this.log(`Подписка ${e} удалена`))}request(e){return d(this,null,function*(){if(!this.isRunningFlag)throw new Error("ServiceBus не запущен");if(this.activeRequests.size>=this.config.maxConcurrentRequests)throw new Error("Превышен лимит одновременных запросов");let t=e;for(const n of this.middleware.sort((e,t)=>e.priority-t.priority))if(n.beforeRequest){const s=n.beforeRequest(t);if(null===s)throw new Error(`Запрос ${e.id} заблокирован middleware`);t=s}const s={id:e.id,method:e.method,source:e.source,target:e.target,status:"pending",createdAt:new Date};this.activeRequests.set(e.id,s);try{const r=`${e.target}:${e.method}`,n=this.requestHandlers.get(r);if(!n)throw new Error(`Обработчик для ${e.target}:${e.method} не найден`);const i=yield n(t);s.status="completed",s.completedAt=new Date;let a=i;for(const e of this.middleware.sort((e,t)=>e.priority-t.priority))if(e.afterResponse){const t=e.afterResponse(a);t&&(a=t)}return this.log(`Запрос ${e.id} выполнен успешно`),a}catch(r){return s.status="error",s.completedAt=new Date,this.log(`Ошибка выполнения запроса ${e.id}:`,r),{id:this.generateId(),requestId:e.id,success:!1,error:r instanceof Error?r.message:"Неизвестная ошибка",timestamp:new Date}}finally{this.activeRequests.delete(e.id)}})}respond(e,t,s){const r=`${e}:${t}`;this.requestHandlers.set(r,s),this.log(`Обработчик ${r} зарегистрирован`)}unrespond(e,t){const s=`${e}:${t}`;this.requestHandlers.delete(s),this.log(`Обработчик ${s} удален`)}addMiddleware(e){this.middleware.push(e),this.middleware.sort((e,t)=>e.priority-t.priority),this.log(`Middleware ${e.name} добавлен`)}removeMiddleware(e){const t=this.middleware.findIndex(t=>t.name===e);-1!==t&&(this.middleware.splice(t,1),this.log(`Middleware ${e} удален`))}start(){for(this.isRunningFlag=!0,this.log("ServiceBus запущен");this.eventBuffer.length>0;){const e=this.eventBuffer.shift();e&&this.publish(e)}}stop(){this.isRunningFlag=!1,this.log("ServiceBus остановлен")}isRunning(){return this.isRunningFlag}getSubscriptions(){return Array.from(this.subscriptions.values())}getActiveRequests(){return Array.from(this.activeRequests.values())}getMiddleware(){return[...this.middleware]}deliverEvent(e){const t=Array.from(this.subscriptions.values()).filter(t=>t.eventType===e.type||"*"===t.eventType);for(const r of t)try{r.handler(e)}catch(s){this.log(`Ошибка в обработчике события ${r.id}:`,s)}}generateId(){return`sb_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}log(e,...t){this.config.enableLogging&&console.log(`[ServiceBus] ${e}`,...t)}}({maxConcurrentRequests:100,defaultTimeout:3e4,eventBufferSize:1e3,enableLogging:!0,enableMetrics:!0});E.addMiddleware(new class{constructor(e=!0,t=!0){this.enableEventLogging=e,this.enableRequestLogging=t,this.name="LoggingMiddleware",this.priority=100}beforeEvent(e){return this.enableEventLogging&&console.log(`[ServiceBus] Событие: ${e.type} от ${e.source}`,{id:e.id,data:e.data,timestamp:e.timestamp}),e}afterEvent(e){return this.enableEventLogging&&console.log(`[ServiceBus] Событие ${e.id} доставлено`),e}beforeRequest(e){return this.enableRequestLogging&&console.log(`[ServiceBus] Запрос: ${e.method} от ${e.source} к ${e.target}`,{id:e.id,params:e.params,timestamp:e.timestamp}),e}afterResponse(e){return this.enableRequestLogging&&console.log(`[ServiceBus] Ответ: ${e.requestId}`,{success:e.success,data:e.data,error:e.error,timestamp:e.timestamp}),e}}),E.addMiddleware(new class{constructor(e=!1){this.strictMode=e,this.name="ValidationMiddleware",this.priority=50}beforeEvent(e){return e.id&&e.type&&e.source?this.isValidEventType(e.type)?e.data&&"object"!=typeof e.data?(console.error("[ServiceBus] Данные события должны быть объектом"),null):e:(console.error(`[ServiceBus] Невалидный тип события: ${e.type}`),null):(console.error("[ServiceBus] Невалидное событие: отсутствуют обязательные поля"),null)}afterEvent(e){return e}beforeRequest(e){return e.id&&e.method&&e.source&&e.target?this.isValidMethod(e.method)?e.params&&"object"!=typeof e.params?(console.error("[ServiceBus] Параметры запроса должны быть объектом"),null):e:(console.error(`[ServiceBus] Невалидный метод: ${e.method}`),null):(console.error("[ServiceBus] Невалидный запрос: отсутствуют обязательные поля"),null)}afterResponse(e){return"boolean"!=typeof e.success?(console.error("[ServiceBus] Поле success в ответе должно быть булевым"),null):(e.success||e.error||console.warn("[ServiceBus] Неуспешный ответ без описания ошибки"),e)}isValidEventType(e){return["service.registered","service.unregistered","service.activated","service.deactivated","service.error","data.changed","user.action","system.notification"].includes(e)||e.startsWith("custom.")}isValidMethod(e){return["get","set","create","update","delete","execute","process","validate","transform"].includes(e)||e.includes(".")}}),E.addMiddleware(new class{constructor(e=[],t=[],s=[],r=[]){this.allowedSources=e,this.blockedSources=t,this.allowedMethods=s,this.blockedMethods=r,this.name="SecurityMiddleware",this.priority=10}beforeEvent(e){return this.blockedSources.includes(e.source)?(console.warn(`[ServiceBus] Событие заблокировано: источник ${e.source} в черном списке`),null):this.allowedSources.length>0&&!this.allowedSources.includes(e.source)?(console.warn(`[ServiceBus] Событие заблокировано: источник ${e.source} не в белом списке`),null):e.ttl&&e.ttl<Date.now()-e.timestamp.getTime()?(console.warn(`[ServiceBus] Событие ${e.id} истекло`),null):(e.data&&(e.data=this.sanitizeData(e.data)),e)}afterEvent(e){return e}beforeRequest(e){return this.blockedSources.includes(e.source)?(console.warn(`[ServiceBus] Запрос заблокирован: источник ${e.source} в черном списке`),null):this.allowedSources.length>0&&!this.allowedSources.includes(e.source)?(console.warn(`[ServiceBus] Запрос заблокирован: источник ${e.source} не в белом списке`),null):this.blockedMethods.includes(e.method)?(console.warn(`[ServiceBus] Запрос заблокирован: метод ${e.method} в черном списке`),null):this.allowedMethods.length>0&&!this.allowedMethods.includes(e.method)?(console.warn(`[ServiceBus] Запрос заблокирован: метод ${e.method} не в белом списке`),null):(e.params&&(e.params=this.sanitizeData(e.params)),e)}afterResponse(e){return e.data&&(e.data=this.sanitizeData(e.data)),e}sanitizeData(e){if("string"==typeof e)return e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");if(Array.isArray(e))return e.map(e=>this.sanitizeData(e));if(e&&"object"==typeof e){const t={};for(const[s,r]of Object.entries(e))s.startsWith("__")||s.includes("prototype")||s.includes("constructor")||(t[s]=this.sanitizeData(r));return t}return e}}),E.start();const I=new class{constructor(){this.channels=new Map,this.messages=new Map,this.subscriptions=new Map,this.serviceStatuses=new Map,this.serviceData=new Map,this.isRunningFlag=!1,this.eventListeners={onMessageReceived:[],onChannelCreated:[],onChannelDestroyed:[],onServiceJoined:[],onServiceLeft:[]}}createChannel(e,t,s){const r={id:this.generateId(),name:e,type:t,participants:s,isActive:!0,metadata:{createdAt:new Date,lastActivity:new Date,messageCount:0}};return this.channels.set(r.id,r),this.messages.set(r.id,[]),this.eventListeners.onChannelCreated.forEach(e=>e(r)),console.log(`[ServiceCommunication] Создан канал ${e} (${t})`),r}joinChannel(e,t){const s=this.channels.get(e);return!!s&&(s.participants.includes(t)||(s.participants.push(t),this.eventListeners.onServiceJoined.forEach(s=>s(e,t)),console.log(`[ServiceCommunication] Сервис ${t} подключен к каналу ${e}`)),!0)}leaveChannel(e,t){const s=this.channels.get(e);if(!s)return!1;const r=s.participants.indexOf(t);return-1!==r&&(s.participants.splice(r,1),this.eventListeners.onServiceLeft.forEach(s=>s(e,t)),console.log(`[ServiceCommunication] Сервис ${t} отключен от канала ${e}`)),!0}getChannel(e){return this.channels.get(e)||null}getServiceChannels(e){return Array.from(this.channels.values()).filter(t=>t.participants.includes(e))}sendMessage(e){return d(this,null,function*(){if(!this.isRunningFlag)return console.warn("[ServiceCommunication] Менеджер не запущен"),!1;const t=this.channels.get(e.channelId);if(!t)return console.error(`[ServiceCommunication] Канал ${e.channelId} не найден`),!1;if(!t.participants.includes(e.senderId))return console.error(`[ServiceCommunication] Сервис ${e.senderId} не имеет доступа к каналу ${e.channelId}`),!1;const s=this.messages.get(e.channelId)||[];return s.push(e),this.messages.set(e.channelId,s),t.metadata.lastActivity=new Date,t.metadata.messageCount++,this.notifySubscribers(e),this.eventListeners.onMessageReceived.forEach(t=>t(e)),console.log(`[ServiceCommunication] Сообщение отправлено в канал ${e.channelId}`),!0})}sendDirectMessage(e,t,s="message"){return d(this,null,function*(){const r={id:this.generateId(),channelId:"direct",senderId:"system",recipientId:e,type:s,content:t,timestamp:new Date,priority:"normal",metadata:{tags:["direct"],correlationId:this.generateId()}};return yield this.sendMessage(r)})}broadcastMessage(e,t="notification"){return d(this,null,function*(){const s={id:this.generateId(),channelId:"broadcast",senderId:"system",type:t,content:e,timestamp:new Date,priority:"normal",metadata:{tags:["broadcast"]}};return yield this.sendMessage(s)})}multicastMessage(e,t,s="message"){return d(this,null,function*(){const e={id:this.generateId(),channelId:"multicast",senderId:"system",type:s,content:t,timestamp:new Date,priority:"normal",metadata:{tags:["multicast"]}};return yield this.sendMessage(e)})}getMessages(e,t){const s=this.messages.get(e)||[];return t?s.slice(-t):s}getServiceMessages(e,t){const s=[];for(const r of this.messages.values()){const t=r.filter(t=>t.senderId===e||t.recipientId===e);s.push(...t)}return t?s.slice(-t):s}getUnreadCount(e){return 0}subscribeToChannel(e,t,s){const r=this.generateId();return this.subscriptions.set(r,{serviceId:t,callback:s}),console.log(`[ServiceCommunication] Сервис ${t} подписан на канал ${e}`),r}subscribeToService(e,t){const s=this.generateId();return this.subscriptions.set(s,{serviceId:e,callback:t}),console.log(`[ServiceCommunication] Подписка на сервис ${e}`),s}unsubscribe(e){this.subscriptions.delete(e),console.log(`[ServiceCommunication] Подписка ${e} удалена`)}onMessageReceived(e){this.eventListeners.onMessageReceived.push(e)}onChannelCreated(e){this.eventListeners.onChannelCreated.push(e)}onChannelDestroyed(e){this.eventListeners.onChannelDestroyed.push(e)}onServiceJoined(e){this.eventListeners.onServiceJoined.push(e)}onServiceLeft(e){this.eventListeners.onServiceLeft.push(e)}getServiceStatus(e){const t=this.serviceStatuses.get(e);return t?t.status:"offline"}setServiceStatus(e,t){this.serviceStatuses.set(e,{serviceId:e,status:t,lastSeen:new Date,capabilities:[],metadata:{}}),console.log(`[ServiceCommunication] Статус сервиса ${e}: ${t}`)}getOnlineServices(){return Array.from(this.serviceStatuses.values()).filter(e=>"online"===e.status).map(e=>e.serviceId)}syncServiceData(e,t){this.serviceData.set(e,t),console.log(`[ServiceCommunication] Данные сервиса ${e} синхронизированы`)}getServiceData(e){return this.serviceData.get(e)}subscribeToServiceData(e,t){const s=this.generateId();return console.log(`[ServiceCommunication] Подписка на данные сервиса ${e}`),s}start(){this.isRunningFlag=!0,console.log("[ServiceCommunication] Менеджер запущен")}stop(){this.isRunningFlag=!1,console.log("[ServiceCommunication] Менеджер остановлен")}isRunning(){return this.isRunningFlag}getStats(){return{totalChannels:this.channels.size,totalMessages:Array.from(this.messages.values()).reduce((e,t)=>e+t.length,0),activeServices:this.getOnlineServices().length,onlineServices:this.getOnlineServices(),messageRate:0,averageLatency:0,errorRate:0}}notifySubscribers(e){for(const s of this.subscriptions.values())if(s.serviceId===e.senderId||s.serviceId===e.recipientId||"broadcast"===e.channelId)try{s.callback(e)}catch(t){console.error("[ServiceCommunication] Ошибка в обработчике подписки:",t)}}generateId(){return`sc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}};I.start();class T{constructor(){this.PLATFORM_VERSION="1.0.0",this.REQUIRED_FIELDS=["id","name","version","category"],this.VALID_CATEGORIES=["ai","utility","communication","productivity","entertainment","system","settings","file","time","transcription","chat","rewrite","summary","translation","commands","create","upload","search","organize","analysis","generation","actions"],this.VALID_ICONS=["Bot","Settings","FileText","MessageCircle","Clock","Mic","Search","Download","Upload","Edit","Trash","Save","Share","Copy","Paste","Cut","Undo","Redo","Play","Pause","Stop","Volume","VolumeX","Volume1","Volume2","Volume3","Volume4","Volume5","Volume6","Volume7","Volume8","Volume9","Volume10","Volume11","Volume12","Volume13","Volume14","Volume15","Volume16","Volume17","Volume18","Volume19","Volume20","Volume21","Volume22","Volume23","Volume24","Volume25","Volume26","Volume27","Volume28","Volume29","Volume30","Grid","Cog","Monitor","Plus","Minus","Check","X","Alert","Info","Warning","Error","Success","List","Layout","Palette","Zap","Lightning","Smile","BarChart3"]}validateService(e){const t=[],s=[],r=[];return this.validateRequiredFields(e,t),this.validateDataTypes(e,t),this.validateValues(e,t,s),this.validateTools(e,t,s),this.validateSettings(e,t,s),this.validateChatButtons(e,t,s),this.validateTheme(e,t,s),e.dependencies&&Array.isArray(e.dependencies)&&e.dependencies.forEach(e=>{"string"!=typeof e?t.push(`Зависимость должна быть строкой: ${e}`):""===e.trim()?t.push("Пустая зависимость недопустима"):this.isValidServiceId(e)||s.push(`Некорректный ID зависимости: ${e}`)}),this.generateSuggestions(e,r),{isValid:0===t.length,errors:t,warnings:s,suggestions:r}}validateDependencies(e){const t=[],s=[];return e.dependencies&&Array.isArray(e.dependencies)&&e.dependencies.forEach(e=>{"string"!=typeof e?t.push(`Зависимость должна быть строкой: ${e}`):""===e.trim()?t.push("Пустая зависимость недопустима"):this.isValidServiceId(e)||s.push(`Некорректный ID зависимости: ${e}`)}),{isValid:0===t.length,errors:t,warnings:s,suggestions:[]}}checkConflicts(e,t){const s=[];t.find(t=>t.id===e.id)&&s.push(`Сервис с ID '${e.id}' уже зарегистрирован`);const r=t.find(t=>t.priority===e.priority);r&&s.push(`Сервис '${r.name}' уже использует приоритет ${e.priority}`);const n=t.find(t=>t.icon===e.icon);return n&&s.push(`Сервис '${n.name}' уже использует иконку '${e.icon}'`),s}validateRequiredFields(e,t){this.REQUIRED_FIELDS.forEach(s=>{s in e&&void 0!==e[s]||t.push(`Отсутствует обязательное поле: ${s}`)})}validateDataTypes(e,t){"string"!=typeof e.id&&t.push("Поле id должно быть строкой"),"string"!=typeof e.name&&t.push("Поле name должно быть строкой"),"string"!=typeof e.version&&t.push("Поле version должно быть строкой"),"string"!=typeof e.category&&t.push("Поле category должно быть строкой"),"boolean"!=typeof e.isActive&&t.push("Поле isActive должно быть булевым"),"number"!=typeof e.priority&&t.push("Поле priority должно быть числом"),Array.isArray(e.tools)||t.push("Поле tools должно быть массивом"),Array.isArray(e.dependencies)||t.push("Поле dependencies должно быть массивом")}validateValues(e,t,s){e.id&&!this.isValidServiceId(e.id)&&t.push("ID сервиса должен содержать только буквы, цифры, дефисы и подчеркивания"),e.version&&!this.isValidVersion(e.version)&&t.push("Версия должна быть в формате semver (например, 1.0.0)"),e.category&&!this.VALID_CATEGORIES.includes(e.category)&&s.push(`Неизвестная категория: ${e.category}. Рекомендуемые: ${this.VALID_CATEGORIES.join(", ")}`),e.icon&&!this.VALID_ICONS.includes(e.icon)&&s.push(`Неизвестная иконка: ${e.icon}. Рекомендуемые: ${this.VALID_ICONS.slice(0,10).join(", ")}...`),(e.priority<0||e.priority>1e3)&&s.push("Приоритет должен быть от 0 до 1000")}validateTools(e,t,s){Array.isArray(e.tools)&&e.tools.forEach((e,r)=>{e.id||t.push(`Инструмент ${r}: отсутствует ID`),e.name||t.push(`Инструмент ${r}: отсутствует название`),e.description||s.push(`Инструмент ${r}: отсутствует описание`),e.icon||s.push(`Инструмент ${r}: отсутствует иконка`),"boolean"!=typeof e.isEnabled&&t.push(`Инструмент ${r}: isEnabled должно быть булевым`)})}validateSettings(e,t,s){e.settings&&"object"!=typeof e.settings&&t.push("Настройки должны быть объектом")}validateChatButtons(e,t,s){e.chatButtons&&(Array.isArray(e.chatButtons)?e.chatButtons.forEach((e,s)=>{e.id||t.push(`Кнопка чата ${s}: отсутствует ID`),e.name||t.push(`Кнопка чата ${s}: отсутствует название`),e.action||t.push(`Кнопка чата ${s}: отсутствует действие`),e.position&&!["top","bottom"].includes(e.position)&&t.push(`Кнопка чата ${s}: неверная позиция '${e.position}'`)}):t.push("chatButtons должно быть массивом"))}validateTheme(e,t,s){e.theme&&(e.theme.id||t.push("Тема сервиса: отсутствует ID"),e.theme.name||t.push("Тема сервиса: отсутствует название"),e.theme.colors||s.push("Тема сервиса: отсутствуют цвета"))}generateSuggestions(e,t){(!e.description||e.description.length<10)&&t.push("Добавьте более подробное описание сервиса"),e.author||t.push("Укажите автора сервиса"),e.tools&&0===e.tools.length&&t.push("Добавьте хотя бы один инструмент"),e.chatButtons&&0!==e.chatButtons.length||t.push("Добавьте кнопки для чата для лучшей интеграции"),e.theme||t.push("Добавьте тему для улучшения внешнего вида"),0===e.priority&&t.push("Установите приоритет для правильной сортировки")}isValidServiceId(e){return/^[a-zA-Z0-9_-]+$/.test(e)}isValidVersion(e){return/^\d+\.\d+\.\d+$/.test(e)}}const A=new class{constructor(){this.services=new Map,this.eventListeners={onServiceRegistered:[],onServiceUnregistered:[],onServiceActivated:[],onServiceDeactivated:[]},this.validator=new T}registerService(e){return d(this,null,function*(){const t=this.validator.validateService(e);if(!t.isValid)return t;const s=Array.from(this.services.values()).map(e=>e.config),r=this.validator.checkConflicts(e,s);if(r.length>0)return{isValid:!1,errors:r,warnings:t.warnings,suggestions:t.suggestions};const n=this.extractCapabilities(e),i=this.extractDependencies(e),a={config:e,capabilities:n,dependencies:i,isRegistered:!0,isActive:e.isActive||!1,lastUpdated:new Date,metadata:{author:e.author||"Unknown",license:"MIT",repository:void 0,documentation:void 0}};return this.services.set(e.id,a),this.eventListeners.onServiceRegistered.forEach(e=>e(a)),{isValid:!0,errors:[],warnings:t.warnings,suggestions:t.suggestions}})}unregisterService(e){return d(this,null,function*(){if(!this.services.get(e))return!1;const t=this.getDependentServices(e);return t.length>0?(console.warn(`Нельзя удалить сервис ${e}: от него зависят ${t.join(", ")}`),!1):(this.services.delete(e),this.eventListeners.onServiceUnregistered.forEach(t=>t(e)),!0)})}clearRegistry(){return d(this,null,function*(){console.log("[ServiceRegistry] Очистка реестра сервисов"),this.services.clear(),this.eventListeners={onServiceRegistered:[],onServiceUnregistered:[],onServiceActivated:[],onServiceDeactivated:[]}})}getService(e){return this.services.get(e)||null}getAllServices(){return Array.from(this.services.values())}getServicesByCategory(e){return Array.from(this.services.values()).filter(t=>t.config.category===e)}getServiceCapabilities(e){const t=this.services.get(e);return t?t.capabilities:null}validateService(e){return this.validator.validateService(e)}validateDependencies(e){const t=this.services.get(e);if(!t)return{isValid:!1,errors:[`Сервис ${e} не найден`],warnings:[],suggestions:[]};const s=[],r=[];return t.dependencies.forEach(e=>{const t=this.services.get(e.serviceId);t?t.isActive||(e.optional?r.push(`Опциональная зависимость ${e.serviceId} неактивна`):s.push(`Обязательная зависимость ${e.serviceId} неактивна`)):e.optional?r.push(`Опциональная зависимость ${e.serviceId} не найдена`):s.push(`Обязательная зависимость ${e.serviceId} не найдена`)}),{isValid:0===s.length,errors:s,warnings:r,suggestions:[]}}checkConflicts(e){const t=this.services.get(e);if(!t)return[];const s=Array.from(this.services.values()).filter(t=>t.config.id!==e).map(e=>e.config);return this.validator.checkConflicts(t.config,s)}getServiceDependencies(e){const t=this.services.get(e);return t?t.dependencies:[]}getDependentServices(e){const t=[];return this.services.forEach((s,r)=>{if(r!==e){s.dependencies.some(t=>t.serviceId===e)&&t.push(r)}}),t}resolveDependencyTree(e){const t=[],s=new Set,r=e=>{if(s.has(e))return;s.add(e);const n=this.services.get(e);n&&(n.dependencies.forEach(e=>{r(e.serviceId)}),t.push(e))};return r(e),t}isServiceRegistered(e){return this.services.has(e)}isServiceActive(e){const t=this.services.get(e);return!!t&&t.isActive}activateService(e){return d(this,null,function*(){const t=this.services.get(e);if(!t)return!1;const s=this.validateDependencies(e);return s.isValid?(t.isActive=!0,t.config.isActive=!0,this.eventListeners.onServiceActivated.forEach(t=>t(e)),!0):(console.error(`Нельзя активировать сервис ${e}:`,s.errors),!1)})}deactivateService(e){return d(this,null,function*(){const t=this.services.get(e);if(!t)return!1;const s=this.getDependentServices(e);return s.length>0?(console.warn(`Нельзя деактивировать сервис ${e}: от него зависят ${s.join(", ")}`),!1):(t.isActive=!1,t.config.isActive=!1,this.eventListeners.onServiceDeactivated.forEach(t=>t(e)),!0)})}onServiceRegistered(e){this.eventListeners.onServiceRegistered.push(e)}onServiceUnregistered(e){this.eventListeners.onServiceUnregistered.push(e)}onServiceActivated(e){this.eventListeners.onServiceActivated.push(e)}onServiceDeactivated(e){this.eventListeners.onServiceDeactivated.push(e)}extractCapabilities(e){return{id:e.id,name:e.name,version:e.version,category:e.category,capabilities:{settings:!!e.settings,workspace:!1,chat:!!(e.chatButtons&&e.chatButtons.length>0),widgets:"widgets"===e.category,api:!!e.chatApiBaseUrl,events:!1},dependencies:e.dependencies||[],conflicts:[],requirements:{minPlatformVersion:"1.0.0",nodeVersion:">=16.0.0",browserSupport:["Chrome","Firefox","Safari","Edge"]}}}extractDependencies(e){return e.dependencies?e.dependencies.map(e=>({serviceId:e,version:"latest",optional:!1,description:`Зависимость от сервиса ${e}`})):[]}};class R{static validateColorScheme(e){const t=[],s=[];for(const n of this.REQUIRED_COLOR_KEYS)e[n]?this.isValidColor(e[n])||t.push(`Некорректный формат цвета для ${n}: ${e[n]}`):t.push(`Отсутствует обязательный цвет: ${n}`);const r=Object.entries(e).filter(([e])=>!this.REQUIRED_COLOR_KEYS.includes(e));for(const[n,i]of r)i&&!this.isValidColor(i)&&s.push(`Некорректный формат дополнительного цвета ${n}: ${i}`);return{isValid:0===t.length,errors:t,warnings:s.length>0?s:void 0}}static validateServiceTheme(e){const t=[],s=[];if(e.id?/^[a-zA-Z0-9-_]+$/.test(e.id)||t.push("ID темы содержит недопустимые символы"):t.push("Отсутствует ID темы"),e.name||t.push("Отсутствует название темы"),e.colors){const r=this.validateColorScheme(e.colors);t.push(...r.errors),r.warnings&&s.push(...r.warnings)}else t.push("Отсутствует цветовая схема");if(e.variables)for(const[r,n]of Object.entries(e.variables))this.VALID_CSS_VARIABLE_PATTERN.test(r)||t.push(`Некорректное имя CSS переменной: ${r}`),"string"!=typeof n&&t.push(`CSS переменная ${r} должна быть строкой`);if(e.animations)for(const[r,n]of Object.entries(e.animations))this.VALID_ANIMATION_PATTERN.test(r)||t.push(`Некорректное имя анимации: ${r}`),"string"!=typeof n&&t.push(`Анимация ${r} должна быть строкой`);return{isValid:0===t.length,errors:t,warnings:s.length>0?s:void 0}}static validateCSSVariable(e,t){const s=[];return this.VALID_CSS_VARIABLE_PATTERN.test(e)||s.push(`Некорректное имя CSS переменной: ${e}`),"string"!=typeof t&&s.push("Значение CSS переменной должно быть строкой"),{isValid:0===s.length,errors:s}}static isValidColor(e){if("string"!=typeof e)return!1;for(const s of this.VALID_COLOR_FORMATS)if(s.test(e))return!0;try{const t=(new Option).style;return t.color=e,""!==t.color}catch(t){return!1}}static validateAnimation(e,t){const s=[];return this.VALID_ANIMATION_PATTERN.test(e)||s.push(`Некорректное имя анимации: ${e}`),"string"!=typeof t&&s.push("Значение анимации должно быть строкой"),{isValid:0===s.length,errors:s}}static validateThemeConfig(e){const t=[];if(!e||"object"!=typeof e)return t.push("Конфигурация темы должна быть объектом"),{isValid:!1,errors:t};const s=e;return s.id&&"string"==typeof s.id||t.push("Отсутствует или некорректный ID темы"),s.name&&"string"==typeof s.name||t.push("Отсутствует или некорректное название темы"),{isValid:0===t.length,errors:t}}}R.VALID_COLOR_FORMATS=[/^#[0-9A-Fa-f]{3}$/,/^#[0-9A-Fa-f]{6}$/,/^#[0-9A-Fa-f]{8}$/,/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/,/^rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d.]+\s*\)$/,/^hsl\(\s*\d+\s*,\s*\d+%\s*,\s*\d+%\s*\)$/,/^hsla\(\s*\d+\s*,\s*\d+%\s*,\s*\d+%\s*,\s*[\d.]+\s*\)$/,/^var\(--[a-zA-Z0-9-]+\)$/,/^theme\(['"][^'"]+['"]\)$/],R.REQUIRED_COLOR_KEYS=["primary","secondary","accent","background","text","border"],R.VALID_CSS_VARIABLE_PATTERN=/^--[a-zA-Z0-9-]+$/,R.VALID_ANIMATION_PATTERN=/^[a-zA-Z0-9-]+$/;class M{constructor(){this.changeQueue=[],this.isProcessing=!1,this.processingTimeout=null,this.config={defaultTheme:"dark",enableBatching:!0,enableValidation:!0,enableServiceThemes:!0,batchDelay:16},this.state={currentTheme:this.config.defaultTheme,serviceThemes:new Map,isProcessing:!1,changeQueue:[],listeners:new Set},this.initializeDefaultThemes()}static getInstance(){return M.instance||(M.instance=new M),M.instance}initializeDefaultThemes(){this.registerServiceTheme("light",{id:"light",name:"Светлая тема",description:"Классическая светлая тема",colors:{primary:"#000000",secondary:"#f3f4f6",accent:"#000000",background:"#ffffff",surface:"#ffffff",text:"#000000",textSecondary:"#000000",border:"rgba(0,0,0,0.12)",muted:"#000000",destructive:"#ef4444",success:"#10b981",warning:"#f59e0b",info:"#000000"},variables:{"--background":"#ffffff","--foreground":"#000000","--primary":"#000000","--secondary":"#f3f4f6","--muted":"#000000","--border":"rgba(0,0,0,0.12)"}}),this.registerServiceTheme("dark",{id:"dark",name:"Темная тема",description:"Современная темная тема",colors:{primary:"#000000",secondary:"#1a1a1a",accent:"#000000",background:"#000000",surface:"#1a1a1a",text:"#ffffff",textSecondary:"#ffffff",border:"rgba(255,255,255,0.10)",muted:"#ffffff",destructive:"#ef4444",success:"#10b981",warning:"#f59e0b",info:"#000000"},variables:{"--background":"#000000","--foreground":"#ffffff","--primary":"#ffffff","--secondary":"#1a1a1a","--muted":"#ffffff","--border":"rgba(255,255,255,0.10)"}})}setTheme(e){this.state.currentTheme!==e&&(this.state.currentTheme=e,this.applyTheme(),this.notifyListeners())}getCurrentTheme(){return this.state.currentTheme}registerServiceTheme(e,t){if(this.config.enableValidation){const s=R.validateServiceTheme(t);if(!s.isValid)return void console.error(`Ошибка валидации темы сервиса ${e}:`,s.errors)}this.state.serviceThemes.set(e,t)}unregisterServiceTheme(e){this.state.serviceThemes.delete(e)}getServiceTheme(e){if(e&&"string"==typeof e)return this.state.serviceThemes.get(e);console.warn("Invalid serviceId provided to getServiceTheme:",e)}getAllThemes(){const e=[];return e.push({id:"light",name:"Светлая",type:"light",isDefault:!1,version:"1.0.0",description:"Классическая светлая тема"},{id:"dark",name:"Темная",type:"dark",isDefault:!0,version:"1.0.0",description:"Современная темная тема"}),this.state.serviceThemes.forEach((t,s)=>{e.push({id:`service-${s}`,name:t.name,type:"service",isServiceTheme:!0,serviceId:s,version:t.version||"1.0.0",author:t.author,description:t.description})}),e}applyTheme(){const e=document.documentElement,t=this.state.currentTheme;e.setAttribute("data-theme",t),this.applyThemeVariables(t)}applyThemeVariables(e){const t=document.documentElement;let s;if(e.startsWith("service-")){const t=e.replace("service-","");s=this.state.serviceThemes.get(t)}else s=this.state.serviceThemes.get(e);s?(s.variables&&Object.entries(s.variables).forEach(([e,s])=>{t.style.setProperty(e,s)}),Object.entries(s.colors).forEach(([e,s])=>{t.style.setProperty(`--${e}`,s)}),s.animations&&Object.entries(s.animations).forEach(([e,s])=>{t.style.setProperty(`--animation-${e}`,s)})):console.warn(`Тема ${e} не найдена`)}queueThemeChange(e){this.config.enableBatching?(this.changeQueue.push(e),this.isProcessing||this.processChanges()):this.applyThemeChange(e)}processChanges(){if(this.isProcessing||0===this.changeQueue.length)return;this.isProcessing=!0;const e=this.groupChanges(this.changeQueue);this.batchApplyChanges(e),this.changeQueue=[],this.isProcessing=!1,this.notifyListeners()}groupChanges(e){const t={attributes:{},variables:{},animations:{}};return e.forEach(e=>{switch(e.type){case"theme":t.attributes["data-theme"]=e.value;break;case"color":case"variable":t.variables[e.key]=e.value;break;case"animation":t.animations[e.key]=e.value}}),t}batchApplyChanges(e){requestAnimationFrame(()=>{const t=document.documentElement;Object.entries(e.attributes).forEach(([e,s])=>{t.setAttribute(e,s)}),Object.entries(e.variables).forEach(([e,s])=>{t.style.setProperty(e,s)}),Object.entries(e.animations).forEach(([e,s])=>{t.style.setProperty(`--animation-${e}`,s)})})}applyThemeChange(e){const t=document.documentElement;switch(e.type){case"theme":t.setAttribute("data-theme",e.value);break;case"color":case"variable":t.style.setProperty(e.key,e.value);break;case"animation":t.style.setProperty(`--animation-${e.key}`,e.value)}}subscribe(e){return this.state.listeners.add(e),()=>{this.state.listeners.delete(e)}}notifyListeners(){const e=[...this.changeQueue];this.state.listeners.forEach(t=>{try{t(this.state.currentTheme,e)}catch(s){console.error("Ошибка в слушателе темы:",s)}})}updateConfig(e){this.config=o(o({},this.config),e)}getConfig(){return o({},this.config)}reset(){this.state.currentTheme=this.config.defaultTheme,this.state.serviceThemes.clear(),this.changeQueue=[],this.initializeDefaultThemes(),this.applyTheme()}getStats(){return{currentTheme:this.state.currentTheme,registeredThemes:this.state.serviceThemes.size,pendingChanges:this.changeQueue.length,listeners:this.state.listeners.size,isProcessing:this.state.isProcessing}}}const _=M.getInstance();const P=new class{constructor(){this.serviceIntegrations=new Map,this.workspaceItems=new Map,this.eventListeners={onItemCreated:[],onItemUpdated:[],onItemDeleted:[],onItemSelected:[]}}registerServiceIntegration(e){this.serviceIntegrations.set(e.serviceId,e),e.autoCreateItems&&e.workspaceItems.forEach(e=>{this.workspaceItems.set(e.id,e),this.eventListeners.onItemCreated.forEach(t=>t(e))}),console.log(`[WorkspaceIntegration] Сервис ${e.serviceId} зарегистрирован`)}unregisterServiceIntegration(e){const t=this.serviceIntegrations.get(e);t&&(t.workspaceItems.forEach(e=>{this.workspaceItems.delete(e.id),this.eventListeners.onItemDeleted.forEach(t=>t(e.id))}),this.serviceIntegrations.delete(e),console.log(`[WorkspaceIntegration] Сервис ${e} удален`))}createWorkspaceItem(e,t,s){const r=this.serviceIntegrations.get(e);if(!r)throw new Error(`Сервис ${e} не зарегистрирован`);const n=r.itemTemplates.find(e=>e.id===t);if(!n)throw new Error(`Шаблон ${t} не найден для сервиса ${e}`);const i=o({id:this.generateId(),name:n.name,type:n.type,icon:n.icon,description:n.description,content:s||n.template.content,metadata:{serviceId:e,createdAt:new Date,updatedAt:new Date,tags:n.tags,permissions:{read:!0,write:!0,delete:!0}}},n.template);return this.workspaceItems.set(i.id,i),this.eventListeners.onItemCreated.forEach(e=>e(i)),console.log(`[WorkspaceIntegration] Создан элемент ${i.name} для сервиса ${e}`),i}updateWorkspaceItem(e,t){const s=this.workspaceItems.get(e);if(!s)return!1;const r=l(o(o({},s),t),{metadata:l(o({},s.metadata),{updatedAt:new Date})});return this.workspaceItems.set(e,r),this.eventListeners.onItemUpdated.forEach(e=>e(r)),console.log(`[WorkspaceIntegration] Обновлен элемент ${e}`),!0}deleteWorkspaceItem(e){return!!this.workspaceItems.get(e)&&(this.workspaceItems.delete(e),this.eventListeners.onItemDeleted.forEach(t=>t(e)),console.log(`[WorkspaceIntegration] Удален элемент ${e}`),!0)}getWorkspaceItem(e){return this.workspaceItems.get(e)||null}getServiceItems(e){return Array.from(this.workspaceItems.values()).filter(t=>t.metadata.serviceId===e)}getAllItems(){return Array.from(this.workspaceItems.values())}getItemTemplates(e){const t=this.serviceIntegrations.get(e);return t?t.itemTemplates:[]}onItemCreated(e){this.eventListeners.onItemCreated.push(e)}onItemUpdated(e){this.eventListeners.onItemUpdated.push(e)}onItemDeleted(e){this.eventListeners.onItemDeleted.push(e)}onItemSelected(e){this.eventListeners.onItemSelected.push(e)}syncWithPlatform(){console.log("[WorkspaceIntegration] Синхронизация с платформой")}exportItems(e){return e?this.getServiceItems(e):this.getAllItems()}importItems(e){e.forEach(e=>{this.workspaceItems.set(e.id,e),this.eventListeners.onItemCreated.forEach(t=>t(e))}),console.log(`[WorkspaceIntegration] Импортировано ${e.length} элементов`)}generateId(){return`ws_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}};const L=new class{constructor(){this.services=[],this.hasLoadedOnce=!1,this.isLoading=!1}validateAndNormalizeConfig(e){try{const t=o({},e);Array.isArray(t.tools)&&(t.tools=t.tools.map(e=>{const s=o({},e);return s.action||(s.action=s.id),s.action!==s.id&&console.warn(`[services] Tool action differs from id in service ${t.id}: tool.id='${s.id}', action='${s.action}'`),s})),Array.isArray(t.chatFunctions)&&(t.chatFunctions=t.chatFunctions.map(e=>{const s=o({},e);return s.id||console.warn(`[services] Chat function without id in service ${t.id}`),"action"in s&&s.action||(s.action=s.id),s.action&&s.id&&s.action!==s.id&&console.warn(`[services] Chat function action differs from id in service ${t.id}: id='${s.id}', action='${s.action}'`),s.isChatFunction=!0,s}));const s=new Set,r=new Set;return(t.tools||[]).forEach(e=>{s.add(e.id),r.add(e.action||e.id)}),(t.chatFunctions||[]).forEach(e=>{s.add(e.id),r.add(e.action||e.id)}),Array.isArray(t.chatButtons)&&(t.chatButtons=t.chatButtons.map(e=>{const n=o({},e);return n.isEnabled||!1===n.isEnabled||(n.isEnabled=!0),"top"!==n.position&&"bottom"!==n.position&&(void 0!==n.position&&console.warn(`[services] Invalid chatButton.position '${n.position}' in service ${t.id}, defaulting to 'top'`),n.position="top"),!n.action||s.has(n.action)||r.has(n.action)||console.warn(`[services] chatButton.action '${n.action}' not found in tools/chatFunctions of service ${t.id}`),n})),t}catch(t){return console.warn(`[services] Validation failed for service ${e.id}:`,t),e}}loadAllServices(){return d(this,null,function*(){try{if(this.isLoading)return void console.log("[ServiceManager] Загрузка сервисов уже в процессе, пропускаем");if(this.hasLoadedOnce&&this.services.length>0)return void console.log("[ServiceManager] Сервисы уже загружены, пропускаем повторную загрузку");this.isLoading=!0,console.log("[ServiceManager] Начинаем загрузку сервисов..."),this.services=[],yield A.clearRegistry();const t=["ai-assistant.json","example-service.json","file-manager.json","settings.json","chatgpt-service.json","widgets-service.json","prompts-service.json","real-speech-service.json","ozon-manager.json","photo-studio.json"];for(const s of t)try{const e=yield fetch(`/services/${s}`);if(!e.ok){console.warn(`Файл сервиса ${s} не найден`);continue}const t=yield e.json(),r=this.validateAndNormalizeConfig(t),n=yield A.registerService(r);if(!n.isValid){console.error(`Ошибка регистрации сервиса ${r.id}:`,n.errors);continue}n.warnings.length>0&&console.warn(`Предупреждения для сервиса ${r.id}:`,n.warnings),n.suggestions.length>0&&console.info(`Предложения для сервиса ${r.id}:`,n.suggestions);const i={config:r,module:null,isLoaded:!1};this.services.some(e=>e.config.id===r.id)||(this.services.push(i),r.theme&&_.registerServiceTheme(r.id,r.theme))}catch(e){const t=e instanceof Error?e.message:"Неизвестная ошибка";console.error(`Ошибка загрузки сервиса ${s}:`,t),e instanceof Error&&e.stack&&console.error("Stack trace:",e.stack)}this.hasLoadedOnce=!0,console.log("[ServiceManager] Загрузка сервисов завершена успешно")}catch(e){console.error("Ошибка загрузки сервисов:",e)}finally{this.isLoading=!1}})}loadServiceFromFile(e){return d(this,null,function*(){try{const t=yield fetch(`/services/${e}`);if(!t.ok)throw new Error(`HTTP ${t.status}`);const s=yield t.json(),r={config:this.validateAndNormalizeConfig(s),module:null,isLoaded:!1};"settings"!==s.id&&"settings"!==s.category||this.services.push(r)}catch(t){console.error(`Ошибка загрузки сервиса ${e}:`,t)}})}loadService(e){return d(this,null,function*(){let t=this.services.find(t=>t.config.id===e);if(!t)try{const s=this.validateAndNormalizeConfig(yield C.loadServiceConfig(e));t={config:s,module:null,isLoaded:!1},this.services.push(t),s.theme&&_.registerServiceTheme(s.id,s.theme)}catch(s){throw console.error(`Не удалось загрузить конфигурацию сервиса ${e}:`,s),new Error(`Сервис ${e} не найден`)}if(!t.isLoaded)try{const s=yield C.loadServiceModule(e);s.initialize&&(yield s.initialize()),t.module=s,t.isLoaded=!0,t.error=void 0}catch(s){throw t.error=s instanceof Error?s.message:"Неизвестная ошибка",console.error(`Ошибка загрузки сервиса ${e}:`,s),s}})}unloadService(e){const t=this.services.find(t=>t.config.id===e);t&&(t.module&&t.module.cleanup&&t.module.cleanup().catch(t=>{console.error(`Ошибка при выгрузке сервиса ${e}:`,t)}),t.isLoaded=!1,t.module=null,C.unloadService(e))}getService(e){return this.services.find(t=>t.config.id===e)}getAllServices(){return this.services}executeTool(e,t,s){return d(this,null,function*(){const r=this.getService(e);if(!r)throw new Error(`Сервис ${e} не найден`);const n=r.config.tools.find(e=>e.id===t);if(!n)throw new Error(`Инструмент ${t} не найден в сервисе ${e}`);if(!n.isEnabled)throw new Error(`Инструмент ${t} отключен`);if(n.isChatFunction)return yield this.executeChatFunction(r,n,s);if(r.isLoaded||(yield this.loadService(e)),r.module&&r.module.execute)try{return yield r.module.execute(t,o(o({},n),s))}catch(i){throw console.error(`Ошибка выполнения инструмента ${t} через модуль:`,i),i}return{success:!0,message:`Инструмент ${n.name} выполнен`,data:null}})}executeChatFunction(e,t,s){return d(this,null,function*(){try{if(t.chatApiEndpoint&&e.config.chatApiBaseUrl){const r=yield fetch(`${e.config.chatApiBaseUrl}${t.chatApiEndpoint}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.config.chatApiKey||""}`},body:JSON.stringify(o({prompt:t.chatPrompt||t.description,serviceId:e.config.id,toolId:t.id},s))});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const n=yield r.json();return{success:!0,message:`Чат функция ${t.name} выполнена`,data:n,isChatResponse:!0}}return{success:!0,message:`Чат функция ${t.name} готова к выполнению`,data:{prompt:t.chatPrompt||t.description,serviceId:e.config.id,toolId:t.id},isChatResponse:!0}}catch(r){throw console.error(`Ошибка выполнения чат функции ${t.name}:`,r),r}})}getChatButtons(){const e=[];return this.services.filter(e=>e.config.isActive).forEach(t=>{t.config.chatButtons&&e.push(...t.config.chatButtons.filter(e=>e.isEnabled))}),e}validateAllServices(){try{this.services.forEach(e=>{e.config=this.validateAndNormalizeConfig(e.config)})}catch(e){console.warn("[services] Validation pass failed:",e)}}getChatButtonsGrouped(){const e=[],t=[];return this.services.filter(e=>e.config.isActive).forEach(s=>{const r=(s.config.chatButtons||[]).filter(e=>e.isEnabled);if(0===r.length)return;const n=r.filter(e=>"top"===(e.position||"top")),i=r.filter(e=>"bottom"===(e.position||"top"));n.length>0&&e.push({serviceId:s.config.id,serviceName:s.config.name,serviceIcon:s.config.icon,buttons:n}),i.length>0&&t.push({serviceId:s.config.id,serviceName:s.config.name,serviceIcon:s.config.icon,buttons:i})}),{top:e,bottom:t}}findChatFunctionInService(e,t){const s=(e.config.chatFunctions||[]).find(e=>e.isChatFunction&&e.isEnabled&&(e.id===t||e.action===t));if(s)return s;return e.config.tools.find(e=>e.isChatFunction&&e.isEnabled&&(e.id===t||e.action===t))}executeChatButton(e,t,s){return d(this,null,function*(){const r=this.getService(e);if(!r)throw new Error(`Сервис ${e} не найден`);const n=this.findChatFunctionInService(r,t.action||t.id);return n?this.executeTool(r.config.id,n.id,s):{success:!1,message:`Не найдена чат-функция для кнопки ${t.name}`}})}getChatFunctions(){const e=[];return this.services.filter(e=>e.config.isActive&&e.isLoaded).forEach(t=>{t.config.chatFunctions&&e.push(...t.config.chatFunctions.filter(e=>e.isEnabled)),e.push(...t.config.tools.filter(e=>e.isChatFunction&&e.isEnabled))}),e}getActiveServices(){return this.services.filter(e=>e.config.isActive&&e.isLoaded)}getSortedServices(){return[...this.services].sort((e,t)=>e.config.priority-t.config.priority)}preloadService(e){return d(this,null,function*(){try{yield C.preloadService(e)}catch(t){console.warn(`Не удалось предзагрузить сервис ${e}:`,t)}})}preloadServices(e){return d(this,null,function*(){yield C.preloadServices(e)})}isServiceLoaded(e){const t=this.getService(e);return!!t&&t.isLoaded}isServiceLoading(e){return C.isServiceLoading(e)}getLoadedServices(){return this.services.filter(e=>e.isLoaded).map(e=>e.config.id)}getServiceInfo(e){return A.getService(e)}getServiceCapabilities(e){return A.getServiceCapabilities(e)}validateService(e){return A.validateService(e)}validateServiceDependencies(e){return A.validateDependencies(e)}getServicesByCategory(e){return A.getServicesByCategory(e)}activateService(e){return d(this,null,function*(){return yield A.activateService(e)})}deactivateService(e){return d(this,null,function*(){return yield A.deactivateService(e)})}onServiceRegistered(e){A.onServiceRegistered(t=>e(t.config))}onServiceUnregistered(e){A.onServiceUnregistered(e)}onServiceActivated(e){A.onServiceActivated(e)}onServiceDeactivated(e){A.onServiceDeactivated(e)}registerWorkspaceIntegration(e,t,s=!0){P.registerServiceIntegration({serviceId:e,workspaceItems:t,autoCreateItems:s,itemTemplates:[],eventHandlers:{onItemCreate:e=>{console.log(`[ServiceManager] Создан элемент Workspace: ${e.name}`)},onItemUpdate:e=>{console.log(`[ServiceManager] Обновлен элемент Workspace: ${e.name}`)},onItemDelete:e=>{console.log(`[ServiceManager] Удален элемент Workspace: ${e}`)},onItemSelect:e=>{console.log(`[ServiceManager] Выбран элемент Workspace: ${e.name}`)}}})}createWorkspaceItem(e,t,s){return P.createWorkspaceItem(e,t,s)}getServiceWorkspaceItems(e){return P.getServiceItems(e)}syncWorkspace(){P.syncWithPlatform()}registerChatIntegration(e,t,s){N.registerServiceIntegration({serviceId:e,handlers:t,chatButtons:s,autoRegister:!0,eventHandlers:{onMessageReceived:t=>{console.log(`[ServiceManager] Получено сообщение для сервиса ${e}:`,t)},onResponseGenerated:t=>{console.log(`[ServiceManager] Сгенерирован ответ для сервиса ${e}:`,t)},onHandlerExecuted:(t,s)=>{console.log(`[ServiceManager] Выполнен обработчик ${t.name} для сервиса ${e}`)}}})}getServiceChatButtons(e){return N.getChatButtons(e)}getServiceChatHandlers(e){return N.getServiceHandlers(e)}syncChat(){N.syncWithChat()}createServiceChannel(e,t,s){return I.createChannel(e,t,s)}sendServiceMessage(e,t,s="message"){return I.sendDirectMessage(e,t,s)}getServiceStatus(e){return I.getServiceStatus(e)}setServiceStatus(e,t){I.setServiceStatus(e,t)}syncServiceData(e,t){I.syncServiceData(e,t)}getServiceData(e){return I.getServiceData(e)}getServiceCommunicationStats(){return I.getStats()}publishEvent(e,t,s="ServiceManager"){E.publish({id:`sm_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:e,source:s,data:t,timestamp:new Date,priority:"normal"})}subscribeToEvents(e,t){return E.subscribe(e,t)}requestFromService(e,t,s){return d(this,null,function*(){const r=yield E.request({id:`sm_req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,method:t,params:s,source:"ServiceManager",target:e,timestamp:new Date});if(!r.success)throw new Error(r.error||"Неизвестная ошибка");return r.data})}registerServiceHandler(e,t,s){E.respond(e,t,e=>d(this,null,function*(){try{const t=yield s(e.params);return{id:`sm_resp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,requestId:e.id,success:!0,data:t,timestamp:new Date}}catch(t){return{id:`sm_resp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,requestId:e.id,success:!1,error:t instanceof Error?t.message:"Неизвестная ошибка",timestamp:new Date}}}))}};const O=new class{constructor(){this.activeModes=new Map,this.availableModes=[],this.initializeModes()}initializeModes(){this.availableModes=[{id:"chatgpt-analysis",name:"Глубокое исследование",description:"Детальный анализ и исследование темы",icon:"Search",serviceId:"chatgpt-service",isActive:!1,priority:1,capabilities:["analysis","research","explanation"],promptTemplate:"Проведи глубокое исследование темы: {userInput}. Рассмотри все аспекты, приведи примеры и сделай выводы.",responseFormat:"markdown"},{id:"chatgpt-generation",name:"Генерация контента",description:"Создание текстов, идей и решений",icon:"Wand2",serviceId:"chatgpt-service",isActive:!1,priority:2,capabilities:["generation","creativity","writing"],promptTemplate:"Создай качественный контент на тему: {userInput}. Используй креативный подход и современные методы.",responseFormat:"text"},{id:"chatgpt-summary",name:"Краткое изложение",description:"Сжатие и структурирование информации",icon:"FileText",serviceId:"chatgpt-service",isActive:!1,priority:3,capabilities:["summarization","structuring","clarity"],promptTemplate:"Создай краткое и структурированное изложение: {userInput}. Выдели ключевые моменты.",responseFormat:"markdown"},{id:"ai-legal-consultation",name:"Юридическая консультация",description:"Правовые советы и анализ документов",icon:"Scale",serviceId:"ai-assistant",isActive:!1,priority:1,capabilities:["legal","analysis","advice"],promptTemplate:"Предоставь юридическую консультацию по вопросу: {userInput}. Укажи правовые нормы и рекомендации.",responseFormat:"markdown"},{id:"ai-contract-generation",name:"Создание договора",description:"Генерация правовых документов",icon:"FileText",serviceId:"ai-assistant",isActive:!1,priority:2,capabilities:["legal","generation","documents"],promptTemplate:"Создай договор на основе требований: {userInput}. Включи все необходимые пункты.",responseFormat:"text"},{id:"ai-task-creation",name:"Создание задачи",description:"Планирование и структурирование задач",icon:"CheckSquare",serviceId:"ai-assistant",isActive:!1,priority:3,capabilities:["planning","organization","productivity"],promptTemplate:"Создай структурированный план задач для: {userInput}. Разбей на этапы и приоритеты.",responseFormat:"markdown"}]}analyzeUserIntent(e){return d(this,null,function*(){const t=e.toLowerCase(),s=[],r={analysis:["анализ","исследование","изучить","разобрать","проанализировать"],generation:["создать","написать","сгенерировать","придумать","разработать"],legal:["юрист","право","договор","консультация","правовой","юридический"],planning:["план","задача","организовать","спланировать","структурировать"],summary:["кратко","суть","изложение","резюме","сжать"]};for(const[e,n]of Object.entries(r))if(n.some(e=>t.includes(e))){const t=this.availableModes.filter(t=>t.capabilities.some(t=>t.includes(e)));s.push(...t)}return 0===s.length&&s.push(this.availableModes.find(e=>"chatgpt-analysis"===e.id),this.availableModes.find(e=>"ai-legal-consultation"===e.id)),s.slice(0,3)})}activateMode(e,t){return d(this,null,function*(){const s=this.availableModes.find(t=>t.id===e);if(!s)throw new Error(`Режим ${e} не найден`);const r={modeId:e,serviceId:s.serviceId,activatedAt:new Date,context:{userInput:t},userIntent:t};return this.activeModes.set(e,r),s.isActive=!0,r})}processRequest(e,t){return d(this,null,function*(){if(!this.activeModes.get(e))throw new Error(`Режим ${e} не активирован`);const s=this.availableModes.find(t=>t.id===e);if(!s)throw new Error(`Режим ${e} не найден`);const r=yield L.executeChatButton(s.serviceId,{id:e,name:s.name,description:s.description,icon:s.icon,action:e,isEnabled:!0,color:"blue"});return{mode:s,response:"string"==typeof r?r:JSON.stringify(r),suggestions:this.generateSuggestions(s,t),nextActions:this.generateNextActions(s),confidence:.85}})}generateSuggestions(e,t){const s=[];return e.capabilities.includes("legal")&&(s.push("Нужна ли дополнительная правовая информация?"),s.push("Хотите создать документ на основе этого?")),e.capabilities.includes("analysis")&&(s.push("Углубиться в детали?"),s.push("Рассмотреть альтернативные подходы?")),e.capabilities.includes("generation")&&(s.push("Создать дополнительные варианты?"),s.push("Развить идею дальше?")),s}generateNextActions(e){const t=[];return e.capabilities.includes("legal")&&(t.push("Создать договор"),t.push("Найти похожие случаи")),e.capabilities.includes("analysis")&&(t.push("Создать диаграмму"),t.push("Экспортировать результаты")),t}getActiveModes(){return Array.from(this.activeModes.values())}deactivateMode(e){this.activeModes.delete(e);const t=this.availableModes.find(t=>t.id===e);t&&(t.isActive=!1)}getAvailableModes(){return this.availableModes}};const $=new class{constructor(){this.context={attachedItems:[],userLocation:"workspace"},this.listeners=new Set,this.handleAttachContext=e=>{const t=e.detail;-1===this.context.attachedItems.findIndex(e=>e.id===t.id)&&(this.context.attachedItems.push(t),this.notifyListeners(),console.log(`Контекст прикреплен: ${t.type} - ${t.title}`))},this.handleDetachContext=e=>{const{id:t}=e.detail;this.context.attachedItems=this.context.attachedItems.filter(e=>e.id!==t),this.notifyListeners(),console.log(`Контекст удален: ${t}`)},this.handleWorkspaceNavigate=e=>{const{projectId:t}=e.detail,s=this.findProjectById(t);s&&(this.context.activeProject={id:s.id,title:s.title,type:"project"},this.context.userLocation="project",this.autoAttachActiveProject(),this.notifyListeners(),console.log(`Активный проект: ${s.title}`))},this.handleWorkspaceSendToChat=e=>{const{items:t}=e.detail;t.forEach(e=>{const t={id:e.id,type:"folder"===e.type?"project":"note"===e.type?"document":e.type,title:e.title,icon:e.emoji||"📄",content:e.content,metadata:{path:e.path,size:e.size,tags:e.tags,createdAt:e.createdAt,updatedAt:e.updatedAt},removable:!0,source:"workspace"};this.attachContext(t)})},this.initEventListeners()}initEventListeners(){window.addEventListener("chat:attach-context",this.handleAttachContext),window.addEventListener("chat:detach-context",this.handleDetachContext),window.addEventListener("workspace:navigate",this.handleWorkspaceNavigate),window.addEventListener("workspace:send-to-chat",this.handleWorkspaceSendToChat)}autoAttachActiveProject(){if(this.context.activeProject){if(!this.context.attachedItems.find(e=>"project"===e.type&&e.id===this.context.activeProject.id)){const e={id:this.context.activeProject.id,type:"project",title:this.context.activeProject.title,icon:"📁",removable:!0,source:"workspace",metadata:{autoAttached:!0}};this.context.attachedItems.push(e)}}}findProjectById(e){var t;return((null==(t=window.__PLATFORM_STATE__)?void 0:t.workspaceItems)||[]).find(t=>t.id===e&&"folder"===t.type)||null}attachContext(e){window.dispatchEvent(new CustomEvent("chat:attach-context",{detail:e}))}detachContext(e){window.dispatchEvent(new CustomEvent("chat:detach-context",{detail:{id:e}}))}getContext(){return o({},this.context)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){this.listeners.forEach(e=>{try{e(this.getContext())}catch(t){console.error("Ошибка в слушателе контекста чата:",t)}})}clearContext(){this.context.attachedItems=[],this.context.activeProject=void 0,this.context.activeDocument=void 0,this.context.userLocation="workspace",this.notifyListeners(),console.log("Контекст чата очищен")}getContextForAI(){const e=this.generateContextSummary();return{attachedItems:this.context.attachedItems,activeProject:this.context.activeProject,userLocation:this.context.userLocation,contextSummary:e}}generateContextSummary(){const e=[];if(this.context.activeProject&&e.push(`Активный проект: ${this.context.activeProject.title}`),this.context.attachedItems.length>0){const t=this.context.attachedItems.map(e=>`${e.type}: ${e.title}`).join(", ");e.push(`Прикрепленные элементы: ${t}`)}return e.push(`Расположение пользователя: ${this.context.userLocation}`),e.join(" | ")}},D={NETWORK:"NETWORK_ERROR",VALIDATION:"VALIDATION_ERROR",AUTHENTICATION:"AUTHENTICATION_ERROR",AUTHORIZATION:"AUTHORIZATION_ERROR",NOT_FOUND:"NOT_FOUND_ERROR",SERVER:"SERVER_ERROR",CLIENT:"CLIENT_ERROR",UNKNOWN:"UNKNOWN_ERROR"},z={NETWORK_TIMEOUT:"NETWORK_TIMEOUT",NETWORK_OFFLINE:"NETWORK_OFFLINE",NETWORK_CONNECTION_FAILED:"NETWORK_CONNECTION_FAILED",INVALID_INPUT:"INVALID_INPUT",MISSING_REQUIRED_FIELD:"MISSING_REQUIRED_FIELD",INVALID_FORMAT:"INVALID_FORMAT",INVALID_CREDENTIALS:"INVALID_CREDENTIALS",TOKEN_EXPIRED:"TOKEN_EXPIRED",TOKEN_INVALID:"TOKEN_INVALID",FILE_TOO_LARGE:"FILE_TOO_LARGE",FILE_TYPE_NOT_SUPPORTED:"FILE_TYPE_NOT_SUPPORTED",FILE_UPLOAD_FAILED:"FILE_UPLOAD_FAILED",MESSAGE_SEND_FAILED:"MESSAGE_SEND_FAILED",MESSAGE_TOO_LONG:"MESSAGE_TOO_LONG",CHAT_NOT_FOUND:"CHAT_NOT_FOUND"},B={GENERIC:"Произошла неожиданная ошибка",NETWORK:"Ошибка сети. Проверьте подключение к интернету",VALIDATION:"Ошибка валидации данных",AUTHENTICATION:"Ошибка аутентификации",AUTHORIZATION:"Недостаточно прав для выполнения операции",NOT_FOUND:"Запрашиваемый ресурс не найден",SERVER:"Ошибка сервера. Попробуйте позже",FILE_UPLOAD:"Ошибка загрузки файла",MESSAGE_SEND:"Ошибка отправки сообщения"},F={MAX_ERRORS_IN_STORAGE:50,ERROR_RETENTION_DAYS:7,LOG_LEVELS:{ERROR:"error",WARNING:"warning",INFO:"info",DEBUG:"debug"}};const H=new class{constructor(){this.notifications=[],this.listeners=[],this.nextId=1}show(e,t,s,r){var n;const i={id:"notification_"+this.nextId++,type:e,title:t,message:s,duration:null!=(n=null==r?void 0:r.duration)?n:this.getDefaultDuration(e),actions:null==r?void 0:r.actions,metadata:null==r?void 0:r.metadata};return this.notifications.unshift(i),this.notifyListeners(),i.duration&&i.duration>0&&setTimeout(()=>{this.hide(i.id)},i.duration),i.id}success(e,t,s){return this.show("success",e,t,s)}error(e,t,s){return this.show("error",e,t,s)}warning(e,t,s){return this.show("warning",e,t,s)}info(e,t,s){return this.show("info",e,t,s)}hide(e){this.notifications=this.notifications.filter(t=>t.id!==e),this.notifyListeners()}hideAll(){this.notifications=[],this.notifyListeners()}getNotifications(){return[...this.notifications]}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}showErrorBoundaryNotification(e,t){const s=this.determineErrorType(e),r=this.getErrorTitle(s),n=this.getErrorMessage(e,s);return this.error(r,n,{duration:0,actions:[{label:"Подробности",action:()=>this.showErrorDetails(e,t),variant:"secondary"},{label:"Закрыть",action:()=>this.hideAll(),variant:"primary"}],metadata:{errorType:s,componentStack:null==t?void 0:t.componentStack,errorBoundary:null==t?void 0:t.errorBoundary}})}getDefaultDuration(e){switch(e){case"success":default:return 3e3;case"error":return 0;case"warning":return 5e3;case"info":return 4e3}}determineErrorType(e){return"TypeError"===e.name?"Ошибка типа":"ReferenceError"===e.name?"Ошибка ссылки":"NetworkError"===e.name?"Ошибка сети":e.message.includes("fetch")?"Ошибка загрузки":e.message.includes("auth")?"Ошибка аутентификации":e.message.includes("permission")?"Ошибка доступа":"Неизвестная ошибка"}getErrorTitle(e){return e}getErrorMessage(e,t){if(e.message)return e.message;switch(t){case"Ошибка сети":return B.NETWORK;case"Ошибка аутентификации":return B.AUTHENTICATION;case"Ошибка доступа":return B.AUTHORIZATION;default:return B.GENERIC}}showErrorDetails(e,t){this.info("Детали ошибки","Подробная информация об ошибке выведена в консоль разработчика")}notifyListeners(){this.listeners.forEach(e=>e(this.notifications))}};function U(e){var t,s,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(s=U(e[t]))&&(r&&(r+=" "),r+=s)}else for(s in e)e[s]&&(r&&(r+=" "),r+=s);return r}function W(){for(var e,t,s=0,r="";s<arguments.length;)(e=arguments[s++])&&(t=G(e))&&(r&&(r+=" "),r+=t);return r}function G(e){if("string"==typeof e)return e;for(var t,s="",r=0;r<e.length;r++)e[r]&&(t=G(e[r]))&&(s&&(s+=" "),s+=t);return s}function V(e){var t=function(e){var t=e.theme,s=e.prefix,r={nextPart:new Map,validators:[]},n=function(e,t){if(!t)return e;return e.map(function(e){return[e[0],e[1].map(function(e){return"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(function(e){var s=e[0],r=e[1];return[t+s,r]})):e})]})}(Object.entries(e.classGroups),s);return n.forEach(function(e){var s=e[0];Q(e[1],r,s,t)}),r}(e),s=e.conflictingClassGroups,r=e.conflictingClassGroupModifiers,n=void 0===r?{}:r;return{getClassGroupId:function(e){var s=e.split("-");return""===s[0]&&1!==s.length&&s.shift(),q(s,t)||function(e){if(K.test(e)){var t=K.exec(e)[1],s=null==t?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}}(e)},getConflictingClassGroupIds:function(e,t){var r=s[e]||[];return t&&n[e]?[].concat(r,n[e]):r}}}function q(e,t){var s;if(0===e.length)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),i=n?q(e.slice(1),n):void 0;if(i)return i;if(0!==t.validators.length){var a=e.join("-");return null==(s=t.validators.find(function(e){return(0,e.validator)(a)}))?void 0:s.classGroupId}}var K=/^\[(.+)\]$/;function Q(e,t,s,r){e.forEach(function(e){if("string"!=typeof e){if("function"==typeof e)return e.isThemeGetter?void Q(e(r),t,s,r):void t.validators.push({validator:e,classGroupId:s});Object.entries(e).forEach(function(e){var n=e[0];Q(e[1],Z(t,n),s,r)})}else{(""===e?t:Z(t,e)).classGroupId=s}})}function Z(e,t){var s=e;return t.split("-").forEach(function(e){s.nextPart.has(e)||s.nextPart.set(e,{nextPart:new Map,validators:[]}),s=s.nextPart.get(e)}),s}function Y(e){if(e<1)return{get:function(){},set:function(){}};var t=0,s=new Map,r=new Map;function n(n,i){s.set(n,i),++t>e&&(t=0,r=s,s=new Map)}return{get:function(e){var t=s.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(n(e,t),t):void 0},set:function(e,t){s.has(e)?s.set(e,t):n(e,t)}}}function J(e){var t=e.separator||":",s=1===t.length,r=t[0],n=t.length;return function(e){for(var i,a=[],o=0,l=0,c=0;c<e.length;c++){var d=e[c];if(0===o){if(d===r&&(s||e.slice(c,c+n)===t)){a.push(e.slice(l,c)),l=c+n;continue}if("/"===d){i=c;continue}}"["===d?o++:"]"===d&&o--}var m=0===a.length?e:e.substring(l),h=m.startsWith("!");return{modifiers:a,hasImportantModifier:h,baseClassName:h?m.substring(1):m,maybePostfixModifierPosition:i&&i>l?i-l:void 0}}}var X=/\s+/;function ee(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];var r,n,i,a=function(e){var s=t[0],c=t.slice(1).reduce(function(e,t){return t(e)},s());return r=function(e){return o({cache:Y(e.cacheSize),splitModifiers:J(e)},V(e))}(c),n=r.cache.get,i=r.cache.set,a=l,l(e)};function l(e){var t=n(e);if(t)return t;var s=function(e,t){var s=t.splitModifiers,r=t.getClassGroupId,n=t.getConflictingClassGroupIds,i=new Set;return e.trim().split(X).map(function(e){var t=s(e),n=t.modifiers,i=t.hasImportantModifier,a=t.baseClassName,o=t.maybePostfixModifierPosition,l=r(o?a.substring(0,o):a),c=Boolean(o);if(!l){if(!o)return{isTailwindClass:!1,originalClassName:e};if(!(l=r(a)))return{isTailwindClass:!1,originalClassName:e};c=!1}var d=function(e){if(e.length<=1)return e;var t=[],s=[];return e.forEach(function(e){"["===e[0]?(t.push.apply(t,s.sort().concat([e])),s=[]):s.push(e)}),t.push.apply(t,s.sort()),t}(n).join(":");return{isTailwindClass:!0,modifierId:i?d+"!":d,classGroupId:l,originalClassName:e,hasPostfixModifier:c}}).reverse().filter(function(e){if(!e.isTailwindClass)return!0;var t=e.modifierId,s=e.classGroupId,r=e.hasPostfixModifier,a=t+s;return!i.has(a)&&(i.add(a),n(s,r).forEach(function(e){return i.add(t+e)}),!0)}).reverse().map(function(e){return e.originalClassName}).join(" ")}(e,r);return i(e,s),s}return function(){return a(W.apply(null,arguments))}}function te(e){var t=function(t){return t[e]||[]};return t.isThemeGetter=!0,t}var se=/^\[(?:([a-z-]+):)?(.+)\]$/i,re=/^\d+\/\d+$/,ne=new Set(["px","full","screen"]),ie=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ae=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,oe=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function le(e){return pe(e)||ne.has(e)||re.test(e)||ce(e)}function ce(e){return je(e,"length",Ne)}function de(e){return je(e,"size",we)}function me(e){return je(e,"position",we)}function he(e){return je(e,"url",ke)}function ue(e){return je(e,"number",pe)}function pe(e){return!Number.isNaN(Number(e))}function xe(e){return e.endsWith("%")&&pe(e.slice(0,-1))}function ge(e){return Se(e)||je(e,"number",Se)}function ve(e){return se.test(e)}function fe(){return!0}function ye(e){return ie.test(e)}function be(e){return je(e,"",Ce)}function je(e,t,s){var r=se.exec(e);return!!r&&(r[1]?r[1]===t:s(r[2]))}function Ne(e){return ae.test(e)}function we(){return!1}function ke(e){return e.startsWith("url(")}function Se(e){return Number.isInteger(Number(e))}function Ce(e){return oe.test(e)}function Ee(){var e=te("colors"),t=te("spacing"),s=te("blur"),r=te("brightness"),n=te("borderColor"),i=te("borderRadius"),a=te("borderSpacing"),o=te("borderWidth"),l=te("contrast"),c=te("grayscale"),d=te("hueRotate"),m=te("invert"),h=te("gap"),u=te("gradientColorStops"),p=te("gradientColorStopPositions"),x=te("inset"),g=te("margin"),v=te("opacity"),f=te("padding"),y=te("saturate"),b=te("scale"),j=te("sepia"),N=te("skew"),w=te("space"),k=te("translate"),S=function(){return["auto",ve,t]},C=function(){return[ve,t]},E=function(){return["",le]},I=function(){return["auto",pe,ve]},T=function(){return["","0",ve]},A=function(){return[pe,ue]},R=function(){return[pe,ve]};return{cacheSize:500,theme:{colors:[fe],spacing:[le],blur:["none","",ye,ve],brightness:A(),borderColor:[e],borderRadius:["none","","full",ye,ve],borderSpacing:C(),borderWidth:E(),contrast:A(),grayscale:T(),hueRotate:R(),invert:T(),gap:C(),gradientColorStops:[e],gradientColorStopPositions:[xe,ce],inset:S(),margin:S(),opacity:A(),padding:C(),saturate:A(),scale:A(),sepia:T(),skew:R(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",ve]}],container:["container"],columns:[{columns:[ye]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[ve])}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ge]}],basis:[{basis:S()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ve]}],grow:[{grow:T()}],shrink:[{shrink:T()}],order:[{order:["first","last","none",ge]}],"grid-cols":[{"grid-cols":[fe]}],"col-start-end":[{col:["auto",{span:["full",ge]},ve]}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":[fe]}],"row-start-end":[{row:["auto",{span:[ge]},ve]}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ve]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ve]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat(["start","end","center","between","around","evenly","stretch"])}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[f]}],px:[{px:[f]}],py:[{py:[f]}],ps:[{ps:[f]}],pe:[{pe:[f]}],pt:[{pt:[f]}],pr:[{pr:[f]}],pb:[{pb:[f]}],pl:[{pl:[f]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[w]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[w]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",ve,t]}],"min-w":[{"min-w":["min","max","fit",ve,le]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[ye]},ye,ve]}],h:[{h:[ve,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",ve,le]}],"max-h":[{"max-h":[ve,t,"min","max","fit"]}],"font-size":[{text:["base",ye,ce]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ue]}],"font-family":[{font:[fe]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ve]}],"line-clamp":[{"line-clamp":["none",pe,ue]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ve,le]}],"list-image":[{"list-image":["none",ve]}],"list-style-type":[{list:["none","disc","decimal",ve]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(["solid","dashed","dotted","double","none"],["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",le]}],"underline-offset":[{"underline-offset":["auto",ve,le]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ve]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ve]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[me])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",de]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},he]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[u]}],"gradient-via":[{via:[u]}],"gradient-to":[{to:[u]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(["solid","dashed","dotted","double","none"],["hidden"])}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:[""].concat(["solid","dashed","dotted","double","none"])}],"outline-offset":[{"outline-offset":[ve,le]}],"outline-w":[{outline:[le]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:E()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[le]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ye,be]}],"shadow-color":[{shadow:[fe]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",ye,ve]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[m]}],saturate:[{saturate:[y]}],sepia:[{sepia:[j]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[j]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ve]}],duration:[{duration:R()}],ease:[{ease:["linear","in","out","in-out",ve]}],delay:[{delay:R()}],animate:[{animate:["none","spin","ping","pulse","bounce",ve]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[ge,ve]}],"translate-x":[{"translate-x":[k]}],"translate-y":[{"translate-y":[k]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ve]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ve]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ve]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[le,ue]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var Ie=ee(Ee);function Te(...e){return Ie(function(){for(var e,t,s=0,r="",n=arguments.length;s<n;s++)(e=arguments[s])&&(t=U(e))&&(r&&(r+=" "),r+=t);return r}(e))}const Ae=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]};var Re={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};var Me=(e,t)=>{const s=g.forwardRef((s,r)=>{var n,i=s,{color:a="currentColor",size:d=24,strokeWidth:m=2,absoluteStrokeWidth:h,children:u}=i,p=c(i,["color","size","strokeWidth","absoluteStrokeWidth","children"]);return g.createElement("svg",o(l(o({ref:r},Re),{width:d,height:d,stroke:a,strokeWidth:h?24*Number(m)/Number(d):m,className:`lucide lucide-${n=e,n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`}),p),[...t.map(([e,t])=>g.createElement(e,t)),...(Array.isArray(u)?u:[u])||[]])});return s.displayName=`${e}`,s};const _e=Me("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Pe=Me("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Le=Me("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]]),Oe=Me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),$e=Me("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),De=Me("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),ze=Me("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Be=Me("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Fe=Me("Bot",[["rect",{width:"18",height:"10",x:"3",y:"11",rx:"2",key:"1ofdy3"}],["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}],["path",{d:"M12 7v4",key:"xawao1"}],["line",{x1:"8",x2:"8",y1:"16",y2:"16",key:"h6x27f"}],["line",{x1:"16",x2:"16",y1:"16",y2:"16",key:"5lty7f"}]]),He=Me("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),Ue=Me("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),We=Me("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Ge=Me("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Ve=Me("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),qe=Me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Ke=Me("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Qe=Me("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Ze=Me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ye=Me("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]),Je=Me("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Xe=Me("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),et=Me("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),tt=Me("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),st=Me("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),rt=Me("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),nt=Me("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),it=Me("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),at=Me("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]),ot=Me("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),lt=Me("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),ct=Me("Folder",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}]]),dt=Me("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),mt=Me("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]]),ht=Me("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),ut=Me("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),pt=Me("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]),xt=Me("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),gt=Me("Layout",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"9",x2:"9",y1:"21",y2:"9",key:"wpwpyp"}]]),vt=Me("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),ft=Me("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),yt=Me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),bt=Me("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),jt=Me("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Nt=Me("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),wt=Me("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),kt=Me("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),St=Me("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),Ct=Me("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Et=Me("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),It=Me("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),Tt=Me("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),At=Me("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Rt=Me("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}]]),Mt=Me("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),_t=Me("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Pt=Me("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Lt=Me("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Ot=Me("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),$t=Me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Dt=Me("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),zt=Me("Rows",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}]]),Bt=Me("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Ft=Me("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),Ht=Me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Ut=Me("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Wt=Me("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Gt=Me("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Vt=Me("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),qt=Me("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Kt=Me("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),Qt=Me("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),Zt=Me("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Yt=Me("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Jt=Me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Xt=Me("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),es=Me("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),ts=Me("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ss=Me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),rs=Me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),ns=Me("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),is=Me("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),as=Me("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),os=Me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ls=Me("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),cs=Me("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),ds=Me("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),ms={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg",xl:"px-8 py-4 text-xl"},hs={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"},us={primary:"platform-button-primary",secondary:"platform-button-secondary",outline:"platform-button-outline",ghost:"platform-button-ghost",danger:"platform-button-danger",success:"platform-button-success"},ps={glass:{initial:{background:"var(--glass-bg)",backdropFilter:"blur(20px)",border:"1px solid var(--glass-border)",boxShadow:"0 8px 32px var(--glass-bg)"},hover:{background:"var(--button-secondary-hover)",backdropFilter:"blur(25px)",borderColor:"var(--primary)",boxShadow:"0 16px 48px var(--glass-border)",y:-4}},neumorphism:{initial:{background:"var(--primary)",color:"var(--background)",boxShadow:"8px 8px 16px var(--neumorphism-dark), -8px -8px 16px var(--neumorphism-light)"},hover:{y:-2,boxShadow:"12px 12px 24px var(--neumorphism-dark), -12px -12px 24px var(--neumorphism-light)"},tap:{y:0,boxShadow:"inset 4px 4px 8px var(--neumorphism-dark), inset -4px -4px 8px var(--neumorphism-light)"}},neon:{initial:{background:"var(--primary)",color:"var(--background)",boxShadow:"0 0 10px var(--primary), 0 0 20px var(--primary)"},hover:{boxShadow:"0 0 20px var(--primary), 0 0 40px var(--primary)",filter:"brightness(1.2)",y:-2}}},xs=g.memo(e=>{var t=e,{variant:s="primary",size:r="md",rounded:n="md",loading:i=!1,isLoading:a=!1,icon:d,leftIcon:p,rightIcon:x,iconPosition:g="left",animationType:f="none",children:y,className:b,disabled:j}=t,N=c(t,["variant","size","rounded","loading","isLoading","icon","leftIcon","rightIcon","iconPosition","animationType","children","className","disabled"]);const[w,k]=v.useState(!1),[S,C]=v.useState(!1),E=i||a,I=d||p,T=x,A=(e=>m({boxShadow:e?"0 0 30px rgba(139, 69, 19, 0.5), 0 0 60px rgba(160, 82, 45, 0.3)":"0 0 20px rgba(139, 69, 19, 0.3), 0 0 40px rgba(160, 82, 45, 0.2)",config:{tension:300,friction:30}}))(w),R=(e=>m({boxShadow:e?"0 0 20px rgba(34, 197, 94, 0.6), 0 0 40px rgba(217, 70, 239, 0.4)":"0 0 10px rgba(34, 197, 94, 0.4), 0 0 20px rgba(217, 70, 239, 0.2)",filter:e?"brightness(1.2)":"brightness(1)",config:{tension:400,friction:25}}))(S),M=s in ps,_=M?ps[s]:null,P=Te("platform-button-base",!M&&us[s],ms[r],hs[n],E&&"platform-button-loading",j&&"platform-button-disabled",b),L=M?{initial:"initial",whileHover:"hover",whileTap:"tap",variants:_||{},onHoverStart:()=>k(!0),onHoverEnd:()=>k(!1),onTapStart:()=>C(!0),onTap:()=>C(!1),transition:{duration:.3,ease:[.4,0,.2,1]}}:{whileHover:j||E?{}:{scale:1.02,transition:{duration:.2}},whileTap:j||E?{}:{scale:.98,transition:{duration:.1}}};return h.jsxs(u.button,l(o(l(o({className:P,disabled:j||E},L),{style:(()=>{switch(f){case"mocha-glow":return A;case"neon-pulse":return R;default:return{}}})()}),N),{children:["glass-shimmer"===f&&h.jsx(u.div,{className:"absolute inset-0 rounded-lg opacity-20",style:{background:"linear-gradient(90deg, transparent, var(--glass-border), transparent)",backgroundSize:"200% 100%"},animate:{backgroundPosition:["-200% 0","200% 0"]},transition:{duration:2,repeat:1/0,ease:"linear"}}),E&&h.jsx(u.div,{className:"platform-button-spinner",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),!E&&I&&"left"===g&&h.jsx(u.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1},className:"platform-button-icon-left",children:I}),h.jsx(u.span,{className:Te("platform-button-content",E&&"opacity-0"),initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:y}),!E&&T&&"right"===g&&h.jsx(u.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{delay:.1},className:"platform-button-icon-right",children:T}),M&&h.jsx(u.div,{className:"absolute inset-0 rounded-lg overflow-hidden",initial:{scale:0,opacity:0},whileTap:{scale:1,opacity:[0,.3,0]},transition:{duration:.6,ease:[.4,0,.2,1]},style:{background:"radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%)"}})]}))});xs.displayName="UnifiedButton";const gs={Square:Qt,Bot:Fe,Camera:Ge,Zap:ls,MessageCircle:wt,Languages:pt,Wand2:is,FileText:it,Edit3:_t,FolderOpen:lt,Upload:ts,Search:Ht,Smile:Kt,Settings:Wt,Eye:nt,EyeOff:rt,Mic:St,Paperclip:Mt,Send:Ut,FileTextIcon:it,Grid:mt},vs=({buttons:e,groups:t,onClick:s,className:r,activeButtonId:n,compactMode:i="normal"})=>{const a=g.useRef(null),c=Array.isArray(e)&&e.length>0,d=Array.isArray(t)&&t.length>0;if(!c&&!d)return null;const m=c?e:t.flatMap(e=>e.buttons.map(t=>l(o({},t),{serviceId:e.serviceId})));return h.jsx("div",{className:Te("chat-buttons-compact",i,r),children:h.jsx("div",{ref:a,className:"chat-buttons-compact-grid",children:m.map(e=>{const t=gs[e.icon]||Qt,r=e.serviceId?`${e.serviceId}-${e.id}`:e.id,i=n===r;return h.jsxs("button",{type:"button",onClick:()=>s(e,e.serviceId),className:Te("chat-button-compact",i&&"active",e.disabled&&"disabled"),title:e.description,disabled:e.disabled,children:[h.jsx(t,{className:"chat-button-icon"}),h.jsx("span",{className:"chat-button-label",children:e.name})]},r)})})})},fs=({contextButtons:e,onRemoveContext:t,className:s=""})=>{if(0===e.length)return null;const r=e=>{switch(e){case"project":return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:h.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"})});case"document":return h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[h.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),h.jsx("polyline",{points:"14 2 14 8 20 8"}),h.jsx("line",{x1:"16",x2:"8",y1:"13",y2:"13"}),h.jsx("line",{x1:"16",x2:"8",y1:"17",y2:"17"}),h.jsx("line",{x1:"10",x2:"8",y1:"9",y2:"9"})]});case"file":return h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[h.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),h.jsx("polyline",{points:"14 2 14 8 20 8"})]});case"image":return h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[h.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),h.jsx("circle",{cx:"9",cy:"9",r:"2"}),h.jsx("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]});case"prompt":return h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[h.jsx("path",{d:"M12 20h9"}),h.jsx("path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"})]});default:return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:h.jsx("circle",{cx:"12",cy:"12",r:"10"})})}},n=e=>{switch(e){case"project":return"bg-blue-100 text-blue-700 border-blue-200";case"document":return"bg-green-100 text-green-700 border-green-200";case"file":default:return"bg-gray-100 text-gray-700 border-gray-200";case"image":return"bg-purple-100 text-purple-700 border-purple-200";case"prompt":return"bg-orange-100 text-orange-700 border-orange-200"}};return h.jsx("div",{className:`flex flex-wrap gap-2 mb-3 ${s}`,children:e.map(e=>h.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border text-sm font-medium transition-colors ${n(e.type)}`,title:`${e.type}: ${e.title}`,children:[r(e.type),h.jsx("span",{className:"truncate max-w-[120px]",children:e.title}),e.removable&&h.jsx("button",{onClick:()=>t(e.id),className:"ml-1 p-0.5 rounded-full hover:bg-black/10 transition-colors",title:"Удалить из контекста",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3 h-3",children:[h.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),h.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]})})]},e.id))})},ys={creative:{temperature:1.2,top_p:.9,max_tokens:2e3,frequency_penalty:.1,presence_penalty:.1,model:"gpt-5-nano"},analytical:{temperature:.3,top_p:.8,max_tokens:1500,frequency_penalty:0,presence_penalty:0,model:"gpt-5-nano"},balanced:{temperature:.7,top_p:.9,max_tokens:1e3,frequency_penalty:0,presence_penalty:0,model:"gpt-5-nano"},precise:{temperature:.1,top_p:.7,max_tokens:800,frequency_penalty:-.1,presence_penalty:0,model:"gpt-5-nano"}};function bs(e){const t=[];return void 0!==e.temperature&&t.push(`T: ${e.temperature}`),void 0!==e.top_p&&t.push(`P: ${e.top_p}`),void 0!==e.max_tokens&&t.push(`Max: ${e.max_tokens}`),void 0!==e.frequency_penalty&&0!==e.frequency_penalty&&t.push(`Freq: ${e.frequency_penalty}`),void 0!==e.presence_penalty&&0!==e.presence_penalty&&t.push(`Pres: ${e.presence_penalty}`),t.join(", ")}const js=({promptId:e,promptTitle:t,settings:s,onRemove:r,onOpenPrompt:n,className:i=""})=>{const a=bs(s);return h.jsxs("div",{className:`prompt-settings-button ${i}`,children:[h.jsxs("button",{className:"prompt-settings-button-content",onClick:n,title:`Открыть промпт: ${t}`,children:[h.jsx("div",{className:"prompt-settings-button-icon",children:h.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),h.jsx("polyline",{points:"14,2 14,8 20,8"}),h.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),h.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),h.jsx("polyline",{points:"10,9 9,9 8,9"})]})}),h.jsxs("div",{className:"prompt-settings-button-text",children:[h.jsx("div",{className:"prompt-settings-button-title",children:t}),h.jsx("div",{className:"prompt-settings-button-settings",children:a})]})]}),h.jsx("button",{className:"prompt-settings-button-remove",onClick:r,title:"Удалить настройки промпта",children:h.jsxs("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),h.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})},Ns=({className:e,onInputResize:t})=>{var s;const{state:r,sendMessage:n,updateSettings:i}=j(),[a,o]=g.useState(""),[l,c]=g.useState(!1),[m,u]=g.useState([]),[p,x]=g.useState(null),[v,f]=g.useState(null),[y,b]=g.useState([]),[N]=g.useState(null),w=g.useRef(null),[k,S]=g.useState(!1),C=g.useRef(null),[E,I]=g.useState(0),[T]=g.useState("ai-assistant"),[A,R]=g.useState([]),[M,_]=g.useState({attachedItems:[],userLocation:"workspace"}),[P,D]=g.useState(null),z=g.useRef(null),B=g.useRef(null),F=g.useRef(null),[U,W]=g.useState(!1),G=g.useRef(null),[V,q]=g.useState(!1),K=g.useMemo(()=>{var e;return(null==(e=r.activeChat)?void 0:e.messages)||[]},[null==(s=r.activeChat)?void 0:s.messages]),Q=g.useMemo(()=>A.find(e=>e.id===T),[A,T]),Z=g.useMemo(()=>(null==Q?void 0:Q.models)?Q.models.map(e=>({id:e.id,name:e.name,description:e.description,icon:"Brain",color:"low"===e.cost?"green":"medium"===e.cost?"yellow":"red",action:`select-model-${e.id}`,isEnabled:!0})):[],[Q]),Y=g.useCallback(()=>{if(V)return void console.log("Прокрутка уже выполняется, игнорируем нажатие");console.log("Кнопка прокрутки нажата!"),q(!0),W(!1);const e=B.current;e?(e.scrollTop=e.scrollHeight,setTimeout(()=>{e.scrollTop=e.scrollHeight},10)):z.current&&z.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),setTimeout(()=>{q(!1)},1e3)},[V]);g.useLayoutEffect(()=>{if(!1===r.settings.autoScroll)return;const e=B.current;if(!e)return;const t=requestAnimationFrame(()=>{const t=requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight,setTimeout(()=>{e.scrollTop=e.scrollHeight},10)});return()=>cancelAnimationFrame(t)});return()=>cancelAnimationFrame(t)},[K.length,r.settings.autoScroll]),g.useEffect(()=>{const e=G.current;return()=>{e&&clearTimeout(e)}},[]),g.useEffect(()=>{console.log("Состояние стрелки изменилось:",U)},[U]),g.useEffect(()=>{if(!C.current)return void I(0);const e=C.current,t=()=>I(e.offsetHeight);t();const s=new ResizeObserver(t);return s.observe(e),()=>{s.disconnect()}},[k,r.settings.hideChatFunctionButtons,m.length]),g.useEffect(()=>{const e=B.current;if(e){const t=E>0&&!k?Math.max(0,E-75):0;e.style.setProperty("--chat-buttons-panel-height",`${t}px`)}},[E,k]),g.useEffect(()=>{if(!k&&E>0){const e=B.current;e&&(e.scrollTop=e.scrollHeight)}},[k,E]),g.useEffect(()=>{const e=L.getChatButtonsGrouped(),t=y.map(e=>({serviceId:"boss-ai",serviceName:"Boss Ai",serviceIcon:"Brain",buttons:[{id:e.id,name:e.name,description:e.description,icon:e.icon,color:"blue",action:e.id,isEnabled:!0}]}));u([...e.bottom,...t])},[r.services,y]),g.useEffect(()=>{const e=O.getAvailableModes();b(e)},[]),g.useEffect(()=>{(()=>{try{const e=L.getActiveServices().filter(e=>{const t=e.config.chatButtons&&e.config.chatButtons.length>0,s=e.config.chatFunctions&&e.config.chatFunctions.length>0,r=e.config.tools&&e.config.tools.some(e=>e.isChatFunction),n=!!e.config.chatApiBaseUrl;return t||s||r||n});R(e.map(e=>{var t;return{id:e.config.id,name:e.config.name,description:e.config.description,icon:e.config.icon,isActive:e.config.isActive,models:(null==(t=e.config.configuration)?void 0:t.models)||[]}}))}catch(e){console.error("Ошибка получения сервисов:",e)}})()},[r.services]),g.useEffect(()=>{var e;null==(e=F.current)||e.focus()},[]),g.useEffect(()=>{const e=document.querySelector(".chat-input-dynamic-height");if(e){const t=Math.max(256,Math.min(800,r.layout.chatInputHeight));e.style.height=`${t}px`}},[r.layout.chatInputHeight]),g.useEffect(()=>{const e=document.querySelector(".chat-container");e&&e.style.setProperty("--chat-width",`${r.layout.chatWidth}px`)},[r.layout.chatWidth]),g.useEffect(()=>{const e=document.querySelector(".chat-input-dynamic-height");if(e){const t=Math.max(256,Math.min(800,r.layout.chatInputHeight));e.style.setProperty("--chat-input-height-value",`${t}px`)}},[r.layout.chatInputHeight]),g.useEffect(()=>{const e=e=>{var t;const s=e;if(null==(t=s.detail)?void 0:t.body){const e=s.detail.body;a.trim()?o(t=>t+"\n\n"+e):o(e),s.detail.settings&&D({id:s.detail.id,title:s.detail.title,settings:s.detail.settings}),setTimeout(()=>{var e;null==(e=F.current)||e.focus()},100),console.log("Inserted prompt into chat:",s.detail.title,s.detail.settings?"with settings":"")}};return window.addEventListener("chat:insert-prompt",e),()=>window.removeEventListener("chat:insert-prompt",e)},[a]),g.useEffect(()=>{const e=e=>{const t=e;if(t.detail){const{title:e,content:s,contractType:r}=t.detail;$.attachContext({id:`contract-${r}-${Date.now()}`,type:"document",title:e,content:s,icon:"📄",removable:!0,source:"manual",metadata:{contractType:r}}),H.success("Документ прикреплен",`Договор "${e}" добавлен в чат`),console.log("Attached document to chat:",e,r)}};return window.addEventListener("chat:attach-document",e),()=>window.removeEventListener("chat:attach-document",e)},[]);const J=g.useCallback(()=>{D(null)},[]),X=g.useCallback(()=>{P&&window.dispatchEvent(new CustomEvent("prompts:open",{detail:{promptId:P.id}}))},[P]);g.useEffect(()=>$.subscribe(e=>{_(e)}),[]);const ee=g.useCallback(e=>{$.detachContext(e)},[]),te=g.useCallback(e=>d(void 0,null,function*(){if(e.preventDefault(),!a.trim())return;const t=a.trim();if(N)try{const e=yield O.processRequest(N.id,t);n(t),n(`🤖 ${e.response}`),e.suggestions.length>0&&n(`💡 Предложения: ${e.suggestions.join(", ")}`)}catch(s){console.error("Ошибка обработки через Boss Ai:",s),n(t)}else n(t),requestAnimationFrame(()=>{Y()});o(""),c(!1),Y()}),[a,n,N,Y]),se=g.useCallback(e=>{const s=e.target.value;o(s),c(!1),t&&t(e)},[t]),re=g.useCallback(()=>{const e=new CustomEvent("widgets:toggle",{detail:"voice-widget"});window.dispatchEvent(e)},[]),ne=g.useCallback(()=>{var e;null==(e=w.current)||e.click()},[]),ie=g.useCallback(()=>{const e=!r.settings.hideChatFunctionButtons;i("hideChatFunctionButtons",e),H.info("Кнопки функций",e?"Кнопки функций скрыты":"Кнопки функций показаны")},[r.settings.hideChatFunctionButtons,i]),ae=g.useCallback(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),te(e))},[te]),oe=(e,t)=>d(void 0,null,function*(){try{const s=`${t}-${e.id}`;if(p===s&&(null==v?void 0:v.buttonId)===s)return x(null),void f(null);const r=(e=>{var t;const s=e.name.toLowerCase(),r=(null==(t=e.description)?void 0:t.toLowerCase())||"";return s.includes("briefly")||s.includes("summary")||r.includes("кратк")?"📝 Режим кратких ответов - введите запрос":s.includes("improve")||r.includes("улучш")?"✨ Режим улучшения - введите текст для улучшения":s.includes("in-depth")||s.includes("research")||r.includes("глубок")?"🔍 Режим глубокого исследования - опишите тему":s.includes("content")||s.includes("generation")||r.includes("генерац")?"✍️ Режим генерации контента - опишите что создать":s.includes("legal")||r.includes("юрид")?"⚖️ Юридическая консультация - опишите вопрос":s.includes("contract")||s.includes("создан")||r.includes("договор")?"📄 Создание договора - укажите тип и детали":s.includes("task")||s.includes("создан")||r.includes("задач")?"✅ Создание задачи - опишите задачу":`🎯 Режим "${e.name}" - ${e.description||"введите запрос"}`})(e);return x(s),void f({buttonId:s,placeholder:r})}catch(s){const r=s instanceof Error?s.message:"Неизвестная ошибка";console.error("Ошибка выполнения чат кнопки:",s),n(`❌ Ошибка выполнения функции: ${e.name}`),H.error("Ошибка выполнения команды",`Не удалось выполнить команду "${e.name}". ${r}`,{metadata:{button:e.name,action:e.action,serviceId:t,error:r,timestamp:(new Date).toISOString()}}),x(null)}}),le=g.useCallback(()=>{S(!k)},[k]),ce=g.useCallback(e=>{try{const t=10485760,s=["image/","text/","application/pdf"],r=e.filter(e=>{const r=e.size<=t,n=s.some(t=>e.type.startsWith(t));return r&&n});r.length!==e.length&&H.warning("Некоторые файлы не загружены","Проверьте размер (макс. 10MB) и тип файлов"),r.length>0&&H.success("Файлы загружены",`Загружено ${r.length} файлов`)}catch(t){console.error("Ошибка загрузки файлов:",t),H.error("Ошибка загрузки","Не удалось загрузить файлы")}},[]),de=g.useCallback(e=>{const t=e.target.files;t&&t.length>0&&ce(Array.from(t)),w.current&&(w.current.value="")},[ce]);return h.jsxs("div",{className:Te("flex flex-col h-full chat-panel liquid-glass-panel relative",e),children:[h.jsx("div",{className:"py-2 px-4 liquid-glass-block flex items-center justify-between relative overflow-hidden chat-header",children:h.jsx("div",{className:"flex items-center space-x-2 relative z-10",children:N?h.jsxs(h.Fragment,{children:[h.jsxs("h3",{className:"font-semibold text-sm",children:["🎯 ",N.name]}),h.jsx("span",{className:"text-xs text-text-secondary",children:N.description})]}):r.layout.activeService?h.jsxs(h.Fragment,{children:[h.jsxs("h3",{className:"font-semibold text-sm",children:["Сервис: ",r.layout.activeService]}),h.jsx("span",{className:"text-xs text-text-secondary",children:"Обработка через выбранный сервис"})]}):h.jsxs("div",{className:"flex items-center space-x-4 relative z-10",children:[h.jsx("h3",{className:"font-bold text-base",children:"⚡ Boss AI"}),h.jsxs("span",{className:"text-xs text-text-secondary",children:["Интеллектуальная ОС с AI от"," ",h.jsx("a",{href:"https://t.me/Borislav_Barsukov",target:"_blank",rel:"noopener noreferrer",className:"text-text-secondary hover:underline transition-colors",children:"@Borislav_Barsukov"})]})]})})}),h.jsxs("div",{className:Te("flex-1 p-6 space-y-6 chat-messages overflow-y-auto chat-scrollbar",m.length>0&&!r.settings.hideChatFunctionButtons&&"chat-messages-with-buttons"),onScroll:e=>{const t=e.currentTarget,s=t.scrollHeight-t.scrollTop<=t.clientHeight+5;G.current&&clearTimeout(G.current),W(!s),console.log("Scroll event:",{scrollTop:t.scrollTop,scrollHeight:t.scrollHeight,clientHeight:t.clientHeight,isAtBottom:s,showScrollButton:!s})},ref:B,children:[0===K.length?h.jsx("div",{className:"flex flex-col items-center justify-center h-full text-center chat-interactive",children:h.jsx("div",{className:"flex flex-col gap-4 justify-center items-center animate-scale-in",children:Z.length>0&&!r.settings.hideChatFunctionButtons&&h.jsxs("div",{className:"w-full max-w-2xl",children:[h.jsxs("div",{className:"text-sm text-text-secondary mb-3",children:["Выберите режим для ",null==Q?void 0:Q.name,":"]}),h.jsx(vs,{buttons:Z,onClick:oe})]})})}):K.map(e=>{return h.jsx("div",{className:Te("flex mb-2 animate-fade-in chat-interactive","user"===e.sender?"justify-end":"justify-start"),children:h.jsx("div",{className:Te("max-w-xs lg:max-w-md px-4 py-0.5 rounded-xl transition-all duration-300 shadow-xl backdrop-blur-sm relative","hover:shadow-2xl transform-gpu","user"===e.sender?"message-user":"system"===e.sender?"message-system":"message-assistant"),children:h.jsxs("div",{className:"relative z-10",children:[h.jsxs("div",{className:Te("flex items-center mb-0 opacity-80 text-[10px] font-semibold","user"===e.sender?"flex-row-reverse justify-end gap-2 text-right":"justify-between"),children:[h.jsx("span",{children:"user"===e.sender?"U":"system"===e.sender?"Boss Ai":"AI"}),r.settings.showTimestamps&&h.jsx("span",{children:(t=e.timestamp,new Intl.DateTimeFormat("ru-RU",{hour:"2-digit",minute:"2-digit"}).format(t))})]}),h.jsx("p",{className:Te("text-xs leading-tight whitespace-pre-wrap font-medium","user"===e.sender&&"text-right"),children:e.content})]})})},e.id);var t}),l&&h.jsxs("div",{className:"flex items-end space-x-4 mb-6 animate-fade-in",role:"status","aria-live":"polite","aria-label":"AI печатает сообщение",children:[h.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-300 shadow-lg backdrop-blur-sm bg-gradient-to-br from-surface to-card-bg text-text shadow-border",children:"AI"}),h.jsx("div",{className:"px-4 py-2 rounded-lg border shadow-lg typing-indicator",children:h.jsxs("div",{className:"flex space-x-1","aria-hidden":"true",children:[h.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce typing-dot"}),h.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce delay-100 typing-dot"}),h.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce delay-200 typing-dot"})]})})]}),h.jsx("div",{ref:z})]}),h.jsxs("div",{className:"relative flex flex-col chat-input-container chat-input-dynamic-height chat-input-absolute","data-chat-input-height":Math.max(256,Math.min(800,r.layout.chatInputHeight)),children:[h.jsx("button",{onClick:Y,className:`chat-scroll-button chat-scroll-button-input absolute w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold cursor-pointer z-50 backdrop-blur-sm transition-all duration-200 ${U?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none is-hidden"} ${V?"opacity-50 cursor-not-allowed":""}`,title:V?"Прокрутка выполняется...":"Прокрутить вниз",disabled:V,children:"↓"}),h.jsx("div",{className:"select-none w-full relative z-50 pointer-events-auto m-0 p-0 chat-resize-handle absolute top-0 left-0 right-0",onMouseDown:t,title:"Изменить высоту поля ввода"}),m.length>0&&!r.settings.hideChatFunctionButtons&&h.jsx("div",{ref:C,className:"chat-buttons-panel-collapse "+(k?"chat-buttons-panel-collapsed":"chat-buttons-panel-expanded"),children:h.jsxs("div",{className:"px-6 pt-2 pb-6 mb-2",children:[h.jsx(vs,{groups:m,onClick:oe,activeButtonId:p}),h.jsx("div",{className:"w-full gradient-divider-wide mt-4 cursor-pointer hover:opacity-50 transition-opacity duration-200 relative flex items-center justify-end",onClick:le,title:k?"Показать выбор режима":"Скрыть выбор режима",children:h.jsx("span",{className:"text-xs text-white hover:text-gray-100 transition-colors duration-200 pointer-events-none pr-4",children:k?"Показать выбор режима":"Скрыть выбор режима"})})]})}),m.length>0&&!r.settings.hideChatFunctionButtons&&k&&h.jsx("div",{className:"px-6 pt-1 pb-1",children:h.jsx("div",{className:"w-full gradient-divider-wide cursor-pointer hover:opacity-50 transition-opacity duration-200 relative flex items-center justify-end",onClick:le,title:"Показать выбор режима",children:h.jsx("span",{className:"text-xs text-white hover:text-gray-100 transition-colors duration-200 pointer-events-none pr-4",children:"Показать выбор режима"})})}),h.jsx("div",{className:"flex-1 flex flex-col relative",children:h.jsxs("form",{onSubmit:te,className:"flex-1 flex flex-col relative z-10",children:[h.jsx(fs,{contextButtons:M.attachedItems,onRemoveContext:ee,className:"px-6 pt-4"}),P&&h.jsx("div",{className:"px-6 pt-2",children:h.jsx(js,{promptId:P.id,promptTitle:P.title,settings:P.settings,onRemove:J,onOpenPrompt:X})}),h.jsx("div",{className:"flex-1 relative",children:h.jsxs("div",{className:"relative h-full",children:[h.jsx("textarea",{ref:F,value:a,onChange:se,onKeyPress:ae,placeholder:(null==v?void 0:v.placeholder)||"Введите сообщение или используйте голосовой ввод",className:Te("w-full h-full pr-24 pl-6 pt-6 pb-6 backdrop-blur-sm border-2 border-border/50 rounded-3xl focus:outline-none focus:ring-2 focus:ring-green-500/30 focus:border-green-500/50 transition-all duration-300 shadow-xl resize-none chat-textarea relative z-10 bg-surface/80",v&&"active-mode"),disabled:!1,rows:4}),h.jsxs("div",{className:"absolute right-2 flex items-center gap-3 z-30 pointer-events-auto chat-input-tools-bottom",children:[h.jsx("div",{className:"input-tools",children:h.jsx(vs,{compactMode:"ultra-compact",buttons:[{id:"attach-file",name:"Файл",icon:"Paperclip",description:"Прикрепить файл",action:"attach",isEnabled:!0},{id:"prompts",name:"Промпты",icon:"Grid",description:"Заготовленные промпты",action:"prompts",isEnabled:!0},{id:"web-search",name:"Поиск",icon:"Search",description:"Поиск в интернете",action:"web-search",isEnabled:!0},{id:"toggle-panel",name:r.settings.hideChatFunctionButtons?"Показать":"Скрыть",icon:r.settings.hideChatFunctionButtons?"EyeOff":"Eye",description:r.settings.hideChatFunctionButtons?"Показать кнопки функций":"Скрыть кнопки функций",action:"toggle-panel",isEnabled:!0},{id:"voice-input",name:"Голос",icon:"Mic",description:"Голосовой ввод",action:"voice",isEnabled:!0}],onClick:e=>{switch(e.action){case"attach":ne();break;case"prompts":{const e=new CustomEvent("prompts:open");window.dispatchEvent(e),H.info("Заготовленные промпты","Открыта панель с готовыми шаблонами");break}case"web-search":{const e=new CustomEvent("web-search:open");window.dispatchEvent(e),H.info("Поиск в интернете","Открыт поиск в интернете");break}case"toggle-panel":ie();break;case"voice":re()}}})}),h.jsx(xs,{type:"button",variant:"primary",size:"sm",title:"Отправить",className:Te("chat-send-button rounded-lg p-0 w-[44px] h-[44px] min-w-[44px] min-h-[44px] leading-none flex items-center justify-center",!a.trim()&&"opacity-50 cursor-not-allowed"),disabled:!a.trim(),onClick:()=>{a.trim()&&(n(a),o(""),Y())},children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[h.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),h.jsx("path",{d:"M22 2 11 13"})]})})]})]})})]})}),h.jsx("input",{ref:w,type:"file",multiple:!0,accept:"image/*,text/*,application/pdf",onChange:de,className:"hidden","aria-label":"Выберите файлы для загрузки"})]})]})};const ws=new class{constructor(e){this.errorHandlers=[],this.errorCount=0,this.errors=[],this.config=e,this.sessionId=this.generateSessionId(),this.setupGlobalErrorHandlers()}registerErrorHandler(e){this.errorHandlers.push(e)}unregisterErrorHandler(e){const t=this.errorHandlers.indexOf(e);t>-1&&this.errorHandlers.splice(t,1)}handleError(e,t){if(this.errorCount>=this.config.maxErrorsPerSession)return;this.errorCount++;const s={id:this.generateErrorId(),message:e.message,stack:e.stack,component:null==t?void 0:t.component,service:null==t?void 0:t.service,timestamp:new Date,severity:this.determineSeverity(e,t),userAgent:navigator.userAgent,url:window.location.href,userId:null==t?void 0:t.userId,sessionId:this.sessionId};this.errors.push(s),this.config.enableConsoleLogging&&this.logToConsole(s,t),this.config.enableUserNotifications&&this.notifyUser(s),this.config.enableRemoteLogging&&this.reportToRemote(s),this.errorHandlers.forEach(s=>{try{s(e,t)}catch(r){console.error("Error in error handler:",r)}})}handlePromiseRejection(e){const t=e.reason instanceof Error?e.reason:new Error(String(e.reason));this.handleError(t,{component:"Promise",action:"rejection"})}handleResourceError(e){const t=e.target,s=new Error(`Failed to load resource: ${t.tagName}`);this.handleError(s,{component:"Resource",action:"load",metadata:{tagName:t.tagName,src:t.src||t.href}})}getErrors(){return[...this.errors]}getErrorsByService(e){return this.errors.filter(t=>t.service===e)}getErrorsByComponent(e){return this.errors.filter(t=>t.component===e)}getErrorsBySeverity(e){return this.errors.filter(t=>t.severity===e)}clearErrors(){this.errors=[],this.errorCount=0}getErrorStats(){const e={total:this.errors.length,bySeverity:{},byService:{},byComponent:{}};return this.errors.forEach(t=>{e.bySeverity[t.severity]=(e.bySeverity[t.severity]||0)+1,t.service&&(e.byService[t.service]=(e.byService[t.service]||0)+1),t.component&&(e.byComponent[t.component]=(e.byComponent[t.component]||0)+1)}),e}setupGlobalErrorHandlers(){this.config.enableErrorBoundary&&(window.addEventListener("error",e=>{this.handleError(e.error,{component:"Global",action:"unhandled"})}),window.addEventListener("unhandledrejection",e=>{this.handlePromiseRejection(e)}),window.addEventListener("error",e=>{e.target!==window&&this.handleResourceError(e)},!0))}determineSeverity(e,t){return"TypeError"===e.name||"ReferenceError"===e.name?"critical":(null==t?void 0:t.service)?"high":(null==t?void 0:t.component)?"medium":"low"}logToConsole(e,t){const s=`[ErrorHandlingService] ${e.severity.toUpperCase()}: ${e.message}`;switch(e.severity){case"critical":case"high":console.error(s,e,t);break;case"medium":console.warn(s,e,t);break;case"low":console.info(s,e,t)}}notifyUser(e){"critical"===e.severity&&console.warn("Critical error occurred:",e.message)}reportToRemote(e){return d(this,null,function*(){if(this.config.remoteEndpoint&&this.config.apiKey)try{yield fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},body:JSON.stringify(e)})}catch(t){console.error("Failed to report error to remote server:",t)}})}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateErrorId(){return`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}({enableConsoleLogging:!0,enableRemoteLogging:!1,enableUserNotifications:!0,enableErrorBoundary:!0,maxErrorsPerSession:100});class ks extends g.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){const s={component:"ErrorBoundary",action:"componentDidCatch",metadata:{componentStack:t.componentStack,errorBoundary:!0}};ws.handleError(e,s),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:h.jsx("div",{className:"error-boundary",children:h.jsxs("div",{className:"error-boundary__container",children:[h.jsx("div",{className:"error-boundary__icon",children:"⚠️"}),h.jsx("h2",{className:"error-boundary__title",children:"Что-то пошло не так"}),h.jsx("p",{className:"error-boundary__message",children:"Произошла ошибка в приложении. Мы уже работаем над её исправлением."}),h.jsxs("div",{className:"error-boundary__actions",children:[h.jsx("button",{className:"error-boundary__button error-boundary__button--primary",onClick:()=>window.location.reload(),children:"Перезагрузить страницу"}),h.jsx("button",{className:"error-boundary__button error-boundary__button--secondary",onClick:()=>this.setState({hasError:!1,error:void 0,errorInfo:void 0}),children:"Попробовать снова"})]}),!1]})}):this.props.children}}const Ss=({notification:e,onClose:t})=>{const s=(e=>{switch(e){case"success":return{container:"bg-green-50 border-green-200 text-green-800",icon:"text-green-400",button:"bg-green-100 hover:bg-green-200 text-green-800"};case"error":return{container:"bg-red-50 border-red-200 text-red-800",icon:"text-red-400",button:"bg-red-100 hover:bg-red-200 text-red-800"};case"warning":return{container:"bg-yellow-50 border-yellow-200 text-yellow-800",icon:"text-yellow-400",button:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800"};case"info":return{container:"bg-primary border-primary text-background",icon:"text-background",button:"bg-primary hover:bg-primary/80 text-background"}}})(e.type);return h.jsx(u.div,{initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.95},transition:{duration:.3,ease:[.25,.46,.45,.94]},className:Te("max-w-sm w-full p-4 rounded-lg border shadow-lg",s.container),children:h.jsxs("div",{className:"flex items-start space-x-3",children:[h.jsx("div",{className:Te("flex-shrink-0",s.icon),children:(e=>{switch(e){case"success":return h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"warning":return h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":return h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}})(e.type)}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"text-sm font-medium mb-1",children:e.title}),h.jsx("p",{className:"text-sm opacity-90",children:e.message}),e.actions&&e.actions.length>0&&h.jsx("div",{className:"mt-3 flex space-x-2",children:e.actions.map((e,t)=>h.jsx("button",{type:"button",onClick:e.action,className:Te("px-3 py-1 text-xs font-medium rounded transition-colors duration-200",s.button),children:e.label},t))})]}),h.jsx("button",{type:"button",onClick:()=>t(e.id),className:Te("flex-shrink-0 p-1 rounded transition-colors duration-200",s.button),"aria-label":"Закрыть уведомление",children:h.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},Cs=()=>{const[e,t]=g.useState([]);return g.useEffect(()=>H.subscribe(t),[]),h.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:h.jsx(p,{children:e.map(e=>h.jsx(Ss,{notification:e,onClose:e=>H.hide(e)},e.id))})})},Es=()=>{const[e,t]=g.useState("regulations"),[s,r]=g.useState(null),[n,i]=g.useState(""),a=[{id:"1",title:"Обработка входящих лидов",category:"leads",priority:"high",status:"active",lastUpdated:"2025-01-15",content:"Регламент обработки входящих лидов определяет стандарты работы с потенциальными клиентами для обеспечения высокого качества сервиса и максимальной конверсии.\n\nЦЕЛИ:\n- Обеспечить быструю реакцию на входящие заявки\n- Квалифицировать лидов по стандарту BANT\n- Максимизировать конверсию лид → клиент\n- Поддерживать высокий уровень клиентского сервиса",steps:["Время реакции: 5 минут (в рабочее время)","Квалификация по BANT (Budget, Authority, Need, Timeline)","Назначение ответственного менеджера","Создание задачи в CRM","Отправка welcome-письма","Планирование следующего контакта"],metrics:{compliance:95,efficiency:88,satisfaction:92}},{id:"2",title:"Поддержка клиентов",category:"support",priority:"high",status:"active",lastUpdated:"2025-01-14",content:"Стандарты поддержки клиентов обеспечивают быстрое и качественное решение вопросов, повышая удовлетворенность и удержание клиентов.\n\nПРИОРИТЕТЫ ОТВЕТОВ:\n- Критический (система не работает): 30 минут\n- Высокий (функция не работает): 4 часа\n- Средний (вопрос по использованию): 24 часа\n- Низкий (улучшение, идея): 7 дней",steps:["Автоматическая классификация тикета по приоритету","Назначение на специалиста соответствующего уровня","Первичный ответ в течение SLA","Диагностика и решение проблемы","Подтверждение решения с клиентом","Закрытие тикета и сбор обратной связи"],metrics:{compliance:98,efficiency:85,satisfaction:89}},{id:"3",title:"Разработка новых функций",category:"development",priority:"medium",status:"active",lastUpdated:"2025-01-13",content:"Процесс разработки новых функций обеспечивает качественную и своевременную доставку функциональности, соответствующей потребностям клиентов.\n\nЭТАПЫ РАЗРАБОТКИ:\n1. Сбор и анализ требований\n2. Техническое проектирование\n3. Разработка и тестирование\n4. Code review и QA\n5. Развертывание и мониторинг",steps:["Сбор запросов от клиентов и команды","Приоритизация по RICE (Reach, Impact, Confidence, Effort)","Создание технического задания","Разработка в спринтах по 2 недели","Code review (обязательно)","Тестирование (покрытие >80%)","Поэтапный rollout","Мониторинг и сбор метрик"],metrics:{compliance:90,efficiency:82,satisfaction:87}},{id:"4",title:"Воронки продаж",category:"sales",priority:"high",status:"active",lastUpdated:"2025-01-12",content:"Автоматизированные воронки продаж обеспечивают систематический подход к конверсии лидов в клиентов с максимальной эффективностью.\n\nСТАДИИ ВОРОНКИ:\n1. Лид (новый контакт)\n2. Квалифицирован (BANT пройден)\n3. Демо назначено\n4. Предложение отправлено\n5. Переговоры\n6. Закрыт (выигран/проигран)",steps:["Автоматическая квалификация лида","Назначение ответственного менеджера","Планирование демонстрации","Подготовка персонализированного предложения","Проведение переговоров","Закрытие сделки или возврат в nurture","Анализ результатов и оптимизация"],metrics:{compliance:93,efficiency:91,satisfaction:88}},{id:"5",title:"Маркетинг-кампании",category:"marketing",priority:"medium",status:"active",lastUpdated:"2025-01-11",content:"Процесс создания и запуска маркетинговых кампаний обеспечивает эффективное привлечение и удержание клиентов.\n\nТИПЫ КАМПАНИЙ:\n- Email-рассылки\n- Таргетированная реклама\n- Контент-маркетинг\n- Вебинары и мероприятия\n- Партнерские программы",steps:["Определение целей и KPI кампании","Сегментация целевой аудитории","Создание креативов и контента","Настройка каналов доставки","A/B тестирование элементов","Запуск и мониторинг","Анализ результатов и оптимизация"],metrics:{compliance:87,efficiency:79,satisfaction:85}}].filter(e=>e.title.toLowerCase().includes(n.toLowerCase())||e.content.toLowerCase().includes(n.toLowerCase())),o=e=>{switch(e){case"leads":return h.jsx(Yt,{className:"w-5 h-5"});case"support":return h.jsx(kt,{className:"w-5 h-5"});case"development":return h.jsx(Wt,{className:"w-5 h-5"});case"sales":return h.jsx(Xt,{className:"w-5 h-5"});case"marketing":return h.jsx(De,{className:"w-5 h-5"});default:return h.jsx(it,{className:"w-5 h-5"})}},l=e=>{switch(e){case"leads":return"Лиды";case"support":return"Поддержка";case"development":return"Разработка";case"sales":return"Продажи";case"marketing":return"Маркетинг";default:return"Общее"}},c=e=>{switch(e){case"high":return"text-red-400 bg-red-900/20 border-red-500/30";case"medium":return"text-yellow-400 bg-yellow-900/20 border-yellow-500/30";case"low":return"text-green-400 bg-green-900/20 border-green-500/30";default:return"text-gray-400 bg-gray-900/20 border-gray-500/30"}},d=e=>{switch(e){case"active":return"text-green-400 bg-green-900/20";case"draft":return"text-yellow-400 bg-yellow-900/20";default:return"text-gray-400 bg-gray-900/20"}},m=(e,t=150)=>e.length<=t?e:e.substring(0,t)+"...";return h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Регламенты работы"}),h.jsx("p",{className:"text-gray-300",children:"Стандарты и процессы для эффективной работы команды"})]}),h.jsx("div",{className:"mb-6",children:h.jsxs("div",{className:"relative max-w-md",children:[h.jsx("input",{type:"text",placeholder:"Поиск регламентов...",value:n,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 pl-10 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500"}),h.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"})]})}),h.jsx("div",{className:"flex space-x-1 mb-8 bg-white/10 rounded-lg p-1",children:[{id:"regulations",label:"Регламенты",icon:it},{id:"templates",label:"Шаблоны",icon:Be},{id:"compliance",label:"Соответствие",icon:Vt}].map(s=>h.jsxs("button",{onClick:()=>t(s.id),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors "+(e===s.id?"bg-purple-500 text-white":"text-gray-300 hover:text-white hover:bg-white/10"),children:[h.jsx(s.icon,{className:"w-4 h-4"}),h.jsx("span",{children:s.label})]},s.id))}),"regulations"===e&&h.jsx("div",{className:"space-y-6",children:a.map(e=>h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl border border-white/10 hover:bg-white/10 transition-all duration-300",children:[h.jsxs("div",{onClick:()=>{return t=e.id,void r(s===t?null:t);var t},className:"p-6 cursor-pointer",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center text-white",children:o(e.category)}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-white",children:e.title}),h.jsx("p",{className:"text-sm text-gray-400",children:l(e.category)})]})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c(e.priority)}`,children:"high"===e.priority?"Высокий":"medium"===e.priority?"Средний":"Низкий"}),h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d(e.status)}`,children:"active"===e.status?"Активен":"draft"===e.status?"Черновик":"Архив"})]})]}),h.jsx("div",{className:"mb-4",children:h.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:m(e.content)})}),h.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[e.metrics.compliance,"%"]}),h.jsx("div",{className:"text-xs text-gray-400",children:"Соответствие"})]}),h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[e.metrics.efficiency,"%"]}),h.jsx("div",{className:"text-xs text-gray-400",children:"Эффективность"})]}),h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[e.metrics.satisfaction,"%"]}),h.jsx("div",{className:"text-xs text-gray-400",children:"Удовлетворенность"})]})]}),h.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[h.jsxs("span",{children:["Обновлено: ",e.lastUpdated]}),h.jsxs("span",{children:[e.steps.length," шагов"]}),h.jsx("span",{className:"text-purple-400 font-medium",children:s===e.id?"Свернуть ▼":"Развернуть ▶"})]})]}),s===e.id&&h.jsx("div",{className:"border-t border-white/10 p-6 bg-black/10",children:h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Полное описание"}),h.jsx("div",{className:"bg-black/20 rounded-lg p-4",children:h.jsx("p",{className:"text-gray-300 whitespace-pre-wrap",children:e.content})})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Шаги выполнения"}),h.jsx("div",{className:"space-y-3",children:e.steps.map((e,t)=>h.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-black/20 rounded-lg",children:[h.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-sm font-semibold flex-shrink-0",children:t+1}),h.jsx("span",{className:"text-gray-300",children:e})]},t))})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Детальные метрики"}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsxs("div",{className:"text-center p-4 bg-green-900/20 border border-green-500/30 rounded-lg",children:[h.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[e.metrics.compliance,"%"]}),h.jsx("div",{className:"text-sm text-gray-400",children:"Соответствие"})]}),h.jsxs("div",{className:"text-center p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:[h.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[e.metrics.efficiency,"%"]}),h.jsx("div",{className:"text-sm text-gray-400",children:"Эффективность"})]}),h.jsxs("div",{className:"text-center p-4 bg-purple-900/20 border border-purple-500/30 rounded-lg",children:[h.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[e.metrics.satisfaction,"%"]}),h.jsx("div",{className:"text-sm text-gray-400",children:"Удовлетворенность"})]})]})]})]})})]},e.id))}),"templates"===e&&h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[h.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Готовые шаблоны процессов"}),h.jsx("p",{className:"text-gray-300 mb-6",children:"Используйте готовые шаблоны для быстрого создания стандартизированных процессов"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{name:"Шаблон обработки лида",description:"Полная процедура работы с новым лидом от первого контакта до квалификации",category:"leads",usage:95,steps:["Получение заявки (время реакции: 5 мин)","Первичный контакт и знакомство","Квалификация по BANT","Назначение ответственного менеджера","Создание карточки в CRM","Отправка welcome-письма","Планирование следующего контакта"],content:"ШАБЛОН ОБРАБОТКИ ЛИДА\n\nЦЕЛЬ: Максимизировать конверсию лид → клиент\n\nВРЕМЯ РЕАКЦИИ: 5 минут (в рабочее время)\n\nПРОЦЕСС:\n1. Получение заявки\n   - Проверить источник лида\n   - Зафиксировать время поступления\n   - Оценить приоритет\n\n2. Первичный контакт\n   - Позвонить в течение 5 минут\n   - Представиться и узнать цель обращения\n   - Задать уточняющие вопросы\n\n3. Квалификация по BANT\n   - Budget (бюджет): есть ли выделенный бюджет?\n   - Authority (полномочия): принимает ли решения?\n   - Need (потребность): какая проблема решается?\n   - Timeline (сроки): когда нужно решение?\n\n4. Назначение менеджера\n   - Выбрать подходящего специалиста\n   - Передать всю информацию\n   - Установить сроки следующего контакта\n\n5. CRM и документирование\n   - Создать карточку лида\n   - Заполнить все поля\n   - Добавить заметки и комментарии\n\n6. Welcome-письмо\n   - Отправить приветственное письмо\n   - Приложить полезные материалы\n   - Указать контакты менеджера\n\n7. Планирование\n   - Запланировать следующий контакт\n   - Подготовить материалы для демо\n   - Настроить напоминания"},{name:"Шаблон поддержки клиента",description:"Стандартная процедура решения проблем клиентов с учетом приоритетов",category:"support",usage:88,steps:["Классификация тикета по приоритету","Назначение на специалиста","Первичный ответ в SLA","Диагностика проблемы","Решение и тестирование","Подтверждение с клиентом","Закрытие и обратная связь"],content:"ШАБЛОН ПОДДЕРЖКИ КЛИЕНТА\n\nПРИОРИТЕТЫ SLA:\n- Критический: 30 минут\n- Высокий: 4 часа\n- Средний: 24 часа\n- Низкий: 7 дней\n\nПРОЦЕСС:\n1. Классификация тикета\n   - Определить тип проблемы\n   - Оценить влияние на бизнес\n   - Установить приоритет\n   - Назначить SLA\n\n2. Назначение специалиста\n   - Выбрать эксперта по теме\n   - Учесть загрузку команды\n   - Уведомить о новом тикете\n   - Передать контекст\n\n3. Первичный ответ\n   - Подтвердить получение\n   - Уточнить детали проблемы\n   - Дать временную оценку\n   - Предложить временное решение\n\n4. Диагностика\n   - Воспроизвести проблему\n   - Проверить логи и метрики\n   - Изучить похожие случаи\n   - Определить корневую причину\n\n5. Решение\n   - Разработать фикс\n   - Протестировать решение\n   - Подготовить инструкции\n   - Задокументировать процесс\n\n6. Подтверждение\n   - Проверить с клиентом\n   - Убедиться в решении\n   - Собрать обратную связь\n   - Предложить улучшения\n\n7. Закрытие\n   - Обновить статус тикета\n   - Добавить в базу знаний\n   - Отправить итоговое письмо\n   - Запланировать follow-up"},{name:"Шаблон разработки функции",description:"Чек-лист для создания новых возможностей продукта",category:"development",usage:92,steps:["Сбор и анализ требований","Техническое проектирование","Разработка в спринтах","Code review и QA","Тестирование и отладка","Развертывание","Мониторинг и метрики"],content:"ШАБЛОН РАЗРАБОТКИ ФУНКЦИИ\n\nЭТАПЫ РАЗРАБОТКИ:\n1. Сбор требований\n2. Техническое проектирование\n3. Разработка и тестирование\n4. Code review и QA\n5. Развертывание и мониторинг\n\nПРОЦЕСС:\n1. СБОР ТРЕБОВАНИЙ\n   - Интервью с заказчиком\n   - Анализ пользовательских историй\n   - Приоритизация по RICE\n   - Создание технического задания\n   - Оценка трудозатрат\n\n2. ТЕХНИЧЕСКОЕ ПРОЕКТИРОВАНИЕ\n   - Архитектурное решение\n   - Выбор технологий\n   - Диаграммы и схемы\n   - API дизайн\n   - План миграции данных\n\n3. РАЗРАБОТКА\n   - Создание ветки feature\n   - Разработка в спринтах (2 недели)\n   - Ежедневные стендапы\n   - Промежуточные демо\n   - Документирование кода\n\n4. CODE REVIEW И QA\n   - Обязательный code review\n   - Автоматические тесты (>80%)\n   - Ручное тестирование\n   - Performance тестирование\n   - Security аудит\n\n5. ТЕСТИРОВАНИЕ\n   - Unit тесты\n   - Integration тесты\n   - E2E тесты\n   - User acceptance тесты\n   - Нагрузочное тестирование\n\n6. РАЗВЕРТЫВАНИЕ\n   - Подготовка к релизу\n   - Поэтапный rollout\n   - Feature flags\n   - Rollback план\n   - Уведомления пользователей\n\n7. МОНИТОРИНГ\n   - Настройка метрик\n   - Алерты и уведомления\n   - Сбор обратной связи\n   - Анализ использования\n   - Планирование улучшений"},{name:"Шаблон продажной встречи",description:"Структура проведения демонстрации и переговоров",category:"sales",usage:85,steps:["Подготовка к встрече","Установление раппорта","Выявление потребностей","Демонстрация решения","Работа с возражениями","Закрытие сделки","Планирование следующих шагов"],content:"ШАБЛОН ПРОДАЖНОЙ ВСТРЕЧИ\n\nСТРУКТУРА ВСТРЕЧИ (60-90 минут):\n1. Подготовка (5 мин)\n2. Установление раппорта (10 мин)\n3. Выявление потребностей (20 мин)\n4. Демонстрация (30 мин)\n5. Работа с возражениями (15 мин)\n6. Закрытие (10 мин)\n\nПРОЦЕСС:\n1. ПОДГОТОВКА К ВСТРЕЧЕ\n   - Изучить профиль клиента\n   - Подготовить персонализированную демо\n   - Проверить технику\n   - Подготовить материалы\n   - Настроить CRM\n\n2. УСТАНОВЛЕНИЕ РАППОРТА\n   - Представиться и поблагодарить\n   - Кратко рассказать о компании\n   - Узнать о роли собеседника\n   - Установить повестку встречи\n   - Создать комфортную атмосферу\n\n3. ВЫЯВЛЕНИЕ ПОТРЕБНОСТЕЙ\n   - Какие задачи решаете сейчас?\n   - Какие проблемы возникают?\n   - Как оцениваете текущее решение?\n   - Какие критерии важны при выборе?\n   - Какие сроки у проекта?\n\n4. ДЕМОНСТРАЦИЯ РЕШЕНИЯ\n   - Показать релевантные функции\n   - Связать с выявленными потребностями\n   - Продемонстрировать ROI\n   - Показать интеграции\n   - Ответить на вопросы\n\n5. РАБОТА С ВОЗРАЖЕНИЯМИ\n   - Выслушать полностью\n   - Уточнить детали\n   - Признать правомерность\n   - Предложить решение\n   - Проверить понимание\n\n6. ЗАКРЫТИЕ СДЕЛКИ\n   - Резюмировать ценность\n   - Уточнить следующие шаги\n   - Обсудить условия\n   - Зафиксировать договоренности\n   - Назначить следующую встречу\n\n7. ПЛАНИРОВАНИЕ\n   - Отправить материалы\n   - Обновить CRM\n   - Запланировать follow-up\n   - Подготовить предложение\n   - Координировать с командой"},{name:"Шаблон маркетинговой кампании",description:"План создания и запуска эффективной маркетинговой кампании",category:"marketing",usage:78,steps:["Определение целей и KPI","Сегментация аудитории","Создание контента","Настройка каналов","A/B тестирование","Запуск и мониторинг","Анализ и оптимизация"],content:"ШАБЛОН МАРКЕТИНГОВОЙ КАМПАНИИ\n\nТИПЫ КАМПАНИЙ:\n- Email-рассылки\n- Таргетированная реклама\n- Контент-маркетинг\n- Вебинары и мероприятия\n- Партнерские программы\n\nПРОЦЕСС:\n1. ОПРЕДЕЛЕНИЕ ЦЕЛЕЙ\n   - Бизнес-цели кампании\n   - KPI и метрики успеха\n   - Бюджет и ресурсы\n   - Временные рамки\n   - Критерии успеха\n\n2. СЕГМЕНТАЦИЯ АУДИТОРИИ\n   - Анализ целевой аудитории\n   - Создание персон\n   - Сегментация по интересам\n   - Выбор каналов коммуникации\n   - Персонализация сообщений\n\n3. СОЗДАНИЕ КОНТЕНТА\n   - Креативная концепция\n   - Копирайтинг\n   - Дизайн материалов\n   - Видео и изображения\n   - Landing pages\n\n4. НАСТРОЙКА КАНАЛОВ\n   - Email-платформа\n   - Рекламные кабинеты\n   - Социальные сети\n   - Веб-сайт\n   - CRM интеграция\n\n5. A/B ТЕСТИРОВАНИЕ\n   - Тестирование заголовков\n   - Варианты дизайна\n   - Время отправки\n   - Call-to-action\n   - Целевые страницы\n\n6. ЗАПУСК И МОНИТОРИНГ\n   - Поэтапный запуск\n   - Отслеживание метрик\n   - Настройка алертов\n   - Ежедневные отчеты\n   - Быстрые корректировки\n\n7. АНАЛИЗ И ОПТИМИЗАЦИЯ\n   - Сбор данных\n   - Анализ результатов\n   - Выявление паттернов\n   - Планирование улучшений\n   - Документирование learnings"},{name:"Шаблон онбординга клиента",description:"Процедура введения нового клиента в продукт и процессы",category:"support",usage:90,steps:["Приветствие и знакомство","Настройка аккаунта","Обучение основам","Настройка интеграций","Планирование внедрения","Первые результаты","Долгосрочная поддержка"],content:"ШАБЛОН ОНБОРДИНГА КЛИЕНТА\n\nЦЕЛЬ: Максимизировать time-to-value и удержание клиентов\n\nПРОЦЕСС (30-60 дней):\n1. ПРИВЕТСТВИЕ И ЗНАКОМСТВО\n   - Персональное приветствие\n   - Знакомство с командой\n   - Обзор процесса онбординга\n   - Установление каналов связи\n   - Определение ролей и ответственности\n\n2. НАСТРОЙКА АККАУНТА\n   - Создание пользователей\n   - Настройка прав доступа\n   - Конфигурация системы\n   - Импорт данных\n   - Тестирование доступа\n\n3. ОБУЧЕНИЕ ОСНОВАМ\n   - Вводная сессия (2-4 часа)\n   - Демонстрация ключевых функций\n   - Практические упражнения\n   - Q&A сессия\n   - Материалы для самостоятельного изучения\n\n4. НАСТРОЙКА ИНТЕГРАЦИЙ\n   - Анализ существующих систем\n   - Планирование интеграций\n   - Настройка API подключений\n   - Тестирование данных\n   - Документирование процессов\n\n5. ПЛАНИРОВАНИЕ ВНЕДРЕНИЯ\n   - Roadmap внедрения\n   - Определение этапов\n   - Назначение ответственных\n   - Установление чекпоинтов\n   - Планирование ресурсов\n\n6. ПЕРВЫЕ РЕЗУЛЬТАТЫ\n   - Запуск пилотного проекта\n   - Сбор обратной связи\n   - Анализ метрик\n   - Корректировка процессов\n   - Празднование успехов\n\n7. ДОЛГОСРОЧНАЯ ПОДДЕРЖКА\n   - Регулярные check-in встречи\n   - Расширенное обучение\n   - Оптимизация процессов\n   - Планирование роста\n   - Стратегическое партнерство"}].map((e,t)=>h.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl border border-white/10 hover:bg-white/10 transition-all duration-300",children:h.jsxs("div",{className:"p-6",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center text-white",children:o(e.category)}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-white",children:e.name}),h.jsx("p",{className:"text-sm text-gray-400",children:l(e.category)})]})]}),h.jsx("p",{className:"text-gray-300 mb-4",children:e.description}),h.jsxs("div",{className:"mb-4",children:[h.jsx("h4",{className:"text-sm font-semibold text-white mb-2",children:"Основные этапы:"}),h.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[e.steps.slice(0,3).map((e,t)=>h.jsxs("li",{className:"flex items-start",children:[h.jsx("span",{className:"text-blue-400 mr-2",children:"•"}),e]},t)),e.steps.length>3&&h.jsxs("li",{className:"text-gray-400 text-xs",children:["+",e.steps.length-3," этапов..."]})]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-1",children:[h.jsx(Xt,{className:"w-4 h-4 text-green-400"}),h.jsxs("span",{className:"text-sm text-gray-300",children:[e.usage,"% использования"]})]}),h.jsx("button",{className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg hover:from-blue-600 hover:to-cyan-600 transition-all duration-300",children:"Использовать"})]})]})},t))})]}),"compliance"===e&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[h.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Общее соответствие"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-900/20 border border-green-500/30 rounded-lg",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-white font-medium",children:"Соответствие регламентам"}),h.jsx("div",{className:"text-sm text-gray-400",children:"Средний показатель по всем процессам"})]}),h.jsx("div",{className:"text-2xl font-bold text-green-400",children:"94%"})]}),h.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-white font-medium",children:"Эффективность процессов"}),h.jsx("div",{className:"text-sm text-gray-400",children:"Скорость выполнения задач"})]}),h.jsx("div",{className:"text-2xl font-bold text-blue-400",children:"87%"})]}),h.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-900/20 border border-purple-500/30 rounded-lg",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-white font-medium",children:"Удовлетворенность команды"}),h.jsx("div",{className:"text-sm text-gray-400",children:"Оценка удобства процессов"})]}),h.jsx("div",{className:"text-2xl font-bold text-purple-400",children:"91%"})]})]})]}),h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[h.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Области для улучшения"}),h.jsx("div",{className:"space-y-4",children:[{area:"Маркетинг-кампании",issue:"Низкая эффективность email-рассылок",priority:"high",action:"Оптимизировать шаблоны писем"},{area:"Поддержка клиентов",issue:"Долгое время ответа на сложные вопросы",priority:"medium",action:"Добавить больше FAQ и автоматизацию"},{area:"Разработка",issue:"Частые изменения требований",priority:"medium",action:"Улучшить процесс сбора требований"}].map((e,t)=>h.jsxs("div",{className:"p-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[h.jsxs("div",{className:"flex items-start justify-between mb-2",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-white font-medium",children:e.area}),h.jsx("div",{className:"text-sm text-gray-400",children:e.issue})]}),h.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("high"===e.priority?"text-red-400 bg-red-900/20":"text-yellow-400 bg-yellow-900/20"),children:"high"===e.priority?"Высокий":"Средний"})]}),h.jsx("div",{className:"text-sm text-yellow-300",children:e.action})]},t))})]})]})]})})},Is=()=>{const[e,t]=g.useState("scripts"),[s,r]=g.useState(null),[n,i]=g.useState(!1),a=[{id:"1",name:"Холодный звонок B2B",type:"cold_call",industry:"B2B",duration:300,successRate:25,content:"Добрый день, [Имя]! Меня зовут [Ваше имя] из Boss AI.\nМы помогаем компаниям автоматизировать продажи и маркетинг\nс помощью искусственного интеллекта.\n\nУ вас сейчас есть 2 минуты, чтобы я рассказал, как мы помогли\n[Компания-аналог] увеличить конверсию на 47%?\n\n[Пауза для ответа]\n\nОтлично! Вот что Boss AI может для вас сделать:\n\n1. AI-ассистент обработает 80% рутинных запросов автоматически\n2. CRM с умным скорингом покажет, на каких лидов тратить время\n3. Воронки продаж автоматизируют follow-up и напоминания\n4. Аналитика в реальном времени покажет, где теряются клиенты\n\nВ среднем наши клиенты видят:\n- +35% конверсия лид→клиент\n- -50% время на рутину\n- +25% средний чек (за счет допродаж)\n\nРезультат: рост выручки на 40-60% за первые 3 месяца.\n\n[Работа с возражениями]\n\nОтлично! Я вижу, что Boss AI может реально помочь вашему бизнесу.\nПредлагаю так: мы дадим вам 14 дней бесплатного доступа ко всем функциям.\nНаш специалист настроит систему под ваши процессы, и вы увидите результаты.\nЕсли не понравится - просто перестанете пользоваться. Риска ноль.\n\nКогда вам удобно начать - в понедельник или среду?",tips:["Используйте имя клиента в начале разговора","Создайте срочность, но не давите","Фокусируйтесь на выгодах, а не на функциях","Слушайте больше, чем говорите","Всегда предлагайте следующий шаг"],objections:["Дорого → ROI расчет","Нам ничего не нужно → Вопрос о росте на 40%","Уже используем конкурента → Сравнение преимуществ","Нет времени → 2 минуты демо","Нужно подумать → Ограниченное предложение"],isActive:!0,createdAt:"2025-01-15"},{id:"2",name:"Теплый лид (входящая заявка)",type:"warm_lead",industry:"Все",duration:1800,successRate:60,content:"Тема: Ваша заявка на Boss AI - начнем прямо сейчас!\n\nПривет, [Имя]!\n\nСпасибо за интерес к Boss AI! 🚀\n\nЯ [Ваше имя], и я помогу вам начать. Вот что дальше:\n\n1. Я забронировал для вас 30-минутную персональную демонстрацию\n2. Мы покажем, как Boss AI решит именно ваши задачи\n3. Вы получите персональное предложение со скидкой 20%\n\nВыберите удобное время: [Ссылка на календарь]\n\nИли напишите мне в WhatsApp: [Номер]\n\nP.S. Первые 10 клиентов этого месяца получают бонус:\nбесплатная настройка системы ($2,000 value) 🎁\n\nДо встречи!\n[Ваше имя]\n[Должность]\nBoss AI",tips:["Отвечайте в течение 5 минут","Персонализируйте каждое письмо","Предлагайте конкретные следующие шаги","Используйте социальные доказательства","Создавайте срочность"],objections:[],isActive:!0,createdAt:"2025-01-15"},{id:"3",name:"Демонстрация продукта",type:"demo",industry:"Все",duration:1800,successRate:40,content:"Структура демонстрации (30 минут):\n\nМИНУТЫ 1-5: ЗНАКОМСТВО\n- Представление и благодарность за время\n- Уточнение задач и болевых точек клиента\n- Постановка целей демонстрации\n- Согласование формата\n\nМИНУТЫ 6-20: ДЕМОНСТРАЦИЯ\n1. AI-ассистент (5 мин)\n   - Показ живого диалога\n   - Решение реальной задачи клиента\n   - Объяснение принципов работы\n\n2. CRM и воронки (5 мин)\n   - Импорт данных клиента\n   - Настройка воронки под их процесс\n   - AI-скоринг лидов\n\n3. Маркетинг-автоматизация (5 мин)\n   - Email-кампании\n   - Лид-магниты\n   - Аналитика\n\nМИНУТЫ 21-25: ВОПРОСЫ И ВОЗРАЖЕНИЯ\n- Активное слушание\n- Уточняющие вопросы\n- Работа с сомнениями\n- Дополнительные функции\n\nМИНУТЫ 26-30: ЗАКРЫТИЕ\n- Резюме ценности для клиента\n- Предложение тарифа\n- Следующие шаги\n- Согласование сроков",tips:["Готовьтесь к каждому демо индивидуально","Используйте реальные данные клиента","Показывайте, а не рассказывайте","Задавайте вопросы каждые 2-3 минуты","Всегда заканчивайте конкретным предложением"],objections:[],isActive:!0,createdAt:"2025-01-15"}],o=e=>{switch(e){case"cold_call":return h.jsx(Lt,{className:"w-5 h-5"});case"warm_lead":return h.jsx(bt,{className:"w-5 h-5"});case"demo":return h.jsx(Ot,{className:"w-5 h-5"});case"objection_handling":return h.jsx(_e,{className:"w-5 h-5"});case"closing":return h.jsx(Yt,{className:"w-5 h-5"});default:return h.jsx(kt,{className:"w-5 h-5"})}},l=e=>{switch(e){case"cold_call":return"Холодный звонок";case"warm_lead":return"Теплый лид";case"demo":return"Демонстрация";case"objection_handling":return"Работа с возражениями";case"closing":return"Закрытие сделки";default:return"Скрипт"}};return h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Скрипты продаж"}),h.jsx("p",{className:"text-gray-300",children:"Готовые скрипты для всех этапов продаж"})]}),h.jsx("div",{className:"flex space-x-1 mb-8 bg-white/10 rounded-lg p-1",children:[{id:"scripts",label:"Скрипты",icon:kt},{id:"templates",label:"Шаблоны",icon:Pt},{id:"analytics",label:"Аналитика",icon:Xt}].map(s=>h.jsxs("button",{type:"button",onClick:()=>t(s.id),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors "+(e===s.id?"bg-purple-500 text-white":"text-gray-300 hover:text-white hover:bg-white/10"),children:[h.jsx(s.icon,{className:"w-4 h-4"}),h.jsx("span",{children:s.label})]},s.id))}),"scripts"===e&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsx("div",{className:"space-y-4",children:a.map(e=>h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10 hover:bg-white/10 transition-all duration-300",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center text-white",children:o(e.type)}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-white",children:e.name}),h.jsxs("p",{className:"text-sm text-gray-400",children:[l(e.type)," • ",e.industry]})]})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs("div",{className:"flex items-center space-x-1",children:[h.jsx(Zt,{className:"w-4 h-4 text-yellow-400 fill-current"}),h.jsxs("span",{className:"text-sm text-gray-300",children:[e.successRate,"%"]})]}),h.jsxs("div",{className:"flex items-center space-x-1",children:[h.jsx(Ze,{className:"w-4 h-4 text-gray-400"}),h.jsxs("span",{className:"text-sm text-gray-300",children:[Math.floor(e.duration/60),"м"]})]})]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs("button",{type:"button",onClick:()=>(e=>{r(e),i(!0),setTimeout(()=>i(!1),100*e.duration)})(e),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-300",children:[h.jsx(Ot,{className:"w-4 h-4"}),h.jsx("span",{children:"Воспроизвести"})]}),h.jsxs("button",{type:"button",onClick:()=>(e=>{navigator.clipboard.writeText(e.content)})(e),className:"flex items-center space-x-2 px-4 py-2 bg-white/10 text-white rounded-lg hover:bg-white/20 transition-colors",children:[h.jsx(Je,{className:"w-4 h-4"}),h.jsx("span",{children:"Копировать"})]})]}),h.jsxs("div",{className:"flex items-center space-x-1",children:[h.jsx(Ve,{className:"w-5 h-5 text-green-400"}),h.jsx("span",{className:"text-sm text-green-400",children:"Активен"})]})]})]},e.id))}),h.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:s?h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsx("h3",{className:"text-xl font-semibold text-white",children:s.name}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),h.jsx("span",{className:"text-sm text-gray-300",children:n?"Воспроизведение...":"Готов к воспроизведению"})]})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Содержание скрипта"}),h.jsx("div",{className:"bg-black/20 rounded-lg p-4 max-h-64 overflow-y-auto",children:h.jsx("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap",children:s.content})})]}),s.tips.length>0&&h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Советы по использованию"}),h.jsx("ul",{className:"space-y-2",children:s.tips.map((e,t)=>h.jsxs("li",{className:"flex items-start space-x-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-400 mt-1 flex-shrink-0"}),h.jsx("span",{className:"text-sm text-gray-300",children:e})]},t))})]}),s.objections.length>0&&h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"Работа с возражениями"}),h.jsx("div",{className:"space-y-2",children:s.objections.map((e,t)=>h.jsx("div",{className:"bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-3",children:h.jsx("span",{className:"text-sm text-yellow-300",children:e})},t))})]})]})]}):h.jsxs("div",{className:"text-center py-12",children:[h.jsx(kt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),h.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Выберите скрипт"}),h.jsx("p",{className:"text-gray-400",children:"Нажмите на скрипт слева, чтобы увидеть его содержимое"})]})})]}),"templates"===e&&h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{name:"Email для холодных лидов",description:"Шаблон для email-рассылок по холодной базе",industry:"B2B",successRate:15},{name:"Скрипт для демо-звонка",description:"Структура демонстрации продукта",industry:"Все",successRate:40},{name:"Работа с возражениями",description:"Ответы на типовые возражения клиентов",industry:"Все",successRate:60},{name:"Закрытие сделки",description:"Техники закрытия и получения согласия",industry:"Все",successRate:35},{name:"Follow-up после встречи",description:"Письмо после демонстрации или встречи",industry:"Все",successRate:25},{name:"Реактивация клиентов",description:"Возврат неактивных клиентов",industry:"Все",successRate:20}].map((e,t)=>h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10 hover:bg-white/10 transition-all duration-300",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center text-white",children:h.jsx(Pt,{className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-white",children:e.name}),h.jsx("p",{className:"text-sm text-gray-400",children:e.industry})]})]}),h.jsx("p",{className:"text-gray-300 mb-4",children:e.description}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-1",children:[h.jsx(Zt,{className:"w-4 h-4 text-yellow-400 fill-current"}),h.jsxs("span",{className:"text-sm text-gray-300",children:[e.successRate,"% успеха"]})]}),h.jsx("button",{type:"button",className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg hover:from-blue-600 hover:to-cyan-600 transition-all duration-300",children:"Использовать"})]})]},t))}),"analytics"===e&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[h.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Эффективность скриптов"}),h.jsx("div",{className:"space-y-4",children:[{name:"Холодный звонок B2B",successRate:25,usage:45,revenue:125e3},{name:"Теплый лид",successRate:60,usage:30,revenue:18e4},{name:"Демонстрация",successRate:40,usage:25,revenue:95e3}].map((e,t)=>h.jsxs("div",{className:"flex items-center justify-between p-4 bg-black/20 rounded-lg",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-white font-medium",children:e.name}),h.jsxs("div",{className:"text-sm text-gray-400",children:[e.usage,"% использования"]})]}),h.jsxs("div",{className:"text-right",children:[h.jsxs("div",{className:"text-green-400 font-semibold",children:[e.successRate,"%"]}),h.jsxs("div",{className:"text-sm text-gray-400",children:["$",e.revenue.toLocaleString()]})]})]},t))})]}),h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[h.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Рекомендации"}),h.jsx("div",{className:"space-y-4",children:["Улучшить скрипт холодных звонков - добавить больше персонализации","Создать A/B тест для email-шаблонов","Добавить больше социальных доказательств в демо","Обучить команду работе с возражениями","Автоматизировать follow-up после встреч"].map((e,t)=>h.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[h.jsx(_e,{className:"w-5 h-5 text-yellow-400 mt-0.5 flex-shrink-0"}),h.jsx("span",{className:"text-sm text-yellow-300",children:e})]},t))})]})]})]})})},Ts={sm:"p-3",md:"p-4",lg:"p-6",xl:"p-8"},As={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"},Rs={none:"shadow-none",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg",xl:"shadow-xl"},Ms={default:"platform-card",glass:"platform-card-glass",solid:"platform-card-solid",elevated:"platform-card-elevated",outlined:"platform-card-outlined"},_s=g.memo(e=>{var t=e,{variant:s="default",size:r="md",hover:n=!0,clickable:i=!1,rounded:a="lg",shadow:d="md",children:m,className:p}=t,x=c(t,["variant","size","hover","clickable","rounded","shadow","children","className"]);const g=Te("platform-card-base",Ms[s],Ts[r],As[a],Rs[d],n&&"platform-card-hover",i&&"platform-card-clickable",p),v=o(o({initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"}},n&&{whileHover:{y:-2,scale:1.01,transition:{duration:.2}}}),i&&{whileTap:{scale:.98,transition:{duration:.1}}});return h.jsx(u.div,l(o(o({className:g},v),x),{children:m}))});_s.displayName="UnifiedCard";const Ps={sm:"h-1",md:"h-2",lg:"h-3"},Ls={sm:"w-1",md:"w-2",lg:"w-3"},Os={small:{value:1,label:"Маленький",size:"0.875rem"},medium:{value:2,label:"Средний",size:"1rem"},large:{value:3,label:"Большой",size:"1.125rem"}};g.memo(e=>{var t=e,{variant:s="default",size:r="md",orientation:n="horizontal",showValue:i=!0,showLabels:a=!1,labels:l=[],value:d=0,onChange:m,onValueChange:u,min:p=0,max:x=100,step:v=1,className:f}=t,y=c(t,["variant","size","orientation","showValue","showLabels","labels","value","onChange","onValueChange","min","max","step","className"]);const[b,j]=g.useState(!1),[N,w]=g.useState(d),k=g.useRef(null),S=void 0!==d?d:N,C=m||u,E=g.useCallback(e=>{const t=(e-Number(p))/(Number(x)-Number(p))*100;k.current&&k.current.style.setProperty("--percent",`${t}%`)},[p,x]);g.useEffect(()=>{E(S)},[S,E]);const I=g.useCallback(e=>{w(e),null==C||C(e)},[C]),T=g.useCallback(e=>{if(!k.current)return;const t=k.current.getBoundingClientRect(),s="touches"in e?e.touches[0].clientX:e.clientX,r="touches"in e?e.touches[0].clientY:e.clientY;let i;if("horizontal"===n){const e=s-t.left;i=Math.max(0,Math.min(100,e/t.width*100))}else{const e=r-t.top;i=Math.max(0,Math.min(100,e/t.height*100))}const a=Number(p)+i/100*(Number(x)-Number(p)),o=Math.round(a/Number(v))*Number(v),l=Math.max(Number(p),Math.min(Number(x),o));I(l)},[p,x,v,n,I]),A=g.useCallback(e=>{const t=Object.keys(Os).find(t=>Os[t].value===e);t&&I(Os[t].value)},[I]),R=(()=>{if("fontSize"!==s)return null;const e=Object.keys(Os).find(e=>Os[e].value===S);return e?Os[e]:Os.medium})(),M=Te("appearance-none outline-none cursor-pointer transition-all duration-200","horizontal"===n?Ps[r]:Ls[r],"vertical"===n&&"writing-mode: bt-lr; -webkit-appearance: slider-vertical",(()=>{switch(s){case"rainbow":return"rainbow-slider";case"hue":return"theme-selector-hue-strip";case"brightness":return"theme-selector-brightness-strip";case"fontSize":return"font-size-slider";default:return"platform-slider"}})(),f);return h.jsxs("div",{className:"space-y-4",children:["fontSize"===s&&R&&h.jsxs("div",{className:"p-4 rounded-lg border font-size-preview","data-font-size":R.size,children:[h.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Предварительный просмотр:"}),h.jsxs("div",{className:"font-medium",children:["Размер шрифта: ",R.label]}),h.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Заголовок H1, обычный текст и мелкий текст"})]}),a&&l.length>0&&h.jsx("div",{className:Te("flex text-sm text-muted-foreground","vertical"===n?"flex-col h-32 justify-between":"justify-between"),children:l.map((e,t)=>h.jsx("span",{children:e},t))}),h.jsxs("div",{className:"relative",children:["fontSize"===s&&h.jsx("div",{className:"w-full h-2 bg-black dark:bg-black rounded-full relative",children:h.jsx("div",{className:"absolute top-0 h-2 bg-primary rounded-full transition-all duration-200","data-width":(S-1)/2*100})}),h.jsx("input",o({ref:k,type:"range",min:p,max:x,step:v,value:S,onChange:e=>{const t=Number(e.target.value);"fontSize"===s?A(t):I(t)},onMouseDown:()=>j(!0),onMouseUp:()=>j(!1),onTouchStart:()=>j(!0),onTouchEnd:()=>j(!1),className:M,"data-percent":(S-Number(p))/(Number(x)-Number(p))*100},y)),"fontSize"===s&&h.jsx("div",{className:"absolute inset-0 cursor-pointer",onMouseDown:T,onMouseMove:e=>{b&&T(e)},onMouseUp:()=>j(!1),onMouseLeave:()=>j(!1),onTouchStart:T,onTouchMove:T,onTouchEnd:()=>j(!1)}),"fontSize"===s&&h.jsx("div",{className:Te("font-size-slider-thumb",b?"scale-110 shadow-xl":"hover:scale-105"),"data-position":(S-1)/2})]}),i&&h.jsxs("div",{className:"flex justify-between items-center text-sm",children:[h.jsx("span",{className:"text-muted-foreground",children:"fontSize"===s&&R?R.label:`${S}${"hue"===s?"°":"brightness"===s?"%":""}`}),"rainbow"===s&&h.jsxs("div",{className:"text-xs text-muted-foreground",children:["HSL: ",Math.round(S/100*360),", 100%, 50%"]})]})]})}).displayName="UnifiedSlider";const $s={active:"platform-service-active",inactive:"platform-service-inactive",loading:"platform-service-loading",error:"platform-service-error"},Ds={sm:"p-3",md:"p-4",lg:"p-6"},zs=g.memo(({id:e,title:t,description:s,icon:r,status:n="inactive",variant:i="default",size:a="md",hover:o=!0,actions:l=[],onToggle:c,onConfigure:d,className:m,children:u})=>{const p="active"===n,x="loading"===n,g="error"===n;return h.jsxs(_s,{variant:i,size:a,hover:o,clickable:!!c,className:Te("platform-service",$s[n],Ds[a],m),onClick:()=>{c&&!x&&c(!p)},children:[h.jsx("div",{className:"platform-service-header-standard",children:h.jsxs("div",{className:"platform-service-header-content",children:[h.jsx("div",{className:"platform-service-icon",children:r}),h.jsxs("div",{className:"platform-service-content",children:[h.jsx("h3",{className:"platform-service-title",children:t}),s&&h.jsx("p",{className:"platform-service-description",children:s})]}),h.jsxs("div",{className:"platform-service-status",children:[x&&h.jsx("div",{className:"platform-service-spinner"}),g&&h.jsx("div",{className:"platform-service-error-icon",children:"⚠️"}),p&&!x&&!g&&h.jsx("div",{className:"platform-service-active-icon",children:"✓"})]})]})}),u&&h.jsx("div",{className:"platform-service-body",children:u}),(l.length>0||d)&&h.jsxs("div",{className:"platform-service-actions",children:[l.map(e=>h.jsx(xs,{variant:e.variant||"secondary",size:"sm",onClick:t=>{t.stopPropagation(),e.onClick()},disabled:e.disabled||x,children:e.label},e.id)),d&&h.jsx(xs,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),d&&!x&&d()},disabled:x,children:"Настроить"})]})]})});zs.displayName="UnifiedService";const Bs={glass:{initial:{background:"var(--glass-bg)",backdropFilter:"blur(20px)",border:"1px solid var(--glass-border)",boxShadow:"0 8px 32px var(--glass-bg)"},hover:{background:"var(--button-secondary-hover)",backdropFilter:"blur(25px)",borderColor:"var(--primary)",boxShadow:"0 16px 48px var(--glass-border)",y:-8,scale:1.02}},neumorphism:{initial:{background:"var(--primary)",boxShadow:"8px 8px 16px var(--neumorphism-dark), -8px -8px 16px var(--neumorphism-light)"},hover:{y:-4,boxShadow:"12px 12px 24px var(--neumorphism-dark), -12px -12px 24px var(--neumorphism-light)",scale:1.01}},solid:{initial:{background:"var(--surface)",border:"1px solid var(--border)",boxShadow:"0 4px 16px var(--glass-bg)"},hover:{background:"var(--surface-hover)",borderColor:"var(--primary)",boxShadow:"0 8px 24px var(--glass-border)",y:-4,scale:1.01}},gradient:{initial:{background:"linear-gradient(135deg, var(--glass-bg), var(--neumorphism-light))",border:"1px solid var(--glass-border)",boxShadow:"0 8px 32px var(--glass-bg)"},hover:{background:"linear-gradient(135deg, var(--button-secondary-hover), var(--neumorphism-light))",borderColor:"var(--primary)",boxShadow:"0 16px 48px var(--glass-border)",y:-6,scale:1.02}}},Fs={sm:"p-3",md:"p-4",lg:"p-6"};g.memo(e=>{var t=e,{variant:s="glass",size:r="md",hover:n=!0,animationType:i="none",children:a,className:d}=t,m=c(t,["variant","size","hover","animationType","children","className"]);const p=Fs[r],x={initial:"initial",whileHover:n?"hover":void 0,variants:Bs[s],animate:"float"===i?{y:[0,-10,0],transition:{duration:3,repeat:1/0,ease:"easeInOut"}}:void 0,transition:{duration:.3,ease:[.4,0,.2,1]}};return h.jsxs(u.div,l(o(l(o({},x),{className:Te("relative rounded-xl overflow-hidden transition-all duration-300",p,d),style:{}}),m),{children:["glass-shimmer"===i&&h.jsx(u.div,{className:"absolute inset-0 opacity-20",style:{background:"linear-gradient(90deg, transparent, var(--glass-border), transparent)",backgroundSize:"200% 100%"},animate:{backgroundPosition:["-200% 0","200% 0"]},transition:{duration:3,repeat:1/0,ease:"linear"}}),"gradient"===s&&h.jsx(u.div,{className:"absolute inset-0 opacity-0",whileHover:{opacity:.1},style:{background:"linear-gradient(135deg, var(--primary), var(--secondary))"}}),h.jsx("div",{className:"relative z-10",children:a}),h.jsx(u.div,{className:"absolute inset-0 rounded-xl overflow-hidden pointer-events-none",initial:{scale:0,opacity:0},whileTap:{scale:1,opacity:[0,.1,0]},transition:{duration:.6,ease:[.4,0,.2,1]},style:{background:"radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%)"}})]}))}).displayName="AnimatedCard";g.memo(e=>{var t=e,{variant:s="fade",direction:r="up",delay:n=0,duration:i=.5,stagger:a=.1,children:d,className:m}=t,p=c(t,["variant","direction","delay","duration","stagger","children","className"]);const x=((e,t,s)=>{const r={fade:{initial:{opacity:0},animate:{opacity:1,transition:{duration:.5,ease:[.4,0,.2,1]}},exit:{opacity:0,transition:{duration:.3,ease:[.4,0,.2,1]}}},slide:{initial:{opacity:0,x:"left"===t?-100:"right"===t?100:0,y:"up"===t?-100:"down"===t?100:0},animate:{opacity:1,x:0,y:0,transition:{duration:.6,ease:[.4,0,.2,1]}},exit:{opacity:0,x:"left"===t?-100:"right"===t?100:0,y:"up"===t?-100:"down"===t?100:0,transition:{duration:.4,ease:[.4,0,.2,1]}}},scale:{initial:{opacity:0,scale:.8,rotate:-5},animate:{opacity:1,scale:1,rotate:0,transition:{duration:.5,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:.8,rotate:5,transition:{duration:.3,ease:[.4,0,.2,1]}}},stagger:{initial:{},animate:{transition:{staggerChildren:s||.1,delayChildren:.1}}}};return r[e]||r.fade})(s,r,a),g=((e,t)=>{const s={fade:{initial:{opacity:0},animate:{opacity:1,transition:{duration:.4,ease:[.4,0,.2,1]}}},slide:{initial:{opacity:0,x:"left"===t?-50:"right"===t?50:0,y:"up"===t?-50:"down"===t?50:0},animate:{opacity:1,x:0,y:0,transition:{duration:.4,ease:[.4,0,.2,1]}}},scale:{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0,transition:{duration:.4,ease:[.4,0,.2,1]}}},stagger:{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1,transition:{duration:.4,ease:[.4,0,.2,1]}}}};return s[e]||s.fade})(s,r),f={initial:"initial",animate:"animate",exit:"exit",variants:x,transition:{duration:i,delay:n,ease:[.4,0,.2,1]}};return"stagger"===s?h.jsx(u.div,l(o(l(o({},f),{className:Te("relative",m)}),p),{children:v.Children.map(d,(e,t)=>h.jsx(u.div,{variants:g,className:"relative",children:e},t))})):h.jsx(u.div,l(o(l(o({},f),{className:Te("relative",m)}),p),{children:d}))});const Hs={subtle:{scale:1.02,duration:.2},medium:{scale:1.05,duration:.3},strong:{scale:1.1,duration:.4}};g.memo(({children:e,variant:t="ripple",intensity:s="medium",duration:r=.3,delay:n=0,disabled:i=!1,className:a,onClick:c,onHover:d,tooltip:m,tooltipPosition:x="top"})=>{const[v,f]=g.useState([]),[y,b]=g.useState(!1),j=g.useRef(null),N=g.useRef(0),w=Hs[s];return h.jsxs("div",{ref:j,className:Te("relative inline-block",a),onMouseEnter:()=>{i||null==d||d(!0)},onMouseLeave:()=>{i||null==d||d(!1)},onMouseDown:e=>{if(!i&&"ripple"===t&&j.current){const t=j.current.getBoundingClientRect(),s=e.clientX-t.left,r=e.clientY-t.top,n={id:N.current++,x:s,y:r};f(e=>[...e,n]),setTimeout(()=>{f(e=>e.filter(e=>e.id!==n.id))},600)}},onMouseUp:()=>{},onClick:()=>{i||null==c||c()},onMouseOver:()=>m&&b(!0),onMouseOut:()=>m&&b(!1),children:[h.jsxs(u.div,l(o({},(()=>{const e={duration:r,ease:"easeInOut"};switch(t){case"ripple":return{whileHover:{scale:w.scale,transition:e},whileTap:{scale:.98,transition:{duration:.1}}};case"glow":return{whileHover:{scale:w.scale,boxShadow:"0 0 20px rgba(139, 69, 19, 0.4), 0 0 40px rgba(160, 82, 45, 0.2)",transition:e}};case"bounce":return{whileHover:{y:-4,scale:w.scale,transition:{duration:r,type:"spring",stiffness:400,damping:10}}};case"scale":return{whileHover:{scale:w.scale,transition:e},whileTap:{scale:.95,transition:{duration:.1}}};case"rotate":return{whileHover:{rotate:5,scale:w.scale,transition:e}};case"shimmer":return{whileHover:{scale:w.scale,backgroundPosition:["0% 0%","100% 0%"],transition:{duration:r,ease:"easeInOut"}}};case"pulse":return{animate:{scale:[1,w.scale,1],transition:{duration:2,repeat:1/0,ease:"easeInOut"}}};case"float":return{animate:{y:[0,-8,0],transition:{duration:3,repeat:1/0,ease:"easeInOut"}},whileHover:{y:-12,scale:w.scale,transition:e}};default:return{}}})()),{className:Te("relative overflow-hidden",{"cursor-pointer":!i,"cursor-not-allowed opacity-50":i}),style:{backgroundImage:"shimmer"===t?"linear-gradient(90deg, transparent, rgba(139, 69, 19, 0.2), transparent)":void 0,backgroundSize:"shimmer"===t?"200% 100%":void 0},children:[e,"ripple"===t&&h.jsx("div",{className:"absolute inset-0 pointer-events-none",children:v.map(e=>h.jsx(u.div,{className:"absolute rounded-full bg-white/30",style:{left:e.x-10,top:e.y-10,width:20,height:20},initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6,ease:"easeOut"}},e.id))})]})),h.jsx(p,{children:y&&m&&h.jsxs(u.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},className:Te("absolute z-[9999999] px-2 py-1 text-xs text-white bg-neutral-800 rounded shadow-lg whitespace-nowrap",{top:"bottom-full left-1/2 transform -translate-x-1/2 mb-2",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-2",left:"right-full top-1/2 transform -translate-y-1/2 mr-2",right:"left-full top-1/2 transform -translate-y-1/2 ml-2"}[x]),children:[m,h.jsx("div",{className:Te("absolute w-2 h-2 bg-neutral-800 transform rotate-45",{"top-full left-1/2 -translate-x-1/2 -mt-1":"top"===x,"bottom-full left-1/2 -translate-x-1/2 -mb-1":"bottom"===x,"right-full top-1/2 -translate-y-1/2 -mr-1":"left"===x,"left-full top-1/2 -translate-y-1/2 -ml-1":"right"===x})})]})})]})}),g.memo(({name:e,description:t,value:s,onChange:r})=>h.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"checkbox",checked:s,onChange:e=>r(e.target.checked),className:"sr-only","aria-label":e}),h.jsx("div",{className:"w-5 h-5 rounded border-2 transition-all duration-200 flex items-center justify-center "+(s?"boolean-checkbox-checked":"boolean-checkbox-unchecked"),children:s&&h.jsx("svg",{className:"w-3 h-3 boolean-checkbox-icon",fill:"currentColor",viewBox:"0 0 20 20",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:"text-sm font-medium text-text-primary",children:e}),t&&h.jsx("div",{className:"text-xs text-text-secondary mt-1",children:t})]})]}));const Us=g.memo(({value:e,options:t,onChange:s,placeholder:r,className:n})=>{const i=t.find(t=>String(t.value)===String(e)),a=g.useCallback(e=>{s(e.value)},[s]),o=(null==i?void 0:i.label)||r||"Выберите опцию";return h.jsxs("div",{className:Te("space-y-2",n),children:[h.jsx("label",{className:"block text-sm font-medium setting-label",children:r||"Выберите опцию"}),h.jsx("div",{className:"flex flex-wrap gap-2",role:"radiogroup","aria-label":o,children:t.map(t=>{const s=String(t.value)===String(e);return h.jsx("button",{type:"button",role:"radio",onClick:()=>a(t),className:Te("px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200","border focus:outline-none focus:ring-2 focus:border-transparent","hover:scale-105 active:scale-95",s?"bg-primary text-background border-primary shadow-lg":"bg-input-bg text-input-text border-input-border hover:bg-surface-hover"),"aria-checked":s,"aria-label":`${o}: ${t.label}`,tabIndex:s?0:-1,children:t.label},String(t.value))})})]})});Us.displayName="ButtonSelect";const Ws=g.memo(({value:e,onChange:t})=>{const[s,r]=g.useState(!1),n=g.useMemo(()=>({small:{value:1,label:"Маленький",size:"0.875rem"},medium:{value:2,label:"Средний",size:"1rem"},large:{value:3,label:"Большой",size:"1.125rem"}}),[]),i=n[e]||n.medium,a=g.useCallback(e=>{const s=Object.keys(n).find(t=>n[t].value===e);s&&t(s)},[t,n]),o=g.useCallback(e=>{const t=e.currentTarget.getBoundingClientRect(),s=("touches"in e?e.touches[0].clientX:e.clientX)-t.left,r=Math.max(0,Math.min(100,s/t.width*100));let n;n=r<33?1:r<66?2:3,a(n)},[a]);return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"p-4 rounded-lg border font-size-preview",style:{"--font-size-preview":i.size},children:[h.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Предварительный просмотр:"}),h.jsxs("div",{className:"font-medium",children:["Размер шрифта: ",i.label]}),h.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Заголовок H1, обычный текст и мелкий текст"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[h.jsx("span",{children:"Маленький"}),h.jsx("span",{children:"Средний"}),h.jsx("span",{children:"Большой"})]}),h.jsx("div",{className:"relative",children:h.jsxs("div",{className:"w-full h-2 bg-black dark:bg-black rounded-full relative",children:[h.jsx("div",{className:"absolute top-0 h-2 bg-primary rounded-full transition-all duration-200",style:{left:"0%",width:(i.value-1)/2*100+"%"}}),h.jsx("div",{className:Te("font-size-slider-thumb",s?"scale-110 shadow-xl":"hover:scale-105"),style:{"--font-size-position":(i.value-1)/2},onMouseDown:e=>{r(!0),o(e)},onTouchStart:e=>{r(!0),o(e)}}),h.jsx("div",{className:"absolute inset-0 cursor-pointer",onMouseDown:o,onMouseMove:e=>{s&&o(e)},onMouseUp:()=>r(!1),onMouseLeave:()=>r(!1),onTouchStart:o,onTouchMove:o,onTouchEnd:()=>r(!1)})]})})]})]})});Ws.displayName="FontSizeSlider",g.memo(({name:e,value:t,min:s=0,max:r=100,step:n=1,onChange:i})=>{const a=g.useRef(null),o=g.useCallback(e=>{const t=(e-s)/(r-s)*100;a.current&&a.current.style.setProperty("--percent",`${t}%`)},[s,r]);return g.useEffect(()=>{o(Number(t))},[t,s,r,o]),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("label",{className:"block text-sm font-medium number-setting-label",children:e}),h.jsx("span",{className:"px-2 py-0.5 rounded-md text-xs shadow-sm number-setting-value","aria-live":"polite",children:String(t)})]}),h.jsx("input",{ref:a,type:"range",value:Number(t),min:s,max:r,step:n,onChange:e=>{const t=Number(e.target.value);o(t),i(t)},className:"slider-brand w-full h-2 appearance-none rounded-lg outline-none cursor-pointer border focus:ring-2 number-setting-slider","aria-label":e}),h.jsxs("div",{className:"flex justify-between text-xs number-setting-range",children:[h.jsx("span",{children:s}),h.jsx("span",{children:r})]})]})}),g.memo(({name:e,value:t,placeholder:s,onChange:r})=>h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-sm font-medium text-setting-label",children:e}),h.jsx("input",{type:"text",value:t,onChange:e=>r(e.target.value),className:"w-full px-3 py-2.5 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-200 text-setting-input","aria-label":e,placeholder:s||`Введите ${e.toLowerCase()}`})]}));const Gs=g.memo(({theme:e,onThemeChange:t,className:s=""})=>{const r=g.useCallback(e=>{t(e)},[t]);return h.jsxs("div",{className:Te("space-y-4",s),children:[h.jsxs("div",{className:"text-center",children:[h.jsx("h3",{className:"text-lg font-semibold text-text mb-1",children:"Тема"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Выберите светлую или темную тему"})]}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:()=>r("light"),className:Te("flex-1 p-3 rounded-lg border-2 transition-all duration-200","bg-card text-text border-primary","light"===e?"ring-2 ring-primary shadow-lg":"hover:bg-surface"),children:h.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[h.jsx("div",{className:"w-4 h-4 bg-black rounded"}),h.jsx("span",{className:"font-medium",children:"Светлая"})]})}),h.jsx("button",{onClick:()=>r("dark"),className:Te("flex-1 p-3 rounded-lg border-2 transition-all duration-200","bg-black text-white border-black","dark"===e?"ring-2 ring-white shadow-lg":"hover:bg-gray-800"),children:h.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[h.jsx("div",{className:"w-4 h-4 bg-white rounded"}),h.jsx("span",{className:"font-medium",children:"Темная"})]})})]}),h.jsx("div",{className:"text-center text-xs text-text-secondary",children:"light"===e?"Белый фон, черный текст":"Черный фон, белый текст"})]})});Gs.displayName="ThemeSelector";const Vs=new class{constructor(){this.errors=[],this.maxErrors=F.MAX_ERRORS_IN_STORAGE,this.retentionDays=F.ERROR_RETENTION_DAYS,this.loadErrorsFromStorage(),this.cleanupOldErrors()}logError(e,t,s){const r={id:this.generateErrorId(),timestamp:new Date,type:this.determineErrorType(e),code:this.determineErrorCode(e),message:e.message||B.GENERIC,stack:e.stack,componentStack:null==t?void 0:t.componentStack,userAgent:navigator.userAgent,url:window.location.href,userId:this.getCurrentUserId(),metadata:l(o({},s),{errorBoundary:null==t?void 0:t.errorBoundary,props:null==t?void 0:t.props,state:null==t?void 0:t.state})};return this.errors.unshift(r),this.trimErrors(),this.saveErrorsToStorage(),this.sendToExternalService(r),console.error("Error logged:",r),r.id}getErrorStats(){const e=new Date((new Date).getTime()-24*this.retentionDays*60*60*1e3),t=this.errors.filter(t=>t.timestamp>=e),s=t.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{}),r=t.reduce((e,t)=>(e[t.code]=(e[t.code]||0)+1,e),{});return{totalErrors:t.length,errorsByType:s,errorsByCode:r,recentErrors:t.slice(0,10)}}getAllErrors(){return[...this.errors]}clearErrors(){this.errors=[],this.saveErrorsToStorage()}exportErrors(){return JSON.stringify(this.errors,null,2)}generateErrorId(){return`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}determineErrorType(e){return"TypeError"===e.name||"ReferenceError"===e.name?D.CLIENT:"NetworkError"===e.name||e.message.includes("fetch")?D.NETWORK:e.message.includes("auth")?D.AUTHENTICATION:e.message.includes("permission")?D.AUTHORIZATION:D.UNKNOWN}determineErrorCode(e){return e.message.includes("timeout")?z.NETWORK_TIMEOUT:e.message.includes("offline")?z.NETWORK_OFFLINE:e.message.includes("file")?z.FILE_UPLOAD_FAILED:e.message.includes("message")?z.MESSAGE_SEND_FAILED:z.INVALID_INPUT}getCurrentUserId(){try{const e=localStorage.getItem("barsukov-user");return e?JSON.parse(e).id:void 0}catch(e){return}}trimErrors(){this.errors.length>this.maxErrors&&(this.errors=this.errors.slice(0,this.maxErrors))}cleanupOldErrors(){const e=new Date;e.setDate(e.getDate()-this.retentionDays),this.errors=this.errors.filter(t=>t.timestamp>=e),this.saveErrorsToStorage()}loadErrorsFromStorage(){try{const e=localStorage.getItem("barsukov-error-log");if(e){const t=JSON.parse(e);this.errors=t.map(e=>l(o({},e),{timestamp:new Date(e.timestamp)}))}}catch(e){console.warn("Failed to load errors from storage:",e)}}saveErrorsToStorage(){try{localStorage.setItem("barsukov-error-log",JSON.stringify(this.errors))}catch(e){console.warn("Failed to save errors to storage:",e)}}sendToExternalService(e){}};class qs extends g.Component{constructor(e){super(e),this.scheduleRetry=()=>{const{retryDelay:e=2e3}=this.props;this.setState({isRetrying:!0}),this.retryTimeout=setTimeout(()=>{this.handleRetry()},e)},this.handleRetry=()=>{this.setState(e=>({hasError:!1,error:void 0,errorInfo:void 0,retryCount:e.retryCount+1,isRetrying:!1}))},this.handleReload=()=>{window.location.reload()},this.handleReportError=()=>{const{error:e}=this.state;if(!e)return;const t=Vs.exportErrors(),s=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(s),n=document.createElement("a");n.href=r,n.download=`error-report-${Date.now()}.json`,n.click(),URL.revokeObjectURL(r),H.success("Отчет об ошибке","Отчет об ошибке сохранен. Отправьте его в службу поддержки.")},this.state={hasError:!1,retryCount:0,isRetrying:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){const{errorBoundaryName:s,onError:r}=this.props;Vs.logError(e,{componentStack:t.componentStack||"",errorBoundary:null!=s?s:"Unknown"}),!1!==this.props.showNotification&&H.showErrorBoundaryNotification(e,{componentStack:t.componentStack||"",errorBoundary:null!=s?s:"Unknown"}),this.setState({error:e,errorInfo:t}),null==r||r(e,t),this.props.autoRetry&&this.state.retryCount<3&&this.scheduleRetry()}componentWillUnmount(){this.retryTimeout&&clearTimeout(this.retryTimeout)}render(){const{hasError:e,error:t,errorInfo:s,isRetrying:r}=this.state,{fallback:n,className:i,errorBoundaryName:a}=this.props;return e?n||h.jsx("div",{className:Te("min-h-screen flex items-center justify-center p-4",i),children:h.jsxs("div",{className:"max-w-lg w-full p-6 rounded-lg border text-center",children:[h.jsx("div",{className:"mb-4",children:h.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),h.jsx("h2",{className:"text-xl font-bold mb-2 error-title-text",children:"Произошла ошибка"}),a&&h.jsxs("p",{className:"text-sm text-text mb-4",children:["Компонент: ",a]}),h.jsx("p",{className:"text-sm mb-4 error-message-text",children:(null==t?void 0:t.message)||B.GENERIC}),r&&h.jsx("div",{className:"mb-4",children:h.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),h.jsx("span",{className:"text-sm",children:"Попытка восстановления..."})]})}),!1,h.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[h.jsx("button",{onClick:this.handleRetry,disabled:r,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 error-button-primary disabled:opacity-50",children:r?"Восстановление...":"Попробовать снова"}),h.jsx("button",{onClick:this.handleReload,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 error-button-secondary",children:"Перезагрузить страницу"}),h.jsx("button",{onClick:this.handleReportError,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 error-button-secondary",children:"Сохранить отчет"})]})]})}):this.props.children}}class Ks extends g.Component{constructor(){super(...arguments),this.handleError=(e,t)=>{var s,r;console.error(`Settings Error${this.props.settingName?` in ${this.props.settingName}`:""}:`,e,t),null==(r=(s=this.props).onError)||r.call(s,e,t)}}render(){const{children:e,settingName:t,className:s}=this.props;return h.jsx(qs,{errorBoundaryName:"Settings"+(t?`: ${t}`:""),onError:this.handleError,className:Te("settings-error-boundary",s),showNotification:!0,autoRetry:!1,fallback:h.jsx("div",{className:Te("p-3 rounded-lg border border-yellow-200 bg-yellow-50",s),children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("h3",{className:"text-sm font-medium text-yellow-800",children:["Ошибка настройки",t?`: ${t}`:""]}),h.jsx("p",{className:"text-sm text-yellow-600 mt-1",children:"Не удалось загрузить настройку. Проверьте корректность данных."})]})]})}),children:e})}}const Qs=g.memo(({item:e,onChange:t,className:s})=>{var r,n,i;const a=null==e?void 0:e.value,o="boolean"==typeof a&&a,l="string"==typeof a?a:"",c="number"==typeof a?a:0,d=g.useCallback(()=>h.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group",children:[h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"checkbox",checked:o,onChange:s=>t(e.id,s.target.checked),className:"sr-only","aria-label":e.name}),h.jsx("div",{className:Te("w-5 h-5 rounded border-2 transition-all duration-200 flex items-center justify-center setting-checkbox",o&&"checked"),children:o&&h.jsx("svg",{className:"w-3 h-3 setting-checkbox-icon",fill:"currentColor",viewBox:"0 0 20 20",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),h.jsx("span",{className:"text-sm transition-colors duration-200 setting-description",children:e.name})]}),[o,e.id,e.name,t]),m=g.useCallback(()=>h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-sm font-medium setting-label",children:e.name}),h.jsx(Us,{value:l,options:e.options||[],onChange:s=>t(e.id,s),placeholder:e.placeholder})]}),[l,e.name,e.options,e.placeholder,e.id,t]),u=g.useRef(null),p=null!=(r=e.min)?r:0,x=null!=(n=e.max)?n:100,v=null!=(i=e.step)?i:1,f=g.useCallback(e=>{const t=(e-p)/(x-p)*100;u.current&&u.current.style.setProperty("--percent",`${t}%`)},[p,x]);g.useEffect(()=>{f(c)},[c,f]);const y=g.useCallback(()=>h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("label",{className:"block text-sm font-medium setting-label",children:e.name}),h.jsx("span",{className:"px-2 py-0.5 rounded-md text-xs shadow-sm setting-slider-value","aria-live":"polite",children:String(c)})]}),h.jsx("input",{ref:u,type:"range",value:c,min:p,max:x,step:v,onChange:s=>{const r=Number(s.target.value);f(r),t(e.id,r)},className:"slider-brand w-full h-2 appearance-none rounded-lg outline-none cursor-pointer border focus:ring-2 setting-slider-base","aria-label":e.name}),h.jsxs("div",{className:"flex justify-between text-xs setting-muted",children:[h.jsx("span",{children:p}),h.jsx("span",{children:x})]})]}),[c,e.name,p,x,v,e.id,t,f]),b=g.useCallback(()=>h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-sm font-medium setting-label",children:e.name}),h.jsx("input",{type:"color",value:l,onChange:s=>t(e.id,s.target.value),className:"w-12 h-10 rounded border-2 border-border cursor-pointer","aria-label":e.name,title:`Выберите цвет для ${e.name}`})]}),[l,e.name,e.id,t]),j=g.useCallback(()=>h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-sm font-medium setting-label",children:e.name}),h.jsx("input",{type:"text",value:l,onChange:s=>t(e.id,s.target.value),className:"w-full px-3 py-2.5 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-200 setting-input-base","aria-label":e.name,placeholder:e.placeholder||`Введите ${e.name.toLowerCase()}`})]}),[l,e.name,e.placeholder,e.id,t]),N=g.useCallback(()=>{switch(e.type){case"boolean":return d();case"select":return m();case"number":return y();case"color":return b();case"font-size-slider":return h.jsx(Ws,{value:"string"==typeof e.value?e.value:"medium",onChange:e.onChange});case"theme-selector":return h.jsx(Gs,{theme:"string"==typeof e.value?e.value:"light",onThemeChange:e.onChange});case"rainbow-theme-system":case"unified-rainbow-theme":case"theme-buttons":return h.jsx(Gs,{theme:"string"==typeof e.value?e.value:"dark",onThemeChange:e.onChange});default:return j()}},[e.type,e.value,e.onChange,d,m,y,b,j]);return e?h.jsx(Ks,{settingName:e.name,children:h.jsxs("div",{className:Te("setting-item-container",s),children:[h.jsxs("div",{className:"mb-3",children:[h.jsx("h4",{className:"text-sm font-medium mb-1 setting-label",children:e.name}),e.description&&h.jsx("p",{className:"text-xs leading-relaxed setting-description",children:e.description})]}),h.jsx("div",{className:"mt-3",children:N()})]})}):(console.error("SettingItem: item is undefined"),null)});const Zs=class e{constructor(){this.currentAccentSet={primary:"#ff0000",secondary:"#ff8000",tertiary:"#ffff00",name:"rainbow-red-orange-yellow"},this.accentSets=[{primary:"#ff0000",secondary:"#ff8000",tertiary:"#ffff00",name:"rainbow-red-orange-yellow"},{primary:"#ff8000",secondary:"#ffff00",tertiary:"#00ff00",name:"rainbow-orange-yellow-green"},{primary:"#ffff00",secondary:"#00ff00",tertiary:"#000000",name:"rainbow-yellow-green-black"},{primary:"#00ff00",secondary:"#000000",tertiary:"#8000ff",name:"rainbow-green-black-purple"},{primary:"#000000",secondary:"#8000ff",tertiary:"#ff0000",name:"rainbow-black-purple-red"},{primary:"#8000ff",secondary:"#ff0000",tertiary:"#ff8000",name:"rainbow-purple-red-orange"}],this.initializeAccentColors()}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeAccentColors(){this.applyAccentColors(this.currentAccentSet)}applyAccentColors(e){const t=document.documentElement;t.style.setProperty("--dynamic-accent-primary",e.primary),t.style.setProperty("--dynamic-accent-secondary",e.secondary),t.style.setProperty("--dynamic-accent-tertiary",e.tertiary),t.style.setProperty("--accent-primary",e.primary),t.style.setProperty("--accent-secondary",e.secondary),t.style.setProperty("--accent-tertiary",e.tertiary)}setAccentSet(e){const t=this.accentSets.find(t=>t.name===e);t&&(this.currentAccentSet=t,this.applyAccentColors(t),this.saveAccentSet(e))}getCurrentAccentSet(){return this.currentAccentSet}getAllAccentSets(){return this.accentSets}cycleAccentSets(){const e=(this.accentSets.findIndex(e=>e.name===this.currentAccentSet.name)+1)%this.accentSets.length,t=this.accentSets[e];this.setAccentSet(t.name)}setRandomAccentSet(){const e=Math.floor(Math.random()*this.accentSets.length),t=this.accentSets[e];this.setAccentSet(t.name)}saveAccentSet(e){try{localStorage.setItem("barsukov-accent-set",e)}catch(t){console.warn("Не удалось сохранить акцентные цвета:",t)}}loadAccentSet(){try{return localStorage.getItem("barsukov-accent-set")}catch(e){return console.warn("Не удалось загрузить акцентные цвета:",e),null}}restoreAccentSet(){const e=this.loadAccentSet();e&&this.setAccentSet(e)}startAutoCycle(e=1e4){setInterval(()=>{this.cycleAccentSets()},e)}getAccentColor(e){return this.currentAccentSet[e]}createAccentGradient(e="diagonal"){const{primary:t,secondary:s,tertiary:r}=this.currentAccentSet;switch(e){case"horizontal":return`linear-gradient(90deg, ${t}, ${s}, ${r})`;case"vertical":return`linear-gradient(180deg, ${t}, ${s}, ${r})`;default:return`linear-gradient(135deg, ${t}, ${s}, ${r})`}}}.getInstance();g.memo(({isVisible:e,message:t,type:s,duration:r=3e3,onComplete:n,className:i=""})=>{const[a,o]=g.useState(!1);if(g.useEffect(()=>{if(e){o(!0);const e=setTimeout(()=>{o(!1),null==n||n()},r);return()=>clearTimeout(e)}},[e,r,n]),!a)return null;return h.jsxs("div",{className:Te("fixed top-4 right-4 z-50 flex items-center space-x-3 px-4 py-3 rounded-lg border shadow-lg backdrop-blur-sm",(()=>{switch(s){case"loading":return"bg-black/10 border-black/20";case"success":return"bg-green-500/10 border-green-500/20";case"error":return"bg-red-500/10 border-red-500/20"}})(),i),children:[(()=>{switch(s){case"loading":return h.jsx(ft,{className:"w-5 h-5 animate-spin text-text"});case"success":return h.jsx(Ve,{className:"w-5 h-5 text-green-500"});case"error":return h.jsx(as,{className:"w-5 h-5 text-red-500"})}})(),h.jsx("span",{className:"text-sm font-medium text-primary",children:t})]})}).displayName="ProgressIndicator";const Ys=g.forwardRef(({zoom:e,isLoading:t,isRendered:s},r)=>h.jsxs("div",{className:"diagram-container",children:[t&&h.jsxs("div",{className:"diagram-loading",children:[h.jsx("div",{className:"loading-spinner"}),h.jsx("div",{className:"loading-text",children:"Загрузка диаграммы..."})]}),h.jsx("div",{ref:r,className:"mermaid-container","data-zoom":e}),!t&&!s&&h.jsxs("div",{className:"diagram-placeholder",children:[h.jsx("div",{className:"placeholder-icon",children:"📊"}),h.jsx("div",{className:"placeholder-text",children:"Диаграмма не загружена"})]})]}));Ys.displayName="DiagramContainer";const Js=({zoom:e,isFullscreen:t,showLegend:s,showMinimap:r,onZoomIn:n,onZoomOut:i,onResetZoom:a,onToggleFullscreen:o,onToggleLegend:l,onToggleMinimap:c,onDownload:d,onRerender:m,onResetControls:u})=>h.jsx("div",{className:"diagram-controls",children:h.jsxs("div",{className:"controls-group",children:[h.jsx("h3",{children:"Управление"}),h.jsxs("div",{className:"zoom-controls",children:[h.jsx("button",{onClick:i,className:"control-button",title:"Уменьшить",children:h.jsx(ds,{className:"w-4 h-4"})}),h.jsxs("span",{className:"zoom-level",children:[Math.round(100*e),"%"]}),h.jsx("button",{onClick:n,className:"control-button",title:"Увеличить",children:h.jsx(cs,{className:"w-4 h-4"})}),h.jsx("button",{onClick:a,className:"control-button",title:"Сбросить зум",children:h.jsx(Dt,{className:"w-4 h-4"})})]}),h.jsxs("div",{className:"main-controls",children:[h.jsx("button",{onClick:o,className:"control-button "+(t?"active":""),title:"Полноэкранный режим",children:h.jsx(Nt,{className:"w-4 h-4"})}),h.jsx("button",{onClick:d,className:"control-button",title:"Скачать диаграмму",children:h.jsx(st,{className:"w-4 h-4"})}),h.jsx("button",{onClick:m,className:"control-button",title:"Перерендерить",children:"🔄"})]}),h.jsxs("div",{className:"display-controls",children:[h.jsxs("label",{className:"control-checkbox",children:[h.jsx("input",{type:"checkbox",checked:s,onChange:l}),h.jsx("span",{children:"Показать легенду"})]}),h.jsxs("label",{className:"control-checkbox",children:[h.jsx("input",{type:"checkbox",checked:r,onChange:c}),h.jsx("span",{children:"Показать мини-карту"})]})]}),h.jsx("button",{onClick:u,className:"reset-button",title:"Сбросить все настройки",children:"Сбросить настройки"})]})}),Xs=({error:e,onRetry:t})=>h.jsxs("div",{className:"diagram-error",children:[h.jsxs("div",{className:"error-content",children:[h.jsx("div",{className:"error-icon",children:(e=>{switch(e){case"render":return"🎨";case"load":return"📥";case"validation":return"✅";case"network":return"🌐";default:return"⚠️"}})(e.type)}),h.jsxs("div",{className:"error-details",children:[h.jsx("h3",{className:"error-title",children:(e=>{switch(e){case"render":return"Ошибка рендеринга";case"load":return"Ошибка загрузки";case"validation":return"Ошибка валидации";case"network":return"Сетевая ошибка";default:return"Неизвестная ошибка"}})(e.type)}),h.jsx("p",{className:"error-message",children:e.message}),e.details&&h.jsxs("details",{className:"error-details-expanded",children:[h.jsx("summary",{children:"Технические детали"}),h.jsx("pre",{className:"error-stack",children:e.details})]}),h.jsxs("div",{className:"error-timestamp",children:["Время: ",new Date(e.timestamp).toLocaleString()]})]})]}),h.jsxs("div",{className:"error-actions",children:[h.jsx("button",{onClick:t,className:"retry-button",children:"🔄 Попробовать снова"}),h.jsx("button",{onClick:()=>window.location.reload(),className:"reload-button",children:"🔄 Обновить страницу"}),h.jsx("button",{onClick:()=>{navigator.clipboard&&navigator.clipboard.writeText(`\nОшибка: ${e.message}\nТип: ${e.type}\nВремя: ${new Date(e.timestamp).toLocaleString()}\nДетали: ${e.details||"Нет"}\n              `)},className:"copy-button",children:"📋 Скопировать отчет"})]})]}),er=()=>h.jsxs("div",{className:"diagram-legend",children:[h.jsx("h3",{children:"Легенда"}),h.jsxs("div",{className:"legend-section",children:[h.jsx("h4",{children:"Статус компонентов"}),h.jsxs("div",{className:"legend-items",children:[h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-dot implemented"}),h.jsx("span",{children:"Реализованные компоненты"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-dot missing"}),h.jsx("span",{children:"Требуют доработки"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-dot raptor"}),h.jsx("span",{children:"RAPTOR Engine"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-dot gpt5"}),h.jsx("span",{children:"GPT-5 Integration"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-dot graph"}),h.jsx("span",{children:"GraphRAG система"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-dot hyde"}),h.jsx("span",{children:"HyDE система"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-dot monitoring"}),h.jsx("span",{children:"Мониторинг"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-dot database"}),h.jsx("span",{children:"Базы данных"})]})]})]}),h.jsxs("div",{className:"legend-section",children:[h.jsx("h4",{children:"Типы соединений"}),h.jsxs("div",{className:"legend-items",children:[h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-line data"}),h.jsx("span",{children:"Поток данных"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-line control"}),h.jsx("span",{children:"Управление"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-line cache"}),h.jsx("span",{children:"Кэширование"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-line monitoring"}),h.jsx("span",{children:"Мониторинг"})]})]})]}),h.jsxs("div",{className:"legend-section",children:[h.jsx("h4",{children:"Архитектурные слои"}),h.jsxs("div",{className:"legend-items",children:[h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"🚪"}),h.jsx("span",{children:"Система входа"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"🌳"}),h.jsx("span",{children:"RAPTOR Engine"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"🚀"}),h.jsx("span",{children:"GPT-5 Integration"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"🔍"}),h.jsx("span",{children:"Поисковая система"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"🕸️"}),h.jsx("span",{children:"GraphRAG + HyDE"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"📄"}),h.jsx("span",{children:"Обработка документов"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"⚡"}),h.jsx("span",{children:"Кэширование"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"📊"}),h.jsx("span",{children:"Мониторинг"})]}),h.jsxs("div",{className:"legend-item",children:[h.jsx("div",{className:"legend-icon",children:"🗄️"}),h.jsx("span",{children:"Базы данных"})]})]})]})]}),tr={id:"gpt5-integration",name:"GPT-5 Integration",description:"Интеллектуальная маршрутизация и адаптивные модели GPT-5",position:{x:1,y:1},dependencies:["raptor-engine"],isVisible:!0,isExpanded:!0,mermaidCode:'\n    %% ================ GPT-5 INTEGRATION ================ %%\n    subgraph GPT5_SYSTEM["🚀 GPT-5 SYSTEM"]\n        ENHANCED_QPROC --\x3e INTELLIGENT_ROUTER["🚀 Intelligent Router<br>• Анализ сложности запросов<br>• Выбор оптимальной модели<br>• Управление бюджетом<br>• Адаптивная маршрутизация"]\n\n        INTELLIGENT_ROUTER --\x3e GPT5_NANO["⚡ GPT-5 Nano<br>• 80% запросов<br>• Простые вопросы<br>• Быстрые ответы<br>• Время: 1-2 сек"]\n\n        INTELLIGENT_ROUTER --\x3e GPT5_MINI["🚀 GPT-5 Mini<br>• 15% запросов<br>• Средние задачи<br>• Баланс скорости/качества<br>• Время: 2-3 сек"]\n\n        INTELLIGENT_ROUTER --\x3e GPT5_STANDARD["🎯 GPT-5 Standard<br>• 5% запросов<br>• Сложные рассуждения<br>• Максимальное качество<br>• Время: 3-5 сек"]\n\n        GPT5_NANO --\x3e RESPONSE_GENERATOR["📝 Генератор ответов<br>• Форматирование ответов<br>• Структурированный вывод<br>• Контекстная адаптация"]\n\n        GPT5_MINI --\x3e RESPONSE_GENERATOR\n        GPT5_STANDARD --\x3e RESPONSE_GENERATOR\n\n        RESPONSE_GENERATOR --\x3e RESULT_CACHE["💾 Result Cache<br>• Кэш ответов GPT-5<br>• TTL настройки<br>• Инвалидация<br>• Статистика попаданий"]\n    end\n\n    %% Стилизация\n    classDef gpt5 fill:#a78bfa,stroke:#8b5cf6,stroke-width:2px\n    class GPT5_NANO,GPT5_MINI,GPT5_STANDARD,INTELLIGENT_ROUTER gpt5\n  '},sr={id:"input-system",name:"Система входа",description:"Пользовательские интерфейсы и балансировщик нагрузки",position:{x:0,y:0},dependencies:[],isVisible:!0,isExpanded:!0,mermaidCode:'\n    %% ================ СИСТЕМА ВХОДА ================ %%\n    USER(("👤 Пользователь")) --\x3e|"Сообщение/Голос/Файл"| NGINX_LB["⚖️ Nginx Load Balancer<br>• Распределение нагрузки<br>• Health checks<br>• SSL termination<br>• Rate limiting"]\n\n    NGINX_LB --\x3e BOT["🤖 Telegram Бот<br>• Redis FSM<br>• Rate limiting<br>• Голосовые команды"]\n    NGINX_LB --\x3e WEB_SERVICE["🌐 Веб-сервис<br>• Next.js 14<br>• WebSockets<br>• PWA поддержка"]\n    NGINX_LB --\x3e MOBILE_APP["📱 Мобильное приложение<br>• React Native<br>• Push-уведомления<br>• Оффлайн-режим"]\n\n    BOT --\x3e REDIS_QUEUE["📬 Redis Queue<br>• Очередь запросов<br>• Приоритизация<br>• Rate limiting"]\n    WEB_SERVICE --\x3e REDIS_QUEUE\n    MOBILE_APP --\x3e REDIS_QUEUE\n\n    REDIS_QUEUE --\x3e WORKER_POOL["⚙️ Worker Pool<br>• Параллельная обработка<br>• Автоматическое масштабирование<br>• Мониторинг состояния"]\n\n    WORKER_POOL --\x3e ROUTER["🧭 Маршрутизатор<br>FastAPI + Pydantic v2<br>• Idempotency keys<br>• Умная валидация"]\n\n    %% Стилизация\n    classDef implemented fill:#d1fae5,stroke:#10b981,stroke-width:2px,color:#111827\n    class USER,NGINX_LB,BOT,WEB_SERVICE,MOBILE_APP,REDIS_QUEUE,WORKER_POOL,ROUTER implemented\n  '},rr={id:"raptor-engine",name:"RAPTOR Engine",description:"Рекурсивная кластеризация и древовидная организация данных",position:{x:0,y:1},dependencies:["input-system"],isVisible:!0,isExpanded:!0,mermaidCode:'\n    %% ================ RAPTOR ENGINE ================ %%\n    subgraph RAPTOR_SYSTEM["🌳 RAPTOR ENGINE"]\n        ROUTER --\x3e ENHANCED_QPROC["🧠 Расширенный обработчик<br>• SlangDictionary<br>• ContextAnalyzer<br>• SynonymExpander<br>• LegalTerminologyManager"]\n\n        ENHANCED_QPROC --\x3e RAPTOR_ENGINE["🌳 RAPTOR Engine<br>• Рекурсивная кластеризация<br>• Древовидная организация<br>• Генерация абстракций<br>• Оптимизированный поиск"]\n\n        RAPTOR_ENGINE --\x3e RAPTOR_TREE["🌳 RAPTOR Tree<br>• Иерархическая структура<br>• Рекурсивные узлы<br>• Абстракции по уровням"]\n\n        RAPTOR_ENGINE --\x3e RAPTOR_CLUSTERING["🔗 RAPTOR Clustering<br>• K-means кластеризация<br>• Семантическое группирование<br>• Адаптивные пороги"]\n    end\n\n    %% Стилизация\n    classDef raptor fill:#fbbf24,stroke:#f59e0b,stroke-width:3px\n    class RAPTOR_ENGINE,RAPTOR_TREE,RAPTOR_CLUSTERING raptor\n  '},nr=()=>{const[e,t]=g.useState(null),[s,r]=g.useState(!0),{zoom:n,isFullscreen:i,zoomIn:a,zoomOut:o,resetZoom:l,toggleFullscreen:c}=(()=>{const[e,t]=g.useState(1),[s,r]=g.useState(!1);return{zoom:e,isFullscreen:s,zoomIn:g.useCallback(()=>{t(e=>Math.min(e+.1,2))},[]),zoomOut:g.useCallback(()=>{t(e=>Math.max(e-.1,.5))},[]),resetZoom:g.useCallback(()=>{t(1)},[]),setZoomLevel:g.useCallback(e=>{t(Math.max(.5,Math.min(2,e)))},[]),toggleFullscreen:g.useCallback(()=>{r(e=>!e)},[]),zoomToFit:g.useCallback(()=>{t(1)},[])}})(),{showLegend:m,showMinimap:u,toggleLegend:p,toggleMinimap:x,resetControls:v}=(()=>{const[e,t]=g.useState(!0),[s,r]=g.useState(!0),[n,i]=g.useState(!0),[a,o]=g.useState(!1),[l,c]=g.useState(!0);return{showLegend:e,showMinimap:s,autoLayout:n,showGrid:a,showConnections:l,toggleLegend:g.useCallback(()=>{t(e=>!e)},[]),toggleMinimap:g.useCallback(()=>{r(e=>!e)},[]),toggleAutoLayout:g.useCallback(()=>{i(e=>!e)},[]),toggleGrid:g.useCallback(()=>{o(e=>!e)},[]),toggleConnections:g.useCallback(()=>{c(e=>!e)},[]),resetControls:g.useCallback(()=>{t(!0),r(!0),i(!0),o(!1),c(!0)},[])}})(),f=g.useMemo(()=>{if(s)return'\n        flowchart TD\n        %% ====== ЧИТАЕМОСТЬ/ЦВЕТА ГРУПП ======\n        classDef input fill:#a7f3d0,stroke:#059669,stroke-width:2px,color:#111827\n        classDef infra fill:#0b1f3b,stroke:#60a5fa,stroke-width:2px,color:#eaf2ff\n        classDef service fill:#0f172a,stroke:#374151,stroke-width:2px,color:#f8fafc\n        classDef queue fill:#0c1f16,stroke:#22c55e,stroke-width:2px,color:#dcfce7\n        classDef raptor fill:#f59e0b,stroke:#b45309,stroke-width:2px,color:#111827\n        classDef gpt5 fill:#2b0b3b,stroke:#8b5cf6,stroke-width:2px,color:#f5eaff\n        %% ================ СИСТЕМА ВХОДА ================ %%\n        USER(("👤 Пользователь")) --\x3e|"Сообщение/Голос/Файл"| NGINX_LB["⚖️ Nginx Load Balancer<br>• Распределение нагрузки<br>• Health checks<br>• SSL termination<br>• Rate limiting"]\n\n        NGINX_LB --\x3e BOT["🤖 Telegram Бот<br>• Redis FSM<br>• Rate limiting<br>• Голосовые команды"]\n        NGINX_LB --\x3e WEB_SERVICE["🌐 Веб-сервис<br>• Next.js 14<br>• WebSockets<br>• PWA поддержка"]\n        NGINX_LB --\x3e MOBILE_APP["📱 Мобильное приложение<br>• React Native<br>• Push-уведомления<br>• Оффлайн-режим"]\n\n        BOT --\x3e REDIS_QUEUE["📬 Redis Queue<br>• Очередь запросов<br>• Приоритизация<br>• Rate limiting"]\n        WEB_SERVICE --\x3e REDIS_QUEUE\n        MOBILE_APP --\x3e REDIS_QUEUE\n\n        REDIS_QUEUE --\x3e WORKER_POOL["⚙️ Worker Pool<br>• Параллельная обработка<br>• Автоматическое масштабирование<br>• Мониторинг состояния"]\n\n        WORKER_POOL --\x3e ROUTER["🧭 Маршрутизатор<br>FastAPI + Pydantic v2<br>• Idempotency keys<br>• Умная валидация"]\n\n        %% ================ RAPTOR ENGINE ================ %%\n        subgraph RAPTOR_SYSTEM["🌳 RAPTOR ENGINE"]\n            ROUTER --\x3e ENHANCED_QPROC["🧠 Расширенный обработчик<br>• SlangDictionary<br>• ContextAnalyzer<br>• SynonymExpander<br>• LegalTerminologyManager"]\n\n            ENHANCED_QPROC --\x3e RAPTOR_ENGINE["🌳 RAPTOR Engine<br>• Рекурсивная кластеризация<br>• Древовидная организация<br>• Генерация абстракций<br>• Оптимизированный поиск"]\n\n            RAPTOR_ENGINE --\x3e RAPTOR_TREE["🌳 RAPTOR Tree<br>• Иерархическая структура<br>• Рекурсивные узлы<br>• Абстракции по уровням"]\n\n            RAPTOR_ENGINE --\x3e RAPTOR_CLUSTERING["🔗 RAPTOR Clustering<br>• K-means кластеризация<br>• Семантическое группирование<br>• Адаптивные пороги"]\n        end\n\n        %% ================ GPT-5 INTEGRATION ================ %%\n        subgraph GPT5_SYSTEM["🚀 GPT-5 SYSTEM"]\n            ENHANCED_QPROC --\x3e INTELLIGENT_ROUTER["🚀 Intelligent Router<br>• Анализ сложности запросов<br>• Выбор оптимальной модели<br>• Управление бюджетом<br>• Адаптивная маршрутизация"]\n\n            INTELLIGENT_ROUTER --\x3e GPT5_NANO["⚡ GPT-5 Nano<br>• 80% запросов<br>• Простые вопросы<br>• Быстрые ответы<br>• Время: 1-2 сек"]\n\n            INTELLIGENT_ROUTER --\x3e GPT5_MINI["🚀 GPT-5 Mini<br>• 15% запросов<br>• Средние задачи<br>• Баланс скорости/качества<br>• Время: 2-3 сек"]\n\n            INTELLIGENT_ROUTER --\x3e GPT5_STANDARD["🎯 GPT-5 Standard<br>• 5% запросов<br>• Сложные рассуждения<br>• Максимальное качество<br>• Время: 3-5 сек"]\n\n            GPT5_NANO --\x3e RESPONSE_GENERATOR["📝 Генератор ответов<br>• Форматирование ответов<br>• Структурированный вывод<br>• Контекстная адаптация"]\n\n            GPT5_MINI --\x3e RESPONSE_GENERATOR\n            GPT5_STANDARD --\x3e RESPONSE_GENERATOR\n\n            RESPONSE_GENERATOR --\x3e RESULT_CACHE["💾 Result Cache<br>• Кэш ответов GPT-5<br>• TTL настройки<br>• Инвалидация<br>• Статистика попаданий"]\n        end\n\n        %% ================ ДАННЫЕ И МОНИТОРИНГ ================ %%\n        subgraph DATA["🗄️ ДАННЫЕ"]\n            POSTGRES[(🐘 PostgreSQL)]\n            QDRANT[(🔍 Qdrant Vector DB)]\n            MINIO[(🗄️ MinIO S3)]\n        end\n\n        subgraph MON["📊 МОНИТОРИНГ"]\n            SIGNOZ["🔍 SigNoz"]\n        end\n\n        %% Связи с данными и метриками\n        ENHANCED_QPROC --\x3e|"метаданные"| POSTGRES\n        ENHANCED_QPROC --\x3e|"векторы"| QDRANT\n        ENHANCED_QPROC --\x3e|"файлы"| MINIO\n        RESPONSE_GENERATOR --\x3e|"метрики"| SIGNOZ\n        WORKER_POOL --\x3e|"метрики"| SIGNOZ\n\n        %% ================ СТИЛИЗАЦИЯ ================ %%\n        %% ====== НАЗНАЧЕНИЕ КЛАССОВ ======\n        class USER input\n        class NGINX_LB input\n        class BOT,WEB_SERVICE,MOBILE_APP,WORKER_POOL,ROUTER input\n        class REDIS_QUEUE input\n        class RESULT_CACHE queue\n        class RAPTOR_ENGINE,RAPTOR_TREE,RAPTOR_CLUSTERING raptor\n        class GPT5_NANO,GPT5_MINI,GPT5_STANDARD,INTELLIGENT_ROUTER gpt5\n        class POSTGRES,QDRANT,MINIO db\n        class SIGNOZ monitor\n      ';if(e){const t=[sr,rr,tr].find(t=>t.id===e);if(console.log("Selected module:",e,"Found module:",t),null==t?void 0:t.mermaidCode){const e=`flowchart TD\n${t.mermaidCode}`;return console.log("Generated diagram code:",e),e}return""}return""},[s,e]),{diagramRef:y,isLoading:b,error:j,performance:N,isRendered:w,forceRerender:k}=(e=>{const[t,s]=g.useState(!0),[r,n]=g.useState(null),[i,a]=g.useState(null),[o,l]=g.useState(!1),c=g.useRef(null),m=g.useRef(0),h=g.useRef(!1),u=g.useRef(""),p=g.useRef(null),x=g.useCallback(()=>d(void 0,null,function*(){return window.mermaid?Promise.resolve():new Promise((e,t)=>{const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js",s.onload=()=>{window.mermaid?(window.mermaid.initialize({startOnLoad:!1,theme:"dark",flowchart:{useMaxWidth:!0,htmlLabels:!0,curve:"basis",padding:12,nodeSpacing:40,rankSpacing:60},themeVariables:{primaryColor:"#0b1220",primaryTextColor:"#f8fafc",primaryBorderColor:"#1f2937",lineColor:"#93c5fd",secondaryColor:"#111827",tertiaryColor:"#0f172a",textColor:"#f8fafc",fontFamily:"Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial",clusterBkg:"#0b1220",clusterBorder:"#1f2937",nodeBorder:"#334155",nodeTextColor:"#f8fafc",noteBkg:"#0b1220",noteTextColor:"#e2e8f0"},themeCSS:"\n              .label, .nodeLabel { font-size: 14px; line-height: 1.35; fill: #f8fafc; font-weight: 600; }\n              .edgeLabel { font-size: 12px; fill: #e2e8f0; font-weight: 600; }\n              .edgeLabel rect { fill: #0b1220; stroke: #1f2937; rx: 4px; ry: 4px; opacity: 0.95; }\n              .cluster text { font-size: 13px; fill: #cbd5e1; }\n              .node rect, .node polygon { rx: 10px; ry: 10px; }\n              .edgePath .path { stroke-width: 2.2px; }\n              .marker, .arrowheadPath { fill: #93c5fd; stroke: #93c5fd; }\n              /* Raptor: чёрный текст на оранжевом */\n              .node.raptor .label, .node.raptor .nodeLabel { fill: #111827 !important; }\n              /* Input: чёрный текст на светло-зелёном фоне */\n              .node.input .label, .node.input .nodeLabel { fill: #111827 !important; }\n              /* Service: текст ярче на тёмном */\n              .node.service .label, .node.service .nodeLabel { fill: #f8fafc !important; }\n              /* DB: тёмный текст на светлом */\n              .node.db .label, .node.db .nodeLabel { fill: #0f172a !important; }\n              /* Monitor: светлый текст */\n              .node.monitor .label, .node.monitor .nodeLabel { fill: #f8fafc !important; }\n            "}),e()):t(new Error("Failed to load Mermaid"))},s.onerror=()=>t(new Error("Failed to load Mermaid script")),document.head.appendChild(s)})}),[]),v=g.useCallback(()=>d(void 0,null,function*(){var t,r;if(!e||!c.current)return;if(h.current)return void console.log("Diagram render already in progress, skipping...");if(u.current===e&&o)return void console.log("Diagram code unchanged, skipping render...");h.current=!0,s(!0),n(null);const i=()=>{var e;try{return(null==(e=window.performance)?void 0:e.now())||Date.now()}catch(t){return Date.now()}},d=i();try{if(c.current&&(c.current.innerHTML=""),yield x(),!window.mermaid)throw new Error("Mermaid not loaded");const{svg:s}=yield window.mermaid.render(`diagram-${Date.now()}-${m.current}`,e);c.current&&(c.current.innerHTML=s,l(!0),m.current=0,u.current=e,c.current.style.setProperty("--zoom-level","1"));const n=i()-d;a({renderTime:n,loadTime:n,memoryUsage:(null==(r=null==(t=window.performance)?void 0:t.memory)?void 0:r.usedJSHeapSize)||0,nodeCount:(s.match(/<g class="node"/g)||[]).length,connectionCount:(s.match(/<path class="path"/g)||[]).length})}catch(p){console.error("Diagram render error:",p);const e={type:"render",message:`Ошибка рендеринга диаграммы: ${p instanceof Error?p.message:"Неизвестная ошибка"}`,details:p instanceof Error?p.stack:void 0,timestamp:Date.now()};n(e),m.current<3?(m.current++,setTimeout(()=>{v()},1e3*m.current)):c.current&&(c.current.innerHTML='\n            <div class="diagram-error">\n              <div class="error-icon">⚠️</div>\n              <div class="error-message">Ошибка загрузки диаграммы</div>\n              <div class="error-details">Попробуйте обновить страницу</div>\n              <button onclick="window.location.reload()" class="retry-button">\n                Обновить страницу\n              </button>\n            </div>\n          ')}finally{s(!1),h.current=!1}}),[e,x,o]);g.useEffect(()=>(e&&(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{v()},300)),()=>{p.current&&clearTimeout(p.current)}),[e,v]);const f=g.useCallback(()=>{l(!1),m.current=0,u.current="",h.current=!1,v()},[v]),y=g.useCallback(()=>{c.current&&(c.current.innerHTML=""),l(!1),n(null),a(null),u.current="",h.current=!1,p.current&&(clearTimeout(p.current),p.current=null)},[]);return{diagramRef:c,isLoading:t,error:r,performance:i,isRendered:o,forceRerender:f,clearDiagram:y}})(f);g.useEffect(()=>{y.current&&y.current.style.setProperty("--zoom-level",n.toString())},[n]);const S=e=>{t(e),r(!1)};return h.jsxs("div",{className:"modular-architecture-diagram "+(i?"fullscreen":""),children:[h.jsx(Js,{zoom:n,isFullscreen:i,showLegend:m,showMinimap:u,onZoomIn:a,onZoomOut:o,onResetZoom:l,onToggleFullscreen:c,onToggleLegend:p,onToggleMinimap:x,onDownload:()=>{var e;const t=null==(e=y.current)?void 0:e.querySelector("svg");if(t){const e=(new XMLSerializer).serializeToString(t),s=new Blob([e],{type:"image/svg+xml"}),r=URL.createObjectURL(s),n=document.createElement("a");n.href=r,n.download="ai-lawyer-architecture.svg",n.click(),URL.revokeObjectURL(r)}},onRerender:k,onResetControls:v}),h.jsxs("div",{className:"diagram-content",children:[h.jsxs("div",{className:"modules-panel",children:[h.jsx("h3",{children:"Модули архитектуры"}),h.jsxs("div",{className:"modules-list",children:[h.jsx("button",{onClick:()=>{t(null),r(!0)},className:"module-button "+(s?"active":""),children:"🏗️ Полная архитектура"}),h.jsx("button",{onClick:()=>S("input-system"),className:"module-button "+("input-system"===e?"active":""),children:"🚪 Система входа"}),h.jsx("button",{onClick:()=>S("raptor-engine"),className:"module-button "+("raptor-engine"===e?"active":""),children:"🌳 RAPTOR Engine"}),h.jsx("button",{onClick:()=>S("gpt5-integration"),className:"module-button "+("gpt5-integration"===e?"active":""),children:"🚀 GPT-5 Integration"})]})]}),h.jsxs("div",{className:"diagram-area",children:[h.jsx(Ys,{ref:y,zoom:n,isLoading:b,isRendered:w}),j&&h.jsx(Xs,{error:j,onRetry:k}),N&&h.jsx("div",{className:"performance-info",children:h.jsxs("small",{children:["Рендер: ",N.renderTime.toFixed(0),"мс | Узлы: ",N.nodeCount," | Связи: ",N.connectionCount]})}),h.jsxs("div",{className:"investor-sections",id:"investor-metrics",children:[h.jsx("h3",{children:"Ценность для бизнеса"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Скорость принятия решений:"})," RAPTOR + GPT‑роутинг сокращают время до результата"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Снижение затрат:"})," Интеллектуальное кэширование и маршрутизация оптимизируют стоимость запроса"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Качество ответов:"})," rerank и иерархический контекст повышают релевантность"]})]}),h.jsx("h3",{children:"SLO/SLI и ключевые метрики"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"p95 латентность (классы задач):"})," поиск ≤ 800 мс; генерация 1–5 с; индексация пачки ≤ 2 мин"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Throughput:"})," 200 ops/сек в пике; OCR 50 стр/мин"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Качество:"})," recall@10 ≥ 0.9 (с rerank); OCR WER ≤ 15%"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Экономика:"})," cost/req −30–55% благодаря кэшу и роутингу"]})]}),h.jsx("h3",{id:"slo-sli",children:"Дорожная карта (квартал)"}),h.jsxs("ol",{children:[h.jsx("li",{children:"Полная автоматизация генерации документов (финализация валидаций)"}),h.jsx("li",{children:"GraphRAG + HyDE: расширенный контекст и multi‑hop reasoning"}),h.jsx("li",{children:"Админ‑панель метрик: визуализация SLO/SLI и демо‑кейсы"})]}),h.jsx("h3",{children:"Риски и контроль"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Качество данных:"})," пред‑/пост‑обработка, анонимизация PII, валидаторы"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Нагрузка:"})," очереди, пул воркеров, деградация с сохранением функциональности"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Модели:"})," переключаемые профили эмбеддингов и rerank, fallback стратегии"]})]}),h.jsx("h3",{id:"demo-cases",children:"Демо‑кейсы"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Поиск по делу:"})," ответ ≤ 2 с, точность повышена за счёт RAPTOR"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Анализ договора:"})," выявление рисков с контекстными ссылками"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Сбор документа:"})," конструктор + валидатор полей, экспорт в DOCX/PDF"]})]})]})]}),m&&h.jsx("div",{className:"legend-panel",children:h.jsx(er,{})})]})]})},ir=({audienceMode:e="user"})=>"user"===e?h.jsxs("div",{className:"bg-gradient-to-r from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-lg p-6",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:"🏆 Наши преимущества"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsx("h4",{className:"font-semibold mb-2 text-green-500",children:"Экономичность"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"В 10 раз дешевле традиционных юридических услуг"})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsx("h4",{className:"font-semibold mb-2 text-blue-500",children:"Мгновенность"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Ответы за секунды, а не недели"})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsx("h4",{className:"font-semibold mb-2 text-purple-500",children:"Точность"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"97% точность vs 85% у обычных юристов"})]})]})]}):h.jsxs("div",{className:"bg-gradient-to-r from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-lg p-6",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:"🏆 Конкурентные преимущества"}),h.jsx("div",{className:"space-y-6",children:[{name:"ChatGPT/Claude",type:"Generic AI",strengths:["Общие знания","Разговорный интерфейс","Широкая доступность"],weaknesses:["Нет специализации","Нет проверки соответствия","Нет интеграции документов"],ourAdvantage:"Специализированное обучение, проверка соответствия, рабочие процессы документов"},{name:"LegalZoom",type:"Legal Tech",strengths:["Узнаваемость бренда","Библиотека шаблонов","Устоявшийся рынок"],weaknesses:["Статичные шаблоны","Нет ИИ-рассуждений","Ограниченная кастомизация"],ourAdvantage:"Динамическая генерация, интеллектуальный анализ, полная персонализация"},{name:"Традиционные юридические фирмы",type:"Human Lawyers",strengths:["Человеческая экспертиза","Построение отношений","Персональный подход"],weaknesses:["Высокая стоимость","Ограниченная доступность","Непоследовательное качество"],ourAdvantage:"В 10 раз дешевле, всегда доступен, последовательное качество"}].map((e,t)=>h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h4",{className:"font-semibold text-lg",children:e.name}),h.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded",children:e.type})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{children:[h.jsxs("h5",{className:"font-semibold text-sm mb-2 text-green-500 flex items-center gap-1",children:[h.jsx(Ve,{className:"w-3 h-3"}),"Сильные стороны"]}),h.jsx("ul",{className:"text-xs text-text-secondary space-y-1",children:e.strengths.map((e,t)=>h.jsxs("li",{children:["• ",e]},t))})]}),h.jsxs("div",{children:[h.jsxs("h5",{className:"font-semibold text-sm mb-2 text-red-500 flex items-center gap-1",children:[h.jsx(as,{className:"w-3 h-3"}),"Слабые стороны"]}),h.jsx("ul",{className:"text-xs text-text-secondary space-y-1",children:e.weaknesses.map((e,t)=>h.jsxs("li",{children:["• ",e]},t))})]}),h.jsxs("div",{children:[h.jsxs("h5",{className:"font-semibold text-sm mb-2 text-primary flex items-center gap-1",children:[h.jsx(Ve,{className:"w-3 h-3"}),"Наше преимущество"]}),h.jsx("p",{className:"text-xs text-text-secondary",children:e.ourAdvantage})]})]})]},t))}),h.jsxs("div",{className:"mt-6 bg-primary/10 border border-primary/20 rounded-lg p-4",children:[h.jsx("h4",{className:"font-semibold mb-3",children:"Технические преимущества"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-2",children:"vs Традиционный RAG"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• Иерархическая организация vs плоский поиск"}),h.jsx("li",{children:"• Multi-hop рассуждения vs одноуровневый поиск"}),h.jsx("li",{children:"• 30-55% экономия затрат"}),h.jsx("li",{children:"• 3x лучшая релевантность"})]})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-2",children:"vs Юридические ИИ"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• Специализированное обучение vs общие модели"}),h.jsx("li",{children:"• Интеграция документов vs статичные шаблоны"}),h.jsx("li",{children:"• Проверка соответствия vs ручная проверка"}),h.jsx("li",{children:"• Непрерывное обучение vs статичные знания"})]})]})]})]}),h.jsxs("div",{className:"mt-4 bg-success/10 border border-success/20 rounded-lg p-4",children:[h.jsx("h4",{className:"font-semibold mb-2 text-success",children:"Ключевые дифференциаторы"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-success mb-1",children:"RAPTOR Engine"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Революционная иерархическая организация документов"})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-success mb-1",children:"GraphRAG"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Понимание связей между правовыми концепциями"})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-success mb-1",children:"Intelligent Router"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Оптимизация затрат и качества через умную маршрутизацию"})]})]})]})]}),ar=({audienceMode:e="user"})=>h.jsxs("div",{className:"bg-gradient-to-r from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-lg p-6",children:[h.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[h.jsx(Vt,{className:"w-5 h-5 text-green-500"}),"Автоматическая проверка соответствия 152-ФЗ"]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),h.jsx("h4",{className:"font-semibold",children:"Анализ документа"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"tech"===e?"RAPTOR Engine извлекает правовые сущности и связи":"Система анализирует документ на соответствие требованиям"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(it,{className:"w-3 h-3 text-blue-500"}),h.jsx("span",{children:"Извлечение сущностей"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(rs,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Идентификация субъектов"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Vt,{className:"w-3 h-3 text-purple-500"}),h.jsx("span",{children:"Правовые требования"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),h.jsx("h4",{className:"font-semibold",children:"Проверка соответствия"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Сравнение с требованиями 152-ФЗ и выявление нарушений"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Ve,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Согласие на обработку"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Ve,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Уведомление о целях"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Pe,{className:"w-3 h-3 text-yellow-500"}),h.jsx("span",{children:"Сроки хранения"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),h.jsx("h4",{className:"font-semibold",children:"Отчет"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Детальный отчет с рекомендациями по устранению нарушений"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(it,{className:"w-3 h-3 text-blue-500"}),h.jsx("span",{children:"Структурированный отчет"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Pe,{className:"w-3 h-3 text-orange-500"}),h.jsx("span",{children:"Риски и нарушения"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Ve,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Рекомендации"})]})]})]})]}),"tech"===e&&h.jsxs("div",{className:"mt-6 bg-surface/50 rounded-lg p-4 border border-border",children:[h.jsx("h4",{className:"font-semibold mb-2",children:"Техническая реализация"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-1",children:"Анализ документов"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• NLP для извлечения правовых сущностей"}),h.jsx("li",{children:"• Классификация типов документов"}),h.jsx("li",{children:"• Выявление правовых связей"})]})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-1",children:"Проверка соответствия"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• Сопоставление с базой требований 152-ФЗ"}),h.jsx("li",{children:"• Автоматическая классификация нарушений"}),h.jsx("li",{children:"• Оценка рисков и приоритетов"})]})]})]})]}),h.jsxs("div",{className:"mt-4 bg-warning/10 border border-warning/20 rounded-lg p-4 flex items-start gap-3",children:[h.jsx(Pe,{className:"w-5 h-5 text-warning mt-0.5 flex-shrink-0"}),h.jsx("div",{children:h.jsxs("p",{className:"text-sm text-text-secondary",children:[h.jsx("strong",{children:"Важно:"})," Автоматическая проверка не заменяет юридическую экспертизу. Для критически важных документов рекомендуется дополнительная проверка юристом."]})})]})]}),or=({audienceMode:e="user"})=>h.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-lg p-6",children:[h.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[h.jsx(kt,{className:"w-5 h-5 text-blue-500"}),"Как работает консультация"]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),h.jsx("h4",{className:"font-semibold",children:"Ваш вопрос"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Опишите юридическую ситуацию или загрузите документ"}),h.jsx("div",{className:"bg-blue-500/10 rounded p-2 text-xs",children:'"Нужно ли согласие на обработку ПД для CRM?"'})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),h.jsx("h4",{className:"font-semibold",children:"Анализ сложности"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"tech"===e?"Intelligent Router анализирует сложность и выбирает модель":"Система определяет сложность вопроса"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(ls,{className:"w-3 h-3 text-yellow-500"}),h.jsx("span",{children:"Простой → GPT-5 Nano"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Ft,{className:"w-3 h-3 text-orange-500"}),h.jsx("span",{children:"Средний → GPT-5 Mini"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(kt,{className:"w-3 h-3 text-purple-500"}),h.jsx("span",{children:"Сложный → RAPTOR Engine"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),h.jsx("h4",{className:"font-semibold",children:"Обработка"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"tech"===e?"RAPTOR Engine + GraphRAG + HyDE для максимальной точности":"Поиск в базе знаний и генерация ответа"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Ze,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Время: 1-5 сек"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Ve,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Точность: 97%"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"4"}),h.jsx("h4",{className:"font-semibold",children:"Ответ"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Структурированный ответ с обоснованием и ссылками"}),h.jsxs("div",{className:"bg-green-500/10 rounded p-2 text-xs",children:[h.jsx("div",{className:"font-semibold mb-1",children:"Да, согласие необходимо"}),h.jsx("div",{children:"• Ст. 9 152-ФЗ"}),h.jsx("div",{children:"• Исключения: ст. 6"})]})]})]}),"tech"===e&&h.jsxs("div",{className:"mt-6 bg-surface/50 rounded-lg p-4 border border-border",children:[h.jsx("h4",{className:"font-semibold mb-2",children:"Технические детали"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-1",children:"RAPTOR Engine"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• Рекурсивная кластеризация"}),h.jsx("li",{children:"• Древовидная организация"}),h.jsx("li",{children:"• Многоуровневые абстракции"})]})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-1",children:"GraphRAG"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• Извлечение сущностей"}),h.jsx("li",{children:"• Связи между понятиями"}),h.jsx("li",{children:"• Multi-hop reasoning"})]})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-1",children:"HyDE"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• Расширение запросов"}),h.jsx("li",{children:"• Улучшенная релевантность"}),h.jsx("li",{children:"• Обработка неоднозначности"})]})]})]})]})]}),lr=({audienceMode:e="user"})=>h.jsxs("div",{className:"bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/20 rounded-lg p-6",children:[h.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[h.jsx(it,{className:"w-5 h-5 text-purple-500"}),"Процесс генерации документов"]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),h.jsx("h4",{className:"font-semibold",children:"Выбор шаблона"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Выберите тип документа из библиотеки шаблонов"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(it,{className:"w-3 h-3 text-blue-500"}),h.jsx("span",{children:"Договоры"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(it,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Соглашения"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(it,{className:"w-3 h-3 text-orange-500"}),h.jsx("span",{children:"Уведомления"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),h.jsx("h4",{className:"font-semibold",children:"Ввод данных"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"tech"===e?"Intelligent Router анализирует сложность и выбирает модель":"Заполните необходимые поля и параметры"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Wt,{className:"w-3 h-3 text-blue-500"}),h.jsx("span",{children:"Стороны договора"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Wt,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Предмет и условия"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Wt,{className:"w-3 h-3 text-orange-500"}),h.jsx("span",{children:"Сроки и обязательства"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),h.jsx("h4",{className:"font-semibold",children:"Генерация"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"tech"===e?"RAPTOR Engine + GPT-5 генерируют документ с учетом всех требований":"ИИ создает документ на основе ваших данных"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(is,{className:"w-3 h-3 text-purple-500"}),h.jsx("span",{children:"Анализ требований"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(is,{className:"w-3 h-3 text-blue-500"}),h.jsx("span",{children:"Генерация текста"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(is,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Проверка соответствия"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-6 h-6 bg-orange-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"4"}),h.jsx("h4",{className:"font-semibold",children:"Проверка"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Автоматическая проверка и экспорт в нужном формате"}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Ve,{className:"w-3 h-3 text-green-500"}),h.jsx("span",{children:"Правовая корректность"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(Ve,{className:"w-3 h-3 text-blue-500"}),h.jsx("span",{children:"Соответствие 152-ФЗ"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsx(st,{className:"w-3 h-3 text-purple-500"}),h.jsx("span",{children:"Экспорт в PDF/DOCX"})]})]})]})]}),"tech"===e&&h.jsxs("div",{className:"mt-6 bg-surface/50 rounded-lg p-4 border border-border",children:[h.jsx("h4",{className:"font-semibold mb-2",children:"Технические особенности"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-1",children:"Шаблоны"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• 500+ готовых шаблонов"}),h.jsx("li",{children:"• Автоматическое обновление"}),h.jsx("li",{children:"• Кастомизация под клиента"})]})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-1",children:"Генерация"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• GPT-5 для создания текста"}),h.jsx("li",{children:"• RAPTOR для анализа требований"}),h.jsx("li",{children:"• GraphRAG для связей"})]})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-primary mb-1",children:"Валидация"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• Автоматическая проверка"}),h.jsx("li",{children:"• Соответствие законодательству"}),h.jsx("li",{children:"• Экспорт в форматы"})]})]})]})]}),h.jsxs("div",{className:"mt-4 bg-success/10 border border-success/20 rounded-lg p-4",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx(Ve,{className:"w-5 h-5 text-success"}),h.jsx("h4",{className:"font-semibold",children:"Преимущества автоматической генерации"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-success mb-1",children:"Скорость"}),h.jsx("p",{className:"text-text-secondary",children:"Документ за 2-5 минут вместо часов"})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-success mb-1",children:"Точность"}),h.jsx("p",{className:"text-text-secondary",children:"97% корректность vs 85% у юристов"})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"font-semibold text-success mb-1",children:"Экономия"}),h.jsx("p",{className:"text-text-secondary",children:"90% экономии на юридических услугах"})]})]})]})]}),cr=({onPrimaryCTA:e,onContactCTA:t})=>h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-gradient-to-r from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-lg p-6",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Почему выбирают нас"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-3xl font-bold text-green-500",children:"Экономично"}),h.jsx("div",{className:"text-sm text-text-secondary",children:"Оптимизация стоимости"}),h.jsx("div",{className:"text-xs text-text-secondary",children:"умная маршрутизация"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-3xl font-bold text-blue-500",children:"Мгновенно"}),h.jsx("div",{className:"text-sm text-text-secondary",children:"Скорость ответа"}),h.jsx("div",{className:"text-xs text-text-secondary",children:"в разы быстрее"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-3xl font-bold text-purple-500",children:"97%"}),h.jsx("div",{className:"text-sm text-text-secondary",children:"Точность RAPTOR"}),h.jsx("div",{className:"text-xs text-text-secondary",children:"доказуемая польза"})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h4",{className:"font-semibold mb-2",children:"Basic"}),h.jsxs("ul",{className:"text-sm text-text-secondary list-disc pl-5 space-y-1",children:[h.jsx("li",{children:"Консультации"}),h.jsx("li",{children:"Базовая генерация документов"}),h.jsx("li",{children:"Поддержка по email"})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-primary/40 ring-2 ring-primary/30",children:[h.jsx("h4",{className:"font-semibold mb-2",children:"Pro"}),h.jsxs("ul",{className:"text-sm text-text-secondary list-disc pl-5 space-y-1",children:[h.jsx("li",{children:"Расширенные шаблоны и комплаенс"}),h.jsx("li",{children:"Приоритетная обработка"}),h.jsx("li",{children:"Онбординг"})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h4",{className:"font-semibold mb-2",children:"Enterprise"}),h.jsxs("ul",{className:"text-sm text-text-secondary list-disc pl-5 space-y-1",children:[h.jsx("li",{children:"SLA, SSO, аудит"}),h.jsx("li",{children:"Deep интеграции"}),h.jsx("li",{children:"Обучение команды"})]})]})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[h.jsx("button",{onClick:e,className:"sidebar-service-item max-w-[300px]",children:h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Начать сейчас"})})}),h.jsx("button",{onClick:t,className:"sidebar-service-item max-w-[300px]",children:h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Связаться с менеджером"})})})]})]}),dr=({audienceMode:e="user"})=>h.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-blue-500/10 border border-primary/20 rounded-lg p-6",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:"🚀 Уникальные технологии"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-primary mb-2",children:"RAPTOR Engine"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Рекурсивная обработка для древовидной организации поиска — ускоряет анализ юридических документов."})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-primary mb-2",children:"Intelligent Router"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Умный выбор модели GPT‑5 по сложности задачи и бюджету, стабильное качество ответов."})]})]}),"tech"===e&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[h.jsxs("div",{className:"text-sm text-text-secondary",children:[h.jsx("h4",{className:"font-semibold mb-1",children:"SLO/SLI"}),h.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[h.jsx("li",{children:"p95: поиск ≤ 800мс; генерация 1–5с"}),h.jsx("li",{children:"Индексация пачки ≤ 2 мин"})]})]}),h.jsxs("div",{className:"text-sm text-text-secondary",children:[h.jsx("h4",{className:"font-semibold mb-1",children:"Производительность"}),h.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[h.jsx("li",{children:"Throughput: 200 ops/сек"}),h.jsx("li",{children:"OCR: 50 стр/мин"})]})]}),h.jsxs("div",{className:"text-sm text-text-secondary",children:[h.jsx("h4",{className:"font-semibold mb-1",children:"Качество и экономика"}),h.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[h.jsx("li",{children:"recall@10 ≥ 0.9 (с rerank)"}),h.jsx("li",{children:"−30–55% cost/req за счёт кэша"})]})]})]}),h.jsxs("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-4 mt-4 flex items-start gap-3",children:[h.jsx(Pe,{className:"w-5 h-5 text-warning mt-0.5 flex-shrink-0"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Для сложных судебных вопросов рекомендуется дополнительная консультация с юристом."})]})]}),mr=({audienceMode:e="user"})=>{const[t,s]=g.useState(new Set),r=e=>{const r=new Set(t);r.has(e)?r.delete(e):r.add(e),s(r)};return"user"===e?h.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-lg p-6",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:"🔧 Технические возможности"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[h.jsx(ls,{className:"w-4 h-4 text-yellow-500"}),"Быстрая обработка"]}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Ответы за 1-5 секунд благодаря оптимизированной архитектуре"})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[h.jsx(et,{className:"w-4 h-4 text-blue-500"}),"Большая база знаний"]}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Доступ к обширной базе юридических документов и прецедентов"})]})]})]}):h.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-lg p-6",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:"🔧 Техническая архитектура"}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border mb-4",children:[h.jsxs("button",{onClick:()=>r("raptor"),className:"w-full flex items-center justify-between text-left",children:[h.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[h.jsx(Xe,{className:"w-4 h-4 text-orange-500"}),"RAPTOR Engine"]}),t.has("raptor")?h.jsx(qe,{className:"w-4 h-4"}):h.jsx(Qe,{className:"w-4 h-4"})]}),t.has("raptor")&&h.jsxs("div",{className:"mt-4 space-y-3",children:[h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Рекурсивная кластеризация"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Документы группируются по уровням абстракции, создавая иерархическую структуру для эффективного поиска"})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Древовидная организация"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Каждый уровень создает абстракции предыдущего, позволяя быстро находить релевантную информацию"})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Многоуровневые абстракции"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"От конкретных документов до общих правовых концепций - система понимает контекст на всех уровнях"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border mb-4",children:[h.jsxs("button",{onClick:()=>r("graphrag"),className:"w-full flex items-center justify-between text-left",children:[h.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[h.jsx(Tt,{className:"w-4 h-4 text-green-500"}),"GraphRAG Integration"]}),t.has("graphrag")?h.jsx(qe,{className:"w-4 h-4"}):h.jsx(Qe,{className:"w-4 h-4"})]}),t.has("graphrag")&&h.jsxs("div",{className:"mt-4 space-y-3",children:[h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Извлечение сущностей"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Автоматическое выявление правовых понятий, сторон, обязательств и их взаимосвязей"})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Связи между понятиями"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Построение графа знаний, показывающего как различные правовые концепции связаны между собой"})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Multi-hop reasoning"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Способность следовать цепочкам правовых рассуждений через несколько связанных документов"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border mb-4",children:[h.jsxs("button",{onClick:()=>r("router"),className:"w-full flex items-center justify-between text-left",children:[h.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[h.jsx(ls,{className:"w-4 h-4 text-purple-500"}),"Intelligent Router"]}),t.has("router")?h.jsx(qe,{className:"w-4 h-4"}):h.jsx(Qe,{className:"w-4 h-4"})]}),t.has("router")&&h.jsxs("div",{className:"mt-4 space-y-3",children:[h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Анализ сложности"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Автоматическая оценка сложности запроса для выбора оптимальной модели GPT-5"})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Оптимизация затрат"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"80% простых запросов → GPT-5 Nano, 15% средних → GPT-5 Mini, 5% сложных → GPT-5 Standard"})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Гарантии качества"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Каждая модель настроена для максимальной точности в своем диапазоне сложности"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[h.jsxs("button",{onClick:()=>r("metrics"),className:"w-full flex items-center justify-between text-left",children:[h.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[h.jsx(et,{className:"w-4 h-4 text-blue-500"}),"Метрики производительности"]}),t.has("metrics")?h.jsx(qe,{className:"w-4 h-4"}):h.jsx(Qe,{className:"w-4 h-4"})]}),t.has("metrics")&&h.jsx("div",{className:"mt-4",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"SLO/SLI"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• p95 поиск: ≤ 800мс"}),h.jsx("li",{children:"• p95 генерация: 1-5с"}),h.jsx("li",{children:"• Индексация пачки: ≤ 2 мин"})]})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Throughput"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• 200 ops/сек пиковая"}),h.jsx("li",{children:"• OCR: 50 стр/мин"}),h.jsx("li",{children:"• 10,000+ одновременных пользователей"})]})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Качество"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• recall@10 ≥ 0.9"}),h.jsx("li",{children:"• Точность: 97%"}),h.jsx("li",{children:"• OCR WER: ≤ 15%"})]})]}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-3",children:[h.jsx("h5",{className:"font-semibold text-sm mb-2",children:"Экономика"}),h.jsxs("ul",{className:"text-xs text-text-secondary space-y-1",children:[h.jsx("li",{children:"• −30–55% cost/req"}),h.jsx("li",{children:"• 40% cache hit rate"}),h.jsx("li",{children:"• 70% gross margin"})]})]})]})})]})]})},hr=()=>{const[e,t]=g.useState("consultation"),[s,r]=g.useState(null),[n,i]=g.useState(()=>{try{const e=localStorage.getItem("aiLawyerMode");return"tech"===e||"user"===e?e:"user"}catch(e){return"user"}});g.useEffect(()=>{const e=e=>{let s=e.detail;"interactive-guide"!==s&&"architecture"!==s||(s="guide"),t(s)};return window.addEventListener("ai-lawyer:switch-tab",e),()=>{window.removeEventListener("ai-lawyer:switch-tab",e)}},[]);const[a,o]=g.useState(null);g.useEffect(()=>{try{localStorage.setItem("aiLawyerMode",n)}catch(e){}},[n]);const l=e=>{r(s===e?null:e)},c=()=>h.jsxs("div",{className:"space-y-6",children:[h.jsx(or,{audienceMode:n}),h.jsx(dr,{audienceMode:n}),"tech"===n&&h.jsx(mr,{audienceMode:n}),h.jsx(ir,{audienceMode:n}),h.jsxs("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-4 flex items-start gap-3",children:[h.jsx(Pe,{className:"w-5 h-5 text-warning mt-0.5 flex-shrink-0"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Для сложных судебных вопросов рекомендуется дополнительная консультация с юристом."})]}),h.jsx(cr,{}),h.jsxs("div",{className:"text-center space-y-4",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[h.jsxs("button",{onClick:()=>l("consultation"),className:"sidebar-service-item max-w-[300px] "+("consultation"===s?"active":""),children:[h.jsx(kt,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Начать консультацию"})})]}),h.jsxs("button",{onClick:()=>l("document-analysis"),className:"sidebar-service-item max-w-[300px] "+("document-analysis"===s?"active":""),children:[h.jsx(it,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Анализ документа"})})]}),h.jsxs("button",{onClick:()=>l("contract-generation"),className:"sidebar-service-item max-w-[300px] "+("contract-generation"===s?"active":""),children:[h.jsx(Ft,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Генерация договора"})})]})]}),h.jsx("p",{className:"text-sm text-text-secondary",children:"💰 Значительная экономия на юридических услугах благодаря автоматизации"})]})]});return h.jsx(zs,{id:"ai-lawyer-service",title:"AI-Юрист",icon:h.jsx("span",{className:"text-green-500",children:"⚖️"}),status:"active",hover:!1,children:h.jsx("div",{className:"h-full",children:h.jsxs("div",{className:"flex-1 overflow-y-auto sidebar-scrollbar h-full "+("guide"===e?"min-h-[400px] max-h-[80vh]":"min-h-0 max-h-none"),children:[(()=>{switch(e){case"consultation":default:return c();case"documents":return h.jsxs("div",{className:"space-y-6",children:[h.jsx(lr,{audienceMode:n}),h.jsxs("div",{className:"bg-gradient-to-r from-green-500/10 to-blue-500/10 border border-green-500/20 rounded-lg p-6",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:"⚡ Быстрое создание"}),h.jsx("p",{className:"text-sm text-text-secondary mb-4",children:"Выберите тип документа и создайте его за несколько кликов"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[h.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+("supply"===a?"border-primary bg-primary/10":"border-border hover:border-primary/50 hover:bg-surface/50"),onClick:()=>o("supply"===a?null:"supply"),children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl mb-2",children:"📦"}),h.jsx("h4",{className:"font-semibold text-sm",children:"Договор поставки"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Товары и услуги"})]})}),h.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+("employment"===a?"border-primary bg-primary/10":"border-border hover:border-primary/50 hover:bg-surface/50"),onClick:()=>o("employment"===a?null:"employment"),children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl mb-2",children:"👥"}),h.jsx("h4",{className:"font-semibold text-sm",children:"Трудовой договор"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Работник и работодатель"})]})}),h.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+("rent"===a?"border-primary bg-primary/10":"border-border hover:border-primary/50 hover:bg-surface/50"),onClick:()=>o("rent"===a?null:"rent"),children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl mb-2",children:"🏠"}),h.jsx("h4",{className:"font-semibold text-sm",children:"Договор аренды"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Недвижимость"})]})}),h.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+("services"===a?"border-primary bg-primary/10":"border-border hover:border-primary/50 hover:bg-surface/50"),onClick:()=>o("services"===a?null:"services"),children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl mb-2",children:"🔧"}),h.jsx("h4",{className:"font-semibold text-sm",children:"Договор услуг"}),h.jsx("p",{className:"text-xs text-text-secondary",children:"Выполнение работ"})]})})]}),"tech"===n&&h.jsx(mr,{audienceMode:n}),h.jsx("div",{className:"text-center",children:h.jsxs("button",{onClick:()=>l("contract-generation"),className:"sidebar-service-item max-w-[300px] "+("contract-generation"===s?"active":""),children:[h.jsx(Ft,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Создать документ"})})]})})]}),h.jsx(cr,{})]});case"compliance":return h.jsxs("div",{className:"space-y-6",children:[h.jsx(ar,{audienceMode:n}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:'152-ФЗ "О персональных данных"'}),h.jsxs("ul",{className:"space-y-3",children:[h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),h.jsx("span",{children:"Аудит обработки ПД"})]}),h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),h.jsx("span",{children:"Политика конфиденциальности"})]}),h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),h.jsx("span",{children:"Согласие на обработку ПД"})]}),h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),h.jsx("span",{children:"Уведомление в Роскомнадзор"})]})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Другие требования"}),h.jsxs("ul",{className:"space-y-3",children:[h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),h.jsx("span",{children:"GDPR (ЕС)"})]}),h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),h.jsx("span",{children:"CCPA (Калифорния)"})]}),h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),h.jsx("span",{children:"LGPD (Бразилия)"})]}),h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ve,{className:"w-4 h-4 text-green-500 mt-1 flex-shrink-0"}),h.jsx("span",{children:"PIPEDA (Канада)"})]})]})]})]}),"tech"===n&&h.jsx(mr,{audienceMode:n}),h.jsx("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-6",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx(Pe,{className:"w-5 h-5 text-warning mt-1 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-warning mb-2",children:"Штрафы за нарушения"}),h.jsx("p",{className:"text-sm",children:"Нарушение 152-ФЗ может повлечь штрафы до 75 000 рублей для ИП и до 300 000 рублей для организаций."})]})]})}),h.jsx(cr,{}),h.jsx("div",{className:"text-center",children:h.jsxs("button",{onClick:()=>l("compliance-check"),className:"sidebar-service-item max-w-[300px] "+("compliance-check"===s?"active":""),children:[h.jsx(Ht,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Проверить соответствие"})})]})})]});case"guide":return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"text-left",children:[h.jsx("h2",{className:"text-2xl font-bold mb-1",children:"🎯 Гид & Архитектура"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Быстрый старт для пользователей и техническая глубина для разработчиков"})]}),h.jsxs("div",{className:"bg-surface border border-border rounded-full p-1 inline-flex",children:[h.jsx("button",{type:"button",onClick:()=>i("user"),className:"px-3 py-1 rounded-full text-sm "+("user"===n?"bg-primary text-white":"text-text-secondary"),children:"User"}),h.jsx("button",{type:"button",onClick:()=>i("tech"),className:"px-3 py-1 rounded-full text-sm "+("tech"===n?"bg-primary text-white":"text-text-secondary"),children:"Tech"})]})]}),"user"===n&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Как использовать"}),h.jsxs("ol",{className:"text-sm text-text-secondary list-decimal pl-5 space-y-1",children:[h.jsx("li",{children:"Откройте вкладку «Консультации» и опишите задачу"}),h.jsx("li",{children:"Загрузите документ или выберите шаблон"}),h.jsx("li",{children:"Получите результат и экспортируйте"})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Что вы получите"}),h.jsxs("ul",{className:"text-sm text-text-secondary list-disc pl-5 space-y-1",children:[h.jsx("li",{children:"Ответ с обоснованием и ссылками"}),h.jsx("li",{children:"Документы с валидациями и экспортом"}),h.jsx("li",{children:"Прозрачные метрики качества и времени"})]})]})]}),"tech"===n&&h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Архитектура"}),h.jsx(nr,{})]})}),h.jsx(dr,{audienceMode:n}),"tech"===n&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Дорожная карта"}),h.jsxs("ol",{className:"text-sm text-text-secondary list-decimal pl-5 space-y-1",children:[h.jsx("li",{children:"Генерация документов: финализация валидаций"}),h.jsx("li",{children:"GraphRAG + HyDE: multi-hop reasoning"}),h.jsx("li",{children:"Админ‑панель метрик и демо‑кейсы"})]})]}),h.jsxs("div",{className:"bg-surface rounded-lg p-6 border border-border",children:[h.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Риски и контроль"}),h.jsxs("ul",{className:"text-sm text-text-secondary list-disc pl-5 space-y-1",children:[h.jsx("li",{children:"Качество данных: анонимизация PII, валидаторы"}),h.jsx("li",{children:"Нагрузка: очереди, деградация с сохранением функций"}),h.jsx("li",{children:"Модели: профили эмбеддингов, fallback стратегии"})]})]})]}),h.jsx(cr,{onPrimaryCTA:()=>t("consultation"),onContactCTA:()=>{try{window.dispatchEvent(new CustomEvent("contact:open"))}catch(e){}}})]})}})(),s&&h.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-lg p-6",children:[h.jsx("h3",{className:"text-lg font-semibold mb-4",children:"💬 Общайтесь через чат!"}),h.jsx("p",{className:"text-text-secondary mb-4",children:"Используйте чат справа для общения с AI-Юристом. Просто напишите ваш запрос, и система поможет вам."}),h.jsxs("div",{className:"bg-surface/50 rounded-lg p-4 border border-border",children:[h.jsxs("p",{className:"text-sm text-text-secondary",children:[h.jsx("strong",{children:"Активная функция:"})," ","consultation"===s?"Консультация":"document-analysis"===s?"Анализ документа":"contract-generation"===s?"Генерация договора":"template-preview"===s?"Просмотр шаблона":"template-edit"===s?"Редактирование шаблона":"template-create"===s?"Создание шаблона":"start-guide"===s?"Интерактивный гид":"quick-demo"===s?"Быстрая демонстрация":"Функция"]}),h.jsxs("p",{className:"text-xs text-text-secondary mt-2",children:['💡 Напишите в чате: "',(d=s,{consultation:"Опишите вашу юридическую ситуацию или задайте вопрос...","document-analysis":"Загрузите документ для анализа или вставьте текст...","contract-generation":"Опишите тип договора и основные условия...","compliance-check":"Опишите процесс обработки персональных данных...","legal-research":"Опишите правовую проблему для исследования...","risk-assessment":"Опишите ситуацию для оценки правовых рисков...","template-preview":"Выберите шаблон для предварительного просмотра...","template-edit":"Выберите шаблон для редактирования...","template-create":"Опишите тип нового шаблона и его назначение...","start-guide":"Начните интерактивное путешествие по архитектуре AI-Юриста...","quick-demo":"Запустите быструю демонстрацию возможностей системы..."}[d]||"Введите ваш запрос..."),'"']})]})]})]})})});var d},ur=({stores:e,selectedStores:t,onStoreSelectionChange:s,onRunPromotions:r,onRunUnarchive:n,onRunAll:i,onStop:a,operationStatus:o})=>h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h2",{className:"text-xl font-semibold text-var-text",children:"Управление операциями"}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{onClick:()=>{s(e)},className:"unified-button unified-button-secondary",children:"Выбрать все"}),h.jsx("button",{onClick:()=>{s([])},className:"unified-button unified-button-secondary",children:"Снять все"})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsx("h3",{className:"text-lg font-medium mb-4 text-var-text",children:"Выберите магазины для операций"}),0===e.length?h.jsx("p",{className:"text-var-text-muted",children:"Нет доступных магазинов"}):h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.map(e=>h.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-surface-hover",children:[h.jsx("input",{type:"checkbox",checked:t.includes(e),onChange:()=>(e=>{t.includes(e)?s(t.filter(t=>t!==e)):s([...t,e])})(e),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),h.jsx("span",{className:"text-sm font-medium text-var-text",children:e})]},e))}),t.length>0&&h.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[h.jsxs("p",{className:"text-sm text-blue-800",children:["Выбрано магазинов: ",t.length," из ",e.length]}),h.jsx("p",{className:"text-xs text-blue-600 mt-1",children:t.join(", ")})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsx("h3",{className:"text-lg font-medium mb-4 text-var-text",children:"Операции"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsx("div",{className:"space-y-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium text-var-text",children:"Удаление из акций"}),h.jsx("p",{className:"text-sm text-var-text-muted",children:"Удаление товаров из невыгодных акций"})]}),h.jsx("button",{onClick:r,disabled:0===t.length||o.isRunning,className:"unified-button unified-button-primary",children:"Запустить"})]})}),h.jsx("div",{className:"space-y-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium text-var-text",children:"Разархивация"}),h.jsx("p",{className:"text-sm text-var-text-muted",children:"Извлечение товаров из автоархива"})]}),h.jsx("button",{onClick:n,disabled:0===t.length||o.isRunning,className:"unified-button unified-button-primary",children:"Запустить"})]})})]}),h.jsx("div",{className:"mt-6 pt-6 border-t",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium text-var-text",children:"Все операции"}),h.jsx("p",{className:"text-sm text-var-text-muted",children:"Запуск всех выбранных операций последовательно"})]}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:i,disabled:0===t.length||o.isRunning,className:"unified-button unified-button-primary",children:"Запустить все"}),h.jsx("button",{onClick:a,disabled:!o.isRunning,className:"unified-button btn-danger",children:"Остановить"})]})]})})]}),o.isRunning&&h.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-yellow-600 mr-3"}),h.jsxs("div",{children:[h.jsxs("p",{className:"text-sm font-medium text-yellow-800",children:["Выполняется: ",o.operation]}),h.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:o.message}),o.progress>0&&h.jsx("div",{className:"mt-2 w-full bg-yellow-200 rounded-full h-2",children:h.jsx("div",{className:"bg-yellow-600 h-2 rounded-full transition-all duration-300","data-progress":o.progress})})]})]})}),o.results.length>0&&h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsx("h3",{className:"text-lg font-medium text-foreground mb-4",children:"Результаты операций"}),h.jsx("div",{className:"space-y-3",children:o.results.map((e,t)=>{const s=e;return h.jsxs("div",{className:"p-3 border rounded-lg",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"font-medium text-foreground",children:s.store}),h.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full "+(s.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.success?"Успешно":"Ошибка"})]}),s.success&&h.jsxs("div",{className:"mt-2 text-sm text-secondary",children:[void 0!==s.products_removed&&h.jsxs("p",{children:["Удалено товаров: ",s.products_removed]}),void 0!==s.actions_processed&&h.jsxs("p",{children:["Обработано акций: ",s.actions_processed]}),void 0!==s.total_unarchived&&h.jsxs("p",{children:["Разархивировано: ",s.total_unarchived]}),void 0!==s.cycles_completed&&h.jsxs("p",{children:["Циклов: ",s.cycles_completed]})]}),!s.success&&s.error&&h.jsx("p",{className:"mt-2 text-sm text-red-600",children:s.error})]},t)})})]})]}),pr=({onRefresh:e,onOpenLogsFolder:t,isLoading:s})=>{const[r,n]=g.useState([]),[i,a]=g.useState(!0),o=g.useRef(null);g.useEffect(()=>{l()},[]),g.useEffect(()=>{i&&o.current&&o.current.scrollIntoView({behavior:"smooth"})},[r,i]);const l=()=>d(void 0,null,function*(){try{yield new Promise(e=>setTimeout(e,1e3));n(["2024-01-15 10:30:15 [INFO] Ozon Manager API запущен на порту 3001","2024-01-15 10:30:16 [INFO] Загружено магазинов: 3","2024-01-15 10:30:17 [INFO] Планировщик запущен","2024-01-15 10:35:22 [INFO] Запуск удаления из акций для магазина: Test Store","2024-01-15 10:35:25 [INFO] Найдено акций: 5","2024-01-15 10:35:26 [INFO] Невыгодных акций найдено: 2","2024-01-15 10:35:28 [INFO] Обрабатываем акцию: Скидка за наш счет (ID: 12345)","2024-01-15 10:35:30 [INFO] Найдено товаров в акции: 15","2024-01-15 10:35:32 [INFO] Удалено товаров из акции: 15","2024-01-15 10:35:35 [INFO] Успешно разархивировано: 15 товаров","2024-01-15 10:35:36 [INFO] Всего разархивировано: 15","2024-01-15 10:35:40 [INFO] Очистка акций завершена. Удалено товаров: 15, обработано акций: 2","2024-01-15 10:40:15 [INFO] Запуск разархивации для магазина: Test Store","2024-01-15 10:40:18 [INFO] Получено 1 автоархивированных товаров","2024-01-15 10:40:20 [INFO] Подготовлено к разархивации: 1 товаров","2024-01-15 10:40:22 [INFO] ID товаров: 98765","2024-01-15 10:40:25 [INFO] Успешно разархивировано: 1 товаров","2024-01-15 10:40:26 [INFO] Всего разархивировано: 1","2024-01-15 10:40:30 [INFO] Разархивация завершена: 1 товаров, 1 циклов","2024-01-15 10:45:00 [INFO] Планировщик: перезагрузка расписания для 3 магазинов"])}catch(e){console.error("Ошибка загрузки логов:",e),n(["Ошибка загрузки логов"])}});return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h2",{className:"text-xl font-semibold text-var-text",children:"Логи системы"}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:()=>d(void 0,null,function*(){yield e(),yield l()}),disabled:s,className:"unified-button unified-button-secondary",children:s?"Обновление...":"Обновить"}),h.jsx("button",{onClick:()=>{n([])},className:"unified-button btn-danger",children:"Очистить"}),h.jsx("button",{onClick:t,className:"unified-button unified-button-secondary",children:"Открыть папку логов"})]})]}),h.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"flex items-center space-x-4",children:h.jsxs("label",{className:"flex items-center",children:[h.jsx("input",{type:"checkbox",checked:i,onChange:e=>a(e.target.checked),className:"mr-2"}),h.jsx("span",{className:"text-sm text-foreground",children:"Автопрокрутка к последнему сообщению"})]})}),h.jsxs("div",{className:"text-sm text-secondary",children:["Всего сообщений: ",r.length]})]})}),h.jsxs("div",{className:"bg-white rounded-lg shadow",children:[h.jsxs("div",{className:"p-4 border-b",children:[h.jsx("h3",{className:"text-lg font-medium text-foreground",children:"Журнал событий"}),h.jsx("p",{className:"text-sm text-secondary",children:"Логи операций и системных событий"})]}),h.jsx("div",{className:"h-96 overflow-y-auto bg-gray-900 text-green-400 font-mono text-sm p-4",children:0===r.length?h.jsx("div",{className:"text-secondary text-center py-8",children:"Нет логов для отображения"}):h.jsxs("div",{className:"space-y-1",children:[r.map((e,t)=>{const s=(e=>e.includes("[ERROR]")?"error":e.includes("[WARN]")?"warn":e.includes("[INFO]")?"info":e.includes("[DEBUG]")?"debug":"info")(e),r=(e=>{switch(e){case"error":return"text-red-600";case"warn":return"text-yellow-600";case"info":return"text-blue-600";default:return"text-secondary"}})(s);return h.jsxs("div",{className:"flex items-start",children:[h.jsxs("span",{className:`${r} font-semibold mr-2`,children:["[",s.toUpperCase(),"]"]}),h.jsx("span",{className:"text-foreground",children:e})]},t)}),h.jsx("div",{ref:o})]})})]}),r.length>0&&h.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[h.jsx("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Статистика логов"}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-lg font-semibold text-foreground",children:r.length}),h.jsx("div",{className:"text-secondary",children:"Всего сообщений"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-lg font-semibold text-red-600",children:r.filter(e=>e.includes("[ERROR]")).length}),h.jsx("div",{className:"text-secondary",children:"Ошибки"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-lg font-semibold text-yellow-600",children:r.filter(e=>e.includes("[WARN]")).length}),h.jsx("div",{className:"text-secondary",children:"Предупреждения"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-lg font-semibold text-blue-600",children:r.filter(e=>e.includes("[INFO]")).length}),h.jsx("div",{className:"text-secondary",children:"Информация"})]})]})]}),h.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[h.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Информация о логах"}),h.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[h.jsx("p",{children:"• Логи автоматически обновляются каждые 30 секунд"}),h.jsx("p",{children:"• Сохраняются последние 1000 записей"}),h.jsx("p",{children:"• Уровни: ERROR (ошибки), WARN (предупреждения), INFO (информация), DEBUG (отладка)"}),h.jsx("p",{children:"• Логи сохраняются в файл: ./logs/ozon_manager.log"})]})]})]})},xr=({onReloadSchedule:e,isLoading:t})=>{const[s,r]=g.useState({isRunning:!1,tasksCount:0,tasks:[]}),[n,i]=g.useState(null);g.useEffect(()=>{a()},[]);const a=()=>d(void 0,null,function*(){try{yield new Promise(e=>setTimeout(e,1e3)),r({isRunning:Math.random()>.5,tasksCount:Math.floor(5*Math.random()),tasks:["store1_promotions","store1_unarchive","store2_promotions"]});const e=new Date((new Date).getTime()+24*Math.random()*60*60*1e3);i(e.toLocaleString("ru-RU"))}catch(e){console.error("Ошибка загрузки статуса планировщика:",e)}}),o=()=>d(void 0,null,function*(){yield e(),yield a()});return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h2",{className:"text-xl font-semibold text-var-text",children:"Планировщик задач"}),h.jsx("button",{onClick:o,disabled:t,className:"unified-button unified-button-primary",children:t?"Перезагрузка...":"Перезагрузить расписание"})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsx("h3",{className:"text-lg font-medium text-foreground mb-4",children:"Статус планировщика"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-sm font-medium text-foreground",children:"Статус:"}),h.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(s.isRunning?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.isRunning?"Запущен":"Остановлен"})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-sm font-medium text-foreground",children:"Активных задач:"}),h.jsx("span",{className:"text-sm text-foreground",children:s.tasksCount})]}),n&&h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-sm font-medium text-foreground",children:"Следующее выполнение:"}),h.jsx("span",{className:"text-sm text-foreground",children:n})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Активные задачи:"}),0===s.tasks.length?h.jsx("p",{className:"text-sm text-secondary",children:"Нет активных задач"}):h.jsx("div",{className:"space-y-2",children:s.tasks.map((e,t)=>h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),h.jsx("span",{className:"text-sm text-foreground",children:e})]},t))})]})]})]}),h.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[h.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Информация о планировщике"}),h.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[h.jsx("p",{children:"• Планировщик автоматически выполняет операции по расписанию"}),h.jsx("p",{children:"• Время выполнения настраивается для каждого магазина отдельно"}),h.jsx("p",{children:"• Операции выполняются в фоновом режиме"}),h.jsx("p",{children:"• Логи операций сохраняются в системе"})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsx("h3",{className:"text-lg font-medium mb-4 text-var-text",children:"Управление"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium text-var-text",children:"Перезагрузка расписания"}),h.jsx("p",{className:"text-sm text-var-text-muted",children:"Перезагружает расписание для всех магазинов"})]}),h.jsx("button",{onClick:o,disabled:t,className:"unified-button unified-button-primary",children:t?"Перезагрузка...":"Перезагрузить"})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium text-var-text",children:"Обновить статус"}),h.jsx("p",{className:"text-sm text-var-text-muted",children:"Обновляет информацию о состоянии планировщика"})]}),h.jsx("button",{onClick:a,className:"unified-button unified-button-secondary",children:"Обновить"})]})]})]}),h.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[h.jsx("h4",{className:"text-sm font-medium mb-2 text-foreground",children:"Статистика"}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-lg font-semibold text-foreground",children:s.tasksCount}),h.jsx("div",{className:"text-secondary",children:"Активных задач"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-lg font-semibold text-foreground",children:s.isRunning?"Да":"Нет"}),h.jsx("div",{className:"text-secondary",children:"Планировщик"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-lg font-semibold text-foreground",children:"24/7"}),h.jsx("div",{className:"text-secondary",children:"Режим работы"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-lg font-semibold text-foreground",children:"Авто"}),h.jsx("div",{className:"text-secondary",children:"Управление"})]})]})]})]})},gr=({isOpen:e,onClose:t,onSave:s,store:r,mode:n})=>{const[i,a]=g.useState({name:"",client_id:"",api_key:"",remove_from_promotions:!1,unarchive_enabled:!1,manual_run_on_startup:!1,schedule_times:{remove:"09:00",unarchive:"10:00"}}),[c,m]=g.useState(!1),[u,p]=g.useState("idle"),[x,v]=g.useState("");g.useEffect(()=>{a("edit"===n&&r?r:{name:"",client_id:"",api_key:"",remove_from_promotions:!1,unarchive_enabled:!1,manual_run_on_startup:!1,schedule_times:{remove:"09:00",unarchive:"10:00"}}),p("idle"),v("")},[e,n,r]);const f=(e,t)=>{if(e.startsWith("schedule_times.")){const s=e.split(".")[1];a(e=>l(o({},e),{schedule_times:l(o({},e.schedule_times),{[s]:t})}))}else a(s=>l(o({},s),{[e]:t}))};return e?h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:h.jsxs("div",{className:"liquid-glass-block rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[h.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"add"===n?"Добавить магазин":"Редактировать магазин"}),h.jsx("button",{onClick:t,className:"text-secondary hover:text-primary transition-colors","aria-label":"Закрыть диалог",children:h.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h.jsxs("div",{className:"p-6 space-y-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-lg font-medium text-foreground",children:"Основная информация"}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"store-name",className:"block text-sm font-medium text-foreground mb-1",children:"Название магазина *"}),h.jsx("input",{id:"store-name",type:"text",value:i.name,onChange:e=>f("name",e.target.value),className:"w-full px-3 py-2 bg-input border border-light rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-foreground",placeholder:"Введите название магазина"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"client-id",className:"block text-sm font-medium text-foreground mb-1",children:"Client ID *"}),h.jsx("input",{id:"client-id",type:"text",value:i.client_id,onChange:e=>f("client_id",e.target.value),className:"w-full px-3 py-2 bg-input border border-light rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-foreground",placeholder:"Введите Client ID"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"api-key",className:"block text-sm font-medium text-foreground mb-1",children:"API Key *"}),h.jsx("input",{id:"api-key",type:"password",value:i.api_key,onChange:e=>f("api_key",e.target.value),className:"w-full px-3 py-2 bg-input border border-light rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-foreground",placeholder:"Введите API Key"})]}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("button",{onClick:()=>d(void 0,null,function*(){if(!i.name||!i.client_id||!i.api_key)return v("Заполните все обязательные поля"),void p("error");m(!0),p("idle"),v("Тестируем подключение...");try{yield new Promise(e=>setTimeout(e,2e3));Math.random()>.3?(p("success"),v("✅ Подключение успешно!")):(p("error"),v("❌ Ошибка подключения к API"))}catch(e){p("error"),v("❌ Ошибка подключения")}finally{m(!1)}}),disabled:c||!i.name||!i.client_id||!i.api_key,className:"unified-button unified-button-secondary",children:c?"Тестируем...":"Тест подключения"}),x&&h.jsx("span",{className:"text-sm "+("success"===u?"text-green-600":"error"===u?"text-red-600":"text-gray-600"),children:x})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-lg font-medium text-foreground",children:"Настройки операций"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("label",{className:"flex items-center",children:[h.jsx("input",{type:"checkbox",checked:i.remove_from_promotions,onChange:e=>f("remove_from_promotions",e.target.checked),className:"mr-3 text-primary focus:ring-primary"}),h.jsx("span",{className:"text-sm text-foreground",children:"Удаление из невыгодных акций"})]}),h.jsxs("label",{className:"flex items-center",children:[h.jsx("input",{type:"checkbox",checked:i.unarchive_enabled,onChange:e=>f("unarchive_enabled",e.target.checked),className:"mr-3 text-primary focus:ring-primary"}),h.jsx("span",{className:"text-sm text-foreground",children:"Разархивация товаров"})]}),h.jsxs("label",{className:"flex items-center",children:[h.jsx("input",{type:"checkbox",checked:i.manual_run_on_startup,onChange:e=>f("manual_run_on_startup",e.target.checked),className:"mr-3 text-primary focus:ring-primary"}),h.jsx("span",{className:"text-sm text-foreground",children:"Запуск при старте программы"})]})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-lg font-medium text-foreground",children:"Расписание"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"remove-time",className:"block text-sm font-medium text-foreground mb-1",children:"Время удаления из акций"}),h.jsx("input",{id:"remove-time",type:"time",value:i.schedule_times.remove,onChange:e=>f("schedule_times.remove",e.target.value),className:"w-full px-3 py-2 bg-input border border-light rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-foreground"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"unarchive-time",className:"block text-sm font-medium text-foreground mb-1",children:"Время разархивации"}),h.jsx("input",{id:"unarchive-time",type:"time",value:i.schedule_times.unarchive,onChange:e=>f("schedule_times.unarchive",e.target.value),className:"w-full px-3 py-2 bg-input border border-light rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-foreground"})]})]})]})]}),h.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t bg-surface",children:[h.jsx("button",{onClick:t,className:"unified-button unified-button-secondary",children:"Отмена"}),h.jsx("button",{onClick:()=>{i.name&&i.client_id&&i.api_key?(s(i),t()):alert("Заполните все обязательные поля")},className:"unified-button unified-button-primary",children:"add"===n?"Добавить":"Сохранить"})]})]})}):null},vr=({stores:e,onAddStore:t,onEditStore:s,onDeleteStore:r,onRefresh:n,onTestConnection:i,isLoading:a})=>{const[o,l]=g.useState(new Set);return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Магазины Ozon"}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:n,disabled:a,className:"unified-button unified-button-secondary",children:a?"Обновление...":"Обновить"}),h.jsx("button",{onClick:t,className:"unified-button unified-button-primary",children:"Добавить магазин"})]})]}),h.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-surface",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary uppercase tracking-wider",children:"Название"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary uppercase tracking-wider",children:"Client ID"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary uppercase tracking-wider",children:"Удаление из акций"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary uppercase tracking-wider",children:"Разархивация"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary uppercase tracking-wider",children:"Расписание"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary uppercase tracking-wider",children:"Действия"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===e.length?h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-secondary",children:"Нет добавленных магазинов"})}):e.map(e=>h.jsxs("tr",{className:"hover:bg-surface-hover",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.jsx("div",{className:"text-sm font-medium text-foreground",children:e.name})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.jsxs("div",{className:"text-sm text-secondary",children:[e.client_id.substring(0,8),"..."]})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.remove_from_promotions?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.remove_from_promotions?"Включено":"Отключено"})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.unarchive_enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.unarchive_enabled?"Включено":"Отключено"})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.jsxs("div",{className:"text-sm text-secondary",children:[h.jsxs("div",{children:["Акции: ",e.schedule_times.remove]}),h.jsxs("div",{children:["Архив: ",e.schedule_times.unarchive]})]})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{onClick:()=>{return t=e.name,d(void 0,null,function*(){l(e=>new Set(e).add(t)),yield i(t),l(e=>{const s=new Set(e);return s.delete(t),s})});var t},disabled:o.has(e.name),className:"unified-button unified-button-secondary",children:o.has(e.name)?"Тест...":"Тест"}),h.jsx("button",{onClick:()=>s(e),className:"unified-button unified-button-secondary",children:"Редактировать"}),h.jsx("button",{onClick:()=>r(e.name),className:"unified-button btn-danger",children:"Удалить"})]})})]},e.name))})]})})}),e.length>0&&h.jsx("div",{className:"bg-surface px-4 py-3 rounded-md",children:h.jsxs("div",{className:"flex items-center justify-between text-sm text-secondary",children:[h.jsxs("span",{children:["Всего магазинов: ",e.length]}),h.jsxs("div",{className:"flex space-x-4",children:[h.jsxs("span",{children:["С акциями: ",e.filter(e=>e.remove_from_promotions).length]}),h.jsxs("span",{children:["С разархивацией: ",e.filter(e=>e.unarchive_enabled).length]})]})]})})]})},fr=()=>{const[e,t]=g.useState("stores"),[s,r]=g.useState([]),[n,i]=g.useState([]),[a,c]=g.useState(!1),[m,u]=g.useState(null),[p,x]=g.useState({isOpen:!1,mode:"add",store:null}),[v,f]=g.useState({isRunning:!1,operation:null,progress:0,message:"",results:[]}),[,y]=g.useState({isRunning:!1,tasksCount:0,tasks:[]}),[,b]=g.useState([]);g.useEffect(()=>{j(),N(),w()},[]),g.useEffect(()=>{const t=setInterval(()=>{"logs"===e&&w(),"scheduler"===e&&N()},3e4);return()=>clearInterval(t)},[e]);const j=()=>d(void 0,null,function*(){c(!0),u(null);try{const e="../../../../public/services/modules/ozon-manager/index.js",t=(yield k(()=>import(e),[])).default;t.isInitialized||(yield t.initialize());const s=yield t.getStores();s.success?r(s.data||[]):u(`Ошибка загрузки магазинов: ${s.error}`)}catch(e){u(`Ошибка загрузки магазинов: ${e instanceof Error?e.message:String(e)}`)}finally{c(!1)}}),N=()=>d(void 0,null,function*(){try{const e="../../../../public/services/modules/ozon-manager/index.js",t=(yield k(()=>import(e),[])).default,s=yield t.getSchedulerStatus();s.success&&y(s.data)}catch(e){console.error("Ошибка загрузки статуса планировщика:",e)}}),w=()=>d(void 0,null,function*(){try{const e="../../../../public/services/modules/ozon-manager/index.js",t=(yield k(()=>import(e),[])).default,s=yield t.getLogs();s.success&&b(s.data||[])}catch(e){console.error("Ошибка загрузки логов:",e)}}),S=()=>d(void 0,null,function*(){if(0!==n.length){f({isRunning:!0,operation:"Удаление из акций",progress:0,message:"Запуск операции...",results:[]});try{const e="../../../../public/services/modules/ozon-manager/index.js",t=(yield k(()=>import(e),[])).default,s=yield t.removeFromPromotions(n);s.success?f(e=>l(o({},e),{isRunning:!1,operation:null,progress:100,message:"Операция завершена",results:s.data||[]})):f(e=>l(o({},e),{isRunning:!1,operation:null,message:`Ошибка: ${s.error}`}))}catch(e){f(t=>l(o({},t),{isRunning:!1,operation:null,message:`Ошибка: ${e instanceof Error?e.message:String(e)}`}))}}else alert("Выберите магазины для операции")}),C=()=>d(void 0,null,function*(){if(0!==n.length){f({isRunning:!0,operation:"Разархивация товаров",progress:0,message:"Запуск операции...",results:[]});try{const e="../../../../public/services/modules/ozon-manager/index.js",t=(yield k(()=>import(e),[])).default,s=yield t.unarchiveProducts(n);s.success?f(e=>l(o({},e),{isRunning:!1,operation:null,progress:100,message:"Операция завершена",results:s.data||[]})):f(e=>l(o({},e),{isRunning:!1,operation:null,message:`Ошибка: ${s.error}`}))}catch(e){f(t=>l(o({},t),{isRunning:!1,operation:null,message:`Ошибка: ${e instanceof Error?e.message:String(e)}`}))}}else alert("Выберите магазины для операции")});return h.jsxs("div",{className:"min-h-screen bg-surface",children:[h.jsx("div",{className:"liquid-glass-block border-b",children:h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"flex items-center justify-between h-16",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:h.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})}),h.jsxs("div",{className:"ml-4",children:[h.jsx("h1",{className:"text-xl font-semibold text-foreground",children:"Ozon Manager"}),h.jsx("p",{className:"text-sm text-secondary",children:"Автоматизация управления товарами на Ozon"})]})]}),h.jsx("div",{className:"flex items-center space-x-4",children:h.jsxs("div",{className:"text-sm text-secondary",children:["Магазинов: ",s.length]})})]})})}),h.jsx("div",{className:"liquid-glass-block",children:h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h.jsx("nav",{className:"flex space-x-2",children:[{id:"stores",name:"Магазины",icon:"🏪"},{id:"control",name:"Управление",icon:"🎛️"},{id:"scheduler",name:"Расписание",icon:"📅"},{id:"logs",name:"Логи",icon:"📋"}].map(s=>h.jsxs("button",{onClick:()=>t(s.id),className:"ozon-button "+(e===s.id?"ozon-button-primary":""),children:[h.jsx("span",{className:"mr-2",children:s.icon}),s.name]},s.id))})})}),h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[m&&h.jsx("div",{className:"mb-6 liquid-glass-block border border-red-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex",children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),h.jsxs("div",{className:"ml-3",children:[h.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Ошибка"}),h.jsx("div",{className:"mt-2 text-sm text-red-700",children:m})]})]})}),"stores"===e&&h.jsx(vr,{stores:s,onAddStore:()=>{x({isOpen:!0,mode:"add",store:null})},onEditStore:e=>{x({isOpen:!0,mode:"edit",store:e})},onDeleteStore:e=>d(void 0,null,function*(){if(window.confirm(`Удалить магазин "${e}"?`))try{const t="../../../../public/services/modules/ozon-manager/index.js",s=(yield k(()=>import(t),[])).default,n=yield s.removeStore(e);n.success?(r(t=>t.filter(t=>t.name!==e)),i(t=>t.filter(t=>t!==e))):u(`Ошибка удаления магазина: ${n.error}`)}catch(t){u(`Ошибка удаления магазина: ${t instanceof Error?t.message:String(t)}`)}}),onRefresh:j,onTestConnection:e=>d(void 0,null,function*(){try{const t="../../../../public/services/modules/ozon-manager/index.js",s=(yield k(()=>import(t),[])).default,r=yield s.testStoreConnection(e);r.success?alert("✅ Подключение успешно!"):alert(`❌ Ошибка подключения: ${r.error}`)}catch(t){alert(`Ошибка тестирования подключения: ${t instanceof Error?t.message:String(t)}`)}}),isLoading:a}),"control"===e&&h.jsx(ur,{stores:s.map(e=>e.name),selectedStores:n,onStoreSelectionChange:i,onRunPromotions:S,onRunUnarchive:C,onRunAll:()=>d(void 0,null,function*(){yield S(),yield new Promise(e=>setTimeout(e,1e3)),yield C()}),onStop:()=>{f(e=>l(o({},e),{isRunning:!1,operation:null,message:"Операция остановлена пользователем"}))},operationStatus:v}),"scheduler"===e&&h.jsx(xr,{onReloadSchedule:()=>d(void 0,null,function*(){try{const e="../../../../public/services/modules/ozon-manager/index.js",t=(yield k(()=>import(e),[])).default,s=yield t.reloadSchedule();s.success?yield N():u(`Ошибка перезагрузки расписания: ${s.error}`)}catch(e){u(`Ошибка перезагрузки расписания: ${e instanceof Error?e.message:String(e)}`)}}),isLoading:a}),"logs"===e&&h.jsx(pr,{onRefresh:()=>d(void 0,null,function*(){yield w()}),onOpenLogsFolder:()=>{alert("Открытие папки логов (в реальности откроется файловый менеджер)")},isLoading:a})]}),h.jsx(gr,{isOpen:p.isOpen,onClose:()=>x(e=>l(o({},e),{isOpen:!1})),onSave:e=>d(void 0,null,function*(){var t;try{const s="../../../../public/services/modules/ozon-manager/index.js",r=(yield k(()=>import(s),[])).default;let n;n="add"===p.mode?yield r.addStore(e):yield r.updateStore((null==(t=p.store)?void 0:t.name)||"",e),n.success?yield j():u(`Ошибка сохранения магазина: ${n.error}`)}catch(s){u(`Ошибка сохранения магазина: ${s instanceof Error?s.message:String(s)}`)}}),store:p.store,mode:p.mode})]})};const yr=({defaults:e={}})=>{var t,s,r,n;const[i,a]=g.useState(""),[o,l]=g.useState(""),[c,m]=g.useState(e.baseUrl||"http://127.0.0.1:7860"),[u,p]=g.useState(null!=(t=e.steps)?t:28),[x,v]=g.useState(e.sampler||"Euler a"),[f,y]=g.useState(null!=(s=e.cfgScale)?s:7),[b,j]=g.useState(null!=(r=e.width)?r:512),[N,w]=g.useState(null!=(n=e.height)?n:512),[k,S]=g.useState(-1),[C,E]=g.useState(.6),[I,T]=g.useState(null),[A,R]=g.useState(!1),[M,_]=g.useState(null),[P,L]=g.useState([]),O=g.useMemo(()=>!!I,[I]);return h.jsxs("div",{className:"h-full w-full p-4 flex flex-col gap-4",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"col-span-2 flex flex-col gap-3",children:[h.jsx("textarea",{value:i,onChange:e=>a(e.target.value),placeholder:"Промпт",className:"w-full p-2 rounded bg-surface text-white min-h-[100px]"}),h.jsx("textarea",{value:o,onChange:e=>l(e.target.value),placeholder:"Негативный промпт (optional)",className:"w-full p-2 rounded bg-surface text-white min-h-[60px]"}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;const s=(null==(t=e.target.files)?void 0:t[0])||null;T(s)},title:"Загрузить фото"}),I&&h.jsx("span",{className:"text-xs text-muted",children:I.name})]}),h.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[h.jsx("label",{className:"text-sm",children:"Sampler"}),h.jsx("input",{className:"w-40 p-1 rounded bg-surface-muted",value:x,onChange:e=>v(e.target.value),title:"Sampler",placeholder:"Euler a"}),h.jsx("label",{className:"text-sm",children:"Steps"}),h.jsx("input",{type:"number",className:"w-24 p-1 rounded bg-surface-muted",value:u,onChange:e=>p(Number(e.target.value)),title:"Steps",placeholder:"28"}),h.jsx("label",{className:"text-sm",children:"CFG"}),h.jsx("input",{type:"number",className:"w-24 p-1 rounded bg-surface-muted",value:f,onChange:e=>y(Number(e.target.value)),title:"CFG Scale",placeholder:"7"}),h.jsx("label",{className:"text-sm",children:"W"}),h.jsx("input",{type:"number",className:"w-24 p-1 rounded bg-surface-muted",value:b,onChange:e=>j(Number(e.target.value)),title:"Width",placeholder:"512"}),h.jsx("label",{className:"text-sm",children:"H"}),h.jsx("input",{type:"number",className:"w-24 p-1 rounded bg-surface-muted",value:N,onChange:e=>w(Number(e.target.value)),title:"Height",placeholder:"512"}),h.jsx("label",{className:"text-sm",children:"Seed"}),h.jsx("input",{type:"number",className:"w-32 p-1 rounded bg-surface-muted",value:k,onChange:e=>S(Number(e.target.value)),title:"Seed",placeholder:"-1"}),O&&h.jsxs(h.Fragment,{children:[h.jsx("label",{className:"text-sm",children:"Denoise"}),h.jsx("input",{type:"number",step:"0.05",className:"w-24 p-1 rounded bg-surface-muted",value:C,onChange:e=>E(Number(e.target.value)),title:"Denoising strength",placeholder:"0.6"})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("button",{onClick:()=>d(void 0,null,function*(){R(!0),_(null),L([]);try{if(!i.trim())throw new Error("Введите промпт");if(O&&I){const e=yield function(e){return d(this,null,function*(){return new Promise((t,s)=>{const r=new FileReader;r.onload=()=>{const e=r.result.replace(/^data:[^,]+,/,"");t(e)},r.onerror=()=>s(r.error),r.readAsDataURL(e)})})}(I),t=yield function(e){return d(this,null,function*(){const{baseUrl:t,prompt:s,negative_prompt:r="",steps:n=28,sampler_name:i="Euler a",cfg_scale:a=7,width:o=512,height:l=512,seed:c=-1,batch_size:d=1,n_iter:m=1,init_images:h,denoising_strength:u=.6}=e,p={prompt:s,negative_prompt:r,steps:n,sampler_name:i,cfg_scale:a,width:o,height:l,seed:c,batch_size:d,n_iter:m,init_images:h,denoising_strength:u},x=yield fetch(`${t.replace(/\/$/,"")}/sdapi/v1/img2img`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!x.ok)throw new Error(`img2img failed: HTTP ${x.status}`);return yield x.json()})}({baseUrl:c,prompt:i,negative_prompt:o,steps:u,sampler_name:x,cfg_scale:f,width:b,height:N,seed:k,init_images:[e],denoising_strength:C});L(t.images||[])}else{const e=yield function(e){return d(this,null,function*(){const{baseUrl:t,prompt:s,negative_prompt:r="",steps:n=28,sampler_name:i="Euler a",cfg_scale:a=7,width:o=512,height:l=512,seed:c=-1,batch_size:d=1,n_iter:m=1}=e,h={prompt:s,negative_prompt:r,steps:n,sampler_name:i,cfg_scale:a,width:o,height:l,seed:c,batch_size:d,n_iter:m},u=yield fetch(`${t.replace(/\/$/,"")}/sdapi/v1/txt2img`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(!u.ok)throw new Error(`txt2img failed: HTTP ${u.status}`);return yield u.json()})}({baseUrl:c,prompt:i,negative_prompt:o,steps:u,sampler_name:x,cfg_scale:f,width:b,height:N,seed:k});L(e.images||[])}}catch(e){_(e instanceof Error?e.message:"Ошибка генерации")}finally{R(!1)}}),disabled:A,className:"px-4 py-2 rounded bg-primary text-background disabled:opacity-50",children:A?"Генерация…":O?"Img2Img":"Txt2Img"}),M&&h.jsx("span",{className:"text-warning text-sm",children:M})]})]}),h.jsxs("div",{className:"col-span-1 flex flex-col gap-3",children:[h.jsx("label",{className:"text-sm",children:"Automatic1111 URL"}),h.jsx("input",{className:"w-full p-2 rounded bg-surface-muted",value:c,onChange:e=>m(e.target.value),title:"Automatic1111 URL",placeholder:"http://127.0.0.1:7860"}),h.jsx("div",{className:"text-xs text-muted",children:"Убедитесь, что A1111 запущен с параметрами: --api --cors-allow-origins *"})]})]}),P.length>0&&h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:P.map((e,t)=>h.jsxs("div",{className:"rounded overflow-hidden bg-surface-muted p-2",children:[h.jsx("img",{alt:`gen-${t}`,className:"w-full h-auto rounded",src:`data:image/png;base64,${e}`}),h.jsx("a",{className:"text-xs underline mt-2 inline-block",href:`data:image/png;base64,${e}`,download:`photo-studio-${Date.now()}-${t}.png`,children:"Скачать"})]},t))})]})},br=()=>{const e=g.useMemo(()=>{const e=L.getServiceInfo("photo-studio");return(null==e?void 0:e.config)||{}},[]),t=(null==e?void 0:e.settings)||{};return h.jsx("div",{className:"h-full w-full",children:h.jsx(yr,{defaults:t})})},jr=(e,t)=>{const s=e[t];return s?"function"==typeof s?s():Promise.resolve(s):new Promise((e,s)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})},Nr="promptsManager";const wr=new class{constructor(){this.modules=new Map,this.quickAccess=new Set,this.loadQuickAccess(),this.loadSystemModules().catch(e=>{console.error("Failed to load system modules in constructor:",e)})}loadUserModules(){return d(this,null,function*(){try{console.log("[PromptManager] Loading user modules...");const t=Object.keys(localStorage).filter(e=>e.startsWith(`${Nr}:module:`));for(const s of t)try{const e=localStorage.getItem(s);if(e){const t=JSON.parse(e);this.modules.set(t.id,t),console.log(`[PromptManager] User module ${t.id} loaded successfully`)}}catch(e){console.warn(`Failed to load user module from ${s}:`,e)}console.log(`[PromptManager] User modules loaded. Total modules: ${this.modules.size}`)}catch(e){console.error("Failed to load user modules:",e)}})}loadSystemModules(){return d(this,null,function*(){try{console.log("[PromptManager] Loading system modules...");const s=["ai-assistant","business","creative","education","productivity"];for(const r of s)try{console.log(`[PromptManager] Loading module: ${r}`);try{const e=yield jr(Object.assign({"./system/ai-assistant.json":()=>k(()=>import("./ai-assistant-28dbcdbf.js"),[]),"./system/business.json":()=>k(()=>import("./business-9faa3aea.js"),[]),"./system/creative.json":()=>k(()=>import("./creative-302b7a2d.js"),[]),"./system/education.json":()=>k(()=>import("./education-629b4108.js"),[]),"./system/productivity.json":()=>k(()=>import("./productivity-d788e687.js"),[])}),`./system/${r}.json`),t=e.default||e;this.modules.set(r,t),console.log(`[PromptManager] Module ${r} loaded successfully via import`)}catch(e){console.log(`[PromptManager] Import failed for ${r}, trying fetch...`);const t=yield fetch(`/src/data/prompts/system/${r}.json`);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);{const e=yield t.json();this.modules.set(r,e),console.log(`[PromptManager] Module ${r} loaded successfully via fetch`)}}}catch(t){console.warn(`Failed to load system module ${r}:`,t)}console.log(`[PromptManager] System modules loaded. Total modules: ${this.modules.size}`)}catch(t){console.error("Failed to load system modules:",t)}})}ensureModulesLoaded(){return d(this,null,function*(){0===this.modules.size&&(console.log("[PromptManager] No modules loaded, waiting for system modules..."),yield new Promise(e=>setTimeout(e,100)),0===this.modules.size&&(console.log("[PromptManager] Still no modules, retrying load..."),yield this.loadSystemModules())),yield this.loadUserModules()})}loadQuickAccess(){try{const e=localStorage.getItem(`${Nr}:quickAccess`);if(console.log("[PromptManager] Loading quick access from localStorage:",e),e){const t=JSON.parse(e);this.quickAccess=new Set(t),console.log("[PromptManager] Loaded quick access IDs:",[...this.quickAccess])}else console.log("[PromptManager] No quick access data found in localStorage")}catch(e){console.warn("Failed to load quick access:",e)}}saveQuickAccess(){try{const e=[...this.quickAccess];console.log("[PromptManager] Saving quick access to localStorage:",e),localStorage.setItem(`${Nr}:quickAccess`,JSON.stringify(e)),console.log("[PromptManager] Quick access saved successfully")}catch(e){console.warn("Failed to save quick access:",e)}}loadModule(e){return d(this,null,function*(){if(this.modules.has(e))return this.modules.get(e);try{const t=localStorage.getItem(`${Nr}:module:${e}`);if(t){const s=JSON.parse(t);return this.modules.set(e,s),s}}catch(t){console.warn(`Failed to load module ${e}:`,t)}throw new Error(`Module ${e} not found`)})}saveModule(e){return d(this,null,function*(){if(this.modules.set(e.id,e),"user"===e.source)try{localStorage.setItem(`${Nr}:module:${e.id}`,JSON.stringify(e))}catch(t){console.warn(`Failed to save module ${e.id}:`,t)}})}deleteModule(e){return d(this,null,function*(){const t=this.modules.get(e);if(t&&"user"===t.source){this.modules.delete(e);try{localStorage.removeItem(`${Nr}:module:${e}`)}catch(s){console.warn(`Failed to delete module ${e}:`,s)}}})}listModules(e){return d(this,null,function*(){const t=Array.from(this.modules.values());return e?t.filter(t=>t.source===e):t})}searchPrompts(e,t){return d(this,null,function*(){var s;const r=[],n=e.toLowerCase();for(const e of this.modules.values())if(!((null==t?void 0:t.source)&&e.source!==t.source||(null==t?void 0:t.moduleId)&&e.id!==t.moduleId))for(const i of e.prompts){if((null==t?void 0:t.categoryId)&&i.categoryId!==t.categoryId)continue;if((null==t?void 0:t.folderId)&&i.folderId!==t.folderId)continue;if(void 0!==(null==t?void 0:t.system)&&i.system!==t.system)continue;if((null==t?void 0:t.tags)&&!t.tags.some(e=>i.tags.includes(e)))continue;if(`${i.title} ${i.body} ${i.description||""} ${i.tags.join(" ")}`.toLowerCase().includes(n)){const t=e.categories.find(e=>e.id===i.categoryId),a=i.folderId?e.folders.find(e=>e.id===i.folderId):void 0;let o=0;i.title.toLowerCase().includes(n)&&(o+=10),i.tags.some(e=>e.toLowerCase().includes(n))&&(o+=5),i.body.toLowerCase().includes(n)&&(o+=3),(null==(s=i.description)?void 0:s.toLowerCase().includes(n))&&(o+=2),r.push({prompt:i,module:e,category:t,folder:a,relevance:o})}}return r.sort((e,t)=>t.relevance-e.relevance)})}getPrompt(e){return d(this,null,function*(){console.log(`[PromptManager] getPrompt called for ID: ${e}`),console.log("[PromptManager] Available modules:",Array.from(this.modules.keys()));for(const t of this.modules.values()){console.log(`[PromptManager] Searching in module: ${t.id}, prompts: ${t.prompts.length}`);const s=t.prompts.find(t=>t.id===e);if(s)return console.log(`[PromptManager] Found prompt in module ${t.id}: ${s.title}`),s}return console.log(`[PromptManager] Prompt not found: ${e}`),null})}getAllPrompts(){return d(this,null,function*(){yield this.ensureModulesLoaded();const e=[];for(const t of this.modules.values())e.push(...t.prompts);return e})}createPrompt(e){return d(this,null,function*(){const t=this.modules.get(e.moduleId);if(!t)throw new Error(`Module ${e.moduleId} not found`);const s=l(o({},e),{id:this.generateId("prompt"),metadata:{author:"User",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usage:0,rating:0}});return t.prompts.push(s),yield this.saveModule(t),s})}updatePrompt(e,t){return d(this,null,function*(){for(const s of this.modules.values()){const r=s.prompts.findIndex(t=>t.id===e);if(-1!==r){const e=s.prompts[r],n=l(o(o({},e),t),{metadata:l(o({},e.metadata),{updatedAt:(new Date).toISOString()})});return s.prompts[r]=n,yield this.saveModule(s),n}}throw new Error(`Prompt ${e} not found`)})}deletePrompt(e){return d(this,null,function*(){for(const t of this.modules.values()){const s=t.prompts.findIndex(t=>t.id===e);if(-1!==s)return t.prompts.splice(s,1),yield this.saveModule(t),this.quickAccess.delete(e),void this.saveQuickAccess()}throw new Error(`Prompt ${e} not found`)})}getCategories(e){return d(this,null,function*(){yield this.ensureModulesLoaded(),console.log(`[PromptManager] getCategories called. ModuleId: ${e}, Total modules: ${this.modules.size}`);const t=[];for(const s of this.modules.values())e&&s.id!==e||(console.log(`[PromptManager] Processing module ${s.id} with ${s.categories.length} categories`),t.push(...s.categories));return console.log(`[PromptManager] Returning ${t.length} categories`),t.sort((e,t)=>e.order-t.order)})}getFolders(e){return d(this,null,function*(){yield this.ensureModulesLoaded(),console.log(`[PromptManager] getFolders called. CategoryId: ${e}, Total modules: ${this.modules.size}`);const t=[];for(const s of this.modules.values()){console.log(`[PromptManager] Processing module ${s.id} with ${s.folders.length} folders`);for(const r of s.folders)e&&r.categoryId!==e||t.push(r)}return console.log(`[PromptManager] Returning ${t.length} folders`),t.sort((e,t)=>e.order-t.order)})}getPromptsInCategory(e){return d(this,null,function*(){const t=[];for(const s of this.modules.values())for(const r of s.prompts)r.categoryId!==e||r.folderId||t.push(r);return t.sort((e,t)=>e.order-t.order)})}getPromptsInFolder(e){return d(this,null,function*(){const t=[];for(const s of this.modules.values())for(const r of s.prompts)r.folderId===e&&t.push(r);return t.sort((e,t)=>e.order-t.order)})}addToQuickAccess(e){return d(this,null,function*(){console.log(`[PromptManager] Adding to quick access: ${e}`),this.quickAccess.add(e),console.log("[PromptManager] Quick access Set after add:",[...this.quickAccess]),this.saveQuickAccess()})}removeFromQuickAccess(e){return d(this,null,function*(){console.log(`[PromptManager] Removing from quick access: ${e}`),this.quickAccess.delete(e),console.log("[PromptManager] Quick access Set after remove:",[...this.quickAccess]),this.saveQuickAccess()})}getQuickAccess(){return d(this,null,function*(){console.log("[PromptManager] getQuickAccess called, quickAccess Set:",[...this.quickAccess]);const e=[];for(const t of this.quickAccess){console.log(`[PromptManager] Looking for prompt with ID: ${t}`);const s=yield this.getPrompt(t);s?(console.log(`[PromptManager] Found prompt: ${s.title} (${s.id})`),e.push(s)):console.log(`[PromptManager] Prompt not found for ID: ${t}`)}return console.log(`[PromptManager] getQuickAccess returning ${e.length} prompts:`,e.map(e=>({id:e.id,title:e.title}))),e})}generateId(e){return`${e}_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}createUserModule(e,t){return d(this,null,function*(){const s={id:this.generateId("module"),name:e,version:"1.0.0",description:t,source:"user",categories:[],folders:[],prompts:[],metadata:{author:"User",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),tags:[],dependencies:[]}};return yield this.saveModule(s),s})}restoreSystemPrompts(){return d(this,null,function*(){try{const e=["ai-assistant","business"];for(const t of e)this.modules.delete(t);yield this.loadSystemModules(),console.log("System prompts restored successfully")}catch(e){throw console.error("Failed to restore system prompts:",e),e}})}ensureBossAIGenerationCategory(){return d(this,null,function*(){let e=(yield this.getCategories()).find(e=>"Boss AI Generation"===e.title);if(!e){let t=Array.from(this.modules.values()).find(e=>"Boss AI Generation"===e.name);t||(t=yield this.createUserModule("Boss AI Generation","Автоматически сгенерированные промпты"));e={id:this.generateId("category"),title:"Boss AI Generation",description:"Автоматически сгенерированные промпты",order:999,icon:"🤖",color:"#8B5CF6",system:!1,moduleId:t.id},t.categories.push(e),yield this.saveModule(t)}return e})}ensureGeneratedCategory(){return d(this,null,function*(){let e=(yield this.getCategories()).find(e=>"Сгенерированные"===e.title);if(!e){let t=Array.from(this.modules.values()).find(e=>"Сгенерированные"===e.name);t||(t=yield this.createUserModule("Сгенерированные","Улучшенные и сгенерированные промпты"));e={id:this.generateId("category"),title:"Сгенерированные",description:"Улучшенные и сгенерированные промпты",order:998,icon:"✨",color:"#10b981",system:!1,moduleId:t.id},t.categories.push(e),yield this.saveModule(t)}return e})}generatePrompt(e){return d(this,null,function*(){try{const t=yield this.ensureBossAIGenerationCategory(),s=`Сгенерированный промпт: ${e.slice(0,50)}...`,r=`Промпт для: ${e}\n\nИнструкции:\n1. ${e}\n2. Будь точным и полезным\n3. Предоставь детальный ответ\n\nКонтекст: Пользователь запросил помощь с: ${e}`;return yield this.createPrompt({title:s,body:r,description:`Автоматически сгенерированный промпт для: ${e}`,tags:["автогенерация","boss-ai","пользовательский"],categoryId:t.id,order:Date.now(),system:!1,moduleId:t.moduleId})}catch(t){throw console.error("Failed to generate prompt:",t),t}})}improvePrompt(e,t){return d(this,null,function*(){try{const s=`${e}\n\nДополнительные инструкции:\n- Будь максимально точным и конкретным\n- Предоставь пошаговое решение\n- Включи примеры если необходимо\n- Учитывай контекст: ${t||"общий"}\n\nФормат ответа:\n1. Анализ задачи\n2. Пошаговое решение\n3. Примеры и пояснения\n4. Рекомендации`,r=["Добавить конкретные примеры","Уточнить формат ответа","Включить критерии качества","Добавить контекстные ограничения"],n="Промпт был улучшен для большей точности и структурированности. Добавлены четкие инструкции по формату ответа и критериям качества.",i=yield this.ensureGeneratedCategory();return{improvedPrompt:s,suggestions:r,explanation:n,savedPrompt:yield this.createPrompt({title:`Улучшенный промпт: ${e.slice(0,50)}...`,body:s,description:"Автоматически улучшенный промпт",tags:["улучшенный","ai-генерация","пользовательский"],categoryId:i.id,order:Date.now(),system:!1,moduleId:i.moduleId})}}catch(s){throw console.error("Failed to improve prompt:",s),s}})}validateImprovedPrompt(e,t){return d(this,null,function*(){try{let s=e,r="Промпт готов к использованию!";return t&&(s=`${e}\n\nДополнительные требования пользователя:\n${t}\n\nУчти эти требования при выполнении задачи.`,r="Промпт обновлен с учетом ваших дополнений!"),{isValid:!0,finalPrompt:s,message:r}}catch(s){throw console.error("Failed to validate improved prompt:",s),s}})}createUserCategory(e,t,s,r){return d(this,null,function*(){try{const n=(yield this.getCategories()).find(t=>t.title===e);if(n)return console.log(`[PromptManager] Category "${e}" already exists, returning existing one`),n;let i=Array.from(this.modules.values()).find(e=>"Пользовательские"===e.name);i||(i=yield this.createUserModule("Пользовательские","Пользовательские категории и промпты"));const a={id:this.generateId("category"),title:e,description:t||`Пользовательская категория: ${e}`,order:Date.now(),icon:s||"📁",color:r||"#6b7280",system:!1,moduleId:i.id};return i.categories.push(a),yield this.saveModule(i),console.log(`[PromptManager] Created new category: "${e}"`),a}catch(n){throw console.error("Failed to create user category:",n),n}})}createPromptInCategory(e,t,s,r,n,i){return d(this,null,function*(){try{const a=(yield this.getCategories()).find(t=>t.id===e);if(!a)throw new Error("Category not found");const o=[...n||["пользовательский"]];if(i){const e=`project:${i}`;o.includes(e)||o.push(e)}return yield this.createPrompt({title:t,body:s,description:r||`Пользовательский промпт: ${t}`,tags:o,categoryId:e,order:Date.now(),system:!1,moduleId:a.moduleId})}catch(a){throw console.error("Failed to create prompt in category:",a),a}})}movePromptToCategory(e,t){return d(this,null,function*(){try{const s=yield this.getPrompt(e);if(!s)throw new Error("Prompt not found");const r=(yield this.getCategories()).find(e=>e.id===t);if(!r)throw new Error("Category not found");s.originalCategoryId||(s.originalCategoryId=s.categoryId),s.categoryId=t,s.folderId=void 0,yield this.updatePrompt(e,{categoryId:t,folderId:void 0,originalCategoryId:s.originalCategoryId}),console.log(`[PromptManager] Moved prompt "${s.title}" to category "${r.title}"`)}catch(s){throw console.error("Failed to move prompt to category:",s),s}})}deleteCategory(e){return d(this,null,function*(){try{const t=(yield this.getCategories()).find(t=>t.id===e);if(!t)throw new Error("Category not found");if(t.system)throw new Error("Cannot delete system categories");if("Избранное"===t.title)throw new Error("Cannot delete favorites category");const s=Array.from(this.modules.values()).find(e=>e.id===t.moduleId);if(!s)throw new Error("Module not found");const r=s.prompts.filter(t=>t.categoryId===e);for(const e of r)yield this.deletePrompt(e.id);const n=s.categories.findIndex(t=>t.id===e);-1!==n&&(s.categories.splice(n,1),yield this.saveModule(s)),console.log(`[PromptManager] Deleted category "${t.title}" and ${r.length} prompts`)}catch(t){throw console.error("Failed to delete category:",t),t}})}mergeGeneratedCategories(){return d(this,null,function*(){try{const t=(yield this.getCategories()).filter(e=>"Сгенерированные"===e.title||"Boss AI Generation"===e.title);if(t.length<=1)return void console.log("[PromptManager] No duplicate generated categories found");console.log(`[PromptManager] Found ${t.length} generated categories, merging...`);const s=t.find(e=>"Сгенерированные"===e.title)||t[0],r=t.filter(e=>e.id!==s.id);for(const n of r)try{const e=Array.from(this.modules.values()).find(e=>e.id===n.moduleId);if(e){const t=e.prompts.filter(e=>e.categoryId===n.id);for(const e of t)e.categoryId=s.id,e.moduleId=s.moduleId;const r=e.categories.findIndex(e=>e.id===n.id);-1!==r&&(e.categories.splice(r,1),yield this.saveModule(e))}console.log(`[PromptManager] Merged category "${n.title}" into "${s.title}"`)}catch(e){console.error(`Failed to merge category ${n.id}:`,e)}console.log(`[PromptManager] Merge completed. Kept category: ${s.title}`)}catch(e){throw console.error("Failed to merge generated categories:",e),e}})}},kr=({settings:e,onChange:t,className:s=""})=>{const[r,n]=g.useState(e||{}),[i,a]=g.useState(""),[c,d]=g.useState(!1),[m,u]=g.useState({valid:!0,errors:[]});g.useEffect(()=>{e&&n(e)},[e]);const p=(e,s)=>{const i=l(o({},r),{[e]:s});n(i);const a=function(e){const t=[];return void 0!==e.temperature&&(e.temperature<0||e.temperature>2)&&t.push("Temperature должен быть от 0.0 до 2.0"),void 0!==e.top_p&&(e.top_p<0||e.top_p>1)&&t.push("Top_p должен быть от 0.0 до 1.0"),void 0!==e.max_tokens&&e.max_tokens<1&&t.push("Max_tokens должен быть больше 0"),void 0!==e.frequency_penalty&&(e.frequency_penalty<-2||e.frequency_penalty>2)&&t.push("Frequency_penalty должен быть от -2.0 до 2.0"),void 0!==e.presence_penalty&&(e.presence_penalty<-2||e.presence_penalty>2)&&t.push("Presence_penalty должен быть от -2.0 до 2.0"),{valid:0===t.length,errors:t}}(i);u(a),a.valid&&t(i)},x=Object.keys(r).length>0;return h.jsxs("div",{className:`gpt-settings-panel ${s}`,children:[h.jsxs("div",{className:"gpt-settings-header",children:[h.jsx("h4",{className:"gpt-settings-title",children:"Настройки GPT"}),x&&h.jsx("button",{className:"gpt-settings-clear",onClick:()=>{n({}),a(""),t(void 0)},title:"Очистить настройки",children:"✕"})]}),h.jsxs("div",{className:"gpt-settings-presets",children:[h.jsx("label",{htmlFor:"preset-select",className:"gpt-settings-label",children:"Предустановка:"}),h.jsxs("select",{id:"preset-select",className:"gpt-settings-select",value:i,onChange:e=>(e=>{if(""===e)n({}),a(""),t(void 0);else{const s=ys[e];n(s),a(e),t(s)}})(e.target.value),children:[h.jsx("option",{value:"",children:"Без предустановки"}),h.jsx("option",{value:"creative",children:"Креативная"}),h.jsx("option",{value:"analytical",children:"Аналитическая"}),h.jsx("option",{value:"balanced",children:"Сбалансированная"}),h.jsx("option",{value:"precise",children:"Точная"})]})]}),h.jsxs("div",{className:"gpt-settings-basic",children:[h.jsxs("div",{className:"gpt-settings-row",children:[h.jsxs("label",{htmlFor:"temperature-slider",className:"gpt-settings-label",children:["Temperature:",h.jsx("span",{className:"gpt-settings-value",children:r.temperature||1})]}),h.jsx("input",{id:"temperature-slider",type:"range",min:"0",max:"2",step:"0.1",value:r.temperature||1,onChange:e=>p("temperature",parseFloat(e.target.value)),className:"gpt-settings-slider"})]}),h.jsxs("div",{className:"gpt-settings-row",children:[h.jsxs("label",{htmlFor:"top-p-slider",className:"gpt-settings-label",children:["Top P:",h.jsx("span",{className:"gpt-settings-value",children:r.top_p||1})]}),h.jsx("input",{id:"top-p-slider",type:"range",min:"0",max:"1",step:"0.05",value:r.top_p||1,onChange:e=>p("top_p",parseFloat(e.target.value)),className:"gpt-settings-slider"})]}),h.jsxs("div",{className:"gpt-settings-row",children:[h.jsxs("label",{htmlFor:"max-tokens-slider",className:"gpt-settings-label",children:["Max Tokens:",h.jsx("span",{className:"gpt-settings-value",children:r.max_tokens||1e3})]}),h.jsx("input",{id:"max-tokens-slider",type:"range",min:"100",max:"4000",step:"100",value:r.max_tokens||1e3,onChange:e=>p("max_tokens",parseInt(e.target.value)),className:"gpt-settings-slider"})]})]}),h.jsxs("div",{className:"gpt-settings-advanced",children:[h.jsxs("button",{className:"gpt-settings-toggle",onClick:()=>d(!c),children:[c?"Скрыть":"Показать"," расширенные настройки"]}),c&&h.jsxs("div",{className:"gpt-settings-advanced-content",children:[h.jsxs("div",{className:"gpt-settings-row",children:[h.jsxs("label",{htmlFor:"frequency-penalty-slider",className:"gpt-settings-label",children:["Frequency Penalty:",h.jsx("span",{className:"gpt-settings-value",children:r.frequency_penalty||0})]}),h.jsx("input",{id:"frequency-penalty-slider",type:"range",min:"-2",max:"2",step:"0.1",value:r.frequency_penalty||0,onChange:e=>p("frequency_penalty",parseFloat(e.target.value)),className:"gpt-settings-slider"})]}),h.jsxs("div",{className:"gpt-settings-row",children:[h.jsxs("label",{htmlFor:"presence-penalty-slider",className:"gpt-settings-label",children:["Presence Penalty:",h.jsx("span",{className:"gpt-settings-value",children:r.presence_penalty||0})]}),h.jsx("input",{id:"presence-penalty-slider",type:"range",min:"-2",max:"2",step:"0.1",value:r.presence_penalty||0,onChange:e=>p("presence_penalty",parseFloat(e.target.value)),className:"gpt-settings-slider"})]})]})]}),!m.valid&&h.jsx("div",{className:"gpt-settings-errors",children:m.errors.map((e,t)=>h.jsx("div",{className:"gpt-settings-error",children:e},t))}),x&&h.jsxs("div",{className:"gpt-settings-preview",children:[h.jsx("span",{className:"gpt-settings-preview-label",children:"Настройки:"}),h.jsx("span",{className:"gpt-settings-preview-value",children:bs(r)})]})]})},Sr=()=>{var e;const{state:t}=j(),[s,r]=g.useState([]),[n,i]=g.useState([]),[a,c]=g.useState([]),[m,u]=g.useState([]),[p,x]=g.useState(!1),[f,y]=g.useState(""),[b,N]=g.useState(!1),[w,k]=g.useState(!1),[S,C]=g.useState(""),[E,I]=g.useState(""),[T,A]=g.useState(""),[R,M]=g.useState({level:"categories",categoryId:void 0,folderId:void 0,promptId:void 0}),[_,P]=g.useState(null),[L,O]=g.useState(null),[$,D]=g.useState({}),z=g.useCallback(()=>{if(L){const e=t.workspaceItems.find(e=>e.id===L&&"folder"===e.type);return(null==e?void 0:e.title)||null}return null},[t.workspaceItems,L]);v.useEffect(()=>{const e=e=>{var t;const s=e;console.log("PromptsService received workspace:navigate event:",s.detail),(null==(t=s.detail)?void 0:t.projectId)&&(O(s.detail.projectId),console.log("Set activeProjectId to:",s.detail.projectId))};return window.addEventListener("workspace:navigate",e),()=>window.removeEventListener("workspace:navigate",e)},[]),v.useEffect(()=>{const e=e=>{var t;const s=e;(null==(t=s.detail)?void 0:t.promptId)&&G(s.detail.promptId)};return window.addEventListener("prompts:open",e),()=>window.removeEventListener("prompts:open",e)},[]);const B=g.useCallback(()=>d(void 0,null,function*(){try{console.log("[PromptsService] Loading data...");const[t,s,n]=yield Promise.all([wr.getCategories(),wr.getFolders(),wr.getQuickAccess()]);console.log("[PromptsService] Initial data loaded:",{categories:t.length,folders:s.length,quick:n.length,quickIds:n.map(e=>e.id)});let a=t;try{yield wr.mergeGeneratedCategories(),a=yield wr.getCategories()}catch(e){console.error("Failed to merge generated categories:",e)}let o=[...a];if(!a.find(e=>"Избранное"===e.title))try{yield wr.createUserCategory("Избранное");o=yield wr.getCategories()}catch(e){console.error("Failed to create favorites category:",e)}if(console.log("[PromptsService] Final data loaded:",{categories:o.length,folders:s.length,quick:n.length,quickIds:n.map(e=>e.id)}),r(o),i(s),u(n),R.categoryId){const e=o.find(e=>e.id===R.categoryId);if(console.log("[PromptsService] Current category:",null==e?void 0:e.title),"Избранное"===(null==e?void 0:e.title)){const e=yield wr.getAllPrompts();console.log(`[PromptsService] Total prompts loaded: ${e.length}`),console.log(`[PromptsService] Quick access items: ${n.length}`,n.map(e=>e.id));const t=e.filter(e=>n.some(t=>t.id===e.id));console.log(`[PromptsService] Filtered favorite prompts: ${t.length}`),console.log("[PromptsService] Favorite prompts details:",t.map(e=>({id:e.id,title:e.title}))),c(t)}else{const e=yield wr.getPromptsInCategory(R.categoryId);c(e)}}else if(R.folderId){const e=yield wr.getPromptsInFolder(R.folderId);c(e)}}catch(e){console.error("Failed to load data:",e)}}),[R.categoryId,R.folderId]),F=g.useCallback(()=>d(void 0,null,function*(){try{const e={};for(const t of s)if("Избранное"===t.title){const s=(yield wr.getAllPrompts()).filter(e=>m.some(t=>t.id===e.id));e[t.id]=s.length,console.log(`[PromptsService] Favorites count: ${s.length} (quick: ${m.length})`)}else{const s=yield wr.getPromptsInCategory(t.id);e[t.id]=s.length}D(e)}catch(e){console.error("Failed to load category counts:",e)}}),[s,m]);v.useEffect(()=>{console.log("[PromptsService] Component mounted, loading data..."),B()},[B]),v.useEffect(()=>{console.log("[PromptsService] State updated:",{categories:s.length,quick:m.length,prompts:a.length,navigation:R})},[s,m,a,R]),v.useEffect(()=>{s.length>0&&F()},[s,F]);const H=g.useMemo(()=>s.sort((e,t)=>e.order-t.order).map(e=>({id:e.id,title:e.title})),[s]),U=e=>d(void 0,null,function*(){console.log(`[PromptsService] Navigating to category: ${e}`),M({level:"category",categoryId:e,folderId:void 0,promptId:void 0}),P(null);try{const t=s.find(t=>t.id===e);if(console.log(`[PromptsService] Current category: ${null==t?void 0:t.title}`),"Избранное"===(null==t?void 0:t.title)){console.log("[PromptsService] Loading favorites, quick state:",m.map(e=>({id:e.id,title:e.title})));const e=yield wr.getAllPrompts();console.log(`[PromptsService] Total prompts for favorites: ${e.length}`),console.log(`[PromptsService] Quick access items: ${m.length}`,m.map(e=>e.id));const t=e.filter(e=>m.some(t=>t.id===e.id));console.log(`[PromptsService] Filtered favorite prompts: ${t.length}`),console.log("[PromptsService] Favorite prompts details:",t.map(e=>({id:e.id,title:e.title}))),c(t),console.log(`[PromptsService] Loaded ${t.length} favorite prompts`)}else{const s=yield wr.getPromptsInCategory(e);c(s),console.log(`[PromptsService] Loaded ${s.length} prompts for category: ${null==t?void 0:t.title}`)}}catch(t){console.error("Failed to load category prompts:",t)}}),W=e=>d(void 0,null,function*(){M({level:"folder",categoryId:R.categoryId,folderId:e,promptId:void 0}),P(null);try{const t=yield wr.getPromptsInFolder(e);c(t)}catch(t){console.error("Failed to load folder prompts:",t)}}),G=e=>d(void 0,null,function*(){try{const t=yield wr.getPrompt(e);t&&(M({level:"prompt",categoryId:t.categoryId,folderId:t.folderId,promptId:e}),P(t))}catch(t){console.error("Failed to load prompt:",t)}}),V=g.useMemo(()=>R.categoryId?s.find(e=>e.id===R.categoryId):null,[s,R.categoryId]),q=g.useMemo(()=>R.folderId?n.find(e=>e.id===R.folderId):null,[n,R.folderId]),K=g.useMemo(()=>"category"===R.level&&R.categoryId?n.filter(e=>e.categoryId===R.categoryId).sort((e,t)=>e.order-t.order):[],[n,R]),Q=g.useMemo(()=>{if("categories"===R.level)return[];let e=a;return R.categoryId&&(e=e.filter(e=>e.categoryId===R.categoryId)),R.folderId?e=e.filter(e=>e.folderId===R.folderId):"category"===R.level&&(e=e.filter(e=>!e.folderId)),e.sort((e,t)=>e.title.localeCompare(t.title))},[a,R]),Z=e=>d(void 0,null,function*(){if(confirm("Удалить этот промпт?"))try{yield wr.deletePrompt(e),yield B(),(null==_?void 0:_.id)===e&&(P(null),d(void 0,null,function*(){if("prompt"===R.level){if(R.folderId){M({level:"folder",categoryId:R.categoryId,folderId:R.folderId,promptId:void 0});const e=yield wr.getPromptsInFolder(R.folderId);c(e)}else{M({level:"category",categoryId:R.categoryId,folderId:void 0,promptId:void 0});const e=yield wr.getPromptsInCategory(R.categoryId);c(e)}P(null)}else if("folder"===R.level){M({level:"category",categoryId:R.categoryId,folderId:void 0,promptId:void 0});const e=yield wr.getPromptsInCategory(R.categoryId);c(e)}else"category"===R.level&&(M({level:"categories",categoryId:void 0,folderId:void 0,promptId:void 0}),c([]))}))}catch(t){console.error("Failed to delete prompt:",t),alert("Ошибка при удалении промпта")}}),Y=()=>d(void 0,null,function*(){if(S.trim())try{yield wr.createUserCategory(S.trim()),C(""),N(!1),yield B(),alert("Категория создана!")}catch(e){console.error("Failed to create category:",e),alert("Ошибка при создании категории")}}),J=e=>d(void 0,null,function*(){try{const t=m.some(t=>t.id===e);console.log(`[PromptsService] Toggling quick access for prompt ${e}, currently in quick: ${t}`),console.log("[PromptsService] Current quick state:",m.map(e=>({id:e.id,title:e.title}))),t?(yield wr.removeFromQuickAccess(e),console.log(`[PromptsService] Removed prompt ${e} from quick access`)):(yield wr.addToQuickAccess(e),console.log(`[PromptsService] Added prompt ${e} to quick access`));const r=yield wr.getQuickAccess();console.log(`[PromptsService] Updated quick access: ${r.length} items`),console.log("[PromptsService] Updated quick access details:",r.map(e=>({id:e.id,title:e.title}))),u(r),yield F();const n=s.find(e=>e.id===R.categoryId);if("Избранное"===(null==n?void 0:n.title)){const e=(yield wr.getAllPrompts()).filter(e=>r.some(t=>t.id===e.id));c(e),console.log(`[PromptsService] Updated favorites list: ${e.length} prompts`),console.log("[PromptsService] Updated favorites details:",e.map(e=>({id:e.id,title:e.title})))}setTimeout(()=>{u([...r])},100),console.log(`[PromptsService] Toggled quick access for prompt ${e}, isInQuick: ${!t}`)}catch(t){console.error("Failed to toggle quick access:",t),alert("Ошибка при добавлении в избранное. Попробуйте еще раз.")}}),X=e=>{window.dispatchEvent(new CustomEvent("chat:insert-prompt",{detail:{id:e.id,body:e.body,title:e.title,settings:e.settings}})),console.log(`Промпт "${e.title}" отправлен в чат${e.settings?" с настройками":""}`)},ee=e=>{const t=e.replace("project:","");window.dispatchEvent(new CustomEvent("workspace:navigate",{detail:{projectName:t}}))},te=()=>{const e=[];return"categories"===R.level?e.push({label:"Все категории",count:s.length}):"category"===R.level&&V?(e.push({label:"Все категории",count:s.length}),e.push({label:V.title,count:Q.length+K.length})):"folder"===R.level&&q?(e.push({label:"Все категории",count:s.length}),e.push({label:(null==V?void 0:V.title)||"",count:0}),e.push({label:q.title,count:Q.length})):"prompt"===R.level&&_&&(e.push({label:"Все категории",count:s.length}),e.push({label:(null==V?void 0:V.title)||"",count:0}),q&&e.push({label:q.title,count:0}),e.push({label:_.title,count:0})),e};return h.jsx(zs,{id:"prompts-service",title:"Промпты",icon:"🗂",status:"inactive",children:h.jsx("div",{className:"flex gap-4 h-full",children:h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:"mb-4",children:h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{className:"platform-input flex-1",placeholder:"✨ Улучшить промпт...",value:f,onChange:e=>y(e.target.value),disabled:p}),h.jsx("button",{className:"prompts-action-button primary",onClick:()=>d(void 0,null,function*(){if(f.trim()){x(!0);try{const e=yield wr.improvePrompt(f);window.dispatchEvent(new CustomEvent("chat:improve-prompt",{detail:{originalPrompt:f,improvedPrompt:e.improvedPrompt,suggestions:e.suggestions,explanation:e.explanation}})),yield B(),y(""),alert('Промпт улучшен, сохранен в категорию "Сгенерированные" и отправлен в чат!')}catch(e){console.error("Failed to improve prompt:",e),alert("Ошибка при улучшении промпта")}finally{x(!1)}}}),disabled:p||!f.trim(),title:"Улучшить промпт и отправить в чат",children:p?"Улучшаю...":"Улучшить"})]})}),h.jsxs("div",{className:"prompts-management-bar",children:[h.jsx("div",{className:"prompts-breadcrumbs",children:te().map((e,t)=>h.jsxs(v.Fragment,{children:[t>0&&h.jsx("span",{className:"prompts-breadcrumb-item",children:"/"}),h.jsx("span",{className:`${t===te().length-1?"prompts-breadcrumb-current":"prompts-breadcrumb-item"} ${t<te().length-1?"clickable":""}`,onClick:()=>{0===t?(M({level:"categories",categoryId:void 0,folderId:void 0,promptId:void 0}),P(null)):1===t&&"categories"!==R.level?U(R.categoryId):2===t&&"prompt"===R.level&&R.folderId&&W(R.folderId)},children:e.label}),e.count>0&&h.jsx("span",{className:"prompts-breadcrumb-count",children:e.count})]},t))}),h.jsxs("div",{className:"prompts-actions",children:[h.jsxs("button",{className:"prompt-favorite-button "+(R.categoryId&&"Избранное"===(null==(e=s.find(e=>e.id===R.categoryId))?void 0:e.title)?"favorited":""),onClick:()=>{const e=s.find(e=>"Избранное"===e.title);e&&U(e.id)},title:`Открыть избранные промпты (${m.length})`,children:[h.jsx("span",{children:"★"}),m.length>0&&h.jsx("span",{className:"favorite-count",children:m.length})]}),h.jsx("button",{className:"prompts-action-button",onClick:()=>d(void 0,null,function*(){try{yield wr.restoreSystemPrompts(),yield B(),alert("Системные промпты восстановлены!")}catch(e){console.error("Failed to restore system prompts:",e),alert("Ошибка при восстановлении системных промптов")}}),title:"Восстановить системные промпты",children:h.jsxs("svg",{className:"icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),h.jsx("path",{d:"M21 3v5h-5"}),h.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),h.jsx("path",{d:"M3 21v-5h5"})]})}),"categories"===R.level&&h.jsxs("button",{className:"create-document-button",onClick:()=>N(!0),title:"Создать категорию",children:[h.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M12 5v14"}),h.jsx("path",{d:"M5 12h14"})]}),h.jsx("span",{children:"Создать категорию"})]}),"category"===R.level&&h.jsxs("button",{className:"create-document-button",onClick:()=>k(!0),title:"Создать промпт",children:[h.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),h.jsx("polyline",{points:"14,2 14,8 20,8"}),h.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),h.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),h.jsx("polyline",{points:"10,9 9,9 8,9"})]}),h.jsx("span",{children:"Создать промпт"})]})]})]}),b&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:h.jsxs("div",{className:"bg-surface rounded-lg p-6 w-96 max-w-full mx-4",children:[h.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Создать категорию"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("input",{className:"platform-input w-full",placeholder:"Название категории",value:S,onChange:e=>C(e.target.value),onKeyPress:e=>"Enter"===e.key&&Y()}),h.jsxs("div",{className:"flex gap-2 justify-end",children:[h.jsx("button",{className:"prompts-action-button",onClick:()=>{N(!1),C("")},children:"Отмена"}),h.jsx("button",{className:"prompts-action-button primary",onClick:Y,disabled:!S.trim(),children:"Создать"})]})]})]})}),w&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:h.jsxs("div",{className:"bg-surface rounded-lg p-6 w-96 max-w-full mx-4 max-h-[80vh] overflow-y-auto",children:[h.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Создать промпт"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("input",{className:"platform-input w-full",placeholder:"Название промпта",value:E,onChange:e=>I(e.target.value)}),h.jsx("textarea",{className:"platform-input w-full min-h-[200px] resize-none",placeholder:"Текст промпта",value:T,onChange:e=>A(e.target.value)}),h.jsxs("div",{className:"flex gap-2 justify-end",children:[h.jsx("button",{className:"prompts-action-button",onClick:()=>{k(!1),I(""),A("")},children:"Отмена"}),h.jsx("button",{className:"prompts-action-button primary",onClick:()=>d(void 0,null,function*(){if(E.trim()&&T.trim())try{const e=R.categoryId;if(!e)return void alert("Выберите категорию для создания промпта");const t=z();console.log("Creating prompt with project:",t,"activeProjectId:",L),yield wr.createPromptInCategory(e,E.trim(),T.trim(),void 0,void 0,t||void 0),I(""),A(""),k(!1),yield B(),alert("Промпт создан!"+(t?` Тег проекта "${t}" добавлен.`:" (проект не определен)"))}catch(e){console.error("Failed to create prompt:",e),alert("Ошибка при создании промпта")}}),disabled:!E.trim()||!T.trim(),children:"Создать"})]})]})]})}),_&&h.jsxs("div",{className:"prompt-detail-view",children:[h.jsxs("div",{className:"prompt-detail-header",children:[h.jsx("h2",{className:"prompt-detail-title",children:"Промпт"}),h.jsxs("div",{className:"prompt-detail-actions",children:[h.jsx("button",{className:"prompt-favorite-button "+(m.some(e=>e.id===_.id)?"favorited":""),onClick:()=>J(_.id),title:m.some(e=>e.id===_.id)?"Убрать из избранного":"Добавить в избранное",children:h.jsx("span",{children:m.some(e=>e.id===_.id)?"★":"☆"})}),h.jsxs("button",{className:"copy-button",onClick:()=>{return e=_,d(void 0,null,function*(){try{yield navigator.clipboard.writeText(e.body),console.log(`Промпт "${e.title}" скопирован в буфер обмена`)}catch(t){console.error("Failed to copy prompt text:",t);const s=document.createElement("textarea");s.value=e.body,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),console.log(`Промпт "${e.title}" скопирован в буфер обмена (fallback)`)}});var e},title:"Копировать текст промпта",children:[h.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),h.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]}),h.jsx("span",{children:"Копировать"})]}),h.jsxs("button",{className:"chat-send-button",onClick:()=>X(_),title:"Отправить в чат",children:[h.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),h.jsx("path",{d:"M22 2 11 13"})]}),h.jsx("span",{className:"text-sm",children:"В чат"})]}),h.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button",onClick:()=>Z(_.id),title:"Удалить промпт",children:h.jsx("span",{className:"platform-button-content",children:h.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M3 6h18"}),h.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),h.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),h.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),h.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]})]}),h.jsxs("div",{className:"prompt-detail-content",children:[h.jsxs("div",{className:"prompt-detail-section",children:[h.jsx("label",{className:"prompt-detail-section-label",children:"Название"}),h.jsx("div",{className:"prompt-detail-section-content prompt-title",children:h.jsx("input",{className:"w-full bg-transparent border-none outline-none text-base font-medium",value:_.title,onChange:e=>d(void 0,null,function*(){try{yield wr.updatePrompt(_.id,{title:e.target.value}),P(l(o({},_),{title:e.target.value}))}catch(t){console.error("Failed to update prompt title:",t)}}),placeholder:"Введите название промпта..."})})]}),h.jsxs("div",{className:"prompt-detail-section",children:[h.jsx("label",{className:"prompt-detail-section-label",children:"Текст промпта"}),h.jsx("div",{className:"prompt-detail-section-content prompt-body",children:h.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none resize-none",value:_.body,onChange:e=>d(void 0,null,function*(){try{yield wr.updatePrompt(_.id,{body:e.target.value}),P(l(o({},_),{body:e.target.value}))}catch(t){console.error("Failed to update prompt body:",t)}}),placeholder:"Введите текст промпта..."})})]}),h.jsxs("div",{className:"prompt-detail-section",children:[h.jsx("label",{className:"prompt-detail-section-label",children:"Теги"}),h.jsxs("div",{className:"prompt-detail-section-content prompt-tags",children:[h.jsx("div",{className:"prompt-detail-tags-list",children:_.tags.map((e,t)=>h.jsxs("div",{className:"prompt-detail-tag-item",children:[h.jsx("span",{className:"prompt-detail-tag "+(e.startsWith("project:")?"project-tag":""),onClick:e.startsWith("project:")?()=>ee(e):void 0,title:e.startsWith("project:")?`Перейти в проект: ${e.replace("project:","")}`:void 0,children:e.startsWith("project:")?e.replace("project:",""):e}),h.jsx("button",{className:"prompt-detail-tag-remove",onClick:()=>d(void 0,null,function*(){try{const e=_.tags.filter((e,s)=>s!==t);yield wr.updatePrompt(_.id,{tags:e}),P(l(o({},_),{tags:e}))}catch(e){console.error("Failed to remove tag:",e)}}),title:"Удалить тег",children:"×"})]},t))}),h.jsx("input",{className:"w-full mt-2 bg-transparent border-none outline-none text-sm",placeholder:"Добавить тег и нажать Enter...",onKeyPress:e=>d(void 0,null,function*(){if("Enter"===e.key){const s=e.target,r=s.value.trim();if(r&&!_.tags.includes(r))try{const e=[..._.tags,r];yield wr.updatePrompt(_.id,{tags:e}),P(l(o({},_),{tags:e})),s.value=""}catch(t){console.error("Failed to update prompt tags:",t)}}})})]})]})]}),h.jsx(kr,{settings:_.settings,onChange:e=>d(void 0,null,function*(){try{yield wr.updatePrompt(_.id,{settings:e}),P(l(o({},_),{settings:e}))}catch(t){console.error("Failed to update prompt settings:",t)}})})]}),h.jsxs("div",{className:"prompts-main-content",children:["categories"===R.level&&h.jsxs("div",{className:"space-y-4",children:[h.jsx("h2",{className:"text-lg font-semibold",children:"Категории"}),h.jsx("div",{className:"space-y-2",children:H.map(e=>{const t=$[e.id]||0,r=s.find(t=>t.id===e.id),n=r&&!r.system&&"Избранное"!==r.title;return h.jsxs("div",{className:"flex items-center justify-between p-3 bg-transparent rounded-lg hover:bg-hover transition-colors",children:[h.jsx("button",{className:"flex-1 text-left",onClick:()=>U(e.id),children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"category-name",children:e.title}),h.jsx("span",{className:"category-count",children:t})]})}),n&&h.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button ml-2",onClick:t=>{var r;t.stopPropagation(),r=e.id,d(void 0,null,function*(){const e=s.find(e=>e.id===r);if(e)if(e.system)alert("Нельзя удалять системные категории");else if("Избранное"!==e.title){if(confirm(`Удалить категорию "${e.title}" и все промпты в ней?`))try{yield wr.deleteCategory(r),yield B()}catch(t){console.error("Failed to delete category:",t),alert("Ошибка при удалении категории")}}else alert('Нельзя удалять категорию "Избранное"')})},title:"Удалить категорию",children:h.jsx("span",{className:"platform-button-content",children:h.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M3 6h18"}),h.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),h.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),h.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),h.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]},e.id)})})]}),"category"===R.level&&h.jsxs("div",{className:"space-y-4",children:[K.length>0&&h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-medium text-text mb-3",children:"Папки"}),h.jsx("div",{className:"space-y-2",children:K.map(e=>h.jsxs("div",{className:"flex items-center justify-between p-3 bg-transparent rounded-lg hover:bg-hover transition-colors",children:[h.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>W(e.id),children:[h.jsxs("h3",{className:"prompt-title",children:["📁 ",e.title]}),h.jsxs("p",{className:"prompt-text",children:[a.filter(t=>t.folderId===e.id).length," промптов"]})]}),h.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button",onClick:()=>{return t=e.id,d(void 0,null,function*(){if(confirm("Удалить эту папку и все промпты в ней?"))try{const e=yield wr.getPromptsInFolder(t);for(const t of e)yield wr.deletePrompt(t.id);yield B()}catch(e){console.error("Failed to delete folder:",e),alert("Ошибка при удалении папки")}});var t},title:"Удалить папку",children:h.jsx("span",{className:"platform-button-content",children:h.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M3 6h18"}),h.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),h.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),h.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),h.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]},e.id))})]}),h.jsxs("div",{children:[h.jsxs("h3",{className:"text-sm font-medium text-text mb-3",children:["Промпты (",Q.length,")"]}),h.jsx("div",{className:"space-y-2",children:Q.map(e=>h.jsxs("div",{className:"flex items-center justify-between p-3 bg-transparent rounded-lg hover:bg-hover transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[h.jsx("div",{className:"prompt-favorite-indicator",onClick:t=>{t.stopPropagation(),J(e.id)},title:m.some(t=>t.id===e.id)?"Убрать из избранного":"Добавить в избранное",children:h.jsx("span",{className:m.some(t=>t.id===e.id)?"":"not-favorited",children:m.some(t=>t.id===e.id)?"★":"☆"})}),h.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>G(e.id),children:[h.jsx("h3",{className:"prompt-title truncate",title:e.title,children:e.title}),h.jsx("p",{className:"prompt-text line-clamp-2",children:e.body||"Пустой промпт"}),e.tags.length>0&&h.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.tags.slice(0,2).map((e,t)=>h.jsx("span",{className:"prompt-tags "+(e.startsWith("project:")?"cursor-pointer hover:bg-primary/20":""),onClick:e.startsWith("project:")?()=>ee(e):void 0,title:e.startsWith("project:")?`Перейти в проект: ${e.replace("project:","")}`:void 0,children:e.startsWith("project:")?e.replace("project:",""):e},t)),e.tags.length>2&&h.jsxs("span",{className:"prompt-text",children:["+",e.tags.length-2]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{className:"chat-send-button",onClick:()=>X(e),title:"Отправить в чат",children:[h.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),h.jsx("path",{d:"M22 2 11 13"})]}),h.jsx("span",{className:"text-sm",children:"В чат"})]}),h.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button",onClick:()=>Z(e.id),title:"Удалить промпт",children:h.jsx("span",{className:"platform-button-content",children:h.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M3 6h18"}),h.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),h.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),h.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),h.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]})]},e.id))})]})]}),"folder"===R.level&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("h3",{className:"text-sm font-medium text-text mb-3",children:["Промпты в папке (",Q.length,")"]}),h.jsx("div",{className:"space-y-2",children:Q.map(e=>h.jsxs("div",{className:"flex items-center justify-between p-3 bg-transparent rounded-lg border border-border hover:bg-hover transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[h.jsx("div",{className:"prompt-favorite-indicator",onClick:t=>{t.stopPropagation(),J(e.id)},title:m.some(t=>t.id===e.id)?"Убрать из избранного":"Добавить в избранное",children:h.jsx("span",{className:m.some(t=>t.id===e.id)?"":"not-favorited",children:m.some(t=>t.id===e.id)?"★":"☆"})}),h.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>G(e.id),children:[h.jsx("h3",{className:"prompt-title truncate",title:e.title,children:e.title}),h.jsx("p",{className:"prompt-text line-clamp-2",children:e.body||"Пустой промпт"}),e.tags.length>0&&h.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.tags.slice(0,2).map((e,t)=>h.jsx("span",{className:"prompt-tags "+(e.startsWith("project:")?"cursor-pointer hover:bg-primary/20":""),onClick:e.startsWith("project:")?()=>ee(e):void 0,title:e.startsWith("project:")?`Перейти в проект: ${e.replace("project:","")}`:void 0,children:e.startsWith("project:")?e.replace("project:",""):e},t)),e.tags.length>2&&h.jsxs("span",{className:"prompt-text",children:["+",e.tags.length-2]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{className:"chat-send-button",onClick:()=>X(e),title:"Отправить в чат",children:[h.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),h.jsx("path",{d:"M22 2 11 13"})]}),h.jsx("span",{className:"text-sm",children:"В чат"})]}),h.jsx("button",{className:"platform-button-base platform-button-danger px-3 py-1.5 text-sm rounded-md sidebar-footer-button",onClick:()=>Z(e.id),title:"Удалить промпт",children:h.jsx("span",{className:"platform-button-content",children:h.jsxs("svg",{className:"w-3.5 h-3.5 icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("path",{d:"M3 6h18"}),h.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),h.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),h.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),h.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})})]})]},e.id))})]})]})]})})})};class Cr{static hexToHsl(e){const t=parseInt(e.slice(1,3),16)/255,s=parseInt(e.slice(3,5),16)/255,r=parseInt(e.slice(5,7),16)/255,n=Math.max(t,s,r),i=Math.min(t,s,r);let a=0,o=0;const l=(n+i)/2;if(n!==i){const e=n-i;switch(o=l>.5?e/(2-n-i):e/(n+i),n){case t:a=(s-r)/e+(s<r?6:0);break;case s:a=(r-t)/e+2;break;case r:a=(t-s)/e+4}a/=6}return{h:360*a,s:100*o,l:100*l}}static hslToHex(e,t,s){const r=e/360,n=t/100,i=s/100,a=(e,t,s)=>(s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e);let o,l,c;if(0===n)o=l=c=i;else{const e=i<.5?i*(1+n):i+n-i*n,t=2*i-e;o=a(t,e,r+1/3),l=a(t,e,r),c=a(t,e,r-1/3)}const d=e=>{const t=Math.round(255*e).toString(16);return 1===t.length?"0"+t:t};return`#${d(o)}${d(l)}${d(c)}`}static getLuminance(e){const t=this.hexToRgb(e);if(!t)return 0;const{r:s,g:r,b:n}=t,[i,a,o]=[s,r,n].map(e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*i+.7152*a+.0722*o}static hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}static generateSurfaceColor(e){const t=this.hexToHsl(e);return t.l>50?this.hslToHex(t.h,t.s,Math.max(t.l-5,10)):this.hslToHex(t.h,t.s,Math.min(t.l+5,90))}static generateBorderColor(e,t){return`rgba(${t?"0,0,0":"255,255,255"}, ${t?.12:.1})`}static generateButtonColors(e,t){const s=this.hexToHsl(e),r=this.hexToHsl(t).l>50;return{primary:e,secondary:this.hslToHex(s.h,s.s,r?Math.min(s.l+20,90):Math.max(s.l-20,10)),hover:this.hslToHex(s.h,s.s,r?Math.max(s.l-10,20):Math.min(s.l+10,80))}}static generateColorScheme(e){const t=this.hexToHsl(e),s=t.l>50,r=this.hslToHex(t.h,Math.min(t.s+10,100),Math.max(t.l-40,5)),n=t.l>90,i=n?"#111827":"#e5e7eb",a=n?"#6b7280":"#9ca3af";return{primary:e,background:r,surface:this.generateSurfaceColor(r),text:i,textSecondary:a,border:this.generateBorderColor(r,s),success:"#10b981",error:"#ef4444"}}static createCustomThemeVariables(e){const t=this.generateColorScheme(e),s=this.hexToHsl(e).l>50;return{"--primary":t.primary,"--background":t.background,"--surface":t.surface,"--text":t.text,"--text-secondary":t.textSecondary,"--border":t.border,"--focus-ring":e,"--focus-border":e,"--selection-bg":s?"#f3f4f6":"#374151","--selection-text":t.text,"--highlight-bg":s?"#f3f4f6":"#374151","--highlight-text":t.text,"--gradient-divider":`linear-gradient(to right, transparent, ${e}, transparent)`,"--gradient-divider-light":`linear-gradient(to right, transparent, ${e}30, transparent)`}}static getContrastIconColor(e){return this.getLuminance(e)>.5?"#111827":"#e5e7eb"}static getContrastIconColorForAccent(e,t=!0){const s=this.getLuminance(e);return t?s>.9?"#111827":"#e5e7eb":s<.1?"#e5e7eb":"#111827"}static getCustomVariablesToRemove(){return["--primary","--background","--surface","--text","--text-secondary","--border","--focus-ring","--focus-border","--selection-bg","--selection-text","--highlight-bg","--highlight-text","--gradient-divider","--gradient-divider-light"]}}class Er{static applyDarkAccent(e){const t=document.documentElement;let s;if(0===e.darkAccentHue&&0===e.lightAccentHue&&50===e.darkBrightness&&50===e.lightBrightness)s="#ffffff";else{const t=50,r=Math.round(t*(e.darkBrightness/100));s=this.hslToHex(e.darkAccentHue,100,r)}if(e.brightnessOverlay){const s=Math.round(e.darkBrightness/100*4),r=Math.round(e.darkBrightness/100*10);t.style.setProperty("--background",`hsl(0, 0%, ${s}%)`),t.style.setProperty("--surface",`hsl(0, 0%, ${r}%)`)}else t.style.removeProperty("--background"),t.style.removeProperty("--surface");const r=Cr.getContrastIconColorForAccent(s,!0);t.style.setProperty("--accent-color",s,"important"),t.style.setProperty("--accent",s,"important"),t.style.setProperty("--focus-ring",s,"important"),t.style.setProperty("--icon-accent",r,"important"),t.style.setProperty("--icon-primary","#e5e7eb","important"),t.style.setProperty("--icon-secondary","#d1d5db","important"),t.style.setProperty("--icon-muted","#9ca3af","important"),t.style.setProperty("--border-active",s,"important"),t.style.setProperty("--selection-bg",`${s}20`,"important"),t.style.setProperty("--slider-active",s,"important"),t.style.setProperty("--slider-thumb",s,"important"),t.style.setProperty("--indicator-border",s,"important"),t.style.setProperty("--indicator-shadow",s,"important"),t.style.setProperty("--indicator-bg","#ffffff","important"),t.classList.remove("theme-accent-light"),t.classList.add("theme-accent-dark")}static applyLightAccent(e){const t=document.documentElement;let s;if(0===e.darkAccentHue&&0===e.lightAccentHue&&50===e.darkBrightness&&50===e.lightBrightness)s="#000000";else{const t=20,r=Math.round(t*(e.lightBrightness/100));s=this.hslToHex(e.lightAccentHue,100,r)}if(e.brightnessOverlay){const s=Math.round(100-e.lightBrightness/100*20),r=Math.round(98-e.lightBrightness/100*10);t.style.setProperty("--background",`hsl(0, 0%, ${s}%)`),t.style.setProperty("--surface",`hsl(0, 0%, ${r}%)`)}else t.style.removeProperty("--background"),t.style.removeProperty("--surface");t.style.setProperty("--accent-color",s,"important"),t.style.setProperty("--accent",s,"important"),t.style.setProperty("--focus-ring",s,"important"),t.style.setProperty("--icon-accent",s,"important"),t.style.setProperty("--icon-primary","#111827","important"),t.style.setProperty("--icon-secondary","#6b7280","important"),t.style.setProperty("--icon-muted","#9ca3af","important"),t.style.setProperty("--border-active",s,"important"),t.style.setProperty("--selection-bg",`${s}20`,"important"),t.style.setProperty("--slider-active",s,"important"),t.style.setProperty("--slider-thumb",s,"important"),t.style.setProperty("--indicator-border",s,"important"),t.style.setProperty("--indicator-shadow",s,"important"),t.classList.remove("theme-accent-dark"),t.classList.add("theme-accent-light")}static applyCustomAccent(e){const t=document.documentElement;let s;if(0===e.darkAccentHue&&0===e.lightAccentHue&&50===e.darkBrightness&&50===e.lightBrightness)s="#ffffff";else{const t=50;s=this.hslToHex(e.darkAccentHue,100,t)}t.style.removeProperty("--global-brightness");const r=Cr.getContrastIconColorForAccent(s,!1);t.style.setProperty("--accent-color",s,"important"),t.style.setProperty("--accent",s,"important"),t.style.setProperty("--focus-ring",s,"important"),t.style.setProperty("--icon-accent",r,"important"),t.style.setProperty("--icon-primary",r,"important"),t.style.setProperty("--icon-secondary",r,"important"),t.style.setProperty("--icon-muted",r,"important"),t.style.setProperty("--border-active",s,"important"),t.style.setProperty("--selection-bg",`${s}20`,"important"),t.style.setProperty("--slider-active",s,"important"),t.style.setProperty("--slider-thumb",s,"important"),t.style.setProperty("--indicator-border",s,"important"),t.style.setProperty("--indicator-shadow",s,"important"),t.style.setProperty("--indicator-bg","#ffffff","important"),t.classList.remove("theme-accent-light","theme-accent-dark"),t.classList.add("theme-accent-custom")}static resetAccentColors(){const e=document.documentElement;e.style.removeProperty("--accent-color"),e.style.removeProperty("--accent"),e.style.removeProperty("--button-primary"),e.style.removeProperty("--focus-ring"),e.style.removeProperty("--icon-accent"),e.style.removeProperty("--icon-primary"),e.style.removeProperty("--icon-secondary"),e.style.removeProperty("--icon-muted"),e.style.removeProperty("--border-active"),e.style.removeProperty("--selection-bg"),e.style.removeProperty("--slider-active"),e.style.removeProperty("--slider-thumb"),e.style.removeProperty("--indicator-border"),e.style.removeProperty("--indicator-shadow"),e.classList.remove("theme-accent-dark","theme-accent-light","theme-accent-custom")}static hslToHex(e,t,s){e/=360,t/=100,s/=100;const r=(1-Math.abs(2*s-1))*t,n=r*(1-Math.abs(6*e%2-1)),i=s-r/2;let a=0,o=0,l=0;0<=e&&e<1/6?(a=r,o=n,l=0):1/6<=e&&e<2/6?(a=n,o=r,l=0):2/6<=e&&e<.5?(a=0,o=r,l=n):.5<=e&&e<4/6?(a=0,o=n,l=r):4/6<=e&&e<5/6?(a=n,o=0,l=r):5/6<=e&&e<1&&(a=r,o=0,l=n);const c=e=>{const t=Math.round(255*(e+i)).toString(16);return 1===t.length?"0"+t:t};return"#"+c(a)+c(o)+c(l)}}class Ir{static loadState(){const e={};try{const t=localStorage.getItem(this.STORAGE_KEYS.DARK_ACCENT_HUE),s=localStorage.getItem(this.STORAGE_KEYS.LIGHT_ACCENT_HUE),r=localStorage.getItem(this.STORAGE_KEYS.DARK_BRIGHTNESS),n=localStorage.getItem(this.STORAGE_KEYS.LIGHT_BRIGHTNESS),i=localStorage.getItem(this.STORAGE_KEYS.ENABLED),a=localStorage.getItem(this.STORAGE_KEYS.BRIGHTNESS_OVERLAY);t&&(e.darkAccentHue=parseInt(t)),s&&(e.lightAccentHue=parseInt(s)),r&&(e.darkBrightness=parseInt(r)),n&&(e.lightBrightness=parseInt(n)),null!==i&&(e.isEnabled="true"===i),null!==a&&(e.brightnessOverlay="true"===a)}catch(t){console.warn("Failed to load accent colors from localStorage:",t)}return e}static saveState(e){try{localStorage.setItem(this.STORAGE_KEYS.DARK_ACCENT_HUE,e.darkAccentHue.toString()),localStorage.setItem(this.STORAGE_KEYS.LIGHT_ACCENT_HUE,e.lightAccentHue.toString()),localStorage.setItem(this.STORAGE_KEYS.DARK_BRIGHTNESS,e.darkBrightness.toString()),localStorage.setItem(this.STORAGE_KEYS.LIGHT_BRIGHTNESS,e.lightBrightness.toString()),localStorage.setItem(this.STORAGE_KEYS.ENABLED,e.isEnabled.toString()),localStorage.setItem(this.STORAGE_KEYS.BRIGHTNESS_OVERLAY,e.brightnessOverlay.toString())}catch(t){console.warn("Failed to save accent colors to localStorage:",t)}}}Ir.STORAGE_KEYS={DARK_ACCENT_HUE:"darkAccentHue",LIGHT_ACCENT_HUE:"lightAccentHue",DARK_BRIGHTNESS:"darkBrightness",LIGHT_BRIGHTNESS:"lightBrightness",ENABLED:"accentColorsEnabled",BRIGHTNESS_OVERLAY:"brightnessOverlay"};class Tr{constructor(){this.state={darkAccentHue:0,lightAccentHue:0,darkBrightness:50,lightBrightness:50,isEnabled:!1,brightnessOverlay:!0},this.loadFromStorage()}static getInstance(){return Tr.instance||(Tr.instance=new Tr),Tr.instance}getDarkAccentHue(){return this.state.darkAccentHue}getLightAccentHue(){return this.state.lightAccentHue}getDarkBrightness(){return this.state.darkBrightness}getLightBrightness(){return this.state.lightBrightness}getState(){return o({},this.state)}getBrightnessOverlay(){return this.state.brightnessOverlay}setDarkAccentHue(e){this.state.darkAccentHue=Math.max(0,Math.min(360,e)),this.saveToStorage(),this.applyAccentColorsIfCurrentTheme("dark")}setLightAccentHue(e){this.state.lightAccentHue=Math.max(0,Math.min(360,e)),this.saveToStorage(),this.applyAccentColorsIfCurrentTheme("light")}setDarkBrightness(e){this.state.darkBrightness=Math.max(0,Math.min(100,e)),this.saveToStorage(),this.applyAccentColorsIfCurrentTheme("dark")}setLightBrightness(e){this.state.lightBrightness=Math.max(0,Math.min(100,e)),this.saveToStorage(),this.applyAccentColorsIfCurrentTheme("light")}setEnabled(e){this.state.isEnabled=e,this.saveToStorage(),this.applyAccentColors()}setBrightnessOverlay(e){this.state.brightnessOverlay=e,this.saveToStorage(),this.applyAccentColors()}setAccentColor(e){const t=this.hexToHsl(e);if(!t)return;const s=t.h;this.state.darkAccentHue=s,this.state.lightAccentHue=s,this.saveToStorage(),this.applyAccentColors()}setDarkContrastAccent(){this.state.darkAccentHue=210,this.saveToStorage(),this.applyAccentColors()}applyAccentColors(){const e=document.documentElement.getAttribute("data-theme");Er.resetAccentColors(),this.state.isEnabled&&("dark"===e?Er.applyDarkAccent(this.state):"light"===e?Er.applyLightAccent(this.state):"custom"===e&&Er.applyCustomAccent(this.state))}hexToHsl(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t)return null;const s=parseInt(t[1],16)/255,r=parseInt(t[2],16)/255,n=parseInt(t[3],16)/255,i=Math.max(s,r,n),a=Math.min(s,r,n);let o=0,l=0;const c=(i+a)/2;if(i!==a){const e=i-a;switch(l=c>.5?e/(2-i-a):e/(i+a),i){case s:o=(r-n)/e+(r<n?6:0);break;case r:o=(n-s)/e+2;break;case n:o=(s-r)/e+4}o/=6}return{h:Math.round(360*o),s:Math.round(100*l),l:Math.round(100*c)}}reset(){this.state={darkAccentHue:0,lightAccentHue:0,darkBrightness:50,lightBrightness:50,isEnabled:!1,brightnessOverlay:!0},this.saveToStorage(),this.applyAccentColors()}loadFromStorage(){const e=Ir.loadState();this.state=o(o({},this.state),e)}saveToStorage(){Ir.saveState(this.state)}applyAccentColorsIfCurrentTheme(e){document.documentElement.getAttribute("data-theme")===e&&this.applyAccentColors()}}const Ar=Tr.getInstance();class Rr{constructor(){this.currentTheme="dark"}static getInstance(){return Rr.instance||(Rr.instance=new Rr),Rr.instance}getThemeColors(e){switch(e){case"dark":return{primary:"#ffffff",background:"#000000",surface:"#1a1a1a",text:"#ffffff",textSecondary:"#ffffff",border:"rgba(255,255,255,0.1)"};case"light":return{primary:"#000000",background:"#ffffff",surface:"#ffffff",text:"#000000",textSecondary:"#000000",border:"rgba(0,0,0,0.1)"};case"custom":return{primary:"#000000",background:"#000000",surface:"#1a1a1a",text:"#ffffff",textSecondary:"#ffffff",border:"rgba(255,255,255,0.10)"};default:return this.getThemeColors("dark")}}applyTheme(e){this.currentTheme=e;const t=this.getThemeColors(e);document.documentElement.setAttribute("data-theme",e),this.setCSSVariables(t)}setCSSVariables(e){const t=document.documentElement;t.style.setProperty("--background",e.background),t.style.setProperty("--surface",e.surface),t.style.setProperty("--text",e.text),t.style.setProperty("--text-secondary",e.textSecondary),t.style.setProperty("--border",e.border),t.style.setProperty("--secondary",this.mixColors(e.primary,e.background,.8)),t.style.setProperty("--accent",this.mixColors(e.primary,e.background,.6)),t.style.setProperty("--text-muted",this.mixColors(e.text,e.background,.6)),t.style.setProperty("--border-light",this.mixColors(e.border,"transparent",.5)),t.style.setProperty("--border-strong",this.mixColors(e.border,"transparent",2)),t.style.setProperty("--border-active",this.mixColors(e.primary,"transparent",.6)),t.style.setProperty("--surface-hover",this.mixColors(e.surface,e.primary,.1)),t.style.setProperty("--icon-primary",e.text),t.style.setProperty("--icon-secondary",e.textSecondary),t.style.setProperty("--icon-accent",e.primary)}mixColors(e,t,s){return e}getCurrentTheme(){return this.currentTheme}setCustomColor(e){if("custom"===this.currentTheme){const t=document.documentElement,s=t.style.getPropertyValue("--background")||"#0a0a0a";t.style.setProperty("--secondary",this.mixColors(e,s,.8)),t.style.setProperty("--accent",this.mixColors(e,s,.6)),t.style.setProperty("--icon-accent",e)}}}const Mr=Rr.getInstance(),_r=class e{constructor(){this.settings={},this.listeners=new Map,this.loadSettings()}static getInstance(){return e.instance||(e.instance=new e),e.instance}loadSettings(){try{const t=localStorage.getItem("barsukov-settings"),s=localStorage.getItem("barsukov-settings-version");if(t){const r=JSON.parse(t);s!==e.SETTINGS_VERSION&&(console.log("Выполняется миграция настроек..."),this.migrateSettings(r,s)),this.settings=o(o({},this.getDefaultSettings()),r),this.saveSettings()}else this.settings=this.getDefaultSettings(),this.saveSettings()}catch(t){console.error("Ошибка загрузки настроек:",t),this.settings=this.getDefaultSettings(),this.saveSettings()}}migrateSettings(t,s){if(!s){const e=this.getDefaultSettings();Object.keys(e).forEach(s=>{s in t||(t[s]=e[s])})}localStorage.setItem("barsukov-settings-version",e.SETTINGS_VERSION)}saveSettings(){try{localStorage.setItem("barsukov-settings",JSON.stringify(this.settings))}catch(e){console.error("Ошибка сохранения настроек:",e)}}getDefaultSettings(){return{theme:"dark",customColor:"#000000",accentsEnabled:!1,accentColor:"#000000",useColoredText:!1,textColor:"#000000",sidebarCollapsed:!1,sidebarWidth:280,notifications:!0,animations:!0,chatWidth:350,chatInputHeight:300,workspaceLayout:"grid",autoSave:!0,showTimestamps:!0,enableVoice:!0,enableFileUpload:!0,maxMessages:100,autoScroll:!0,brightnessOverlay:!0,hideChatFunctionButtons:!1}}getSetting(e){return this.settings[e]}validateSetting(e,t){const s={theme:e=>["dark","light","custom"].includes(e),customColor:e=>"string"==typeof e&&/^#[0-9A-Fa-f]{6}$/.test(e),accentColor:e=>"string"==typeof e&&/^#[0-9A-Fa-f]{6}$/.test(e),textColor:e=>"string"==typeof e&&/^#[0-9A-Fa-f]{6}$/.test(e),sidebarWidth:e=>"number"==typeof e&&e>=200&&e<=500,chatWidth:e=>"number"==typeof e&&e>=250&&e<=2e3,chatInputHeight:e=>"number"==typeof e&&e>=256&&e<=1200,maxMessages:e=>"number"==typeof e&&e>=50&&e<=1e3,workspaceLayout:e=>["grid","list","compact"].includes(e)}[e];return!s||s(t)}setSetting(e,t){return d(this,null,function*(){if(!this.validateSetting(e,t))throw new Error(`Некорректное значение для настройки ${e}: ${t}`);if(this.settings[e]=t,this.saveSettings(),this.notifyListeners(e,t),"theme"===e){const e=this.settings.theme||"dark";Mr.applyTheme(e)}if("customColor"===e&&"custom"===this.settings.theme){const e=this.settings.customColor;Mr.setCustomColor(e)}"brightnessOverlay"===e&&Ar.setBrightnessOverlay(t)})}getAllSettings(){return o({},this.settings)}resetSettings(){this.settings=this.getDefaultSettings(),this.saveSettings(),this.notifyAllListeners()}subscribe(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{var s;null==(s=this.listeners.get(e))||s.delete(t)}}notifyListeners(e,t){var s;null==(s=this.listeners.get(e))||s.forEach(e=>e(t))}notifyAllListeners(){this.listeners.forEach((e,t)=>{e.forEach(e=>e(this.settings[t]))})}getUserPreferences(){return{theme:this.getSetting("theme")||"dark",sidebarCollapsed:this.getSetting("sidebarCollapsed")||!1,notifications:this.getSetting("notifications")||!0,animations:this.getSetting("animations")||!0,sounds:this.getSetting("sounds")||!0}}updateUserPreferences(e){Object.entries(e).forEach(([e,t])=>{this.setSetting(e,t)})}getSettingsCategories(){return[{id:"appearance",name:"Внешний вид",description:"Тема и шрифты",icon:"appearance",items:[{id:"theme",name:"Тема",description:"Схема",type:"theme-buttons",value:this.getSetting("theme"),onChange:e=>this.setSetting("theme",e)},{id:"animations",name:"Анимации",description:"Плавно",type:"boolean",value:this.getSetting("animations"),onChange:e=>this.setSetting("animations",e)},{id:"autoSave",name:"Автосохранение",description:"Авто",type:"boolean",value:this.getSetting("autoSave"),onChange:e=>this.setSetting("autoSave",e)},{id:"customColor",name:"Кастомный цвет",description:"Свой",type:"color",value:this.getSetting("customColor"),onChange:e=>this.setSetting("customColor",e)},{id:"accentsEnabled",name:"Акцентные цвета",description:"Акценты",type:"boolean",value:this.getSetting("accentsEnabled"),onChange:e=>this.setSetting("accentsEnabled",e)},{id:"accentColor",name:"Цвет акцентов",description:"Цвет",type:"color",value:this.getSetting("accentColor"),onChange:e=>this.setSetting("accentColor",e)},{id:"useColoredText",name:"Цветной текст",description:"Цветной",type:"boolean",value:this.getSetting("useColoredText"),onChange:e=>this.setSetting("useColoredText",e)},{id:"textColor",name:"Цвет текста",description:"Текст",type:"color",value:this.getSetting("textColor"),onChange:e=>this.setSetting("textColor",e)},{id:"sidebarCollapsed",name:"Свернутый сайдбар",description:"Свернуть",type:"boolean",value:this.getSetting("sidebarCollapsed"),onChange:e=>this.setSetting("sidebarCollapsed",e)},{id:"sidebarWidth",name:"Ширина сайдбара",description:"Пиксели",type:"number",value:this.getSetting("sidebarWidth"),min:256,max:500,step:10,onChange:e=>this.setSetting("sidebarWidth",e)},{id:"workspaceLayout",name:"Макет рабочего пространства",description:"Макет",type:"select",value:this.getSetting("workspaceLayout"),options:[{label:"Сетка",value:"grid"},{label:"Список",value:"list"},{label:"Компактный",value:"compact"}],onChange:e=>this.setSetting("workspaceLayout",e)}]},{id:"chat",name:"Чат",description:"Чат",icon:"chat",items:[{id:"chatWidth",name:"Ширина чата",description:"Пиксели",type:"number",value:this.getSetting("chatWidth"),min:250,max:2e3,step:10,onChange:e=>this.setSetting("chatWidth",e)},{id:"chatInputHeight",name:"Высота поля ввода",description:"Пиксели",type:"number",value:this.getSetting("chatInputHeight"),min:256,max:1200,step:10,onChange:e=>this.setSetting("chatInputHeight",e)},{id:"showTimestamps",name:"Показывать время",description:"Время",type:"boolean",value:this.getSetting("showTimestamps"),onChange:e=>this.setSetting("showTimestamps",e)},{id:"autoScroll",name:"Автопрокрутка",description:"Прокрутка",type:"boolean",value:this.getSetting("autoScroll"),onChange:e=>this.setSetting("autoScroll",e)},{id:"maxMessages",name:"Максимум сообщений",description:"Максимум",type:"number",value:this.getSetting("maxMessages"),min:50,max:1e3,step:50,onChange:e=>this.setSetting("maxMessages",e)},{id:"enableVoice",name:"Голосовые сообщения",description:"Голос",type:"boolean",value:this.getSetting("enableVoice"),onChange:e=>this.setSetting("enableVoice",e)},{id:"enableFileUpload",name:"Загрузка файлов",description:"Файлы",type:"boolean",value:this.getSetting("enableFileUpload"),onChange:e=>this.setSetting("enableFileUpload",e)},{id:"hideChatFunctionButtons",name:"Скрыть кнопки функций",description:"Скрыть кнопки функций в чате",type:"boolean",value:this.getSetting("hideChatFunctionButtons"),onChange:e=>this.setSetting("hideChatFunctionButtons",e)}]},{id:"notifications",name:"Уведомления",description:"Уведомления",icon:"notifications",items:[{id:"notifications",name:"Уведомления",description:"Включить",type:"boolean",value:this.getSetting("notifications"),onChange:e=>this.setSetting("notifications",e)}]}]}exportSettings(){return JSON.stringify(this.settings,null,2)}importSettings(e){try{const t=JSON.parse(e);return this.settings=o(o({},this.getDefaultSettings()),t),this.saveSettings(),this.notifyAllListeners(),!0}catch(t){return console.error("Ошибка импорта настроек:",t),!1}}};_r.SETTINGS_VERSION="1.0.0";const Pr=_r.getInstance();class Lr{constructor(){this.themes=new Map,this.currentTheme="dark",this.initializeDefaultThemes()}static getInstance(){return Lr.instance||(Lr.instance=new Lr),Lr.instance}initializeDefaultThemes(){this.themes.set("light",this.createThemeConfig("light","#111827","#ffffff","Светлая")),this.themes.set("dark",this.createThemeConfig("dark","#e5e7eb","#0a0a0a","Темная"))}createThemeConfig(e,t,s,r){const n=Cr.getLuminance(s)>.5,i=n?"#000000":"#ffffff";return{id:e,name:r,colors:{primary:t,secondary:Cr.generateButtonColors(t,s).secondary,accent:Cr.generateButtonColors(t,s).secondary,background:s,surface:Cr.generateSurfaceColor(s),text:i,textSecondary:n?"#6b7280":"#9ca3af",border:Cr.generateBorderColor(s,n),success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#10b981"},isCustom:!1}}getThemes(){return Array.from(this.themes.values())}getTheme(e){return this.themes.get(e)}createCustomTheme(e){const t=Cr.generateColorScheme(e),s={id:"custom",name:"Цветная",colors:l(o({},t),{text:"#ffffff",secondary:Cr.generateButtonColors(e,t.background).secondary,accent:Cr.generateButtonColors(e,t.background).secondary,warning:"#f59e0b",info:t.success}),isCustom:!0};return this.themes.set("custom",s),s}applyColoredText(e){document.documentElement.style.setProperty("--text",e)}resetColoredText(){const e=document.documentElement,t=e.getAttribute("data-theme")||"dark",s=this.getTheme(t);s&&e.style.setProperty("--text",s.colors.text)}applyTheme(e,t,s,r,n,i){const a=document.documentElement;a.classList.add("theme-transitioning"),requestAnimationFrame(()=>{a.getAttribute("data-theme")!==e&&a.setAttribute("data-theme",e),"custom"===e&&t?this.applyCustomTheme(t):this.applyStandardTheme(e),setTimeout(()=>{a.classList.remove("theme-transitioning"),s&&r?this.applyColoredText(r):this.resetColoredText(),n&&i?(Ar.setAccentColor(i),Ar.applyAccentColors()):Ar.getState().isEnabled&&Ar.applyAccentColors()},500)})}applyCustomTheme(e){const t=document.documentElement,s=Cr.createCustomThemeVariables(e);Object.entries(s).forEach(([e,s])=>{t.style.setProperty(e,s)})}applyStandardTheme(e){const t=document.documentElement;Cr.getCustomVariablesToRemove().forEach(e=>{t.style.removeProperty(e)}),t.setAttribute("data-theme",e)}getCurrentTheme(){return this.currentTheme}resetCustomTheme(){this.themes.delete("custom"),"custom"===this.currentTheme&&(this.currentTheme="dark",this.applyTheme("dark"))}}Lr.getInstance();const Or=()=>{const{updateSettings:e}=j(),[t,s]=g.useState(!1),[r,n]=g.useState(!1),[i,a]=g.useState(!1),[o,l]=g.useState(""),c=g.useRef(null),m=Pr.getAllSettings(),h=g.useCallback((t,r)=>d(void 0,null,function*(){try{a(!0),yield Pr.setSetting(t,r),e(t,r),s(!0)}catch(n){console.error("Ошибка изменения настройки:",n)}finally{a(!1)}}),[e]),u=g.useCallback(()=>{s(!1),n(!0),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>n(!1),2e3)},[]),p=g.useCallback(()=>d(void 0,null,function*(){if(confirm("Вы уверены, что хотите сбросить все настройки к значениям по умолчанию?"))try{a(!0),Pr.resetSettings(),s(!1),window.location.reload()}catch(e){console.error("Ошибка сброса настроек:",e)}finally{a(!1)}}),[]),x=g.useCallback(()=>{try{const e=Pr.exportSettings(),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`barsukov-settings-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(s)}catch(e){console.error("Ошибка экспорта настроек:",e)}},[]),v=g.useCallback(e=>{var t;const r=null==(t=e.target.files)?void 0:t[0];if(r){const e=new FileReader;e.onload=e=>{var t;try{const r=null==(t=e.target)?void 0:t.result;Pr.importSettings(r)?(s(!1),setTimeout(()=>window.location.reload(),100)):alert("Ошибка импорта настроек. Проверьте формат файла.")}catch(r){console.error("Ошибка импорта:",r),alert("Ошибка импорта настроек")}},e.readAsText(r)}},[]),f=g.useCallback(e=>{l(e)},[]),y=g.useCallback((e,t)=>{const s=m[e];Pr.setSetting(e,t),setTimeout(()=>{Pr.setSetting(e,s)},3e3)},[m]);return g.useEffect(()=>()=>{c.current&&clearTimeout(c.current)},[]),{settings:m,hasUnsavedChanges:t,showSaveSuccess:r,isLoading:i,searchQuery:o,handleSettingChange:h,updateSetting:h,handleSave:u,handleReset:p,handleExport:x,handleImport:v,searchSettings:f,previewChanges:y}},$r=({title:e,description:t,children:s,className:r})=>h.jsxs("div",{className:Te("p-4 settings-card",r),children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:e}),t&&h.jsx("p",{className:"text-xs text-text-secondary mt-1",children:t})]}),h.jsx("div",{className:"space-y-3",children:s})]}),Dr=({service:e,onSettingChange:t,className:s})=>{const r=e.config.settings||{},n=(s,r)=>{const n=`${e.config.id}.${s}`;return"boolean"==typeof r?h.jsx(Qs,{item:{id:n,name:s,description:`Настройка для ${e.config.name}`,type:"boolean",value:r,onChange:e=>t(n,e)},onChange:t},n):"string"==typeof r?h.jsx(Qs,{item:{id:n,name:s,description:`Настройка для ${e.config.name}`,type:"string",value:r,onChange:e=>t(n,e)},onChange:t},n):"number"==typeof r?h.jsx(Qs,{item:{id:n,name:s,description:`Настройка для ${e.config.name}`,type:"number",value:r,min:0,max:100,step:1,onChange:e=>t(n,e)},onChange:t},n):Array.isArray(r)?h.jsx(Qs,{item:{id:n,name:s,description:`Настройка для ${e.config.name}`,type:"select",value:r[0]||"",options:r.map((e,t)=>({value:e,label:"string"==typeof e?e:`Опция ${t+1}`})),onChange:e=>t(n,e)},onChange:t},n):null};return 0===Object.keys(r).length?null:h.jsx("div",{className:Te("service-settings",s),children:h.jsx($r,{title:e.config.name,description:"Настройки сервиса",className:"mb-6",children:h.jsx("div",{className:"space-y-4",children:Object.entries(r).map(([e,t])=>h.jsx("div",{children:n(e,t)},e))})})})},zr=g.createContext(null),Br=({children:e})=>{const[t,s]=g.useState([]);g.useEffect(()=>{(()=>{const e=L.getAllServices().filter(e=>e.config.settings&&Object.keys(e.config.settings).length>0);s(e)})();return L.onServiceRegistered(e=>{e.config.settings&&Object.keys(e.config.settings).length>0&&s(t=>[...t,e])}),L.onServiceUnregistered(e=>{s(t=>t.filter(t=>t.config.id!==e))}),()=>{}},[]);const r={serviceSettings:t,registerServiceSettings:e=>{s(t=>t.some(t=>t.config.id===e.config.id)?t.map(t=>t.config.id===e.config.id?e:t):[...t,e])},unregisterServiceSettings:e=>{s(t=>t.filter(t=>t.config.id!==e))},getServiceSettings:e=>t.find(t=>t.config.id===e)||null};return h.jsx(zr.Provider,{value:r,children:e})},Fr=({showAdvanced:e,searchQuery:t})=>(Or(),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[h.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:h.jsx(nt,{className:"w-4 h-4 text-primary dark:text-white"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-lg font-semibold text-text",children:"Расширенные настройки"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Продвинутые параметры для опытных пользователей"})]})]}),h.jsx("div",{className:"p-4 rounded-lg bg-yellow-500/10 border border-yellow-500/20",children:h.jsxs("div",{className:"flex items-start space-x-3",children:[h.jsx(Pe,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-yellow-500 mb-1",children:"Внимание"}),h.jsx("div",{className:"text-sm text-text-secondary",children:"Изменение этих настроек может повлиять на работу платформы. Будьте осторожны при изменении значений."})]})]})}),h.jsx($r,{title:"Отладка",description:"Настройки для разработчиков и отладки",className:"mb-6",children:h.jsx("div",{className:"space-y-4",children:h.jsx("div",{className:"text-sm text-text-secondary",children:"Настройки отладки будут добавлены в будущих версиях."})})}),h.jsx($r,{title:"API",description:"Настройки API и интеграций",className:"mb-6",children:h.jsx("div",{className:"space-y-4",children:h.jsx("div",{className:"text-sm text-text-secondary",children:"Настройки API будут добавлены в будущих версиях."})})}),h.jsx($r,{title:"Экспериментальные функции",description:"Функции в разработке (могут быть нестабильными)",className:"mb-6",children:h.jsx("div",{className:"space-y-4",children:h.jsx("div",{className:"text-sm text-text-secondary",children:"Экспериментальные функции будут добавлены в будущих версиях."})})})]})),Hr=({showAdvanced:e,searchQuery:t})=>{const{settings:s,updateSetting:r}=Or(),n=[{id:"animations",name:"Анимации",description:"Плавно",type:"boolean",value:s.animations,onChange:e=>i("animations",e)}],i=(e,t)=>{r(e,t)};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[h.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:h.jsx(At,{className:"w-4 h-4 text-primary dark:text-white"})}),h.jsx("div",{children:h.jsx("h2",{className:"text-lg font-semibold text-text",children:"Внешний вид"})})]}),h.jsx($r,{title:"Тема",className:"mb-6",children:h.jsx(Qs,{item:{id:"theme",name:"Цветовая тема",description:"Схема",type:"select",value:s.theme||"dark",options:[{value:"light",label:"Светлая"},{value:"dark",label:"Темная"}],onChange:e=>i("theme",e)},onChange:i})}),h.jsx($r,{title:"Анимации",className:"mb-6",children:h.jsx(Qs,{item:n[0],onChange:i})}),e&&h.jsx($r,{title:"Дополнительные настройки",description:"Дополнительно",className:"mb-6",children:h.jsx("div",{className:"text-sm text-text-secondary",children:"Дополнительные настройки внешнего вида будут добавлены в будущих версиях."})})]})},Ur=({showAdvanced:e,searchQuery:t})=>{const{settings:s,updateSetting:r}=Or(),n=(e,t)=>{r(e,t)},i=[{key:"animations",label:"Анимации",type:"boolean",value:s.animations,icon:ls,onChange:e=>n("animations",e)},{key:"autoSave",label:"Автосохранение",type:"boolean",value:s.autoSave,icon:Bt,onChange:e=>n("autoSave",e)},{key:"useColoredText",label:"Цветной текст",type:"boolean",value:s.useColoredText,icon:es,onChange:e=>n("useColoredText",e)}];return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[h.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:h.jsx(ze,{className:"w-4 h-4 text-primary dark:text-white"})}),h.jsx("div",{children:h.jsx("h2",{className:"text-lg font-semibold text-text",children:"Поведение"})})]}),h.jsx($r,{title:"Звуки и уведомления",className:"mb-6",children:h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.filter(e=>["sounds","notifications"].includes(e.key)).map(e=>h.jsxs("div",{className:"flex items-center space-x-3 p-3 settings-card hover:bg-surface-hover transition-colors",children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx(e.icon,{className:"w-4 h-4 text-text-secondary"})}),h.jsx("div",{className:"flex-1 min-w-0",children:h.jsx("div",{className:"text-sm font-medium text-text",children:e.label})}),h.jsx("div",{className:"flex-shrink-0",children:h.jsx(Qs,{item:{id:e.key,name:"",description:"",type:"boolean",value:e.value||!1,onChange:t=>e.onChange(t)},onChange:n,className:"!p-0"})})]},e.key))})}),h.jsxs($r,{title:"Автосохранение",className:"mb-6",children:[h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.filter(e=>"autoSave"===e.key).map(e=>h.jsxs("div",{className:"flex items-center space-x-3 p-3 settings-card hover:bg-surface-hover transition-colors",children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx(e.icon,{className:"w-4 h-4 text-text-secondary"})}),h.jsx("div",{className:"flex-1 min-w-0",children:h.jsx("div",{className:"text-sm font-medium text-text",children:e.label})}),h.jsx("div",{className:"flex-shrink-0",children:h.jsx(Qs,{item:{id:e.key,name:"",description:"",type:"boolean",value:e.value||!1,onChange:t=>e.onChange(t)},onChange:n,className:"!p-0"})})]},e.key))}),h.jsx("div",{className:"mt-4",children:h.jsx(Qs,{item:{id:"autoSaveInterval",name:"Интервал автосохранения",type:"select",value:s.autoSaveInterval||5e3,options:[{value:1e3,label:"1 секунда"},{value:5e3,label:"5 секунд"},{value:1e4,label:"10 секунд"},{value:3e4,label:"30 секунд"},{value:6e4,label:"1 минута"}],onChange:e=>n("autoSaveInterval",e)},onChange:n})})]}),e&&h.jsx($r,{title:"Дополнительные настройки",className:"mb-6",children:h.jsx("div",{className:"text-sm text-text-secondary",children:"Дополнительные настройки поведения будут добавлены в будущих версиях."})})]})},Wr=({items:e,onSettingChange:t})=>h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(e=>h.jsxs("div",{className:"flex items-center space-x-3 p-3 settings-card hover:bg-surface-hover transition-colors",children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx(e.icon,{className:"w-4 h-4 text-text-secondary dark:text-white"})}),h.jsx("div",{className:"flex-1 min-w-0",children:h.jsx("div",{className:"text-sm font-medium text-text",children:e.label})}),h.jsx("div",{className:"flex-shrink-0",children:h.jsx(Qs,{item:{id:e.key,name:"",description:"",type:"boolean",value:e.value||!1,onChange:s=>t(e.key,s)},onChange:t,className:"!p-0"})})]},e.key))}),Gr=({showAdvanced:e,searchQuery:t})=>{const{settings:s,updateSetting:r}=Or(),n=[{key:"sidebarCollapsed",title:"Свернутый сайдбар",description:"Свернуть боковую панель по умолчанию - скрывает левую панель навигации",type:"boolean",value:s.sidebarCollapsed,icon:Rt},{key:"chatVisible",title:"Видимость чата",description:"Показывать панель чата по умолчанию - отображает правую панель чата",type:"boolean",value:s.chatVisible,icon:kt},{key:"workspaceLayout",title:"Макет рабочего пространства",description:"Сетка или список для проектов",type:"boolean",value:"grid"===s.workspaceLayout,icon:Ct}],i=(e,t)=>{r(e,t)};return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[h.jsx(Ct,{className:"w-4 h-4 text-primary dark:text-white"}),h.jsx("h2",{className:"text-base font-medium text-text",children:"Макет"})]}),h.jsxs($r,{title:"Размеры панелей",className:"mb-4",children:[h.jsx(Qs,{item:{id:"chatWidth",name:"Ширина чата",description:"Ширина панели чата в пикселях",type:"number",value:s.chatWidth||400,min:250,max:2e3,step:10,onChange:e=>i("chatWidth",e)},onChange:i}),h.jsx(Qs,{item:{id:"chatInputHeight",name:"Высота поля ввода",description:"Высота поля ввода чата в пикселях",type:"number",value:s.chatInputHeight||300,min:256,max:800,step:10,onChange:e=>i("chatInputHeight",e)},onChange:i}),h.jsx(Qs,{item:{id:"sidebarWidth",name:"Ширина сайдбара",description:"Ширина боковой панели в пикселях",type:"number",value:s.sidebarWidth||300,min:256,max:600,step:10,onChange:e=>i("sidebarWidth",e)},onChange:i})]}),h.jsx($r,{title:"Видимость панелей",className:"mb-4",children:h.jsx(Wr,{items:n,onSettingChange:i})}),e&&h.jsx($r,{title:"Дополнительные настройки",className:"mb-6",children:h.jsx("div",{className:"text-sm text-text-secondary",children:"Дополнительные настройки макета будут добавлены в будущих версиях."})})]})},Vr=({showAdvanced:e,searchQuery:t})=>h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[h.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:h.jsx(Wt,{className:"w-4 h-4 text-primary dark:text-white"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-lg font-semibold text-text",children:"Система"}),h.jsx("p",{className:"text-sm text-text-secondary",children:"Системные настройки и информация"})]})]}),h.jsx($r,{title:"Информация о системе",description:"Информация о платформе и версии",className:"mb-6",children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between p-3 settings-card",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(ut,{className:"w-4 h-4 text-text-secondary"}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-text",children:"Версия платформы"}),h.jsx("div",{className:"text-xs text-text-secondary",children:"1.0.0"})]})]}),h.jsx("div",{className:"text-sm text-text-secondary",children:"v1.0.0"})]}),h.jsxs("div",{className:"flex items-center justify-between p-3 settings-card",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(et,{className:"w-4 h-4 text-text-secondary"}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-text",children:"Размер данных"}),h.jsx("div",{className:"text-xs text-text-secondary",children:"Настройки и кэш"})]})]}),h.jsx("div",{className:"text-sm text-text-secondary",children:"~2.5 MB"})]})]})}),h.jsx($r,{title:"Безопасность",description:"Настройки безопасности и приватности",className:"mb-6",children:h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex items-center justify-between p-3 settings-card",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Vt,{className:"w-4 h-4 text-text-secondary"}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-text",children:"Шифрование данных"}),h.jsx("div",{className:"text-xs text-text-secondary",children:"Все данные зашифрованы"})]})]}),h.jsx("div",{className:"text-sm text-green-500",children:"Активно"})]})})}),h.jsx($r,{title:"Производительность",description:"Настройки производительности системы",className:"mb-6",children:h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex items-center justify-between p-3 settings-card",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Wt,{className:"w-4 h-4 text-text-secondary"}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-text",children:"Кэширование"}),h.jsx("div",{className:"text-xs text-text-secondary",children:"Включено для ускорения работы"})]})]}),h.jsx("div",{className:"text-sm text-green-500",children:"Включено"})]})})}),e&&h.jsx($r,{title:"Дополнительные настройки",description:"Расширенные системные параметры",className:"mb-6",children:h.jsx("div",{className:"text-sm text-text-secondary",children:"Дополнительные системные настройки будут добавлены в будущих версиях."})})]}),qr=({selectedCategory:e,showAdvanced:t,searchQuery:s})=>{const{serviceSettings:r}=g.useContext(zr)||(console.warn("useServiceSettings используется вне ServiceSettingsProvider, возвращаем значения по умолчанию"),{serviceSettings:[],registerServiceSettings:()=>{},getServiceSettings:()=>null});return h.jsx("div",{className:"p-6",children:(()=>{switch(e){case"appearance":return h.jsx(Hr,{category:{id:"appearance",name:"Внешний вид",description:"Настройки темы, шрифтов и отображения",icon:"Palette",items:[]},showAdvanced:t,searchQuery:s});case"interface":return h.jsx(Gr,{category:{id:"interface",name:"Интерфейс",description:"Настройки панелей и макета",icon:"Layout",items:[]},showAdvanced:t,searchQuery:s});case"chat":return h.jsx(Ur,{category:{id:"chat",name:"Чат",description:"Настройки чата и сообщений",icon:"MessageSquare",items:[]},showAdvanced:t,searchQuery:s});case"notifications":return h.jsx(Vr,{category:{id:"notifications",name:"Уведомления",description:"Настройки уведомлений и звуков",icon:"Bell",items:[]},showAdvanced:t,searchQuery:s});case"services":return h.jsxs("div",{className:"space-y-6",children:[h.jsx("h2",{className:"text-lg font-semibold text-text",children:"Настройки сервисов"}),r.map(e=>h.jsx(Dr,{service:e,onSettingChange:(e,t)=>{console.log(`Изменение настройки ${e}:`,t)}},e.config.id)),0===r.length&&h.jsx("div",{className:"text-center py-8 text-text-secondary",children:"Нет доступных настроек сервисов"})]});default:return h.jsxs("div",{className:"space-y-6",children:[h.jsx(Hr,{category:{id:"appearance",name:"Внешний вид",description:"Настройки темы, шрифтов и отображения",icon:"Palette",items:[]},showAdvanced:t,searchQuery:s}),h.jsx(Gr,{category:{id:"interface",name:"Интерфейс",description:"Настройки панелей и макета",icon:"Layout",items:[]},showAdvanced:t,searchQuery:s}),h.jsx(Ur,{category:{id:"chat",name:"Чат",description:"Настройки чата и сообщений",icon:"MessageSquare",items:[]},showAdvanced:t,searchQuery:s}),h.jsx(Vr,{category:{id:"notifications",name:"Уведомления",description:"Настройки уведомлений и звуков",icon:"Bell",items:[]},showAdvanced:t,searchQuery:s}),t&&h.jsx(Fr,{category:{id:"advanced",name:"Расширенные",description:"Продвинутые параметры для опытных пользователей",icon:"Settings",items:[]},showAdvanced:t,searchQuery:s})]})}})()})},Kr=({className:e})=>{const{settingsState:t}=(()=>{const{updateSetting:e}=Or(),{state:t,setActiveSettingsCategory:s}=j(),[r,n]=g.useState(!1),[i,a]=g.useState(""),[o,l]=g.useState(!1),[c,m]=g.useState(!1),h=t.layout.activeSettingsCategory,u=g.useCallback(()=>{n(e=>!e)},[]),p=g.useCallback(e=>{s(e||"all")},[s]),x=g.useCallback((t,s)=>{e(t,s)},[e]);return{settingsState:{searchQuery:i,showAdvanced:r,selectedCategory:h||"all",isExporting:o,isImporting:c},settingsActions:{setSearchQuery:a,toggleAdvanced:u,selectCategory:p,exportSettings:g.useCallback(()=>d(void 0,null,function*(){l(!0);try{const e=JSON.stringify(t.settings,null,2),s=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(s),n=document.createElement("a");n.href=r,n.download="barsukov-platform-settings.json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}catch(e){console.error("Ошибка экспорта настроек:",e)}finally{l(!1)}}),[t.settings]),importSettings:g.useCallback(t=>d(void 0,null,function*(){m(!0);try{const s=yield t.text(),r=JSON.parse(s);Object.entries(r).forEach(([t,s])=>{e(t,s)})}catch(s){console.error("Ошибка импорта настроек:",s)}finally{m(!1)}}),[e]),resetSettings:g.useCallback(()=>{if(confirm("Вы уверены, что хотите сбросить все настройки?")){const t={theme:"light",fontSize:"medium",sidebarCollapsed:!1,sidebarWidth:280};Object.entries(t).forEach(([t,s])=>{e(t,s)})}},[e])},handleSettingChange:x}})();return h.jsx(Br,{children:h.jsxs("div",{className:Te("settings-container h-full flex flex-col",e),children:[h.jsxs("div",{className:"platform-service-header-standard",children:[h.jsxs("div",{className:"platform-service-header-content",children:[h.jsx("div",{className:"platform-service-icon",children:"⚙️"}),h.jsx("div",{className:"platform-service-content",children:h.jsx("h3",{className:"platform-service-title",children:"Настройки"})})]}),h.jsx("div",{className:"platform-service-status"})]}),h.jsx("div",{className:"settings-content-container flex-1 min-h-0 overflow-y-auto border border-border rounded-lg bg-card-bg",children:h.jsx("div",{className:"p-4",children:h.jsx(qr,{selectedCategory:t.selectedCategory,showAdvanced:t.showAdvanced,searchQuery:""})})})]})})};function Qr({botUsername:e,size:t="large",radius:s,requestAccess:r=!0,onAuth:n,onError:i}){const a=g.useRef(null),o=g.useRef(!1);g.useEffect(()=>{if(window.onTelegramAuth=e=>{console.log("[TelegramAuthButton] Получены данные от Telegram:",e),n(e)},!o.current&&a.current){if(document.getElementById("telegram-widget-script"))return console.log("[TelegramAuthButton] Скрипт Telegram уже загружен"),o.current=!0,void l();console.log("[TelegramAuthButton] Загрузка скрипта Telegram Widget...");const n=document.createElement("script");n.id="telegram-widget-script",n.src="https://telegram.org/js/telegram-widget.js?22",n.async=!0,n.setAttribute("data-telegram-login",e),n.setAttribute("data-size",t),n.setAttribute("data-onauth","onTelegramAuth(user)"),n.setAttribute("data-request-access",r?"write":""),void 0!==s&&n.setAttribute("data-radius",s.toString()),n.onload=()=>{console.log("[TelegramAuthButton] Скрипт Telegram Widget загружен"),o.current=!0},n.onerror=()=>{console.error("[TelegramAuthButton] Ошибка загрузки скрипта Telegram Widget"),i&&i("Не удалось загрузить Telegram Widget")},a.current.appendChild(n)}return()=>{}},[e,t,s,r,n,i]);const l=()=>{};return h.jsx("div",{ref:a,className:"flex justify-center items-center min-h-[50px]","data-testid":"telegram-auth-button"})}function Zr({user:e,onAccept:t,onDecline:s,isLoading:r=!1}){const n=`https://t.me/${{}.VITE_TELEGRAM_BOT_USERNAME||"your_bot"}?start=auth_${e.id}`;return h.jsx(u.div,{className:"agreement-dialog-backdrop",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:h.jsxs(u.div,{className:"agreement-dialog-card",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:300,damping:30},children:[h.jsx("div",{className:"flex items-center mb-4",children:h.jsx("h2",{className:"text-2xl font-semibold text-text",children:"Пользовательское соглашение"})}),h.jsxs("p",{className:"text-text-secondary mb-4",children:["Здравствуйте, ",h.jsx("span",{className:"text-text font-medium",children:e.first_name}),"!"]}),h.jsxs("div",{className:"mb-6 p-4 bg-surface rounded-lg border border-border max-h-64 overflow-y-auto",children:[h.jsx("h3",{className:"text-lg font-medium text-text mb-3",children:"📋 Условия использования Boss AI"}),h.jsxs("div",{className:"space-y-3 text-sm text-text-secondary",children:[h.jsx("p",{children:'Нажимая "Принять", вы соглашаетесь с условиями использования платформы Boss AI:'}),h.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-2",children:[h.jsxs("li",{children:[h.jsx("strong",{className:"text-text",children:"Обработка данных:"})," Мы обрабатываем ваши данные Telegram (ID, имя, username, фото профиля) для авторизации и идентификации в системе."]}),h.jsxs("li",{children:[h.jsx("strong",{className:"text-text",children:"Конфиденциальность:"})," Ваши данные не передаются третьим лицам и используются исключительно для работы платформы."]}),h.jsxs("li",{children:[h.jsx("strong",{className:"text-text",children:"Удаление аккаунта:"})," Вы можете удалить свой аккаунт и все связанные данные в любой момент через настройки профиля."]}),h.jsxs("li",{children:[h.jsx("strong",{className:"text-text",children:"Использование сервисов:"})," Вы обязуетесь использовать платформу в соответствии с законодательством и не нарушать права других пользователей."]})]}),h.jsxs("p",{className:"mt-4",children:["📄 Подробнее с условиями можно ознакомиться на странице"," ",h.jsx("a",{href:"https://boss-ai.com/terms",target:"_blank",rel:"noopener noreferrer",className:"text-button-primary hover:underline",children:"Пользовательское соглашение"})]})]})]}),h.jsxs("div",{className:"mb-6 p-3 bg-telegram-blue/10 border border-telegram-blue/30 rounded-lg",children:[h.jsxs("p",{className:"text-sm text-text-secondary mb-2",children:["💡 ",h.jsx("strong",{className:"text-text",children:"Альтернативный способ:"})]}),h.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Вы также можете подтвердить соглашение через нашего бота в Telegram:"}),h.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"agreement-button-telegram inline-block w-full text-center",children:"📱 Открыть бота в Telegram"})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:s,disabled:r,className:"flex-1 px-6 py-3 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Отклонить"}),h.jsx("button",{onClick:t,disabled:r,className:"flex-1 px-6 py-3 bg-button-primary text-button-primary-text rounded-lg font-semibold hover:bg-button-primary-hover transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:r?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Подтверждение..."]}):"✅ Принять"})]}),h.jsx("p",{className:"text-xs text-text-muted text-center mt-4",children:"Принимая соглашение, вы подтверждаете что ознакомились с условиями использования"})]})})}const Yr=new class{constructor(){var e;const t=void 0!==import.meta&&(null==(e={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1})?void 0:e.VITE_API_URL)?{}.VITE_API_URL:"https://boss-ai.online/api";this.config={baseUrl:t,tokenKey:"barsukov-token",userKey:"barsukov-user"}}loginWithTelegram(e){return d(this,null,function*(){try{const t=yield fetch(`${this.config.baseUrl}/auth/telegram/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=yield t.json();throw new Error(e.error||"Ошибка авторизации")}const s=yield t.json();if(!s.success)throw new Error("Ошибка авторизации");return this.setStoredToken(s.data.token),this.setStoredUser(s.data.user),s.data}catch(t){throw console.error("[AuthService] Ошибка авторизации:",t),t}})}getCurrentUser(e){return d(this,null,function*(){const t=e||this.getStoredToken();if(!t)throw new Error("Не авторизован");try{const e=yield fetch(`${this.config.baseUrl}/auth/me`,{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(!e.ok){401===e.status&&this.clearStorage();const t=yield e.json();throw new Error(t.error||"Ошибка получения данных пользователя")}const s=yield e.json();if(!s.success)throw new Error("Ошибка получения данных пользователя");return this.setStoredUser(s.data),s.data}catch(s){throw console.error("[AuthService] Ошибка получения пользователя:",s),s}})}logout(){return d(this,null,function*(){const e=this.getStoredToken();if(e)try{yield fetch(`${this.config.baseUrl}/auth/logout`,{method:"POST",headers:{Authorization:`Bearer ${e}`}})}catch(t){console.error("[AuthService] Ошибка при выходе:",t)}this.clearStorage()})}confirmAgreement(e,t){return d(this,null,function*(){try{const s=yield fetch(`${this.config.baseUrl}/auth/telegram/agree`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegram_id:e,agreed:t})});if(!s.ok){const e=yield s.json();throw new Error(e.error||"Ошибка обновления соглашения")}if(!(yield s.json()).success)throw new Error("Ошибка обновления соглашения")}catch(s){throw console.error("[AuthService] Ошибка обновления соглашения:",s),s}})}getStoredToken(){try{return localStorage.getItem(this.config.tokenKey)}catch(e){return console.error("[AuthService] Ошибка чтения токена:",e),null}}setStoredToken(e){try{localStorage.setItem(this.config.tokenKey,e)}catch(t){console.error("[AuthService] Ошибка сохранения токена:",t)}}getStoredUser(){try{const e=localStorage.getItem(this.config.userKey);return e?JSON.parse(e):null}catch(e){return console.error("[AuthService] Ошибка чтения данных пользователя:",e),null}}setStoredUser(e){try{localStorage.setItem(this.config.userKey,JSON.stringify(e))}catch(t){console.error("[AuthService] Ошибка сохранения данных пользователя:",t)}}isAuthenticated(){return!!this.getStoredToken()}clearStorage(){try{localStorage.removeItem(this.config.tokenKey),localStorage.removeItem(this.config.userKey)}catch(e){console.error("[AuthService] Ошибка очистки хранилища:",e)}}getConfig(){return o({},this.config)}updateConfig(e){this.config=o(o({},this.config),e)}};function Jr({onAuthSuccess:e,onAuthError:t}){const[s,r]=g.useState(!1),[n,i]=g.useState(null),[a,o]=g.useState(!1),[l,c]=g.useState(null),[m,x]=g.useState(null);return h.jsxs(h.Fragment,{children:[h.jsx(u.div,{className:"auth-widget-backdrop",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:h.jsxs(u.div,{className:"auth-widget-card",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:300,damping:30},children:[h.jsx("div",{className:"auth-logo",children:"Boss AI"}),h.jsx("h1",{className:"auth-title",children:"Добро пожаловать в Boss AI"}),h.jsx("p",{className:"auth-description",children:"Авторизуйтесь через Telegram для доступа к платформе"}),!s&&h.jsx(Qr,{botUsername:{}.VITE_TELEGRAM_BOT_USERNAME||"OzonBossAi_bot",onAuth:s=>d(this,null,function*(){r(!0),i(null);try{console.log("[AuthWidget] Получены данные от Telegram:",s);const t=yield Yr.loginWithTelegram(s);console.log("[AuthWidget] Результат авторизации:",{userId:t.user.id,needsAgreement:t.needsAgreement}),t.needsAgreement?(c(t.user),x(t.token),o(!0)):e(t.user,t.token)}catch(n){const e=n instanceof Error?n.message:"Ошибка авторизации";console.error("[AuthWidget] Ошибка авторизации:",n),i(e),t&&t(e)}finally{r(!1)}}),onError:e=>i(e)}),s&&h.jsxs(u.div,{className:"flex items-center justify-center py-4",initial:{opacity:0},animate:{opacity:1},children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-telegram-blue"}),h.jsx("span",{className:"ml-3 text-text-secondary",children:"Авторизация..."})]}),n&&h.jsx(u.div,{className:"mt-4 p-3 bg-error/10 border border-error/30 rounded-lg text-error text-sm",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:n}),h.jsx("p",{className:"text-text-muted text-xs mt-4 text-center",children:"или используйте demo-режим для ознакомления"})]})}),h.jsx(p,{children:a&&l&&h.jsx(Zr,{user:l,onAccept:()=>d(this,null,function*(){if(l&&m){r(!0);try{yield Yr.confirmAgreement(l.telegram_id,!0),console.log("[AuthWidget] Соглашение принято"),e(l,m)}catch(t){const e=t instanceof Error?t.message:"Ошибка подтверждения соглашения";console.error("[AuthWidget] Ошибка подтверждения:",t),i(e)}finally{r(!1)}}}),onDecline:()=>{console.log("[AuthWidget] Соглашение отклонено"),c(null),x(null),o(!1),Yr.clearStorage()},isLoading:s})})]})}function Xr({user:e,onClose:t,onLogout:s}){const[r,n]=g.useState(!1),i=e=>{if(!e)return"Неизвестно";return new Date(1e3*e).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})};return h.jsxs(h.Fragment,{children:[h.jsx(u.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),h.jsxs(u.div,{className:"profile-panel",initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},children:[h.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[h.jsx("h2",{className:"text-xl font-semibold text-text",children:"Профиль"}),h.jsx("button",{onClick:t,className:"p-2 hover:bg-surface-hover rounded-lg transition-colors","aria-label":"Закрыть",children:h.jsx(os,{className:"w-5 h-5 text-text-secondary"})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[h.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.photo_url?h.jsx("img",{src:e.photo_url,alt:e.first_name,className:"profile-avatar mb-4"}):h.jsx("div",{className:"profile-avatar mb-4 flex items-center justify-center bg-button-primary text-white text-2xl font-bold",children:(((null==(a=e.first_name)?void 0:a.charAt(0))||"")+((null==(o=e.last_name)?void 0:o.charAt(0))||"")).toUpperCase()||"?"}),h.jsxs("h3",{className:"profile-name mb-1",children:[e.first_name," ",e.last_name||""]}),e.username&&h.jsxs("p",{className:"profile-username",children:["@",e.username]})]}),h.jsxs("div",{className:"space-y-4 mb-8",children:[h.jsxs("div",{className:"p-4 bg-surface rounded-lg border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(ss,{className:"w-4 h-4 text-text-secondary"}),h.jsx("span",{className:"text-sm text-text-secondary",children:"Telegram ID"})]}),h.jsx("p",{className:"text-text font-mono text-sm",children:e.telegram_id})]}),e.created_at&&h.jsxs("div",{className:"p-4 bg-surface rounded-lg border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(We,{className:"w-4 h-4 text-text-secondary"}),h.jsx("span",{className:"text-sm text-text-secondary",children:"Дата регистрации"})]}),h.jsx("p",{className:"text-text text-sm",children:i(e.created_at)})]}),e.last_login&&h.jsxs("div",{className:"p-4 bg-surface rounded-lg border border-border",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(We,{className:"w-4 h-4 text-text-secondary"}),h.jsx("span",{className:"text-sm text-text-secondary",children:"Последний вход"})]}),h.jsx("p",{className:"text-text text-sm",children:i(e.last_login)})]}),h.jsxs("div",{className:"p-4 bg-surface rounded-lg border border-border",children:[h.jsx("div",{className:"flex items-center gap-2 mb-1",children:h.jsx("span",{className:"text-sm text-text-secondary",children:"Пользовательское соглашение"})}),h.jsx("p",{className:"text-text text-sm",children:e.agreed_to_terms?h.jsx("span",{className:"text-success",children:"✅ Принято"}):h.jsx("span",{className:"text-warning",children:"⚠️ Не принято"})})]})]}),!1]}),h.jsx("div",{className:"p-6 border-t border-border",children:h.jsx("button",{onClick:()=>d(this,null,function*(){n(!0);try{yield s()}catch(e){console.error("[ProfilePanel] Ошибка при выходе:",e),n(!1)}}),disabled:r,className:"profile-logout-button w-full",children:r?h.jsxs("div",{className:"flex items-center justify-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Выход..."]}):h.jsxs("div",{className:"flex items-center justify-center",children:[h.jsx(yt,{className:"w-5 h-5 mr-2"}),"Выйти из системы"]})})})]})]});var a,o}const en=({className:e})=>{var t;const{state:s,toggleSidebar:r,switchSection:n,createWorkspaceItem:i,setActiveSettingsCategory:a,toggleChat:o,dispatch:l,logout:c}=j(),[m,u]=g.useState("workspace"),[x,v]=g.useState("guide"),[f,y]=g.useState(!1),[b,N]=g.useState(!1),w=g.useRef(null),k=g.useRef(null),S=g.useRef(null),[C,E]=g.useState(null),[I,T]=g.useState(""),A=g.useRef(null),R=s.layout.sidebarCollapsed;g.useEffect(()=>{const e=e=>{const t=e.detail;v(t)};return window.addEventListener("ai-lawyer:switch-tab",e),()=>{window.removeEventListener("ai-lawyer:switch-tab",e)}},[]),g.useEffect(()=>{const e=document.querySelector(".sidebar-dynamic-width");if(e){const t=R?60:s.layout.sidebarWidth,r=R?12:20;e.style.setProperty("--sidebar-width",`${t}px`),e.style.setProperty("--sidebar-border-radius",`${r}px`)}},[R,s.layout.sidebarWidth]);const M=g.useMemo(()=>s.workspaceItems,[s.workspaceItems]),_=()=>{const e=`workspace_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;i({id:e,type:"folder",title:"Новое пространство",content:"",path:"/workspaces/",size:0,tags:["workspace"],createdAt:new Date,updatedAt:new Date})},P=e=>{I.trim()&&l({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e,updates:{title:I.trim()}}}),E(null),T("")},L=(e="all")=>{a(e),n("settings")},O=e=>{const t=s.layout.activeWidgetsCategory;if(t.includes(e)){const s=t.filter(t=>t!==e);l({type:"SET_ACTIVE_WIDGETS_CATEGORY",payload:s})}else{const s=[...t,e];l({type:"SET_ACTIVE_WIDGETS_CATEGORY",payload:s})}},$=e=>{s.layout.activeSettingsCategory===e?a("all"):L(e)},D=e=>{n(e)};g.useEffect(()=>{if(!S.current)return;const e=S.current,t=e.querySelector('[data-workspace-id="'+m+'"]');if(t){const s=t.getBoundingClientRect(),r=e.getBoundingClientRect();(s.top<r.top+8||s.bottom>r.bottom-8)&&t.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}},[m]);return h.jsxs("div",{className:Te("h-full liquid-glass-panel transition-[width] duration-150 flex flex-col sidebar-dynamic-width shadow-2xl overflow-y-auto sidebar-scrollbar animate-sidebar-slide-in sidebar-main-container relative volume-container",R&&"collapsed",e),children:[h.jsxs("div",{className:Te("flex items-center animate-sidebar-content sidebar-header",R?"p-0 justify-center":"p-3 justify-center"),children:[!R&&h.jsx("div",{className:"flex items-center justify-center w-full",children:h.jsx("div",{onClick:r,className:"w-full h-12 rounded-lg flex items-center justify-center sidebar-logo cursor-pointer hover:scale-105 transition-transform duration-200 bg-transparent border-none",title:"Свернуть панель",children:h.jsx("span",{className:"font-bold text-2xl sidebar-logo-text tracking-widest leading-none boss-ai-text",children:"Boss Ai"})})}),R&&h.jsx("button",{onClick:r,className:"sidebar-logo-button mx-auto",title:"Развернуть панель",children:h.jsx("span",{className:"font-bold text-lg sidebar-logo-text sidebar-service-icon-inverted",children:"B"})})]}),h.jsx("div",{className:Te("gradient-divider",!R&&"mx-3")}),h.jsxs("div",{className:Te("sidebar-services-scroll",R?"p-0":"px-0"),children:[h.jsx("div",{className:Te(R?"p-0":"px-3 py-2"),children:h.jsxs("button",{onClick:e=>{D("prompts"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()});try{window.dispatchEvent(new CustomEvent("prompts:open"))}catch(t){}},className:Te("sidebar-service-button",R&&"compact","prompts"===s.layout.activeSection&&"active"),title:"Библиотека промптов",children:[h.jsx(zt,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Библиотека промптов"})})]})}),h.jsxs("div",{className:Te(R?"p-0":"px-3 py-2"),children:[h.jsxs("button",{onClick:e=>{"ai-lawyer"===s.layout.activeSection?D("workspace"):(D("ai-lawyer"),s.layout.chatVisible||o()),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Te("sidebar-service-button",R&&"compact","ai-lawyer"===s.layout.activeSection&&"active"),title:"AI-Юрист",children:[h.jsx(Ft,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"AI-Юрист"})})]}),R&&"ai-lawyer"===s.layout.activeSection&&h.jsxs("div",{className:"sidebar-service-dropdown",children:[h.jsx("button",{onClick:()=>{v("guide");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"guide"});window.dispatchEvent(e)},className:Te("sidebar-service-item","guide"===x&&"active"),title:"Гид & Архитектура",children:h.jsx(Yt,{className:"icon"})}),h.jsx("button",{onClick:()=>{v("consultation");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"consultation"});window.dispatchEvent(e)},className:Te("sidebar-service-item","consultation"===x&&"active"),title:"Консультация",children:h.jsx(Ft,{className:"icon"})}),h.jsx("button",{onClick:()=>{v("documents");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"documents"});window.dispatchEvent(e)},className:Te("sidebar-service-item","documents"===x&&"active"),title:"Документы",children:h.jsx(it,{className:"icon"})}),h.jsx("button",{onClick:()=>{v("compliance");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"compliance"});window.dispatchEvent(e)},className:Te("sidebar-service-item","compliance"===x&&"active"),title:"152-ФЗ и комплаенс",children:h.jsx(Vt,{className:"icon"})})]}),!R&&"ai-lawyer"===s.layout.activeSection&&h.jsxs("div",{className:"sidebar-service-dropdown",children:[h.jsxs("button",{onClick:()=>{v("guide");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"guide"});window.dispatchEvent(e)},className:Te("sidebar-service-item","guide"===x&&"active"),children:[h.jsx(Yt,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Гид & Архитектура"})})]}),h.jsxs("button",{onClick:()=>{v("consultation");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"consultation"});window.dispatchEvent(e)},className:Te("sidebar-service-item","consultation"===x&&"active"),children:[h.jsx(Ft,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Консультация"})})]}),h.jsxs("button",{onClick:()=>{v("documents");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"documents"});window.dispatchEvent(e)},className:Te("sidebar-service-item","documents"===x&&"active"),children:[h.jsx(it,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Документы"})})]}),h.jsxs("button",{onClick:()=>{v("compliance");const e=new CustomEvent("ai-lawyer:switch-tab",{detail:"compliance"});window.dispatchEvent(e)},className:Te("sidebar-service-item","compliance"===x&&"active"),children:[h.jsx(Vt,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"152-ФЗ и комплаенс"})})]})]})]}),h.jsx("div",{className:Te(R?"p-0":"px-3 py-2"),children:h.jsxs("button",{onClick:e=>{"ozon-manager"===s.layout.activeSection?D("workspace"):D("ozon-manager"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Te("sidebar-service-button",R&&"compact","ozon-manager"===s.layout.activeSection&&"active"),title:"Ozon Manager",children:[h.jsx(qt,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Ozon Manager"})})]})}),h.jsx("div",{className:Te(R?"p-0":"px-3 py-2"),children:h.jsxs("div",{className:"relative",ref:w,children:[h.jsxs("button",{onClick:e=>{"settings"===s.layout.activeSection?D("workspace"):L("all");const t=e.currentTarget;requestAnimationFrame(()=>{t&&"function"==typeof t.blur&&t.blur()})},className:Te("sidebar-service-button",R&&"compact","settings"===s.layout.activeSection&&"active"),title:"Настройки",children:[h.jsx(Ye,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Настройки"})})]}),R&&"settings"===s.layout.activeSection&&h.jsxs("div",{className:"sidebar-service-dropdown",children:[h.jsx("button",{onClick:()=>$("appearance"),className:Te("sidebar-service-item","appearance"===s.layout.activeSettingsCategory&&"active"),title:"Внешний вид",children:h.jsx(At,{className:"icon"})}),h.jsx("button",{onClick:()=>$("interface"),className:Te("sidebar-service-item","interface"===s.layout.activeSettingsCategory&&"active"),title:"Интерфейс",children:h.jsx(Ct,{className:"icon"})}),h.jsx("button",{onClick:()=>$("chat"),className:Te("sidebar-service-item","chat"===s.layout.activeSettingsCategory&&"active"),title:"Чат",children:h.jsx(kt,{className:"icon"})}),h.jsx("button",{onClick:()=>$("notifications"),className:Te("sidebar-service-item","notifications"===s.layout.activeSettingsCategory&&"active"),title:"Уведомления",children:h.jsx(ze,{className:"icon"})})]}),"settings"===s.layout.activeSection&&!R&&h.jsxs("div",{className:"sidebar-service-dropdown",children:[h.jsxs("button",{onClick:()=>$("appearance"),className:Te("sidebar-service-item","appearance"===s.layout.activeSettingsCategory&&"active"),children:[h.jsx(At,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Внешний вид"})})]}),h.jsxs("button",{onClick:()=>$("interface"),className:Te("sidebar-service-item","interface"===s.layout.activeSettingsCategory&&"active"),children:[h.jsx(Ct,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Интерфейс"})})]}),h.jsxs("button",{onClick:()=>$("chat"),className:Te("sidebar-service-item","chat"===s.layout.activeSettingsCategory&&"active"),children:[h.jsx(kt,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Чат"})})]}),h.jsxs("button",{onClick:()=>$("notifications"),className:Te("sidebar-service-item","notifications"===s.layout.activeSettingsCategory&&"active"),children:[h.jsx(ze,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Уведомления"})})]})]})]})}),h.jsx("div",{className:Te(R?"p-0":"px-3 py-2"),children:h.jsxs("div",{className:"relative",ref:k,children:[h.jsxs("button",{onClick:e=>{y(!f);const t=e.currentTarget;requestAnimationFrame(()=>{t&&"function"==typeof t.blur&&t.blur()})},className:Te("sidebar-service-button",R&&"compact",(f||s.layout.activeWidgetsCategory.length>0)&&"active"),title:"Виджеты",children:[h.jsx(xt,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Виджеты"})})]}),R&&f&&h.jsxs("div",{className:"sidebar-service-dropdown",children:[h.jsx("button",{onClick:()=>O("time-widget"),className:Te("sidebar-service-item",s.layout.activeWidgetsCategory.includes("time-widget")&&"active"),title:"Часы",children:h.jsx(Ze,{className:"icon"})}),h.jsx("button",{onClick:()=>O("voice-widget"),className:Te("sidebar-service-item",s.layout.activeWidgetsCategory.includes("voice-widget")&&"active"),title:"Голосовой ввод",children:h.jsx(St,{className:"icon"})})]}),f&&!R&&h.jsxs("div",{className:"sidebar-service-dropdown",children:[h.jsxs("button",{onClick:()=>{O("time-widget"),window.dispatchEvent(new CustomEvent("widgets:toggle",{detail:"time-widget"}))},className:Te("sidebar-service-item",s.layout.activeWidgetsCategory.includes("time-widget")&&"active"),children:[h.jsx(Ze,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Часы"})})]}),h.jsxs("button",{onClick:()=>{O("voice-widget"),window.dispatchEvent(new CustomEvent("widgets:toggle",{detail:"voice-widget"}))},className:Te("sidebar-service-item",s.layout.activeWidgetsCategory.includes("voice-widget")&&"active"),children:[h.jsx(St,{className:"icon"}),h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Голосовой ввод"})})]})]})]})}),h.jsx("div",{className:Te(R?"p-0":"px-3 py-2"),children:h.jsxs("button",{onClick:e=>{"photo-studio"===s.layout.activeSection?D("workspace"):D("photo-studio"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Te("sidebar-service-button",R&&"compact","photo-studio"===s.layout.activeSection&&"active"),title:"Фотостудия",children:[h.jsx(Ge,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Фотостудия"})})]})}),h.jsx("div",{className:Te(R?"p-0":"px-3 py-2"),children:h.jsxs("button",{onClick:e=>{"corporate"===s.layout.activeSection?D("workspace"):D("corporate"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Te("sidebar-service-button",R&&"compact","corporate"===s.layout.activeSection&&"active"),title:"Корпоративный сайт",children:[h.jsx(Ue,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Корпоративный сайт"})})]})}),h.jsx("div",{className:Te(R?"p-0":"px-3 py-2"),children:h.jsxs("button",{onClick:e=>{"sales-scripts"===s.layout.activeSection?D("workspace"):D("sales-scripts"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Te("sidebar-service-button",R&&"compact","sales-scripts"===s.layout.activeSection&&"active"),title:"Скрипты продаж",children:[h.jsx(kt,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Скрипты продаж"})})]})}),h.jsx("div",{className:Te(R?"p-0":"px-3 py-2"),children:h.jsxs("button",{onClick:e=>{"regulations"===s.layout.activeSection?D("workspace"):D("regulations"),requestAnimationFrame(()=>{const t=e.currentTarget;t&&"function"==typeof t.blur&&t.blur()})},className:Te("sidebar-service-button",R&&"compact","regulations"===s.layout.activeSection&&"active"),title:"Регламенты работы",children:[h.jsx(it,{className:"icon"}),!R&&h.jsx("div",{className:"service-content",children:h.jsx("div",{className:"service-title",children:"Регламенты"})})]})})]}),h.jsx("div",{className:Te("gradient-divider",!R&&"mx-3")}),h.jsxs("nav",{className:Te("animate-sidebar-content flex-1 min-h-0 sidebar-projects",R?"p-0":"p-3 pt-1"),children:[!R&&h.jsxs("div",{className:"flex items-center justify-between mb-2 mt-2",children:[h.jsx("h3",{className:"text-sm font-medium sidebar-services-title",children:"Проекты"}),h.jsx(xs,{onClick:_,variant:"primary",size:"sm",className:"sidebar-create-button",title:"Создать проект",children:h.jsx("span",{className:"text-sm",children:"+"})})]}),h.jsx("div",{ref:S,className:"sidebar-workspaces-scroll h-full min-h-0",children:h.jsxs("ul",{className:Te("sidebar-nav",R?"space-y-4":"space-y-5"),children:[R&&h.jsx("li",{children:h.jsx(xs,{onClick:_,variant:"primary",size:"sm",className:"sidebar-create-button w-full",title:"Создать проект",children:h.jsx("span",{className:"text-sm",children:"+"})})}),M.filter(e=>"folder"===e.type).map(e=>{const t=(e=>{switch(e){case"folder":return ct;case"document":return at;case"note":return kt;case"image":return nt;default:return gt}})(e.type);return h.jsx("li",{children:h.jsx("div",{"data-workspace-id":e.id,onClick:()=>{u(e.id),D("workspace");try{window.dispatchEvent(new CustomEvent("workspace:navigate",{detail:{projectId:e.id}}))}catch(t){}},className:Te("sidebar-service-button transition-all duration-200",R&&"compact",m===e.id&&"active"),title:R?e.title:void 0,children:h.jsxs("div",{className:Te("sidebar-project-btn flex items-center flex-1 text-left",R?"justify-center":"space-x-3"),onDoubleClick:()=>(e=>{R||(E(e.id),T(e.title),setTimeout(()=>{var e,t;null==(e=A.current)||e.focus(),null==(t=A.current)||t.select()},0))})(e),children:[h.jsx(t,{className:"icon"}),R||C!==e.id?!R&&h.jsx("span",{className:"service-content",children:h.jsx("span",{className:"service-title truncate",children:e.title})}):h.jsx("input",{ref:A,type:"text",value:I,onChange:e=>T(e.target.value),onBlur:()=>P(e.id),onKeyDown:t=>{"Enter"===t.key?P(e.id):"Escape"===t.key&&(E(null),T(""))},onClick:e=>e.stopPropagation(),placeholder:"Название проекта","aria-label":"Редактировать название проекта",className:"service-content service-title truncate bg-surface border border-border rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-primary"})]})})},e.id)})]})})]}),h.jsx("div",{className:Te("gradient-divider",!R&&"mx-3")}),h.jsx("div",{className:Te("mt-auto sidebar-footer",R?"p-0 collapsed":"p-4"),children:h.jsxs("div",{className:Te("flex",R?"flex-col space-y-1":"items-center justify-between gap-2"),children:[h.jsx("button",{onClick:()=>n("notifications"),className:Te("sidebar-footer-button","notifications"===s.layout.activeSection&&"active"),title:"Уведомления",children:h.jsx(ze,{className:"w-4 h-4 icon"})}),h.jsx("button",{onClick:()=>{"settings"===s.layout.activeSection?D("workspace"):L("all")},className:Te("sidebar-footer-button","settings"===s.layout.activeSection&&"active"),title:"Настройки",children:h.jsx(Ye,{className:"w-4 h-4 icon"})}),h.jsx("button",{onClick:()=>N(!0),className:Te("sidebar-footer-button",b&&"active"),title:"Профиль","aria-label":"Открыть профиль",children:(null==(t=s.authUser)?void 0:t.photo_url)?h.jsx("img",{src:s.authUser.photo_url,alt:"Профиль",className:"w-4 h-4 rounded-full"}):h.jsx(ss,{className:"w-4 h-4 icon"})})]})}),h.jsx(p,{children:b&&s.authUser&&h.jsx(Xr,{user:s.authUser,onClose:()=>N(!1),onLogout:()=>d(void 0,null,function*(){yield c(),N(!1)})})})]})},tn=g.memo(({items:e,activeItem:t,isCollapsed:s,className:r=""})=>h.jsx("ul",{className:Te("space-y-1",r),children:e.map((e,r)=>{const n=e.icon,i=t===e.id;return h.jsx("li",{className:"animate-interface-stagger",children:h.jsxs("button",{onClick:e.action,className:Te("w-full flex items-center px-3 py-2.5 rounded-lg transition-all duration-200 group","hover:bg-surface-hover hover:shadow-sm",i?"bg-primary text-button-primary-text shadow-lg":"text-white hover:text-white",s?"justify-center":"justify-start"),title:s?e.name:void 0,style:{animationDelay:.1*r+"s"},children:[h.jsx(n,{className:Te("transition-all duration-200",s?"w-5 h-5":"w-5 h-5 mr-3",i?"text-button-primary-text":"text-white group-hover:text-white")}),!s&&h.jsx("span",{className:"text-sm font-medium truncate",children:e.name})]})},e.id)})}));tn.displayName="SidebarMenu";const sn=g.memo(({isCollapsed:e,onToggle:t,className:s=""})=>h.jsx("button",{onClick:t,className:Te("absolute -right-3 top-1/2 transform -translate-y-1/2 z-10","w-6 h-6 rounded-full border-2 transition-all duration-200","bg-surface border-border hover:border-primary hover:bg-surface-hover","flex items-center justify-center shadow-lg hover:shadow-xl","text-icon-muted hover:text-primary",s),title:e?"Развернуть сайдбар":"Свернуть сайдбар",children:e?h.jsx(Qe,{className:"w-4 h-4"}):h.jsx(Ke,{className:"w-4 h-4"})}));sn.displayName="SidebarToggle";g.memo(({className:e})=>{const{state:t,toggleSidebar:s,switchSection:r}=j(),[n,i]=g.useState("workspace"),a=t.layout.sidebarCollapsed;g.useEffect(()=>{const e=document.querySelector(".sidebar-dynamic-width");if(e&&!e.style.getPropertyValue("--sidebar-width")){const s=a?60:t.layout.sidebarWidth;e.style.setProperty("--sidebar-width",`${s}px`)}},[a,t.layout.sidebarWidth]),g.useEffect(()=>{const e=document.querySelector(".sidebar-dynamic-width");if(e){const s=a?60:t.layout.sidebarWidth;e.style.setProperty("--sidebar-width",`${s}px`)}},[a,t.layout.sidebarWidth]);const o=g.useMemo(()=>[{id:"workspace",name:"Рабочее пространство",icon:ct,action:()=>{i("workspace"),r("workspace")}}],[r]);return h.jsxs("div",{className:Te("sidebar-container relative flex flex-col h-full transition-all duration-300 ease-in-out","bg-surface border-r border-border",a?"sidebar-collapsed":"sidebar-expanded",e),children:[h.jsx(sn,{isCollapsed:a,onToggle:s}),!a&&h.jsxs("div",{className:"p-4 border-b border-border",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"w-6 h-6 rounded-lg bg-primary/20 flex items-center justify-center",children:h.jsx("span",{className:"font-bold text-sm text-primary",children:"B"})}),h.jsxs("h2",{className:"text-lg font-semibold text-white",children:[h.jsx("span",{className:"font-bold",children:"oss"})," ",h.jsx("span",{className:"font-bold",children:"Ai"})]})]}),h.jsx("p",{className:"text-xs text-white mt-1",children:"BARSUKOV OS v2.1.0"})]}),h.jsx("div",{className:"flex-1 p-4 space-y-6",children:h.jsx(tn,{items:o,activeItem:n,isCollapsed:a})}),!a&&h.jsx("div",{className:"p-4 border-t border-border",children:h.jsx("div",{className:"text-xs text-white text-center",children:"© 2024 Boss Ai"})})]})}).displayName="SidebarModular";const rn=g.memo(({tool:e,serviceId:t,onToolClick:s,iconMap:r,isCollapsed:n,className:i=""})=>{const a=r[e.icon]||r.Folder;return h.jsxs("button",{onClick:()=>{s(t,e.id)},className:Te("w-full flex items-center px-3 py-2 rounded-md transition-all duration-200 group","hover:bg-surface-hover hover:shadow-sm text-white hover:text-white",n?"justify-center":"justify-start",i),title:n?e.name:void 0,children:[h.jsx(a,{className:Te("transition-all duration-200",n?"w-4 h-4":"w-4 h-4 mr-2","text-icon-muted group-hover:text-icon-primary")}),!n&&h.jsx("span",{className:"text-xs font-medium truncate",children:e.name})]},e.id)});rn.displayName="SidebarTool";g.memo(({services:e,expandedServices:t,onToggleExpansion:s,onToolClick:r,iconMap:n,isCollapsed:i,className:a=""})=>{const o=g.useCallback(e=>{s(e)},[s]);return 0===e.length?null:h.jsx("div",{className:Te("space-y-0.5",a),children:e.map(e=>{const s=t.has(e.config.id),a=n[e.config.icon]||n.Folder;return h.jsxs("div",{className:"animate-interface-stagger",children:[h.jsxs("button",{onClick:()=>o(e.config.id),className:Te("w-full flex items-center px-3 py-2 rounded-lg transition-all duration-200 group","hover:bg-surface-hover hover:shadow-sm text-white hover:text-white",i?"justify-center":"justify-between"),title:i?e.config.name:void 0,children:[h.jsxs("div",{className:Te("flex items-center",i?"justify-center":"justify-start"),children:[h.jsx(a,{className:Te("transition-all duration-200",i?"w-5 h-5":"w-5 h-5 mr-3","text-icon-muted group-hover:text-icon-primary")}),!i&&h.jsx("span",{className:"text-sm font-medium truncate",children:e.config.name})]}),!i&&h.jsxs("div",{className:"flex items-center",children:[h.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded-full bg-primary/10 text-primary mr-2",children:e.config.tools.length}),s?h.jsx("svg",{className:"w-4 h-4 text-icon-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):h.jsx("svg",{className:"w-4 h-4 text-icon-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),s&&!i&&h.jsx("div",{className:"mt-1 ml-3 mr-4 pr-2 pt-1 pb-1 space-y-0.5 animate-interface-slide-up overflow-visible",children:e.config.tools.map(t=>h.jsx(rn,{tool:t,serviceId:e.config.id,onToolClick:r,iconMap:n,isCollapsed:i},t.id))})]},e.config.id)})})}).displayName="SidebarServices";const nn=({widget:e,onMinimize:t,onClose:s,isMinimized:r,onDragStart:n})=>{const[i,a]=g.useState(new Date),[o,l]=g.useState(!1),c=g.useRef(null);g.useEffect(()=>{const e=()=>{a(new Date)};return e(),c.current=setInterval(e,1e3),()=>{c.current&&clearInterval(c.current)}},[]);const d=t=>{const s=t.getHours(),r=t.getMinutes(),n=t.getSeconds();if(e.settings.format24h){let t=`${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;return e.settings["show-seconds"]&&(t+=`:${n.toString().padStart(2,"0")}`),t}{const t=s>=12?"PM":"AM";let i=`${s%12||12}:${r.toString().padStart(2,"0")}`;return e.settings["show-seconds"]&&(i+=`:${n.toString().padStart(2,"0")}`),i+=` ${t}`,i}};return r?h.jsx("div",{className:"widget-minimized time-widget-minimized",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onClick:t,children:h.jsxs("div",{className:"widget-minimized-content",children:[h.jsx(Ze,{size:16,className:"widget-minimized-icon"}),h.jsx("div",{className:"widget-minimized-time",children:d(i)})]})}):h.jsxs("div",{className:"widget-container time-widget-container active","data-testid":"widget-container",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onMouseDown:n,children:[h.jsxs("div",{className:"widget-header",children:[h.jsxs("div",{className:"widget-title",children:[h.jsx(Ze,{size:16,className:"widget-icon"}),h.jsx("span",{children:"Часы"})]}),h.jsxs("div",{className:Te("widget-controls",o&&"widget-controls-visible"),children:[h.jsx("button",{onClick:()=>{const e=document.querySelector(".time-widget-container");e&&e.classList.toggle("no-shadow")},className:"widget-control-btn",title:"Убрать тень",children:h.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),h.jsx("path",{d:"M2 17l10 5 10-5"}),h.jsx("path",{d:"M2 12l10 5 10-5"})]})}),h.jsx("button",{onClick:s,className:"widget-control-btn widget-control-close",title:"Закрыть",children:h.jsx(os,{size:12})})]})]}),h.jsxs("div",{className:"widget-content time-widget-content",children:[h.jsx("div",{className:"time-display",children:h.jsx("div",{className:"time-main",children:d(i)})}),e.settings["show-date"]&&h.jsxs("div",{className:"date-display",children:[h.jsx(We,{size:14,className:"date-icon"}),h.jsx("span",{className:"date-text",children:(m=i,m.toLocaleDateString("ru-RU",{weekday:"short",day:"numeric",month:"short"}))})]})]})]});var m},an=({widget:e,onMinimize:t,onClose:s,isMinimized:r,onTranscriptionComplete:n,onDragStart:i})=>{const[a,o]=g.useState(!1),[l,c]=g.useState(!1),[d,m]=g.useState(0),[u,p]=g.useState(""),[x,f]=g.useState(!1),y=g.useRef(null);v.useEffect(()=>{e.settings["auto-start"]&&!r&&j()},[e.settings,r]),v.useEffect(()=>(a&&!l?y.current=setInterval(()=>{m(e=>e+1)},1e3):y.current&&(clearInterval(y.current),y.current=null),()=>{y.current&&clearInterval(y.current)}),[a,l]);const b=e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},j=()=>{o(!0),c(!1),m(0),p("")};return v.useEffect(()=>{if(a&&!l){const t=window.SpeechRecognition||window.webkitSpeechRecognition;if(!t)return console.error("Web Speech API не поддерживается в этом браузере"),void p("Ошибка: Web Speech API не поддерживается");const s=new t;s.continuous=!0,s.interimResults=!0,s.lang="ru-RU",s.maxAlternatives=1,s.onresult=e=>{let t="",s="";if(e.results&&Array.isArray(e.results)&&"number"==typeof e.resultIndex)for(let r=e.resultIndex;r<e.results.length;r++){const n=e.results[r][0].transcript;e.results[r].isFinal?t+=n:s+=n}p(e=>{const r=e.replace(/<span class="interim">.*?<\/span>/g,"")+t;return s?`${r} <span class="interim">${s}</span>`:r})},s.onerror=e=>{console.error("Ошибка распознавания речи:",e.error),p(t=>t+` [Ошибка: ${e.error}]`)},s.onend=()=>{a&&!l&&setTimeout(()=>{try{s.start()}catch(e){console.error("Restart speech recognition failed",e)}},100)};try{s.start()}catch(e){console.error("Ошибка запуска распознавания речи",e),p("Ошибка запуска распознавания речи")}return()=>{try{s.stop()}catch(e){console.error("Ошибка остановки распознавания",e)}}}},[a,l]),r?h.jsx("div",{className:"widget-minimized voice-widget-minimized",onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onClick:t,children:h.jsxs("div",{className:"widget-minimized-content",children:[h.jsx("button",{className:"widget-minimized-mic-btn",onClick:e=>{e.stopPropagation(),a||j()},title:a?"Идёт запись":"Начать запись",children:h.jsx(St,{size:16,className:Te("widget-minimized-icon",a&&"recording")})}),a&&h.jsx("div",{className:"widget-minimized-time",children:b(d)})]})}):h.jsxs("div",{className:"widget-container voice-widget-container active",onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onMouseDown:i,children:[h.jsxs("div",{className:"widget-header",children:[h.jsxs("div",{className:"widget-title",children:[h.jsx(St,{size:16,className:"widget-icon"}),h.jsx("span",{children:"Голосовой ввод"})]}),h.jsxs("div",{className:Te("widget-controls",x&&"widget-controls-visible"),children:[h.jsx("button",{onClick:()=>{const e=document.querySelector(".voice-widget-container");e&&e.classList.toggle("no-shadow")},className:"widget-control-btn",title:"Убрать тень",children:h.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),h.jsx("path",{d:"M2 17l10 5 10-5"}),h.jsx("path",{d:"M2 12l10 5 10-5"})]})}),h.jsx("button",{onClick:s,className:"widget-control-btn widget-control-close",title:"Закрыть",children:h.jsx(os,{size:12})})]})]}),h.jsxs("div",{className:"widget-content voice-widget-content",children:[h.jsx("div",{className:"voice-main-controls",children:a?h.jsxs("div",{className:"voice-recording-info",children:[h.jsx("div",{className:"voice-recording-time",children:b(d)}),h.jsx("div",{className:"voice-recording-status",children:l?"Пауза":"Идёт запись..."})]}):h.jsxs("button",{className:"voice-start-btn-small",onClick:j,title:"Начать запись",children:[h.jsx(St,{size:20}),h.jsx("span",{children:"Запись"})]})}),a&&h.jsxs("div",{className:"voice-recording-controls",children:[h.jsx("button",{className:"voice-control-btn voice-pause-btn",onClick:()=>{c(e=>!e)},title:l?"Возобновить":"Пауза",children:h.jsx(Qt,{size:16})}),h.jsx("button",{className:"voice-control-btn voice-send-btn",onClick:()=>{u.trim()&&(n(u.trim()),p(""),o(!1),c(!1),m(0))},title:"Отправить",disabled:!u.trim(),children:h.jsx(Ut,{size:16})})]}),e.settings["show-transcription"]&&u&&h.jsx("div",{className:"voice-transcription",dangerouslySetInnerHTML:{__html:u}})]})]})},on=({onTranscriptionComplete:e})=>{const{state:t,dispatch:s}=j(),[r,n]=g.useState({}),[i,a]=g.useState({}),c=g.useRef(1e3),d=g.useRef(null),[m,u]=g.useState([{id:"voice-widget",name:"Голосовой ввод",icon:h.jsx(St,{size:16}),component:an,isActive:!1},{id:"time-widget",name:"Часы",icon:h.jsx(Ze,{size:16}),component:nn,isActive:!1}]);g.useEffect(()=>{const e=t.layout.activeWidgetsCategory;e&&0!==e.length?(u(t=>t.map(t=>l(o({},t),{isActive:e.includes(t.id)}))),n(t=>{const s=o({},t);return e.forEach((e,t)=>{s[e]||(s[e]={x:520+t%3*40,y:140+t%3*40})}),s}),a(t=>{const s=o({},t);return e.forEach(e=>{s[e]||(s[e]=c.current++)}),s})):u(e=>e.map(e=>l(o({},e),{isActive:!1})))},[t.layout.activeWidgetsCategory]);const p=e=>{u(t=>t.map(t=>t.id===e?l(o({},t),{isActive:!1}):t));const r=t.layout.activeWidgetsCategory.filter(t=>t!==e);s({type:"SET_ACTIVE_WIDGETS_CATEGORY",payload:r})},x=m.filter(e=>e.isActive),v=(e,t)=>{var s;if(0!==t.button)return;const n={x:t.clientX,y:t.clientY},i=null!=(s=r[e])?s:{x:480,y:120};d.current={id:e,start:n,offset:i},(e=>{a(t=>l(o({},t),{[e]:c.current++}))})(e),window.addEventListener("mousemove",f),window.addEventListener("mouseup",y),t.preventDefault()},f=e=>{if(!d.current)return;const{id:t,start:s,offset:r}=d.current,i=e.clientX-s.x,a=e.clientY-s.y;n(e=>l(o({},e),{[t]:{x:r.x+i,y:r.y+a}}))},y=g.useCallback(()=>{d.current=null,window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",y)},[]);return g.useEffect(()=>()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",y)},[y]),g.useEffect(()=>{const e=e=>{const t=e.detail;u(e=>e.map(e=>e.id===t?l(o({},e),{isActive:!e.isActive}):e))};return window.addEventListener("widgets:toggle",e),()=>window.removeEventListener("widgets:toggle",e)},[]),h.jsx(h.Fragment,{children:x.map(t=>{var s,n;const a=t.component,o=null!=(s=r[t.id])?s:{x:520,y:140},l=null!=(n=i[t.id])?n:1e3;return h.jsx("div",{className:"widget-wrapper",ref:e=>{e&&(e.style.left=`${o.x}px`,e.style.top=`${o.y}px`,e.style.zIndex=l.toString())},children:h.jsx(a,{widget:{id:t.id,settings:"voice-widget"===t.id?{"auto-start":!1,"show-transcription":!0}:{"show-seconds":!0,"show-date":!0,format24h:!0}},onMinimize:()=>p(t.id),onClose:()=>p(t.id),isMinimized:!1,onTranscriptionComplete:e,onDragStart:e=>v(t.id,e)})},t.id)})})},ln=g.memo(({item:e,isSelected:t,isChecked:s,isNew:r,onItemClick:n,onItemAction:i,onDocumentCheck:a})=>{const[l,c]=g.useState(!1);return h.jsxs("div",{onClick:()=>{n(e.id)},onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),className:Te("workspace-item group relative transition-all cursor-pointer rounded-md border p-2","hover:shadow-sm hover:scale-[1.01]",t?"border-primary bg-primary/5":"border-border bg-surface/30",r?"animate-new-item":""),children:[h.jsxs("div",{className:"flex items-center gap-2",children:["document"===e.type&&h.jsx("input",{type:"checkbox",checked:s,onChange:t=>{t.stopPropagation(),a(e.id,t.target.checked)},className:"w-3 h-3 text-primary bg-background border-border rounded",title:"Выбрать документ"}),h.jsx("div",{className:"text-muted-foreground flex-shrink-0",children:(e=>{const t={className:"w-3 h-3"};switch(e){case"document":return h.jsx(it,o({},t));case"folder":return h.jsx(ct,o({},t));case"image":return h.jsx(ht,o({},t));case"video":return h.jsx(ns,o({},t));case"audio":return h.jsx(It,o({},t));case"archive":return h.jsx(Le,o({},t));default:return h.jsx(at,o({},t))}})(e.type)}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h4",{className:"text-xs font-medium truncate text-foreground",children:e.title}),h.jsx("span",{className:"text-[10px] text-muted-foreground ml-2 flex-shrink-0",children:Ae(e.size)})]}),e.tags.length>0&&h.jsx("span",{className:"text-[9px] text-primary bg-primary/10 px-1 py-0.5 rounded",children:e.tags[0]})]})]}),l&&h.jsxs("div",{className:"absolute top-1 right-1 flex gap-0.5",children:[h.jsx(xs,{onClick:t=>{t.stopPropagation(),i(e.id,"send-to-chat")},variant:"ghost",size:"sm",className:"w-5 h-5 p-0",title:"Отправить в чат",children:h.jsx(Ut,{className:"w-2.5 h-2.5"})}),h.jsx(xs,{onClick:t=>{t.stopPropagation(),i(e.id,"menu")},variant:"ghost",size:"sm",className:"w-5 h-5 p-0",title:"Действия",children:h.jsx(Et,{className:"w-2.5 h-2.5"})})]}),t&&h.jsx("div",{className:"absolute top-0.5 right-0.5 w-1.5 h-1.5 rounded-full bg-primary"})]})});ln.displayName="CompactWorkspaceItem";const cn=g.memo(({isOpen:e,document:t,onSave:s,onClose:r,className:n=""})=>{const[i,a]=g.useState(""),[o,l]=g.useState(""),[c,d]=g.useState(!1);g.useEffect(()=>{t&&(a(t.title),l(t.content||""),d(!1))},[t]),g.useEffect(()=>{if(t){const e=i!==t.title,s=o!==(t.content||"");d(e||s)}},[i,o,t]);const m=g.useCallback(()=>{t&&c&&(s(t.id,i,o),d(!1))},[t,i,o,c,s]),u=g.useCallback(()=>{if(c){if(!window.confirm("У вас есть несохраненные изменения. Закрыть без сохранения?"))return}r()},[c,r]),p=g.useCallback(e=>{"Escape"===e.key?u():"s"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),m())},[u,m]);return e&&t?h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/50 backdrop-blur-sm",children:h.jsxs("div",{className:Te("w-full max-w-4xl h-[80vh] bg-background border border-border rounded-xl shadow-2xl flex flex-col",n),onKeyDown:p,children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Редактор документа"}),c&&h.jsx("span",{className:"px-2 py-1 text-xs bg-orange-500/20 text-orange-500 rounded-full",children:"Есть изменения"})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs("button",{onClick:m,disabled:!c,className:Te("flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors",c?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-muted text-muted-foreground cursor-not-allowed"),title:"Сохранить (Ctrl+S)",children:[h.jsx(Bt,{className:"w-4 h-4"}),h.jsx("span",{children:"Сохранить"})]}),h.jsxs("button",{onClick:u,className:"flex items-center space-x-2 px-3 py-2 rounded-lg hover:bg-surface-hover transition-colors",title:"Закрыть (Esc)",children:[h.jsx(os,{className:"w-4 h-4"}),h.jsx("span",{children:"Закрыть"})]})]})]}),h.jsxs("div",{className:"flex-1 flex flex-col p-4 space-y-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-sm font-medium text-secondary",children:"Название документа"}),h.jsx("input",{type:"text",value:i,onChange:e=>a(e.target.value),className:"w-full px-3 py-2 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Введите название документа"})]}),h.jsxs("div",{className:"flex-1 flex flex-col space-y-2",children:[h.jsx("label",{className:"text-sm font-medium text-secondary",children:"Содержимое документа"}),h.jsx("textarea",{value:o,onChange:e=>l(e.target.value),className:"flex-1 w-full px-3 py-2 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none",placeholder:"Введите содержимое документа..."})]}),h.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("span",{children:["Символов: ",o.length]}),h.jsxs("span",{children:["Слов: ",o.split(/\s+/).filter(e=>e.length>0).length]}),h.jsxs("span",{children:["Строк: ",o.split("\n").length]})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("span",{children:"Ctrl+S для сохранения"}),h.jsx("span",{children:"Esc для закрытия"})]})]})]})]})}):null});cn.displayName="DocumentEditor";const dn=({project:e,items:t,onItemClick:s,onItemSendToChat:r,onItemDelete:n,className:i=""})=>{const[a,c]=g.useState([]),[d,m]=g.useState(!1),[u,p]=g.useState({x:0,y:0}),[x,v]=g.useState("canvas"),f=g.useRef(null);g.useEffect(()=>{const e=t.map((e,t)=>({id:e.id,x:50+t%4*200,y:50+150*Math.floor(t/4),width:180,height:120,type:e.type,title:e.title,content:e.content,isSelected:!1,isDragging:!1}));c(e)},[t]);const y=g.useCallback(e=>{const r=t.find(t=>t.id===e.id);r&&s(r)},[t,s]),b=g.useCallback((e,s)=>{s.stopPropagation();const n=t.find(t=>t.id===e.id);n&&r(n)},[t,r]),j=g.useCallback((e,s)=>{s.stopPropagation();const r=t.find(t=>t.id===e.id);r&&n(r)},[t,n]),N=g.useCallback((e,t)=>{t.preventDefault(),m(!0),p({x:t.clientX-e.x,y:t.clientY-e.y}),c(t=>t.map(t=>t.id===e.id?l(o({},t),{isDragging:!0}):t))},[]),w=g.useCallback(e=>{d&&c(t=>t.map(t=>t.isDragging?l(o({},t),{x:e.clientX-u.x,y:e.clientY-u.y}):t))},[d,u]),k=g.useCallback(()=>{m(!1),c(e=>e.map(e=>l(o({},e),{isDragging:!1})))},[]);g.useEffect(()=>{if(d)return document.addEventListener("mousemove",w),document.addEventListener("mouseup",k),()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",k)}},[d,w,k]);const S=e=>{switch(e){case"document":default:return"📄";case"image":return"🖼️";case"file":return"📁";case"note":return"📝"}},C=e=>{switch(e){case"document":return"bg-blue-100 border-blue-200 text-blue-800";case"image":return"bg-purple-100 border-purple-200 text-purple-800";case"file":default:return"bg-gray-100 border-gray-200 text-gray-800";case"note":return"bg-green-100 border-green-200 text-green-800"}};return h.jsxs("div",{className:Te("project-canvas-container h-full flex flex-col",i),children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("h2",{className:"text-lg font-semibold text-text",children:["Холст проекта: ",e.title]}),h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs("span",{className:"text-sm text-text-secondary",children:[t.length," элементов"]})})]}),h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs("div",{className:"flex rounded-lg p-0.5 bg-surface border border-border",children:[h.jsx("button",{onClick:()=>v("canvas"),className:Te("px-3 py-1.5 text-sm rounded-md transition-colors","canvas"===x?"bg-primary text-primary-foreground":"text-text-secondary hover:text-text"),children:"Холст"}),h.jsx("button",{onClick:()=>v("grid"),className:Te("px-3 py-1.5 text-sm rounded-md transition-colors","grid"===x?"bg-primary text-primary-foreground":"text-text-secondary hover:text-text"),children:"Сетка"}),h.jsx("button",{onClick:()=>v("list"),className:Te("px-3 py-1.5 text-sm rounded-md transition-colors","list"===x?"bg-primary text-primary-foreground":"text-text-secondary hover:text-text"),children:"Список"})]})})]}),h.jsx("div",{ref:f,className:"flex-1 relative overflow-auto bg-gradient-to-br from-surface/50 to-surface/30",style:{minHeight:"400px"},children:"canvas"===x?h.jsx("div",{className:"relative w-full h-full",style:{minWidth:"800px",minHeight:"600px"},children:a.map(e=>h.jsxs("div",{className:Te("absolute cursor-pointer transition-all duration-200 rounded-lg border-2 p-3",C(e.type),e.isDragging?"shadow-2xl scale-105 z-50":"shadow-md hover:shadow-lg",e.isSelected?"ring-2 ring-primary ring-offset-2":""),style:{left:e.x,top:e.y,width:e.width,height:e.height},onClick:()=>y(e),onMouseDown:t=>N(e,t),children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-lg",children:S(e.type)}),h.jsx("span",{className:"font-medium text-sm truncate",children:e.title})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:t=>b(e,t),className:"p-1 rounded hover:bg-black/10 transition-colors",title:"Отправить в чат",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),h.jsx("path",{d:"M22 2 11 13"})]})}),h.jsx("button",{onClick:t=>j(e,t),className:"p-1 rounded hover:bg-red-100 transition-colors",title:"Удалить",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),h.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]})})]})]}),e.content&&h.jsxs("div",{className:"text-xs text-text-secondary line-clamp-3",children:[e.content.substring(0,100),"..."]}),h.jsx("div",{className:"absolute bottom-2 left-2 right-2",children:h.jsx("div",{className:"text-xs text-text-secondary",children:e.type})})]},e.id))}):"grid"===x?h.jsx("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:t.map(e=>h.jsxs("div",{className:Te("p-4 rounded-lg border-2 cursor-pointer transition-all hover:shadow-lg",C(e.type)),onClick:()=>s(e),children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("span",{className:"text-lg",children:S(e.type)}),h.jsx("span",{className:"font-medium text-sm truncate",children:e.title})]}),e.content&&h.jsxs("div",{className:"text-xs text-text-secondary line-clamp-2",children:[e.content.substring(0,80),"..."]})]},e.id))}):h.jsx("div",{className:"p-4 space-y-2",children:t.map(e=>h.jsx("div",{className:Te("p-3 rounded-lg border cursor-pointer transition-all hover:shadow-md",C(e.type)),onClick:()=>s(e),children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"text-lg",children:S(e.type)}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium text-sm",children:e.title}),e.content&&h.jsxs("div",{className:"text-xs text-text-secondary",children:[e.content.substring(0,100),"..."]})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:t=>{t.stopPropagation(),r(e)},className:"p-1 rounded hover:bg-black/10 transition-colors",title:"Отправить в чат",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"m22 2-7 20-4-9-9-4Z"}),h.jsx("path",{d:"M22 2 11 13"})]})}),h.jsx("button",{onClick:t=>{t.stopPropagation(),n(e)},className:"p-1 rounded hover:bg-red-100 transition-colors",title:"Удалить",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),h.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]})})]})]})},e.id))})})]})},mn=g.memo(({item:e,isSelected:t,isChecked:s,isNew:r,viewMode:n,onItemClick:i,onItemAction:a,onDocumentCheck:l})=>{const[c,d]=g.useState(!1),[m,u]=g.useState(!1);return h.jsxs("div",{onClick:()=>{i(e.id)},onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),className:Te("workspace-item group relative transition-all cursor-pointer rounded-lg border","hover:shadow-md hover:scale-[1.02]",t?"border-primary bg-primary/5":"border-border bg-surface/50",r?"animate-new-item":""),children:[h.jsxs("div",{className:"p-3",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:["document"===e.type&&h.jsx("input",{type:"checkbox",checked:s,onChange:t=>{t.stopPropagation(),l(e.id,t.target.checked)},className:"w-3 h-3 text-primary bg-background border-border rounded",title:"Выбрать документ"}),h.jsx("div",{className:"text-muted-foreground",children:(e=>{const t={className:"w-3 h-3"};switch(e){case"document":return h.jsx(it,o({},t));case"folder":return h.jsx(ct,o({},t));case"image":return h.jsx(ht,o({},t));case"video":return h.jsx(ns,o({},t));case"audio":return h.jsx(It,o({},t));case"archive":return h.jsx(Le,o({},t));default:return h.jsx(at,o({},t))}})(e.type)}),h.jsx("button",{className:"text-sm hover:bg-surface-hover rounded px-1 py-0.5 transition-colors",onClick:e=>{e.stopPropagation(),u(!m)},title:"Изменить эмодзи",children:e.emoji||"🏷️"}),h.jsx("h4",{className:"text-sm font-medium truncate text-foreground flex-1",children:e.title})]}),m&&h.jsx("div",{className:"absolute top-12 left-2 z-20 p-2 bg-surface border border-border rounded-lg shadow-lg",children:h.jsx("div",{className:"grid grid-cols-5 gap-1",children:["📁","📝","📷","🎵","🎬","🚀","⭐","🔥","💡","✅","🧠","⚙️","🌈","🧪","🏷️"].map(t=>h.jsx("button",{className:"p-1 hover:bg-surface-hover rounded text-xs",onClick:s=>{s.stopPropagation(),a(e.id,`set-emoji:${t}`),u(!1)},children:t},t))})}),h.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[h.jsx("span",{children:Ae(e.size)}),"compact"!==n&&h.jsx("span",{children:e.updatedAt.toLocaleDateString()})]}),e.tags.length>0&&h.jsx("div",{className:"mt-2",children:h.jsxs("span",{className:"inline-block px-2 py-1 text-xs rounded-full bg-primary/10 text-primary",children:[e.tags[0],e.tags.length>1&&" +"+(e.tags.length-1)]})})]}),c&&h.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[h.jsx(xs,{onClick:t=>{t.stopPropagation(),a(e.id,"send-to-chat")},variant:"ghost",size:"sm",className:"w-6 h-6 p-0",title:"Отправить в чат",children:h.jsx(Ut,{className:"w-3 h-3"})}),h.jsx(xs,{onClick:t=>{t.stopPropagation(),a(e.id,"menu")},variant:"ghost",size:"sm",className:"w-6 h-6 p-0",title:"Действия",children:h.jsx(Et,{className:"w-3 h-3"})})]}),t&&h.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 rounded-full bg-primary"})]})});mn.displayName="WorkspaceItem";const hn=({className:e})=>{const{state:t,createWorkspaceItem:s,dispatch:r,sendMessage:n}=j(),[i,a]=g.useState(""),[c,d]=g.useState(new Set),[m,u]=g.useState(new Set),[p,x]=g.useState("compact"),[v,f]=g.useState(new Set),[y,b]=g.useState(new Set),[N,w]=g.useState(null),[k,S]=g.useState(null),[C,E]=g.useState(!1),[I,T]=g.useState(!1),A=g.useRef(null),R=g.useRef(null),M=g.useCallback(e=>t.workspaceItems.find(t=>t.id===e&&"folder"===t.type)||null,[t.workspaceItems]),_=g.useCallback(()=>{setTimeout(()=>{const e=A.current,t=document.activeElement;e&&t&&e.contains(t)||T(!0)},0)},[]);g.useEffect(()=>{if(!I)return;const e=setTimeout(()=>{E(!1),T(!1)},150);return()=>clearTimeout(e)},[I]);const P=t.workspaceItems,L=g.useMemo(()=>P.filter(e=>"folder"===e.type),[P]),O=g.useMemo(()=>P.find(e=>e.id===N&&"folder"===e.type)||null,[P,N]),$=g.useMemo(()=>{if(!O)return L;const e=`/workspaces/${O.id}/`;return P.filter(t=>{var s;return null==(s=t.path)?void 0:s.startsWith(e)})},[P,L,O]),D=g.useMemo(()=>$.filter(e=>e.title.toLowerCase().includes(i.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(i.toLowerCase()))),[$,i]);g.useEffect(()=>{const e=e=>{var t;const s=e;(null==(t=s.detail)?void 0:t.projectId)&&w(s.detail.projectId)};return window.addEventListener("workspace:navigate",e),()=>window.removeEventListener("workspace:navigate",e)},[t.workspaceItems]);const z=()=>{if(!O){const e=`proj_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return s({id:e,type:"folder",title:"Новый проект",path:"/workspaces/",size:0,tags:["project"],createdAt:new Date,updatedAt:new Date}),f(t=>new Set([...t,e])),void setTimeout(()=>f(t=>{const s=new Set(t);return s.delete(e),s}),1e3)}const e=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,t={id:e,type:"document",title:"Новый документ",content:"",path:`/workspaces/${O.id}/`,size:0,tags:[],createdAt:new Date,updatedAt:new Date};s(t),f(t=>new Set([...t,e])),setTimeout(()=>{f(t=>{const s=new Set(t);return s.delete(e),s})},1e3)},B=g.useCallback(e=>{d(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s});const s=t.workspaceItems.find(t=>t.id===e);"folder"===(null==s?void 0:s.type)&&(console.log("Workspace: Setting active project to:",s.id,s.title),w(s.id),window.dispatchEvent(new CustomEvent("workspace:navigate",{detail:{projectId:s.id}})),console.log("Workspace: Sent workspace:navigate event with projectId:",s.id))},[t.workspaceItems]),F=g.useCallback((e,s)=>{const n=t.workspaceItems.find(t=>t.id===e);if(n)switch(s){case s&&s.startsWith("set-emoji:")?s:"":{const t=s.replace("set-emoji:","");r({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e,updates:{emoji:t}}});break}case"download":if("file"===n.type){const e=document.createElement("a");e.href=n.url||"#",e.download=n.name||n.title,e.click()}break;case"edit-document":"document"===n.type&&S({id:n.id,title:n.title,content:n.content||""});break;case"send-to-chat":{const s=t.workspaceItems.find(t=>t.id===e);s&&(window.dispatchEvent(new CustomEvent("workspace:send-to-chat",{detail:{items:[s]}})),b(t=>new Set([...t,e])),setTimeout(()=>{b(t=>{const s=new Set(t);return s.delete(e),s})},1200));break}case"delete":window.confirm(`Вы уверены, что хотите удалить ${"folder"===n.type?"проект":"документ"} "${n.title}"?`)&&r({type:"REMOVE_WORKSPACE_ITEM",payload:e});break;case"share":navigator.clipboard&&n.url&&navigator.clipboard.writeText(n.url).catch(()=>{const e=document.createElement("textarea");e.value=n.url||"",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)})}},[t.workspaceItems,r]),H=g.useCallback(()=>{const e=M(N);if(!e)return;const t=(window.prompt("Новое имя проекта",e.title)||"").trim();t&&window.confirm(`Переименовать проект в "${t}"?`)&&r({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e.id,updates:{title:t,updatedAt:new Date}}})},[N,r,M]),U=g.useCallback(()=>{const e=M(N);if(!e)return;const t=e.url||`${window.location.origin}/workspaces/${e.id}`;navigator.clipboard&&navigator.clipboard.writeText(t).catch(()=>{})},[N,M]),W=g.useCallback(()=>{const e=M(N);e&&window.confirm(`Удалить проект "${e.title}"?`)&&(r({type:"REMOVE_WORKSPACE_ITEM",payload:e.id}),w(null))},[N,r,M]),G=g.useCallback((e,t)=>{const s=(t||"").trim();s&&window.confirm(`Переименовать в "${s}"?`)&&r({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e,updates:{title:s,updatedAt:new Date}}})},[r]),V=g.useCallback((e,t)=>{u(s=>{const r=new Set(s);return t?r.add(e):r.delete(e),r})},[]),q=g.useCallback(()=>{if(0===m.size)return;const e=t.workspaceItems.filter(e=>m.has(e.id)&&"document"===e.type);0!==e.length&&(window.dispatchEvent(new CustomEvent("workspace:send-to-chat",{detail:{items:e}})),e.forEach(e=>{b(t=>new Set([...t,e.id]))}),setTimeout(()=>{b(t=>{const s=new Set(t);return e.forEach(e=>s.delete(e.id)),s})},1200),u(new Set))},[m,t.workspaceItems]),K=g.useCallback((e,t,s)=>{r({type:"UPDATE_WORKSPACE_ITEM",payload:{id:e,updates:{title:t,content:s,updatedAt:new Date}}}),S(null)},[r]),Q=g.useCallback(()=>{S(null)},[]);return h.jsxs("div",{className:Te("workspace-container liquid-glass-panel flex-1 flex flex-col",e),children:[h.jsx("div",{className:"p-3 liquid-glass-block workspace-header-bg header-with-divider",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"flex items-center gap-2 mr-auto",children:O?h.jsxs(h.Fragment,{children:[h.jsx("button",{className:"sidebar-footer-button",title:"Все проекты","aria-label":"Все проекты",onClick:()=>w(null),children:h.jsx(ct,{className:"w-4 h-4 icon"})}),h.jsx("span",{className:"text-xs opacity-60",children:"/"}),h.jsx("span",{className:"text-sm workspace-title-color",children:O.title}),h.jsx("span",{className:"text-xs workspace-subtitle-color",children:D.length})]}):h.jsxs(h.Fragment,{children:[h.jsx("h1",{className:"text-base font-semibold workspace-title-color leading-none",children:"Проекты"}),h.jsx("span",{className:"text-xs workspace-subtitle-color leading-none",children:D.length})]})}),h.jsxs("div",{className:"flex rounded-lg p-0.5 workspace-view-container gap-1",children:[h.jsx("button",{onClick:()=>x("grid"),className:Te("sidebar-footer-button","grid"===p?"active":""),title:"Сетка","aria-label":"Переключить вид сетка",children:h.jsx(mt,{className:"w-3.5 h-3.5 icon"})}),h.jsx("button",{onClick:()=>x("list"),className:Te("sidebar-footer-button","list"===p?"active":""),title:"Список","aria-label":"Переключить вид список",children:h.jsx(vt,{className:"w-3.5 h-3.5 icon"})}),h.jsx("button",{onClick:()=>x("compact"),className:Te("sidebar-footer-button","compact"===p?"active":""),title:"Компактный","aria-label":"Переключить компактный вид",children:h.jsx(xt,{className:"w-3.5 h-3.5 icon"})}),h.jsx("button",{onClick:()=>x("ultra-compact"),className:Te("sidebar-footer-button","ultra-compact"===p?"active":""),title:"Ультра-компактный","aria-label":"Переключить ультра-компактный вид",children:h.jsx(mt,{className:"w-3.5 h-3.5 icon"})}),h.jsx("button",{onClick:()=>x("canvas"),className:Te("sidebar-footer-button","canvas"===p?"active":""),title:"Холст","aria-label":"Переключить вид холст",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3.5 h-3.5 icon",children:[h.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),h.jsx("path",{d:"M9 9h6v6H9z"})]})})]}),m.size>0&&h.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-3 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",title:`Отправить ${m.size} документов в чат`,children:[h.jsx(Ut,{className:"w-4 h-4"}),h.jsxs("span",{className:"text-sm",children:["Отправить в чат (",m.size,")"]})]}),h.jsxs("div",{className:"flex items-center gap-2",ref:A,children:[h.jsxs("div",{className:Te("relative flex items-center",C?"w-56":""),children:[!C&&h.jsx("button",{className:"sidebar-footer-button",title:"Поиск","aria-label":"Поиск",onClick:()=>{E(!0),requestAnimationFrame(()=>{var e;return null==(e=R.current)?void 0:e.focus()})},children:h.jsx(Ht,{className:"w-4 h-4 icon"})}),C&&h.jsxs("div",{className:Te("flex items-center gap-1 w-full",I?"animate-scale-out":"animate-scale-in animate-slide-in-down"),children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(Ht,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 workspace-search-icon-color"}),h.jsx("input",{ref:R,type:"text",placeholder:"Поиск файлов...",value:i,onChange:e=>a(e.target.value),onBlur:_,className:"w-full pl-10 pr-8 py-2 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent workspace-input-styles"})]}),h.jsx("button",{className:"sidebar-footer-button",title:"Закрыть поиск","aria-label":"Закрыть поиск",onMouseDown:e=>e.preventDefault(),onClick:()=>T(!0),children:h.jsx(os,{className:"w-4 h-4 icon"})})]})]}),h.jsxs(xs,{variant:"ghost",size:"sm",className:"sidebar-footer-button",title:"Фильтры","aria-label":"Фильтры",children:[h.jsx(ot,{className:"w-4 h-4 icon"}),h.jsx("span",{className:"sr-only",children:"Фильтры"})]})]}),O&&h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(xs,{variant:"ghost",size:"sm",className:"sidebar-footer-button",title:"Переименовать","aria-label":"Переименовать",onClick:H,children:h.jsx(_t,{className:"w-3.5 h-3.5 icon"})}),h.jsx(xs,{variant:"ghost",size:"sm",className:"sidebar-footer-button",title:"Поделиться","aria-label":"Поделиться",onClick:U,children:h.jsx(Gt,{className:"w-3.5 h-3.5 icon"})}),h.jsx(xs,{variant:"danger",size:"sm",className:"sidebar-footer-button",title:"Удалить","aria-label":"Удалить",onClick:W,children:h.jsx(Jt,{className:"w-3.5 h-3.5 icon"})})]}),h.jsx(xs,{onClick:z,variant:"primary",size:"sm",className:"sidebar-footer-button",title:"Создать",children:h.jsx($t,{className:"w-4 h-4 icon"})})]})}),h.jsx("div",{className:"p-3 backdrop-blur-sm overflow-y-auto main-content-scrollbar bg-background workspace-content-limited flex-1",children:0===D.length?h.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[h.jsx("div",{className:"w-24 h-24 rounded-full flex items-center justify-center mb-6 workspace-empty-icon-bg",children:h.jsx(ct,{className:"w-12 h-12 workspace-empty-icon-color"})}),h.jsx("h3",{className:"text-xl font-semibold mb-2 workspace-empty-title",children:i?"Ничего не найдено":O?"Нет документов":"Нет проектов"}),h.jsx("p",{className:"mb-6 max-w-md workspace-empty-subtitle",children:i?"Попробуйте изменить поисковый запрос":O?"Создайте первый документ в проекте":"Создайте первый проект"}),!i&&h.jsxs("button",{onClick:z,className:"flex items-center space-x-2 px-6 py-3 rounded-lg transition-colors workspace-create-button-styles",children:[h.jsx($t,{className:"w-5 h-5"}),h.jsx("span",{children:O?"Создать документ":"Создать проект"})]})]}):"canvas"===p&&O?h.jsx(dn,{project:O,items:D,onItemClick:e=>B(e.id),onItemSendToChat:e=>{window.dispatchEvent(new CustomEvent("workspace:send-to-chat",{detail:{items:[e]}}))},onItemDelete:e=>{window.confirm(`Вы уверены, что хотите удалить ${"folder"===e.type?"проект":"документ"} "${e.title}"?`)&&r({type:"REMOVE_WORKSPACE_ITEM",payload:e.id})},className:"flex-1"}):h.jsx("div",{className:Te("workspace-grid grid gap-3","grid"===p&&"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4","list"===p&&"grid-cols-1","compact"===p&&"grid-cols-2 sm:grid-cols-4 lg:grid-cols-6","ultra-compact"===p&&"grid-cols-3 sm:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10"),"data-view-mode":p,children:D.map(e=>{const t={key:e.id,item:e,isSelected:c.has(e.id),isChecked:m.has(e.id),isNew:v.has(e.id)||y.has(e.id),onItemClick:B,onItemAction:F,onDocumentCheck:V};return"ultra-compact"===p?h.jsx(ln,o({},t)):h.jsx(mn,l(o({},t),{viewMode:"canvas"===p?"grid":p,onItemRename:G,onEditCancel:()=>{}}))})})}),h.jsx(cn,{isOpen:null!==k,document:k,onSave:K,onClose:Q})]})},un={DEFAULT_WIDTH:280,MIN_WIDTH:200,MAX_WIDTH:500,COLLAPSED_WIDTH:60},pn={DEFAULT_WIDTH:525,MIN_WIDTH:250,MAX_WIDTH:2e3,INPUT_DEFAULT_HEIGHT:300,INPUT_MIN_HEIGHT:200,INPUT_MAX_HEIGHT:800},xn={DARK:"dark",LIGHT:"light",CUSTOM:"custom"},gn={SMALL:"small",MEDIUM:"medium",LARGE:"large"};const vn=new class{constructor(){this.config={enableSystemCommands:!0,enableServiceRouting:!0,enableContextAnalysis:!0,maxHistoryLength:50,responseTimeout:3e4},this.context={activeService:null,activeSection:"workspace",conversationHistory:[],userPreferences:{},lastActivity:new Date}}processMessage(e,t=null,s="workspace"){return d(this,null,function*(){try{this.updateContext(t,s);const r=$.getContextForAI(),n=yield this.analyzeIntentWithContext(e,r);return this.config.enableSystemCommands&&n.isSystemCommand?yield this.handleSystemCommand(e,n):this.config.enableServiceRouting&&n.shouldRouteToService&&n.serviceId?yield this.routeToService(e,{serviceId:n.serviceId,toolId:n.toolId,shouldRouteToService:n.shouldRouteToService}):yield this.handleGeneralQueryWithContext(e,n,r)}catch(r){return console.error("AI Brain error:",r),{success:!1,message:"Произошла ошибка при обработке сообщения",isSystemResponse:!0}}})}analyzeIntentWithContext(e,t){return d(this,null,function*(){const s=yield this.analyzeIntent(e);return t.attachedItems.length>0&&(s.confidence=Math.min(s.confidence+.2,1),t.attachedItems.some(e=>"document"===e.type)&&(s.serviceId||(s.serviceId="ai-assistant",s.shouldRouteToService=!0))),t.activeProject&&s.keywords.push(`проект:${t.activeProject.title}`),s})}analyzeIntent(e){return d(this,null,function*(){const t=e.toLowerCase(),s=this.extractKeywords(t),r=["настройки","settings","конфигурация","config","помощь","help","справка","команды","выход","exit","закрыть","close","очистить","clear","сброс","reset"].some(e=>t.includes(e)),n=[{service:"chatgpt-service",keywords:["chatgpt","gpt","openai","ии","ai","чат","переписать","rewrite","кратко","summary","перевести","translate"]},{service:"settings",keywords:["настройки","settings","конфигурация","config","тема","theme","цвет","color","интерфейс","interface","уведомления","notifications"]},{service:"whisper-service",keywords:["голос","voice","микрофон","mic","говорить","speak","транскрипция","transcription","записать","record"]},{service:"ai-assistant",keywords:["помощь","help","ассистент","assistant"]}];let i,a,o=!1,l=0;for(const e of n){const s=e.keywords.filter(e=>t.includes(e)).length;if(s>0){const r=s/e.keywords.length;r>l&&(l=r,i=e.service,o=!0,"chatgpt-service"===e.service?a=t.includes("переписать")||t.includes("rewrite")?"text-rewrite":t.includes("кратко")||t.includes("summary")?"summarize-text":t.includes("перевести")||t.includes("translate")?"translate-chatgpt":"chat-completion":"settings"===e.service?a=t.includes("тема")||t.includes("theme")?"toggle-theme":t.includes("интерфейс")||t.includes("interface")?"interface":t.includes("уведомления")||t.includes("notifications")?"notifications":t.includes("чат")||t.includes("chat")?"chat":t.includes("внешний вид")||t.includes("appearance")?"appearance":"open-preferences":"whisper-service"===e.service&&(a=t.includes("голос")||t.includes("voice")||t.includes("микрофон")||t.includes("mic")?"realtime-transcription":t.includes("транскрипция")||t.includes("transcription")?"audio-transcription":t.includes("команда")||t.includes("command")?"voice-commands":"realtime-transcription"))}}return{isSystemCommand:r,shouldRouteToService:o,serviceId:i,toolId:a,confidence:l,keywords:s}})}handleSystemCommand(e,t){return d(this,null,function*(){const t=e.toLowerCase();return t.includes("помощь")||t.includes("help")?{success:!0,message:this.getHelpMessage(),isSystemResponse:!0}:t.includes("очистить")||t.includes("clear")?(this.context.conversationHistory=[],{success:!0,message:"История разговора очищена",isSystemResponse:!0}):t.includes("настройки")||t.includes("settings")?yield this.routeToService(e,{serviceId:"settings",toolId:"open-preferences",shouldRouteToService:!0}):{success:!0,message:"Системная команда обработана",isSystemResponse:!0}})}routeToService(e,t){return d(this,null,function*(){if(!t.serviceId)return{success:!1,message:"Не удалось определить сервис для обработки",isSystemResponse:!0};try{const e=L.getService(t.serviceId);if(!e)return{success:!1,message:`Сервис ${t.serviceId} не найден`,isSystemResponse:!0};if(e.isLoaded||(yield L.loadService(t.serviceId)),t.toolId){const s=yield L.executeTool(t.serviceId,t.toolId);return{success:!0,message:`Сообщение обработано сервисом ${e.config.name}`,data:s,serviceId:t.serviceId,toolId:t.toolId,shouldRouteToService:!0}}const s=L.getChatFunctions().find(e=>e.isChatFunction);if(s){const r=yield L.executeTool(t.serviceId,s.id);return{success:!0,message:`Сообщение обработано сервисом ${e.config.name}`,data:r,serviceId:t.serviceId,toolId:s.id,shouldRouteToService:!0}}return{success:!0,message:`Сообщение получено сервисом ${e.config.name}`,serviceId:t.serviceId,shouldRouteToService:!0}}catch(e){return console.error("Service routing error:",e),{success:!1,message:`Ошибка при обращении к сервису: ${e instanceof Error?e.message:"Unknown error"}`,isSystemResponse:!0}}})}handleGeneralQueryWithContext(e,t,s){return d(this,null,function*(){if(s.attachedItems.length>0||s.activeProject){const t=this.buildContextInfo(s),n=`${e}\n\nКонтекст:\n${t}`;try{const e=L.getService("ai-assistant");if(e&&e.isLoaded)return{success:!0,message:`Запрос обработан с учетом контекста: ${s.contextSummary}`,serviceId:"ai-assistant",shouldRouteToService:!0,data:{enhancedMessage:n,contextInfo:t}}}catch(r){console.error("Ошибка маршрутизации к AI Assistant:",r)}}return yield this.handleGeneralQuery(e,t)})}buildContextInfo(e){const t=[];if(e.activeProject&&t.push(`Активный проект: ${e.activeProject.title}`),e.attachedItems.length>0){const s=e.attachedItems.map(e=>`${e.type}: ${e.title}${e.content?`\nСодержимое: ${e.content.substring(0,200)}...`:""}`).join("\n\n");t.push(`Прикрепленные элементы:\n${s}`)}return t.join("\n\n")}handleGeneralQuery(e,t){return d(this,null,function*(){return"workspace"===this.context.activeSection?{success:!0,message:"Сообщение получено центральным мозгом платформы",isSystemResponse:!0}:this.context.activeService?{success:!0,message:`Сообщение получено сервисом ${this.context.activeService}`,serviceId:this.context.activeService,shouldRouteToService:!0}:{success:!0,message:"Сообщение получено платформой",isSystemResponse:!0}})}updateContext(e,t){this.context.activeService=e,this.context.activeSection=t,this.context.lastActivity=new Date}extractKeywords(e){return e.split(/\s+/).filter(e=>e.length>2)}getHelpMessage(){return'🧠 **BARSUKOV PLATFORM - AI BRAIN**\n\nДоступные команды:\n\n🤖 **ChatGPT сервис**\n- "ChatGPT, помоги с..." - обращение к ChatGPT\n- "Переписать текст" - переписать с помощью GPT\n- "Краткое изложение" - создать краткое изложение\n- "Перевести текст" - перевод с помощью GPT\n\n🎤 **Whisper AI (Голосовой ввод)**\n- "Голосовой ввод" - начать голосовой ввод\n- "Транскрипция" - преобразовать речь в текст\n- "Голосовые команды" - обработать голосовые команды\n- Нажмите микрофон для живого голосового ввода\n\n⚙️ **Настройки**\n- "Настройки" - открыть настройки\n- "Сменить тему" - изменить тему оформления\n- "Настройки интерфейса" - настройки интерфейса\n- "Настройки уведомлений" - настройки уведомлений\n\n📁 **Рабочее пространство**\n- Общие вопросы обрабатываются центральным мозгом\n- Умное хранение всех данных\n- Автоматическая маршрутизация к сервисам\n\n🔧 **Системные команды**\n- "Помощь" - показать это сообщение\n- "Очистить" - очистить историю разговора\n\n💡 **Как это работает:**\n1. Отправляете сообщение в чат\n2. AI-мозг анализирует намерения\n3. Сообщение маршрутизируется к нужному сервису\n4. Получаете ответ от соответствующего сервиса\n\n🎯 **Советы:**\n- Будьте конкретны в запросах\n- Система понимает контекст и намерения\n- Команды работают на русском и английском языках'}addMessageToHistory(e){this.context.conversationHistory.push(e),this.context.conversationHistory.length>this.config.maxHistoryLength&&(this.context.conversationHistory=this.context.conversationHistory.slice(-this.config.maxHistoryLength))}getContext(){return o({},this.context)}updateConfig(e){this.config=o(o({},this.config),e)}clearContext(){this.context={activeService:null,activeSection:"workspace",conversationHistory:[],userPreferences:{},lastActivity:new Date}}},fn={user:null,authUser:null,authLoading:!1,authError:null,layout:{sidebarCollapsed:!1,sidebarWidth:un.DEFAULT_WIDTH,chatVisible:!0,chatWidth:pn.DEFAULT_WIDTH,chatInputHeight:pn.INPUT_DEFAULT_HEIGHT,workspaceLayout:"grid",activeService:null,activeTool:null,activeSection:"ai-lawyer",activeSettingsCategory:"all",activeWidgetsCategory:[],chatType:"default",expandedTabsHeight:0},services:[],activeChat:null,workspaceItems:[],settings:{theme:xn.DARK,fontSize:gn.MEDIUM,animations:!0,sidebarCollapsed:!1,useColoredText:!1,textColor:"#ffffff",accentsEnabled:!1,autoScroll:!0,hideChatFunctionButtons:!1,showTimestamps:!1},isLoading:!0,error:null,isInitialized:!1};function yn(e,t){var s;switch(t.type){case"SET_USER":return l(o({},e),{user:t.payload});case"SET_AUTH_USER":{const r=t.payload,n={id:r.id.toString(),name:`${r.first_name} ${r.last_name||""}`.trim(),email:r.username?`${r.username}@telegram.user`:"",avatar:r.photo_url,preferences:(null==(s=e.user)?void 0:s.preferences)||{theme:"dark",sidebarCollapsed:!1,notifications:!0,animations:!0,sounds:!1}};return l(o({},e),{authUser:r,user:n,authError:null})}case"CLEAR_AUTH_USER":return l(o({},e),{authUser:null,user:null,authError:null});case"SET_AUTH_LOADING":return l(o({},e),{authLoading:t.payload});case"SET_AUTH_ERROR":return l(o({},e),{authError:t.payload});case"SET_LOADING":return l(o({},e),{isLoading:t.payload});case"SET_ERROR":return l(o({},e),{error:t.payload});case"SET_INITIALIZED":return l(o({},e),{isInitialized:t.payload});case"SWITCH_SERVICE":{const s=t.payload,r=e.services.find(e=>e.config.id===s);return(null==r?void 0:r.config.theme)&&_.setTheme(`service-${s}`),l(o({},e),{layout:l(o({},e.layout),{activeService:t.payload,activeTool:null})})}case"SWITCH_TOOL":return l(o({},e),{layout:l(o({},e.layout),{activeTool:t.payload})});case"ADD_MESSAGE":return e.activeChat?l(o({},e),{activeChat:l(o({},e.activeChat),{messages:[...e.activeChat.messages,t.payload],updatedAt:new Date})}):e;case"CREATE_WORKSPACE_ITEM":{const s=t.payload;if(e.workspaceItems.find(e=>e.id===s.id))return e;const n=l(o({},s),{createdAt:s.createdAt instanceof Date?s.createdAt:new Date(s.createdAt),updatedAt:s.updatedAt instanceof Date?s.updatedAt:new Date(s.updatedAt)}),i=[...e.workspaceItems,n];try{localStorage.setItem("barsukov-workspace",JSON.stringify(i))}catch(r){}return l(o({},e),{workspaceItems:i})}case"REMOVE_WORKSPACE_ITEM":{const s=e.workspaceItems.find(e=>e.id===t.payload),n=e.workspaceItems.filter(e=>e.id!==t.payload);try{localStorage.setItem("barsukov-workspace",JSON.stringify(n))}catch(r){}const i=l(o({},e),{workspaceItems:n});return s&&H.info("Проект удалён",s.title,{duration:5e3,actions:[{label:"Отменить",action:()=>{const e=[...i.workspaceItems,s];try{localStorage.setItem("barsukov-workspace",JSON.stringify(e))}catch(r){}window.dispatchEvent(new CustomEvent("workspace:restore",{detail:s}))},variant:"primary"}]}),i}case"UPDATE_SETTINGS":{Pr.setSetting(t.payload.key,t.payload.value);const s=l(o({},e),{settings:l(o({},e.settings),{[t.payload.key]:t.payload.value})});return"chatInputHeight"===t.payload.key&&(s.layout=l(o({},s.layout),{chatInputHeight:"number"==typeof t.payload.value?t.payload.value:300})),s}case"UPDATE_WORKSPACE_ITEM":{const{id:s,updates:n}=t.payload,i=e.workspaceItems.map(e=>e.id===s?l(o(o({},e),n),{updatedAt:new Date}):e);try{localStorage.setItem("barsukov-workspace",JSON.stringify(i))}catch(r){}return l(o({},e),{workspaceItems:i})}case"TOGGLE_SIDEBAR":return l(o({},e),{layout:l(o({},e.layout),{sidebarCollapsed:!e.layout.sidebarCollapsed})});case"TOGGLE_CHAT":return l(o({},e),{layout:l(o({},e.layout),{chatVisible:!e.layout.chatVisible})});case"SET_CHAT_TYPE":return l(o({},e),{layout:l(o({},e.layout),{chatType:t.payload})});case"SET_LAYOUT":return l(o({},e),{layout:o(o({},e.layout),t.payload)});case"SWITCH_SECTION":return l(o({},e),{layout:l(o({},e.layout),{activeSection:t.payload})});case"SET_ACTIVE_SETTINGS_CATEGORY":return l(o({},e),{layout:l(o({},e.layout),{activeSettingsCategory:t.payload})});case"SET_ACTIVE_WIDGETS_CATEGORY":return l(o({},e),{layout:l(o({},e.layout),{activeWidgetsCategory:t.payload})});case"SET_EXPANDED_TABS_HEIGHT":return l(o({},e),{layout:l(o({},e.layout),{expandedTabsHeight:t.payload})});case"ADD_SERVICE":{const s=e.services.findIndex(e=>e.config.id===t.payload.config.id);if(s>=0){const r=[...e.services];return r[s]=t.payload,l(o({},e),{services:r})}return l(o({},e),{services:[...e.services,t.payload]})}case"TOGGLE_SERVICE":return l(o({},e),{services:e.services.map(e=>e.config.id===t.payload?l(o({},e),{config:l(o({},e.config),{isActive:!e.config.isActive})}):e)});case"SET_ACTIVE_CHAT":return l(o({},e),{activeChat:t.payload});default:return e}}function bn({children:e}){var t,s,r,n,i,a,c;const[m,u]=g.useReducer(yn,fn);g.useEffect(()=>{const e=e=>{const t=e.detail;t&&u({type:"CREATE_WORKSPACE_ITEM",payload:t})};return window.addEventListener("workspace:restore",e),()=>window.removeEventListener("workspace:restore",e)},[]),g.useEffect(()=>{if(m.isInitialized)return;(()=>{d(this,null,function*(){var e,t;try{u({type:"SET_LOADING",payload:!0});const[s,r,n]=yield Promise.all([Promise.resolve(localStorage.getItem("barsukov-user")),Promise.resolve(localStorage.getItem("barsukov-settings")),Promise.resolve(localStorage.getItem("barsukov-workspace"))]);if(yield R(),!m.authUser&&s){const e=JSON.parse(s);u({type:"SET_USER",payload:e})}if(r){const e=JSON.parse(r),t={chatWidth:"chatWidth",chatInputHeight:"chatInputHeight",sidebarCollapsed:"sidebarCollapsed",sidebarWidth:"sidebarWidth",workspaceLayout:"workspaceLayout"};Object.entries(e).forEach(([e,s])=>{u({type:"UPDATE_SETTINGS",payload:{key:e,value:s}}),e in t&&u({type:"SET_LAYOUT",payload:{[t[e]]:s}})})}if(n){JSON.parse(n).forEach(e=>{const t=l(o({},e),{createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)});u({type:"CREATE_WORKSPACE_ITEM",payload:t})})}yield L.loadAllServices();L.getSortedServices().forEach(e=>{u({type:"ADD_SERVICE",payload:e})});u({type:"SET_ACTIVE_CHAT",payload:{id:"default-chat",title:"Основной чат",messages:[],createdAt:new Date,updatedAt:new Date,isActive:!0}});const i=(null==(e=m.settings)?void 0:e.theme)||"light",a=null==(t=m.settings)?void 0:t.customColor;document.documentElement.setAttribute("data-theme",i),"custom"===i&&a?(Mr.applyTheme("custom"),Mr.setCustomColor(a)):Mr.applyTheme(i),u({type:"SET_LOADING",payload:!1}),u({type:"SET_INITIALIZED",payload:!0})}catch(s){console.error("Ошибка инициализации платформы:",s),u({type:"SET_ERROR",payload:"Ошибка загрузки платформы"}),u({type:"SET_LOADING",payload:!1})}})})()},[null==(t=m.settings)?void 0:t.theme,null==(s=m.settings)?void 0:s.customColor]),g.useEffect(()=>{var e,t;const s=(null==(e=m.settings)?void 0:e.theme)||"dark",r=null==(t=m.settings)?void 0:t.customColor;document.documentElement.setAttribute("data-theme",s),"custom"===s&&r?(Mr.applyTheme("custom"),Mr.setCustomColor(r)):Mr.applyTheme(s)},[null==(r=m.settings)?void 0:r.theme,null==(n=m.settings)?void 0:n.customColor]),g.useEffect(()=>{var e;const t=(null==(e=m.settings)?void 0:e.fontSize)||"medium";document.documentElement.setAttribute("data-font-size",t)},[null==(i=m.settings)?void 0:i.fontSize]),g.useEffect(()=>{var e;const t=null==(e=m.settings)?void 0:e.animations;_.queueThemeChange({type:"animation",key:"enabled",value:t?"true":"false"}),document.documentElement.setAttribute("data-animations",t?"on":"off")},[null==(a=m.settings)?void 0:a.animations]),g.useEffect(()=>{try{m.user&&localStorage.setItem("barsukov-user",JSON.stringify(m.user)),localStorage.setItem("barsukov-settings",JSON.stringify(m.settings)),localStorage.setItem("barsukov-workspace",JSON.stringify(m.workspaceItems))}catch(e){console.error("Ошибка сохранения в localStorage:",e)}},[m.user,m.settings,m.workspaceItems]);const p=g.useCallback(e=>{u({type:"SWITCH_SERVICE",payload:e})},[]),x=g.useCallback(e=>{u({type:"SWITCH_TOOL",payload:e})},[]),v=g.useCallback(e=>d(this,null,function*(){const t={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:e,sender:"user",timestamp:new Date,type:"text"};u({type:"ADD_MESSAGE",payload:t}),vn.addMessageToHistory(t);try{const t=yield vn.processMessage(e,m.layout.activeService,m.layout.activeSection),s={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:t.message,sender:t.isSystemResponse?"system":"assistant",timestamp:new Date,type:"text"};u({type:"ADD_MESSAGE",payload:s}),vn.addMessageToHistory(s),t.shouldRouteToService&&t.serviceId&&u({type:"SWITCH_SERVICE",payload:t.serviceId})}catch(s){console.error("AI Brain processing error:",s);const e={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:"Произошла ошибка при обработке сообщения. Попробуйте еще раз.",sender:"system",timestamp:new Date,type:"text"};u({type:"ADD_MESSAGE",payload:e})}}),[m.layout.activeService,m.layout.activeSection]),f=g.useCallback(e=>{m.workspaceItems.find(t=>t.id===e.id)?console.warn("Элемент с таким ID уже существует:",e.id):u({type:"CREATE_WORKSPACE_ITEM",payload:e})},[m.workspaceItems]),y=g.useCallback((e,t)=>{u({type:"UPDATE_SETTINGS",payload:{key:e,value:t}});const s={chatWidth:"chatWidth",sidebarCollapsed:"sidebarCollapsed",sidebarWidth:"sidebarWidth",workspaceLayout:"workspaceLayout"};e in s&&u({type:"SET_LAYOUT",payload:{[s[e]]:t}})},[]),j=g.useCallback(()=>{u({type:"TOGGLE_SIDEBAR"})},[]),N=g.useCallback(()=>{u({type:"TOGGLE_CHAT"})},[]),w=g.useCallback(e=>{u({type:"SET_CHAT_TYPE",payload:e})},[]),k=g.useCallback(e=>{u({type:"SWITCH_SECTION",payload:e}),setTimeout(()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0)},[]),S=g.useCallback(e=>{u({type:"SET_ACTIVE_SETTINGS_CATEGORY",payload:e})},[]),C=g.useCallback(e=>{u({type:"SET_EXPANDED_TABS_HEIGHT",payload:e})},[]),E=g.useCallback(e=>{u({type:"TOGGLE_SERVICE",payload:e}),setTimeout(()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0)},[]),I=g.useCallback((e,t)=>d(this,null,function*(){var s;try{if("settings"===e){if("open-preferences"===t||"appearance"===t||"interface"===t||"chat"===t||"notifications"===t){const e="open-preferences"===t?"appearance":t;return u({type:"SWITCH_SECTION",payload:"settings"}),u({type:"UPDATE_SETTINGS",payload:{key:"selectedSettingsCategory",value:e}}),setTimeout(()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),{success:!0,message:"Открыты настройки",data:{section:e}}}if("toggle-theme"===t){const e="dark"===((null==(s=m.settings)?void 0:s.theme)||"dark")?"light":"dark";return u({type:"UPDATE_SETTINGS",payload:{key:"theme",value:e}}),{success:!0,message:`Тема переключена: ${e}`,data:{theme:e}}}}return yield L.executeTool(e,t)}catch(r){throw console.error("Ошибка выполнения инструмента:",r),r}}),[null==(c=m.settings)?void 0:c.theme]),T=g.useCallback(e=>d(this,null,function*(){try{u({type:"SET_AUTH_LOADING",payload:!0}),u({type:"SET_AUTH_ERROR",payload:null}),console.log("[PlatformContext] Начинаем авторизацию через Telegram:",e);const t=yield Yr.loginWithTelegram(e);Yr.setStoredToken(t.token),Yr.setStoredUser(t.user),u({type:"SET_AUTH_USER",payload:t.user}),console.log("[PlatformContext] Авторизация успешна:",{userId:t.user.id,needsAgreement:t.needsAgreement}),t.needsAgreement&&console.log("[PlatformContext] Требуется принятие соглашения")}catch(t){console.error("[PlatformContext] Ошибка авторизации:",t);const e=t instanceof Error?t.message:"Ошибка авторизации";throw u({type:"SET_AUTH_ERROR",payload:e}),t}finally{u({type:"SET_AUTH_LOADING",payload:!1})}}),[]),A=g.useCallback(()=>d(this,null,function*(){try{console.log("[PlatformContext] Выход из системы"),yield Yr.logout(),u({type:"CLEAR_AUTH_USER"}),console.log("[PlatformContext] Выход выполнен успешно")}catch(e){console.error("[PlatformContext] Ошибка при выходе:",e),u({type:"CLEAR_AUTH_USER"})}}),[]),R=g.useCallback(()=>d(this,null,function*(){try{console.log("[PlatformContext] Проверка авторизации...");if(!Yr.getStoredToken())return void console.log("[PlatformContext] Токен не найден");console.log("[PlatformContext] Токен найден, проверяем пользователя...");const e=yield Yr.getCurrentUser();u({type:"SET_AUTH_USER",payload:e}),console.log("[PlatformContext] Авторизация подтверждена:",{userId:e.id,username:e.username})}catch(e){console.error("[PlatformContext] Ошибка проверки авторизации:",e),Yr.clearStorage(),u({type:"CLEAR_AUTH_USER"})}}),[]),M=g.useMemo(()=>({state:m,dispatch:u,switchService:p,switchTool:x,sendMessage:v,createWorkspaceItem:f,updateSettings:y,toggleSidebar:j,toggleChat:N,setChatType:w,switchSection:k,setActiveSettingsCategory:S,setExpandedTabsHeight:C,toggleService:E,executeServiceTool:I,loginWithTelegram:T,logout:A,checkAuth:R}),[m,u,p,x,v,f,y,j,N,w,k,S,C,E,I,T,A,R]);return h.jsx(b.Provider,{value:M,children:e})}const jn=()=>{const[e,t]=g.useState(!1),[s,r]=g.useState("hero");g.useEffect(()=>{const e=()=>{const e=["hero","features","products","pricing","testimonials","contact"],t=window.scrollY+100;for(const s of e){const e=document.getElementById(s);if(e&&e.offsetTop<=t&&e.offsetTop+e.offsetHeight>t){r(s);break}}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);const n=e=>{const s=document.getElementById(e);s&&s.scrollIntoView({behavior:"smooth"}),t(!1)};return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:[h.jsxs("nav",{className:"fixed top-0 w-full z-50 bg-black/20 backdrop-blur-md border-b border-white/10",children:[h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"flex justify-between items-center h-16",children:[h.jsx("div",{className:"flex items-center",children:h.jsx("div",{className:"flex-shrink-0",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:h.jsx(He,{className:"w-5 h-5 text-white"})}),h.jsx("span",{className:"text-xl font-bold text-white",children:"Boss AI"})]})})}),h.jsx("div",{className:"hidden md:block",children:h.jsx("div",{className:"ml-10 flex items-baseline space-x-8",children:[{id:"hero",label:"Главная"},{id:"features",label:"Возможности"},{id:"products",label:"Продукты"},{id:"pricing",label:"Цены"},{id:"testimonials",label:"Отзывы"},{id:"contact",label:"Контакты"}].map(e=>h.jsx("button",{onClick:()=>n(e.id),className:"px-3 py-2 rounded-md text-sm font-medium transition-colors "+(s===e.id?"text-purple-400 bg-purple-900/30":"text-gray-300 hover:text-white hover:bg-white/10"),children:e.label},e.id))})}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("button",{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-2 rounded-lg font-medium hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105",children:"Попробовать бесплатно"}),h.jsx("button",{className:"md:hidden text-white",onClick:()=>t(!e),"aria-label":"Открыть меню",children:h.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]})}),e&&h.jsx("div",{className:"md:hidden bg-black/50 backdrop-blur-md border-t border-white/10",children:h.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[{id:"hero",label:"Главная"},{id:"features",label:"Возможности"},{id:"products",label:"Продукты"},{id:"pricing",label:"Цены"},{id:"testimonials",label:"Отзывы"},{id:"contact",label:"Контакты"}].map(e=>h.jsx("button",{onClick:()=>n(e.id),className:"block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-white/10 w-full text-left",children:e.label},e.id))})})]}),h.jsx("section",{id:"hero",className:"pt-20 pb-16 px-4 sm:px-6 lg:px-8",children:h.jsx("div",{className:"max-w-7xl mx-auto",children:h.jsxs("div",{className:"text-center",children:[h.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-white mb-6",children:[h.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Boss AI"}),h.jsx("br",{}),h.jsx("span",{className:"text-white",children:"Платформа будущего"})]}),h.jsx("p",{className:"text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto",children:"Автоматизируйте продажи, маркетинг и бизнес-процессы с помощью искусственного интеллекта. Увеличьте выручку на 40-60% за первые 3 месяца."}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-12",children:[h.jsxs("button",{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 flex items-center space-x-2",children:[h.jsx("span",{children:"Начать бесплатно"}),h.jsx(Oe,{className:"w-5 h-5"})]}),h.jsxs("button",{className:"border border-white/30 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-white/10 transition-all duration-300 flex items-center space-x-2",children:[h.jsx(Ot,{className:"w-5 h-5"}),h.jsx("span",{children:"Смотреть демо"})]})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-8 text-gray-400",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(rs,{className:"w-5 h-5"}),h.jsx("span",{children:"2,000+ клиентов"})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Xt,{className:"w-5 h-5"}),h.jsx("span",{children:"+40% рост продаж"})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx($e,{className:"w-5 h-5"}),h.jsx("span",{children:"Топ-1 AI платформа"})]})]})]})})}),h.jsx("section",{id:"features",className:"py-20 px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("div",{className:"text-center mb-16",children:[h.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Почему выбирают Boss AI?"}),h.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Единственная платформа, которая объединяет AI, CRM, маркетинг и продажи в единую экосистему"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[{icon:He,title:"AI-ассистент 24/7",description:"Интеллектуальный помощник обрабатывает 80% рутинных запросов автоматически"},{icon:Yt,title:"Умная CRM",description:"AI-скоринг лидов, автоматические воронки продаж и персонализированные рекомендации"},{icon:ls,title:"Маркетинг-автоматизация",description:"Email-кампании, лид-магниты, ретаргетинг и A/B тестирование на одной платформе"},{icon:tt,title:"Готовые продукты",description:"Ozon-инструменты, TikTik-аналог и другие готовые решения для быстрого заработка"},{icon:dt,title:"Международные платежи",description:"Поддержка РФ и зарубежных рынков с разными ценами и платежными системами"},{icon:Vt,title:"152-ФЗ compliance",description:"Полное соответствие российскому законодательству о защите персональных данных"}].map((e,t)=>h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10 hover:bg-white/10 transition-all duration-300",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center mb-4",children:h.jsx(e.icon,{className:"w-6 h-6 text-white"})}),h.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:e.title}),h.jsx("p",{className:"text-gray-300",children:e.description})]},t))})]})}),h.jsx("section",{id:"products",className:"py-20 px-4 sm:px-6 lg:px-8 bg-black/20",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("div",{className:"text-center mb-16",children:[h.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Наши продукты"}),h.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"От готовых инструментов до полной автоматизации бизнеса"})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[h.jsxs("div",{className:"bg-gradient-to-br from-purple-900/50 to-pink-900/50 rounded-2xl p-8 border border-purple-500/30",children:[h.jsxs("div",{className:"flex items-center mb-6",children:[h.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mr-4",children:h.jsx(He,{className:"w-8 h-8 text-white"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-2xl font-bold text-white",children:"Boss AI Platform"}),h.jsx("p",{className:"text-purple-300",children:"Основная платформа"})]})]}),h.jsx("p",{className:"text-gray-300 mb-6",children:"Модульная AI-платформа с CRM, воронками продаж, маркетинг-автоматизацией и готовыми интеграциями. Все в одном месте."}),h.jsx("div",{className:"space-y-3 mb-6",children:["AI-ассистент с умной маршрутизацией","CRM с AI-скорингом лидов","Автоматические воронки продаж","Email и SMS маркетинг","Аналитика в реальном времени","Интеграция с 50+ сервисами"].map((e,t)=>h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Ve,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),h.jsx("span",{className:"text-gray-300",children:e})]},t))}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-2xl font-bold text-white",children:"от $49/мес"}),h.jsx("div",{className:"text-sm text-gray-400",children:"14 дней бесплатно"})]}),h.jsx("button",{className:"bg-white text-purple-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Попробовать"})]})]}),h.jsxs("div",{className:"bg-gradient-to-br from-blue-900/50 to-cyan-900/50 rounded-2xl p-8 border border-blue-500/30",children:[h.jsxs("div",{className:"flex items-center mb-6",children:[h.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center mr-4",children:h.jsx(Yt,{className:"w-8 h-8 text-white"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-2xl font-bold text-white",children:"Ozon-инструменты"}),h.jsx("p",{className:"text-blue-300",children:"Готовые продукты"})]})]}),h.jsx("p",{className:"text-gray-300 mb-6",children:"Набор инструментов для автоматизации работы с Ozon: автоудаление из архива, управление акциями, оптимизация каталога."}),h.jsx("div",{className:"space-y-3 mb-6",children:["Автоудаление из архива","Автоудаление из акций","Раскладчик товаров","AI-рекомендации по позиционированию","Аналитика продаж","Интеграция с Ozon API"].map((e,t)=>h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Ve,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),h.jsx("span",{className:"text-gray-300",children:e})]},t))}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-2xl font-bold text-white",children:"от $99"}),h.jsx("div",{className:"text-sm text-gray-400",children:"Разовая покупка"})]}),h.jsx("button",{className:"bg-white text-blue-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Купить"})]})]})]})]})}),h.jsx("section",{id:"pricing",className:"py-20 px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("div",{className:"text-center mb-16",children:[h.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Выберите свой план"}),h.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Гибкие тарифы для бизнеса любого размера"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Базовый"}),h.jsx("p",{className:"text-gray-400",children:"Для малого бизнеса"}),h.jsxs("div",{className:"mt-4",children:[h.jsx("span",{className:"text-4xl font-bold text-white",children:"$49"}),h.jsx("span",{className:"text-gray-400",children:"/мес"})]})]}),h.jsx("div",{className:"space-y-4 mb-8",children:["10 AI-запросов в день","CRM до 100 контактов","Базовые воронки продаж","Email поддержка","Мобильное приложение"].map((e,t)=>h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Ve,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),h.jsx("span",{className:"text-gray-300",children:e})]},t))}),h.jsx("button",{className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300",children:"Начать бесплатно"})]}),h.jsxs("div",{className:"bg-gradient-to-br from-purple-900/50 to-pink-900/50 rounded-2xl p-8 border border-purple-500/50 relative",children:[h.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:h.jsx("span",{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-4 py-2 rounded-full text-sm font-semibold",children:"Популярный"})}),h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Профессиональный"}),h.jsx("p",{className:"text-gray-400",children:"Для растущего бизнеса"}),h.jsxs("div",{className:"mt-4",children:[h.jsx("span",{className:"text-4xl font-bold text-white",children:"$149"}),h.jsx("span",{className:"text-gray-400",children:"/мес"})]})]}),h.jsx("div",{className:"space-y-4 mb-8",children:["Безлимитные AI-запросы","CRM до 10,000 контактов","Продвинутые воронки продаж","Email и SMS маркетинг","Приоритетная поддержка","Интеграции с 50+ сервисами","Аналитика и отчеты","Командная работа"].map((e,t)=>h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Ve,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),h.jsx("span",{className:"text-gray-300",children:e})]},t))}),h.jsx("button",{className:"w-full bg-white text-purple-600 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Попробовать бесплатно"})]}),h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Корпоративный"}),h.jsx("p",{className:"text-gray-400",children:"Для крупных компаний"}),h.jsxs("div",{className:"mt-4",children:[h.jsx("span",{className:"text-4xl font-bold text-white",children:"$499"}),h.jsx("span",{className:"text-gray-400",children:"/мес"})]})]}),h.jsx("div",{className:"space-y-4 mb-8",children:["Все функции Pro","Белый лейбл","Кастомные интеграции","Выделенный менеджер","SLA 99.9%","Обучение команды","Приоритетная разработка","24/7 поддержка"].map((e,t)=>h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Ve,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),h.jsx("span",{className:"text-gray-300",children:e})]},t))}),h.jsx("button",{className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300",children:"Связаться с нами"})]})]})]})}),h.jsx("section",{id:"testimonials",className:"py-20 px-4 sm:px-6 lg:px-8 bg-black/20",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("div",{className:"text-center mb-16",children:[h.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Что говорят наши клиенты"}),h.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Более 2,000 компаний уже увеличили продажи с Boss AI"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[{name:"Александр Петров",company:"CEO, TechStart",content:"Boss AI помог нам увеличить конверсию на 47% за 3 месяца. AI-ассистент обрабатывает 80% запросов автоматически.",rating:5},{name:"Мария Сидорова",company:"Маркетинг-директор, RetailPro",content:"Лучшая CRM, которую мы использовали. Автоматические воронки продаж экономят нам 15 часов в неделю.",rating:5},{name:"Дмитрий Козлов",company:"Основатель, E-commerce Plus",content:"Ozon-инструменты от Boss AI увеличили наши продажи на 35%. Окупились за первый месяц.",rating:5}].map((e,t)=>h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[h.jsx("div",{className:"flex items-center mb-4",children:[...Array(e.rating)].map((e,t)=>h.jsx(Zt,{className:"w-5 h-5 text-yellow-400 fill-current"},t))}),h.jsxs("p",{className:"text-gray-300 mb-4 italic",children:['"',e.content,'"']}),h.jsxs("div",{children:[h.jsx("div",{className:"font-semibold text-white",children:e.name}),h.jsx("div",{className:"text-sm text-gray-400",children:e.company})]})]},t))})]})}),h.jsx("section",{id:"contact",className:"py-20 px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("div",{className:"text-center mb-16",children:[h.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Готовы начать?"}),h.jsx("p",{className:"text-xl text-gray-300 max-w-2xl mx-auto",children:"Свяжитесь с нами или начните бесплатный пробный период прямо сейчас"})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-2xl font-bold text-white mb-6",children:"Свяжитесь с нами"}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:h.jsx(bt,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{children:[h.jsx("div",{className:"text-white font-semibold",children:"Email"}),h.jsx("div",{className:"text-gray-400",children:"hello@bossai.ru"})]})]}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:h.jsx(Lt,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{children:[h.jsx("div",{className:"text-white font-semibold",children:"Телефон"}),h.jsx("div",{className:"text-gray-400",children:"+7 (495) 123-45-67"})]})]}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:h.jsx(jt,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{children:[h.jsx("div",{className:"text-white font-semibold",children:"Адрес"}),h.jsx("div",{className:"text-gray-400",children:"Москва, ул. Тверская, 1"})]})]})]})]}),h.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10",children:h.jsxs("form",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Имя"}),h.jsx("input",{type:"text",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Ваше имя"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Email"}),h.jsx("input",{type:"email",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"your@email.com"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Компания"}),h.jsx("input",{type:"text",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Название компании"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Сообщение"}),h.jsx("textarea",{rows:4,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Расскажите о ваших задачах..."})]}),h.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300",children:"Отправить сообщение"})]})})]})]})}),h.jsx("footer",{className:"bg-black/50 border-t border-white/10 py-12 px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[h.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:h.jsx(He,{className:"w-5 h-5 text-white"})}),h.jsx("span",{className:"text-xl font-bold text-white",children:"Boss AI"})]}),h.jsx("p",{className:"text-gray-400 mb-4",children:"Платформа будущего для автоматизации бизнеса с помощью искусственного интеллекта."})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-white font-semibold mb-4",children:"Продукты"}),h.jsx("ul",{className:"space-y-2",children:["Boss AI Platform","Ozon-инструменты","TikTok-аналог","Маркетплейс"].map(e=>h.jsx("li",{children:h.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-white font-semibold mb-4",children:"Поддержка"}),h.jsx("ul",{className:"space-y-2",children:["Документация","База знаний","API","Статус системы"].map(e=>h.jsx("li",{children:h.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-white font-semibold mb-4",children:"Компания"}),h.jsx("ul",{className:"space-y-2",children:["О нас","Карьера","Блог","Контакты"].map(e=>h.jsx("li",{children:h.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]})]}),h.jsx("div",{className:"border-t border-white/10 mt-8 pt-8 text-center text-gray-400",children:h.jsx("p",{children:"© 2025 Boss AI. Все права защищены."})})]})})]})};const Nn=new class{constructor(){this.widgets=new Map,this.widgetTypes=new Map,this.nextZIndex=1e3,this.isEnabled=!0,this.initializeDefaultWidgets()}initializeDefaultWidgets(){this.registerWidgetType({id:"time-widget",name:"Часы",description:"Отображает текущее время и дату",icon:"Clock",category:"utility",defaultSize:{width:200,height:120},minSize:{width:150,height:80},maxSize:{width:300,height:200},component:()=>null,settings:[{id:"show-seconds",name:"Показывать секунды",type:"boolean",defaultValue:!0,description:"Отображать секунды в часах"},{id:"show-date",name:"Показывать дату",type:"boolean",defaultValue:!0,description:"Отображать дату под временем"},{id:"format24h",name:"24-часовой формат",type:"boolean",defaultValue:!0,description:"Использовать 24-часовой формат времени"}]}),this.registerWidgetType({id:"voice-widget",name:"Голосовой ввод",description:"Быстрый доступ к голосовому вводу",icon:"Mic",category:"input",defaultSize:{width:180,height:100},minSize:{width:120,height:60},maxSize:{width:250,height:150},component:()=>null,settings:[{id:"auto-start",name:"Автозапуск",type:"boolean",defaultValue:!1,description:"Автоматически начинать запись при открытии"},{id:"show-transcription",name:"Показывать транскрипцию",type:"boolean",defaultValue:!0,description:"Отображать транскрибированный текст"}]})}registerWidgetType(e){this.widgetTypes.set(e.id,e)}createWidget(e,t={}){const s=this.widgetTypes.get(e);if(!s)throw new Error(`Widget type ${e} not found`);const r=o({id:`widget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:e,title:s.name,description:s.description,icon:s.icon,serviceId:t.serviceId,position:t.position||{x:100,y:100},size:t.size||o({},s.defaultSize),isMinimized:!1,isVisible:!0,isDraggable:!0,isResizable:!0,zIndex:this.nextZIndex++,settings:this.initializeWidgetSettings(s.settings),component:s.component},t);return this.widgets.set(r.id,r),r}initializeWidgetSettings(e){const t={};return e.forEach(e=>{t[e.id]=e.defaultValue}),t}getWidget(e){return this.widgets.get(e)}getAllWidgets(){return Array.from(this.widgets.values())}getVisibleWidgets(){return Array.from(this.widgets.values()).filter(e=>e.isVisible)}getWidgetTypes(){return Array.from(this.widgetTypes.values())}getWidgetTypesByCategory(e){return Array.from(this.widgetTypes.values()).filter(t=>t.category===e)}updateWidget(e,t){const s=this.widgets.get(e);s&&Object.assign(s,t)}moveWidget(e,t){this.updateWidget(e,{position:t})}resizeWidget(e,t){const s=this.widgets.get(e);if(s){const r=this.widgetTypes.get(s.type);if(r){const s={width:Math.max(r.minSize.width,Math.min(r.maxSize.width,t.width)),height:Math.max(r.minSize.height,Math.min(r.maxSize.height,t.height))};this.updateWidget(e,{size:s})}}}toggleMinimize(e){const t=this.widgets.get(e);t&&this.updateWidget(e,{isMinimized:!t.isMinimized})}toggleVisibility(e){const t=this.widgets.get(e);t&&this.updateWidget(e,{isVisible:!t.isVisible})}bringToFront(e){this.updateWidget(e,{zIndex:this.nextZIndex++})}removeWidget(e){this.widgets.delete(e)}clearAllWidgets(){this.widgets.clear()}setEnabled(e){this.isEnabled=e}isWidgetsEnabled(){return this.isEnabled}exportConfig(){const e={widgets:Array.from(this.widgets.values()).map(e=>({id:e.id,type:e.type,title:e.title,position:e.position,size:e.size,isMinimized:e.isMinimized,isVisible:e.isVisible,settings:e.settings})),widgetTypes:Array.from(this.widgetTypes.values())};return JSON.stringify(e,null,2)}importConfig(e){try{const t=JSON.parse(e);if(t.widgets)for(const e of t.widgets){this.widgetTypes.get(e.type)&&this.createWidget(e.type,e)}}catch(t){console.error("Error importing widgets config:",t)}}};const wn=new class{constructor(e){this.metrics=[],this.observer=null,this.reportingInterval=null,this.config=e,this.sessionId=this.generateSessionId(),this.initializeMonitoring()}initializeMonitoring(){"undefined"!=typeof window&&window.performance&&(this.config.enableNavigationTiming&&this.collectNavigationMetrics(),this.config.enableResourceTiming&&this.setupResourceObserver(),this.config.enablePaintTiming&&this.setupPaintObserver(),this.config.enableLayoutTiming&&this.setupLayoutObserver(),this.config.enableScriptTiming&&this.setupScriptObserver(),this.config.enableReporting&&this.setupReporting())}collectNavigationMetrics(){const e=performance.getEntriesByType("navigation")[0];if(e){const t=[{id:this.generateMetricId(),name:"DOMContentLoaded",value:e.domContentLoadedEventEnd-e.domContentLoadedEventStart,unit:"ms",timestamp:new Date,category:"navigation"},{id:this.generateMetricId(),name:"LoadComplete",value:e.loadEventEnd-e.loadEventStart,unit:"ms",timestamp:new Date,category:"navigation"},{id:this.generateMetricId(),name:"FirstByte",value:e.responseStart-e.requestStart,unit:"ms",timestamp:new Date,category:"navigation"},{id:this.generateMetricId(),name:"DOMInteractive",value:e.domInteractive-e.fetchStart,unit:"ms",timestamp:new Date,category:"navigation"}];this.addMetrics(t)}}setupResourceObserver(){window.PerformanceObserver&&(this.observer=new PerformanceObserver(e=>{const t=e.getEntries(),s=[];t.forEach(e=>{this.shouldSample()&&s.push({id:this.generateMetricId(),name:`Resource_${e.name.split("/").pop()}`,value:e.duration,unit:"ms",timestamp:new Date,category:"resource",metadata:{resourceType:e.initiatorType||"unknown",resourceSize:e.transferSize||0}})}),this.addMetrics(s)}),this.observer.observe({entryTypes:["resource"]}))}setupPaintObserver(){if(!window.PerformanceObserver)return;new PerformanceObserver(e=>{const t=e.getEntries(),s=[];t.forEach(e=>{this.shouldSample()&&s.push({id:this.generateMetricId(),name:e.name,value:e.startTime,unit:"ms",timestamp:new Date,category:"paint"})}),this.addMetrics(s)}).observe({entryTypes:["paint"]})}setupLayoutObserver(){if(!window.PerformanceObserver)return;new PerformanceObserver(e=>{const t=e.getEntries(),s=[];t.forEach(e=>{this.shouldSample()&&s.push({id:this.generateMetricId(),name:"LayoutShift",value:e.value,unit:"count",timestamp:new Date,category:"layout",metadata:{hadRecentInput:e.hadRecentInput}})}),this.addMetrics(s)}).observe({entryTypes:["layout-shift"]})}setupScriptObserver(){if(!window.PerformanceObserver)return;new PerformanceObserver(e=>{const t=e.getEntries(),s=[];t.forEach(e=>{this.shouldSample()&&s.push({id:this.generateMetricId(),name:"ScriptExecution",value:e.duration,unit:"ms",timestamp:new Date,category:"script",metadata:{scriptName:e.name}})}),this.addMetrics(s)}).observe({entryTypes:["measure","mark"]})}addCustomMetric(e,t,s,r){if(!this.config.enableCustomMetrics)return;const n={id:this.generateMetricId(),name:e,value:t,unit:s,timestamp:new Date,category:"custom",metadata:r};this.addMetrics([n])}measureFunction(e,t){const s=performance.now(),r=t(),n=performance.now();return this.addCustomMetric(`Function_${e}`,n-s,"ms"),r}measureAsyncFunction(e,t){return d(this,null,function*(){const s=performance.now(),r=yield t(),n=performance.now();return this.addCustomMetric(`AsyncFunction_${e}`,n-s,"ms"),r})}getMetrics(){return[...this.metrics]}getMetricsByCategory(e){return this.metrics.filter(t=>t.category===e)}getMetricsByName(e){return this.metrics.filter(t=>t.name===e)}getPerformanceStats(){var e;const t=this.getMetricsByName("LoadComplete"),s=this.getMetricsByCategory("paint"),r=this.getMetricsByCategory("resource"),n=t.length>0?t.reduce((e,t)=>e+t.value,0)/t.length:0,i=s.length>0?s.reduce((e,t)=>e+t.value,0)/s.length:0,a=(null==(e=performance.memory)?void 0:e.usedJSHeapSize)||0,o=r.sort((e,t)=>e.value-t.value),l=o.slice(-5),c=o.slice(0,5);return{totalMetrics:this.metrics.length,averageLoadTime:n,averageRenderTime:i,memoryUsage:a,slowestResources:l,fastestResources:c}}generateReport(){const e=this.getPerformanceStats();return{sessionId:this.sessionId,timestamp:new Date,metrics:this.metrics,summary:{totalMetrics:e.totalMetrics,averageLoadTime:e.averageLoadTime,averageRenderTime:e.averageRenderTime,memoryUsage:e.memoryUsage,errorCount:0}}}clearMetrics(){this.metrics=[]}stopMonitoring(){this.observer&&(this.observer.disconnect(),this.observer=null),this.reportingInterval&&(clearInterval(this.reportingInterval),this.reportingInterval=null)}addMetrics(e){this.metrics.length>=this.config.maxMetricsPerSession||this.metrics.push(...e)}shouldSample(){return Math.random()<this.config.sampleRate}setupReporting(){this.config.reportingEndpoint&&(this.reportingInterval=setInterval(()=>{const e=this.generateReport();this.sendReport(e)},this.config.reportingInterval))}sendReport(e){return d(this,null,function*(){if(this.config.reportingEndpoint)try{yield fetch(this.config.reportingEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){console.error("Failed to send performance report:",t)}})}generateSessionId(){return`perf_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateMetricId(){return`metric_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}({enableNavigationTiming:!0,enableResourceTiming:!0,enablePaintTiming:!0,enableLayoutTiming:!0,enableScriptTiming:!0,enableCustomMetrics:!0,sampleRate:.1,maxMetricsPerSession:1e3,enableReporting:!1,reportingInterval:6e4});const kn=new class{constructor(e){this.currentSession=null,this.sessions=[],this.events=[],this.reportingInterval=null,this.sessionTimeout=null,this.config=e,this.initializeTracking()}initializeTracking(){this.config.enableTracking&&(this.config.enableSessionTracking&&this.startSession(),this.config.enablePageTracking&&this.setupPageTracking(),this.config.enableServiceTracking&&this.setupServiceTracking(),this.config.enableReporting&&this.setupReporting(),this.setupSessionTimeout())}startSession(){this.currentSession&&this.endSession(),this.currentSession={id:this.generateSessionId(),startTime:new Date,events:[],userAgent:navigator.userAgent,referrer:document.referrer,pageViews:0,interactions:0},this.sessions.push(this.currentSession),this.resetSessionTimeout()}endSession(){this.currentSession&&(this.currentSession.endTime=new Date,this.currentSession.duration=this.currentSession.endTime.getTime()-this.currentSession.startTime.getTime(),this.currentSession=null,this.sessionTimeout&&(clearTimeout(this.sessionTimeout),this.sessionTimeout=null))}trackEvent(e,t,s,r,n){if(!this.config.enableEventTracking||!this.currentSession)return;const i={id:this.generateEventId(),type:e,action:t,component:s,service:r,timestamp:new Date,sessionId:this.currentSession.id,metadata:n};this.events.push(i),this.currentSession.events.push(i),this.currentSession.interactions++,this.currentSession.events.length>=this.config.maxEventsPerSession&&(this.endSession(),this.startSession())}trackPageView(e,t){this.config.enablePageTracking&&(this.trackEvent("page","view",void 0,void 0,o({page:e},t)),this.currentSession&&this.currentSession.pageViews++)}trackServiceUsage(e,t,s){this.config.enableServiceTracking&&this.trackEvent("service",t,void 0,e,s)}trackComponentInteraction(e,t,s){this.trackEvent("component",t,e,void 0,s)}trackError(e,t,s,r){this.trackEvent("error","occurred",t,s,o({errorMessage:e.message,errorStack:e.stack,errorName:e.name},r))}trackPerformance(e,t,s,r){this.trackEvent("performance",e,void 0,void 0,o({value:t,unit:s},r))}getUsageStats(){const e=this.sessions.length,t=this.events.length,s=e>0?this.sessions.reduce((e,t)=>e+(t.duration||0),0)/e:0,r=new Map;this.events.forEach(e=>{e.component&&r.set(e.component,(r.get(e.component)||0)+1)});const n=Array.from(r.entries()).map(([e,t])=>({component:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10),i=new Map;this.events.forEach(e=>{e.service&&i.set(e.service,(i.get(e.service)||0)+1)});const a=Array.from(i.entries()).map(([e,t])=>({service:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10),o=new Map;this.events.forEach(e=>{o.set(e.action,(o.get(e.action)||0)+1)});const l=Array.from(o.entries()).map(([e,t])=>({action:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10),c=new Date,d=new Date(c.getTime()-864e5),m=new Date(c.getTime()-6048e5),h=new Date(c.getTime()-2592e6);return{totalSessions:e,totalEvents:t,averageSessionDuration:s,mostUsedComponents:n,mostUsedServices:a,popularActions:l,userEngagement:{dailyActiveUsers:new Set(this.sessions.filter(e=>e.startTime>=d).map(e=>e.userId).filter(Boolean)).size,weeklyActiveUsers:new Set(this.sessions.filter(e=>e.startTime>=m).map(e=>e.userId).filter(Boolean)).size,monthlyActiveUsers:new Set(this.sessions.filter(e=>e.startTime>=h).map(e=>e.userId).filter(Boolean)).size}}}getEventsByType(e){return this.events.filter(t=>t.type===e)}getEventsByComponent(e){return this.events.filter(t=>t.component===e)}getEventsByService(e){return this.events.filter(t=>t.service===e)}getUserSessions(e){return this.sessions.filter(t=>t.userId===e)}clearData(){this.events=[],this.sessions=[],this.currentSession&&(this.currentSession.events=[])}stopTracking(){this.endSession(),this.reportingInterval&&(clearInterval(this.reportingInterval),this.reportingInterval=null),this.sessionTimeout&&(clearTimeout(this.sessionTimeout),this.sessionTimeout=null)}setupPageTracking(){let e=window.location.href;const t=()=>{window.location.href!==e&&(e=window.location.href,this.trackPageView(e))};window.addEventListener("popstate",t);const s=history.pushState,r=history.replaceState;history.pushState=function(...e){s.apply(history,e),t()},history.replaceState=function(...e){r.apply(history,e),t()}}setupServiceTracking(){}setupReporting(){this.config.reportingEndpoint&&(this.reportingInterval=setInterval(()=>{this.sendReport()},this.config.reportingInterval))}setupSessionTimeout(){this.resetSessionTimeout()}resetSessionTimeout(){this.sessionTimeout&&clearTimeout(this.sessionTimeout),this.sessionTimeout=setTimeout(()=>{this.endSession(),this.startSession()},this.config.sessionTimeout)}sendReport(){return d(this,null,function*(){if(!this.config.reportingEndpoint)return;const e={sessions:this.sessions,events:this.events,stats:this.getUsageStats(),timestamp:new Date};try{yield fetch(this.config.reportingEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){console.error("Failed to send analytics report:",t)}})}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateEventId(){return`event_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}({enableTracking:!0,enableSessionTracking:!0,enableEventTracking:!0,enableUserTracking:!0,enablePageTracking:!0,enableServiceTracking:!0,sessionTimeout:18e5,maxEventsPerSession:1e3,enableReporting:!1,reportingInterval:3e5,enableLocalStorage:!0,enableCookies:!1}),Sn=g.memo(()=>{const e=j(),{state:t,updateSettings:s,switchSection:r}=e;g.useEffect(()=>{Nn.registerWidgetType({id:"time-widget",name:"Часы",description:"Отображает текущее время и дату",icon:"Clock",category:"utility",defaultSize:{width:200,height:120},minSize:{width:150,height:80},maxSize:{width:300,height:200},component:nn,settings:[{id:"show-seconds",name:"Показывать секунды",type:"boolean",defaultValue:!0,description:"Отображать секунды в часах"},{id:"show-date",name:"Показывать дату",type:"boolean",defaultValue:!0,description:"Отображать дату под временем"},{id:"format24h",name:"24-часовой формат",type:"boolean",defaultValue:!0,description:"Использовать 24-часовой формат времени"}]}),Nn.registerWidgetType({id:"voice-widget",name:"Голосовой ввод",description:"Быстрый доступ к голосовому вводу",icon:"Mic",category:"input",defaultSize:{width:180,height:100},minSize:{width:120,height:60},maxSize:{width:250,height:150},component:an,settings:[{id:"auto-start",name:"Автозапуск",type:"boolean",defaultValue:!1,description:"Автоматически начинать запись при открытии"},{id:"show-transcription",name:"Показывать транскрипцию",type:"boolean",defaultValue:!0,description:"Отображать транскрибированный текст"}]}),console.log("Widgets initialized successfully")},[]),g.useEffect(()=>{Zs.restoreAccentSet()},[]),g.useEffect(()=>{kn.startSession(),kn.trackPageView(window.location.href),wn.addCustomMetric("AppLoad",performance.now(),"ms"),ws.registerErrorHandler((e,t)=>{kn.trackError(e,null==t?void 0:t.component,null==t?void 0:t.service,null==t?void 0:t.metadata)})},[]),g.useEffect(()=>{const e=()=>{"prompts"===t.layout.activeSection?r("workspace"):r("prompts")};return window.addEventListener("prompts:open",e),()=>window.removeEventListener("prompts:open",e)},[t.layout.activeSection,r]);const n=g.useCallback(e=>{e.preventDefault();const r=e.clientX,n=t.layout.chatWidth;let i,a=0;const o=e=>{const o=performance.now();o-a<16||(i&&cancelAnimationFrame(i),i=requestAnimationFrame(()=>{const i=e.clientX-r,l=n-i,c=Math.min(2e3,Math.max(250,l)),d=document.querySelector(".chat-container");if(d){const e=0;if(d.getBoundingClientRect().right-c<e)return}Math.abs(c-t.layout.chatWidth)>1&&(s("chatWidth",c),a=o)}))},l=()=>{i&&cancelAnimationFrame(i),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",l)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",l)},[t.layout.chatWidth,s]),i=g.useCallback(e=>{e.preventDefault();const r=e.clientY,n=t.layout.chatInputHeight;let i,a=0;const o=e=>{const o=performance.now();o-a<16||(i&&cancelAnimationFrame(i),i=requestAnimationFrame(()=>{const i=e.clientY-r,l=n-i,c=Math.min(800,Math.max(200,l));c===l&&Math.abs(c-t.layout.chatInputHeight)>1&&(s("chatInputHeight",c),a=o)}))},l=()=>{i&&cancelAnimationFrame(i),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",l)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",l)},[t.layout.chatInputHeight,s]);return t.isInitialized?t.isInitialized&&!t.authUser?h.jsx(p,{mode:"wait",children:h.jsx(Jr,{onAuthSuccess:(e,t)=>{console.log("[App] Авторизация успешна:",e),console.log("Auth success, user:", e)},onAuthError:e=>{console.error("[App] Ошибка авторизации:",e)}})}):t.isLoading?h.jsxs(u.div,{className:"h-screen w-screen flex flex-col items-center justify-center app-loading-screen relative",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:[h.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 z-50 animated-top-bar"}),h.jsxs(u.div,{className:"text-center mb-4",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},"aria-label":"Загрузка Boss Ai",children:[h.jsx("div",{className:"loading-boss-logo",children:"Boss Ai"}),h.jsx("div",{className:"loading-boss-dots"})]})]}):t.error?h.jsx("div",{className:"h-screen flex items-center justify-center error-container",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-warning-500 rounded-full flex items-center justify-center mb-4 mx-auto",children:h.jsx("span",{className:"text-2xl",children:"⚠️"})}),h.jsx("h2",{className:"text-xl font-semibold mb-2 error-title",children:"Ошибка загрузки"}),h.jsx("p",{className:"mb-4 error-message",children:t.error}),h.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 rounded-lg transition-all duration-200 shadow-lg error-button",children:"Перезагрузить"})]})}):h.jsxs(u.div,{className:"min-h-screen w-screen flex app-container",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.6,ease:"easeOut"},children:[h.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 z-50 animated-top-bar"}),h.jsx(u.div,{className:Te("sidebar-container relative sidebar-dynamic-width",t.layout.sidebarCollapsed&&"collapsed"),initial:{opacity:0,x:-20,scale:.98},animate:{opacity:1,x:0,scale:1},transition:{duration:.8,delay:.1,ease:[.25,.46,.45,.94]},children:h.jsx(en,{})}),h.jsxs(u.div,{className:"flex-1 flex h-screen main-content",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[h.jsx(u.div,{className:Te("flex-1 overflow-x-hidden main-content-scrollbar rounded-2xl expanded-tabs-container","widgets"===t.layout.activeSection&&"service-tabs-expanded"),initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.4},style:{"--expanded-height":`${t.layout.expandedTabsHeight}px`},children:"ozon-manager"===t.layout.activeSection?h.jsx(fr,{}):"ai-lawyer"===t.layout.activeSection?h.jsx(hr,{}):"corporate"===t.layout.activeSection?h.jsx(jn,{}):"sales-scripts"===t.layout.activeSection?h.jsx(Is,{}):"regulations"===t.layout.activeSection?h.jsx(Es,{}):"photo-studio"===t.layout.activeSection?h.jsx(br,{}):h.jsx(hn,{})}),"settings"===t.layout.activeSection&&h.jsx(u.div,{className:"settings-panel relative rounded-2xl full-height",initial:{opacity:0,x:10,scale:.99},animate:{opacity:1,x:0,scale:1},transition:{duration:.3,delay:.2},style:{width:500},children:h.jsx(Kr,{})}),"prompts"===t.layout.activeSection&&h.jsx(u.div,{className:"prompts-panel relative rounded-2xl full-height",initial:{opacity:0,x:10,scale:.99},animate:{opacity:1,x:0,scale:1},transition:{duration:.3,delay:.2},style:{width:800},children:h.jsx(Sr,{})}),t.layout.chatVisible&&h.jsxs(u.div,{className:"chat-container relative rounded-2xl h-screen max-h-screen",style:{"--chat-width":`${t.layout.chatWidth}px`},initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},children:[h.jsx(Ns,{onInputResize:i}),h.jsx("div",{className:"chat-resizer",onMouseDown:n,title:"Изменить ширину чата"})]})]}),h.jsx(on,{onTranscriptionComplete:e=>{console.log("Widget transcription:",e)}})]}):h.jsxs(u.div,{className:"h-screen w-screen flex flex-col items-center justify-center app-loading-screen relative",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:[h.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 z-50 animated-top-bar"}),h.jsxs(u.div,{className:"text-center mb-4",initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},"aria-label":"Загрузка Boss Ai",children:[h.jsx("div",{className:"loading-boss-logo",children:"Boss Ai"}),h.jsx("div",{className:"loading-boss-dots"})]})]})});Sn.displayName="AppContent";const Cn=g.memo(()=>{const{handleError:e}={handleError:(e,t)=>{console.error("Application error:",e,t)}};return h.jsx(ks,{onError:e,children:h.jsxs(bn,{children:[h.jsx(p,{mode:"wait",children:h.jsx(Sn,{})}),h.jsx(Cs,{})]})})});Cn.displayName="App";document.documentElement.getAttribute("data-theme")||document.documentElement.setAttribute("data-theme","dark");f.createRoot(document.getElementById("root")).render(h.jsx(v.StrictMode,{children:h.jsx(Cn,{})}));
