# üìã –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï v3.0 FINAL: Telegram Bot "–ö–∞—Ç—è" –¥–ª—è Boss AI Platform

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** –ù–∏–∫–æ–ª–∞–π
**–î–∞—Ç–∞:** 20 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 3.0 FINAL (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ üöÄ

---

## üéØ –¶–ï–õ–¨ –ü–†–û–ï–ö–¢–ê

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å **Telegram –±–æ—Ç–∞ "–ö–∞—Ç—è"** –∫–∞–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Boss AI —Å —Ñ—É–Ω–∫—Ü–∏–µ–π **—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ –∫–æ–º–∞–Ω–¥—ã** (Institutional Knowledge), –∫–æ—Ç–æ—Ä—ã–π:

1. **–†–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤—É—Ö —Ä–µ–∂–∏–º–∞—Ö:**

   - üì± **Telegram Bot** - –æ—Ç–≤–µ—á–∞–µ—Ç –≤ TG —á–∞—Ç–∞—Ö –Ω–∞ @–ö–∞—Ç—è
   - üí¨ **–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π —á–∞—Ç** - –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Boss AI

2. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:**

   - ‚úÖ –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ GPT —á–µ—Ä–µ–∑ `/api/ai/chatgpt` (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GPT-5 nano)
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–¥–∏–Ω—É—é –ë–î Boss AI (SQLite, WAL mode)
   - ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å –±–∏–ª–ª–∏–Ω–≥–æ–º —á–µ—Ä–µ–∑ `service_pricing`

3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–æ —Ä–∞—Å—Ö–æ–¥–∞–º:**
   - üí∞ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ OpenAI API –∫–ª—é—á–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
   - ‚ö° –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   - üéØ –£–º–Ω–∞—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø)

### –¢–µ–∫—É—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Boss AI:

```
Boss AI Platform (Production)
‚îú‚îÄ‚îÄ Frontend (React + Vite) ‚Üí https://boss-ai.online
‚îú‚îÄ‚îÄ API Gateway (Node.js, port 3000)
‚îÇ   ‚îú‚îÄ‚îÄ /api/auth/* - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Telegram Login)
‚îÇ   ‚îú‚îÄ‚îÄ /api/billing/* - –±–∏–ª–ª–∏–Ω–≥ (BT —Ç–æ–∫–µ–Ω—ã)
‚îÇ   ‚îú‚îÄ‚îÄ /api/ai/chatgpt - GPT-5 nano (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!) ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ /api/ozon/* - –ø—Ä–æ–∫—Å–∏ –∫ Ozon Manager
‚îÇ   ‚îî‚îÄ‚îÄ /api/katya/* - –ø—Ä–æ–∫—Å–∏ –∫ Katya Service (–¥–æ–±–∞–≤–∏—Ç—å)
‚îú‚îÄ‚îÄ Ozon Manager (Node.js, port 4200)
‚îî‚îÄ‚îÄ Database: SQLite WAL
    ‚îî‚îÄ‚îÄ /var/www/boss-ai/backend/ozon-manager/data/ozon_manager.db
```

### –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –ö–∞—Ç–µ–π (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è):

```
Katya AI Service (NEW, port 4300)
‚îú‚îÄ‚îÄ Express API Server
‚îÇ   ‚îú‚îÄ‚îÄ /health - health check
‚îÇ   ‚îú‚îÄ‚îÄ /summarize - —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ /api/ai/chatgpt ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ /search - –ø–æ–∏—Å–∫ –≤ –ë–î + AI —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ /question - –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ /api/ai/chatgpt ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ /decisions - —á—Ç–µ–Ω–∏–µ –∏–∑ –ë–î (–±–µ–∑ AI)
‚îÇ   ‚îî‚îÄ‚îÄ /settings - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ Telegram Bot (polling)
‚îÇ   ‚îú‚îÄ‚îÄ @–ö–∞—Ç—è —É–ø–æ–º–∏–Ω–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ –ö–æ–º–∞–Ω–¥—ã: /summary, /search, /decisions
‚îÇ   ‚îî‚îÄ‚îÄ Inline keyboards
‚îú‚îÄ‚îÄ Context Manager
‚îÇ   ‚îú‚îÄ‚îÄ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π)
‚îÇ   ‚îî‚îÄ‚îÄ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
‚îî‚îÄ‚îÄ Database: SHARED SQLite
    ‚îî‚îÄ‚îÄ –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã: chat_messages, chat_summaries, etc.

API Gateway (–æ–±–Ω–æ–≤–∏—Ç—å)
‚îú‚îÄ‚îÄ –î–æ–±–∞–≤–∏—Ç—å /api/katya/* proxy ‚Üí http://localhost:4300
‚îú‚îÄ‚îÄ –ü—Ä–∏–º–µ–Ω–∏—Ç—å authenticateToken middleware
‚îî‚îÄ‚îÄ –ü—Ä–∏–º–µ–Ω–∏—Ç—å billing middleware (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!)

Frontend (–æ–±–Ω–æ–≤–∏—Ç—å)
‚îú‚îÄ‚îÄ –î–æ–±–∞–≤–∏—Ç—å katya-service.json
‚îú‚îÄ‚îÄ –ö–Ω–æ–ø–∫–∞ "–ö–∞—Ç—è" –≤ —á–∞—Ç–µ
‚îî‚îÄ‚îÄ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç KatyaSettings
```

### ‚ö° –ö–õ–Æ–ß–ï–í–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø:

**–ö–∞—Ç—è –ù–ï –∏–º–µ–µ—Ç —Å–≤–æ–µ–≥–æ OpenAI –∫–ª–∏–µ–Ω—Ç–∞!**

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:

```typescript
// ‚ùå –ü–õ–û–•–û (–±—ã–ª–æ –≤ v2.0):
const gpt5Client = new GPT5NanoClient(apiKey); // –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ!

// ‚úÖ –•–û–†–û–®–û (v3.0):
const response = await axios.post(
  "http://localhost:3000/api/ai/chatgpt",
  {
    prompt: summarizationPrompt,
    options: { model: "gpt-5-nano", temperature: 0.3 },
  },
  {
    headers: { Authorization: `Bearer ${platformToken}` },
  }
);
// –ë–∏–ª–ª–∏–Ω–≥ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π middleware!
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- üí∞ –û–¥–∏–Ω OpenAI API –∫–ª—é—á –¥–ª—è –≤—Å–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- üîí –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –±–∏–ª–ª–∏–Ω–≥ (–Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
- üìä –ï–¥–∏–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AI
- ‚ö° –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ = –º–µ–Ω—å—à–µ –±–∞–≥–æ–≤

---

## üìã –°–¢–†–£–ö–¢–£–†–ê –°–ï–†–í–ò–°–ê

### 1. katya-service.json (–¥–ª—è frontend/public/services/)

```json
{
  "id": "katya-ai-service",
  "name": "–ö–∞—Ç—è AI",
  "description": "AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é –∫–æ–º–∞–Ω–¥—ã. –°—É–º–º–∞—Ä–∏–∑–∏—Ä—É–µ—Ç –æ–±—Å—É–∂–¥–µ–Ω–∏—è, –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∏—Å—Ç–æ—Ä–∏–∏, –ø–æ–º–æ–≥–∞–µ—Ç –Ω–æ–≤—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º.",
  "icon": "Brain",
  "version": "1.0.0",
  "isActive": true,
  "category": "ai",
  "priority": 2,
  "author": "–ù–∏–∫–æ–ª–∞–π –¥–ª—è BOSS AI Team",

  "settings": {
    "telegram_enabled": true,
    "platform_chat_enabled": true,
    "auto_summarize": false,
    "context_window": 50,
    "billing_enabled": true
  },

  "tools": [
    {
      "id": "summarize-chat",
      "name": "üìä –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è",
      "description": "–ü–æ–¥–≤–æ–¥–∏—Ç –∏—Ç–æ–≥–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π –∏ –≤—ã–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è",
      "icon": "FileText",
      "action": "summarize",
      "isEnabled": true,
      "category": "analysis",
      "isChatFunction": true,
      "chatPrompt": "–ü–æ–¥–≤–µ–¥–∏ –∏—Ç–æ–≥–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è: {userInput}",
      "chatApiEndpoint": "/api/katya/summarize",
      "pricing": {
        "type": "per_request",
        "cost_bt": 0.5,
        "cost_rub": 5.0
      }
    },
    {
      "id": "search-history",
      "name": "üîç –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏",
      "description": "–ù–∞—Ö–æ–¥–∏—Ç –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∏ —Ä–µ—à–µ–Ω–∏—è –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ",
      "icon": "Search",
      "action": "search",
      "isEnabled": true,
      "category": "search",
      "isChatFunction": true,
      "chatPrompt": "–ù–∞–π–¥–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏: {userInput}",
      "chatApiEndpoint": "/api/katya/search",
      "pricing": {
        "type": "per_request",
        "cost_bt": 0.2,
        "cost_rub": 2.0
      }
    },
    {
      "id": "ask-katya",
      "name": "üí¨ –°–ø—Ä–æ—Å–∏—Ç—å –ö–∞—Ç—é",
      "description": "–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∫–æ–º–∞–Ω–¥—ã",
      "icon": "MessageCircle",
      "action": "question",
      "isEnabled": true,
      "category": "chat",
      "isChatFunction": true,
      "chatPrompt": "{userInput}",
      "chatApiEndpoint": "/api/katya/question",
      "pricing": {
        "type": "per_request",
        "cost_bt": 0.3,
        "cost_rub": 3.0
      }
    },
    {
      "id": "show-decisions",
      "name": "‚úÖ –†–µ—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã",
      "description": "–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–Ω—è—Ç—ã—Ö —Ä–µ—à–µ–Ω–∏–π",
      "icon": "CheckCircle",
      "action": "decisions",
      "isEnabled": true,
      "category": "history",
      "isChatFunction": false,
      "apiEndpoint": "/api/katya/decisions",
      "pricing": {
        "type": "free",
        "cost_bt": 0,
        "cost_rub": 0
      }
    },
    {
      "id": "katya-settings",
      "name": "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏",
      "description": "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞–±–æ—Ç—ã –ö–∞—Ç–∏",
      "icon": "Settings",
      "action": "settings",
      "isEnabled": true,
      "category": "settings",
      "isChatFunction": false,
      "uiComponent": "KatyaSettings"
    }
  ],

  "telegram": {
    "enabled": true,
    "bot_username": "katya_boss_ai_bot",
    "commands": [
      { "command": "/summary", "description": "–°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞" },
      { "command": "/search", "description": "–ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏" },
      { "command": "/decisions", "description": "–°–ø–∏—Å–æ–∫ —Ä–µ—à–µ–Ω–∏–π" }
    ]
  },

  "billing": {
    "service_name": "katya_ai",
    "pricing_items": [
      {
        "name": "katya_summarize",
        "description": "–°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –æ–±—Å—É–∂–¥–µ–Ω–∏–π",
        "unit_type": "request",
        "price_bt": 0.5,
        "price_rub": 5.0
      },
      {
        "name": "katya_search",
        "description": "–ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏",
        "unit_type": "request",
        "price_bt": 0.2,
        "price_rub": 2.0
      },
      {
        "name": "katya_question",
        "description": "–í–æ–ø—Ä–æ—Å –∫ –ö–∞—Ç–µ",
        "unit_type": "request",
        "price_bt": 0.3,
        "price_rub": 3.0
      }
    ]
  }
}
```

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Backend Katya Service

```
backend/katya-service/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                    # Express server (port 4300)
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (DB_PATH, API_GATEWAY_URL)
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ summarize.route.ts      # POST /summarize
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search.route.ts         # POST /search
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ question.route.ts       # POST /question
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ decisions.route.ts      # GET /decisions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.route.ts       # GET/PUT /settings
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ history.route.ts        # GET /history
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health.route.ts         # GET /health
‚îÇ   ‚îú‚îÄ‚îÄ telegram/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bot.ts                  # Telegram Bot (polling)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mention.handler.ts  # @–ö–∞—Ç—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ command.handler.ts  # /summary, /search
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ message.handler.ts  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ keyboards.ts            # Inline buttons
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ platform-gpt.service.ts # ‚≠ê –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ /api/ai/chatgpt
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ context-manager.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ knowledge-base.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ anonymizer.service.ts   # üîí 152-–§–ó (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ connection.ts           # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrations.ts           # –ú–∏–≥—Ä–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ messages.repo.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ summaries.repo.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ contexts.repo.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ settings.repo.ts
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ logger.ts
‚îÇ       ‚îú‚îÄ‚îÄ prompts.ts              # –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è GPT
‚îÇ       ‚îî‚îÄ‚îÄ cache.ts                # LRU –∫—ç—à –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îî‚îÄ‚îÄ unit/
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ README.md                       # –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
‚îî‚îÄ‚îÄ INTEGRATION.md                  # –ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Boss AI
```

---

## ü§ñ AI –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –ß–ï–†–ï–ó –ü–õ–ê–¢–§–û–†–ú–£

### ‚ö° –í–ê–ñ–ù–û: Dual Mode –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ production

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∏–∫–æ–ª–∞–π —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ `http://localhost:3000/api/ai/chatgpt`

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å **–¥–≤–∞ –∫–ª–∏–µ–Ω—Ç–∞** –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ env:

```typescript
// src/config/index.ts
export const AI_CONFIG = {
  USE_PLATFORM_GPT: process.env.USE_PLATFORM_GPT === "true", // false –¥–ª—è dev
  OPENAI_API_KEY: process.env.OPENAI_API_KEY || "", // –¥–ª—è dev
  API_GATEWAY_URL: process.env.API_GATEWAY_URL || "http://localhost:3000",
};
```

### ‚≠ê –ì–ª–∞–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ v3.0: –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ `/api/ai/chatgpt`

#### 1. PlatformGPTService (–¥–ª—è production)

```typescript
// src/services/platform-gpt.service.ts
import axios, { AxiosInstance } from "axios";
import { Logger } from "../utils/logger";

/**
 * –°–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è GPT –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É Boss AI
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π /api/ai/chatgpt endpoint —Å –±–∏–ª–ª–∏–Ω–≥–æ–º
 */
export class PlatformGPTService {
  private client: AxiosInstance;
  private logger: Logger;
  private apiGatewayUrl: string;

  constructor(apiGatewayUrl: string = "http://localhost:3000") {
    this.apiGatewayUrl = apiGatewayUrl;
    this.logger = new Logger("PlatformGPT");

    this.client = axios.create({
      baseURL: this.apiGatewayUrl,
      timeout: 60000, // AI –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –∑–∞–Ω–∏–º–∞—Ç—å –≤—Ä–µ–º—è
      headers: {
        "Content-Type": "application/json",
        "X-Service": "katya-ai",
      },
    });
  }

  /**
   * –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π GPT
   * –ë–∏–ª–ª–∏–Ω–≥ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
   */
  async summarize(
    messages: string[],
    userToken: string,
    context?: string
  ): Promise<SummaryResult> {
    const prompt = this.buildSummarizationPrompt(messages, context);

    try {
      this.logger.info(
        `–°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è ${messages.length} —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É`
      );

      const response = await this.client.post(
        "/api/ai/chatgpt",
        {
          prompt,
          options: {
            model: "gpt-5-nano",
            temperature: 0.3,
            max_tokens: 2000,
            response_format: { type: "json_object" },
          },
        },
        {
          headers: {
            Authorization: `Bearer ${userToken}`, // –¢–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–∏–ª–ª–∏–Ω–≥–∞!
          },
        }
      );

      if (!response.data.success) {
        throw new Error(response.data.error?.message || "AI request failed");
      }

      // –ü–∞—Ä—Å–∏–º JSON –æ—Ç–≤–µ—Ç –æ—Ç GPT
      const result = JSON.parse(response.data.data.choices[0].message.content);

      return {
        summary: result.summary,
        topics: result.topics || [],
        decisions: result.decisions || [],
        keywords: result.keywords || [],
        participants: result.participants || [],
      };
    } catch (error: any) {
      this.logger.error("–û—à–∏–±–∫–∞ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏", error);

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫—É –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
      if (error.response?.status === 402) {
        throw new Error("Insufficient funds");
      }

      throw error;
    }
  }

  /**
   * –ü–æ–∏—Å–∫ + AI —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
   */
  async searchAndRank(
    query: string,
    searchResults: any[],
    userToken: string
  ): Promise<RankedResult[]> {
    const prompt = this.buildSearchPrompt(query, searchResults);

    try {
      const response = await this.client.post(
        "/api/ai/chatgpt",
        {
          prompt,
          options: {
            model: "gpt-5-nano",
            temperature: 0.5,
            max_tokens: 1500,
          },
        },
        {
          headers: { Authorization: `Bearer ${userToken}` },
        }
      );

      return this.parseSearchResponse(
        response.data.data.choices[0].message.content
      );
    } catch (error: any) {
      this.logger.error("–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞", error);
      throw error;
    }
  }

  /**
   * –û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ GPT
   */
  async answer(
    question: string,
    context: string[],
    userToken: string
  ): Promise<AnswerResult> {
    const prompt = this.buildQuestionPrompt(question, context);

    try {
      const response = await this.client.post(
        "/api/ai/chatgpt",
        {
          prompt,
          options: {
            model: "gpt-5-nano",
            temperature: 0.7,
            max_tokens: 1000,
          },
        },
        {
          headers: { Authorization: `Bearer ${userToken}` },
        }
      );

      return {
        answer: response.data.data.choices[0].message.content,
        sources: this.extractSources(context),
        confidence: 0.85,
      };
    } catch (error: any) {
      this.logger.error("–û—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞", error);
      throw error;
    }
  }

  /**
   * –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
   */
  private buildSummarizationPrompt(
    messages: string[],
    context?: string
  ): string {
    return `–¢—ã - –ö–∞—Ç—è, AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∫–æ–º–∞–Ω–¥—ã Boss AI.
–¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å—É–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã.

–ö–æ–Ω—Ç–µ–∫—Å—Ç: ${context || "–û–±—â–µ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ"}

–°–æ–æ–±—â–µ–Ω–∏—è (${messages.length} —à—Ç.):
${messages.join("\n---\n")}

–í—ã–¥–µ–ª–∏:
- –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- –ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è (–∫—Ç–æ —Ä–µ—à–∏–ª, –∫–æ–≥–¥–∞)
- –ù–µ—Ä–µ—à–µ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞
- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è

–û—Ç–≤–µ—Ç –¥–∞–π –°–¢–†–û–ì–û –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ:
{
  "summary": "–ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ...",
  "topics": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2"],
  "decisions": [{"decision": "—Ç–µ–∫—Å—Ç", "decided_by": "username", "date": "timestamp"}],
  "keywords": ["–∫–ª—é—á1", "–∫–ª—é—á2"],
  "unresolved": ["–≤–æ–ø—Ä–æ—Å1"],
  "participants": ["user1", "user2"]
}`;
  }

  private buildSearchPrompt(query: string, results: any[]): string {
    return `–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: "${query}"

–ù–∞–π–¥–µ–Ω–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è:
${results.map((r, i) => `${i + 1}. ${r.text}`).join("\n\n")}

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∏ —Ä–∞–Ω–∂–∏—Ä—É–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏. –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ 3 —Å–∞–º—ã—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö.
–û–±—ä—è—Å–Ω–∏, –ø–æ—á–µ–º—É –∫–∞–∂–¥—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω.`;
  }

  private buildQuestionPrompt(question: string, context: string[]): string {
    return `–¢—ã - –ö–∞—Ç—è. –û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫–æ–º–∞–Ω–¥—ã.

–í–æ–ø—Ä–æ—Å: ${question}

–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏:
${context.join("\n---\n")}

–î–∞–π –∫—Ä–∞—Ç–∫–∏–π –∏ —Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç. –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ - —Ç–∞–∫ –∏ —Å–∫–∞–∂–∏.`;
  }

  private parseSearchResponse(response: string): RankedResult[] {
    // –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞ GPT
    return [];
  }

  private extractSources(context: string[]): number[] {
    // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ message IDs
    return [];
  }
}

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
interface SummaryResult {
  summary: string;
  topics: string[];
  decisions: Array<{ decision: string; decided_by: string; date: string }>;
  keywords: string[];
  participants: string[];
}

interface RankedResult {
  text: string;
  relevance: number;
  explanation: string;
}

interface AnswerResult {
  answer: string;
  sources: number[];
  confidence: number;
}
```

#### 2. DirectGPTClient (–¥–ª—è local development)

```typescript
// src/ai/direct-gpt-client.ts
import OpenAI from "openai";
import { Logger } from "../utils/logger";

/**
 * –ü—Ä—è–º–æ–π –∫–ª–∏–µ–Ω—Ç OpenAI –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ USE_PLATFORM_GPT=false
 */
export class DirectGPTClient {
  private client: OpenAI;
  private logger: Logger;

  constructor(apiKey: string) {
    this.client = new OpenAI({ apiKey });
    this.logger = new Logger("DirectGPT");
  }

  async summarize(
    messages: string[],
    context?: string
  ): Promise<SummaryResult> {
    const prompt = this.buildSummarizationPrompt(messages, context);

    try {
      this.logger.info(
        `–°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è ${messages.length} —Å–æ–æ–±—â–µ–Ω–∏–π (DIRECT MODE)`
      );

      const response = await this.client.chat.completions.create({
        model: "gpt-4o-mini", // –∏–ª–∏ gpt-5-nano –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
        messages: [
          {
            role: "system",
            content: prompt.system,
          },
          {
            role: "user",
            content: prompt.user,
          },
        ],
        temperature: 0.3,
        max_tokens: 2000,
        response_format: { type: "json_object" },
      });

      const result = JSON.parse(response.choices[0].message.content);

      return {
        summary: result.summary,
        topics: result.topics || [],
        decisions: result.decisions || [],
        keywords: result.keywords || [],
        participants: result.participants || [],
      };
    } catch (error: any) {
      this.logger.error("–û—à–∏–±–∫–∞ DirectGPT —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏", error);
      throw error;
    }
  }

  // ... –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã searchAndRank, answer

  private buildSummarizationPrompt(messages: string[], context?: string) {
    return {
      system: `–¢—ã - –ö–∞—Ç—è, AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∫–æ–º–∞–Ω–¥—ã Boss AI.
–¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å—É–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã.
–í—ã–¥–µ–ª–∏: —Ä–µ—à–µ–Ω–∏—è, —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∫–ª—é—á–µ–≤—ã–µ —Ç–µ–º—ã, –Ω–µ—Ä–µ—à–µ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã.
–û—Ç–≤–µ—Ç –¥–∞–π –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ JSON.`,
      user: `–°—É–º–º–∞—Ä–∏–∑–∏—Ä—É–π —Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:\n\n${messages.join("\n---\n")}`,
    };
  }
}
```

#### 3. AIClientFactory (—Ñ–∞–±—Ä–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è)

```typescript
// src/services/ai-client-factory.ts
import { PlatformGPTService } from "./platform-gpt.service";
import { DirectGPTClient } from "../ai/direct-gpt-client";
import { AI_CONFIG } from "../config";

export interface AIClient {
  summarize(
    messages: string[],
    userToken: string,
    context?: string
  ): Promise<SummaryResult>;
  searchAndRank(
    query: string,
    results: any[],
    userToken: string
  ): Promise<RankedResult[]>;
  answer(
    question: string,
    context: string[],
    userToken: string
  ): Promise<AnswerResult>;
}

/**
 * –§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è AI –∫–ª–∏–µ–Ω—Ç–∞
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç PlatformGPTService (production) –∏–ª–∏ DirectGPTClient (dev)
 */
export class AIClientFactory {
  static create(): AIClient {
    if (AI_CONFIG.USE_PLATFORM_GPT) {
      console.log("üîß Using PlatformGPTService (production mode)");
      return new PlatformGPTService(AI_CONFIG.API_GATEWAY_URL);
    } else {
      console.log("üß™ Using DirectGPTClient (development mode)");
      // –í dev mode —Å–æ–∑–¥–∞–µ–º –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
      const directClient = new DirectGPTClient(AI_CONFIG.OPENAI_API_KEY);

      return {
        async summarize(
          messages: string[],
          userToken: string,
          context?: string
        ) {
          // –í dev —Ä–µ–∂–∏–º–µ userToken –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
          return directClient.summarize(messages, context);
        },
        async searchAndRank(query: string, results: any[], userToken: string) {
          return directClient.searchAndRank(query, results);
        },
        async answer(question: string, context: string[], userToken: string) {
          return directClient.answer(question, context);
        },
      };
    }
  }
}
```

#### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ routes

```typescript
// src/routes/summarize.route.ts
import { Router, Request, Response } from "express";
import { AIClientFactory } from "../services/ai-client-factory";
import { MessagesRepository } from "../database/repositories/messages.repo";
import { SummariesRepository } from "../database/repositories/summaries.repo";

const router = Router();
const aiClient = AIClientFactory.create(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Ä–µ–∂–∏–º!
const messagesRepo = new MessagesRepository();
const summariesRepo = new SummariesRepository();

/**
 * POST /summarize
 * –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –æ–±—Å—É–∂–¥–µ–Ω–∏–π
 *
 * Body:
 * - chatId: number
 * - messageCount?: number (default: 50)
 * - query?: string
 *
 * Headers:
 * - Authorization: Bearer <platform_token>
 */
router.post("/summarize", async (req: Request, res: Response) => {
  try {
    const { chatId, messageCount = 50, query } = req.body;
    const userToken = req.headers.authorization?.replace("Bearer ", "");

    if (!userToken) {
      return res.status(401).json({
        success: false,
        error: "Unauthorized",
      });
    }

    // 1. –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –ë–î
    const messages = await messagesRepo.getLastMessages(chatId, messageCount);

    if (messages.length === 0) {
      return res.json({
        success: true,
        data: {
          summary: "–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏",
          topics: [],
          decisions: [],
          keywords: [],
        },
      });
    }

    // 2. –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ AI –∫–ª–∏–µ–Ω—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ä–µ–∂–∏–º!)
    const summary = await aiClient.summarize(
      messages.map((m) => `${m.username}: ${m.text}`),
      userToken,
      query
    );

    // 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å summary –≤ –ë–î
    await summariesRepo.create({
      chatId,
      summaryText: summary.summary,
      messageCount: messages.length,
      keywords: JSON.stringify(summary.keywords),
      topics: JSON.stringify(summary.topics),
      decisions: JSON.stringify(summary.decisions),
    });

    // 4. –û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É
    res.json({
      success: true,
      data: summary,
    });
  } catch (error: any) {
    console.error("Summarize error:", error);

    if (error.message === "Insufficient funds") {
      return res.status(402).json({
        success: false,
        error: "Insufficient funds",
        message:
          "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å BT —Ç–æ–∫–µ–Ω–æ–≤.",
      });
    }

    res.status(500).json({
      success: false,
      error: error.message || "Internal server error",
    });
  }
});

export default router;
```

---

## üîí 152-–§–ó –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø (–û–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏–µ –ü–î)

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Anonymizer Service

```typescript
// src/services/anonymizer.service.ts
/**
 * –°–µ—Ä–≤–∏—Å –¥–ª—è –æ–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (152-–§–ó)
 * –ó–∞–º–µ–Ω—è–µ—Ç –§–ò–û, —Ç–µ–ª–µ—Ñ–æ–Ω—ã, email –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ GPT
 */
export class AnonymizerService {
  private piiPatterns = {
    phone: /(\+7|8)?[\s\(]?\d{3}[\s\)]?\d{3}[\s-]?\d{2}[\s-]?\d{2}/g,
    email: /[\w.-]+@[\w.-]+\.\w+/g,
    // –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ –¥–ª—è –∏–º–µ–Ω (—É–ª—É—á—à–∏—Ç—å!)
    name: /\b[–ê-–Ø–Å][–∞-—è—ë]+\s[–ê-–Ø–Å][–∞-—è—ë]+(?:\s[–ê-–Ø–Å][–∞-—è—ë]+)?\b/g,
  };

  private replacementMap: Map<string, string> = new Map();
  private counter = 0;

  /**
   * –û–±–µ–∑–ª–∏—á–∏—Ç—å —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ GPT
   */
  anonymize(text: string): { anonymized: string; map: Record<string, string> } {
    let anonymized = text;
    const map: Record<string, string> = {};

    // –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω—ã
    anonymized = anonymized.replace(this.piiPatterns.phone, (match) => {
      const replacement = `[PHONE_${++this.counter}]`;
      map[replacement] = match;
      return replacement;
    });

    // –ó–∞–º–µ–Ω—è–µ–º email
    anonymized = anonymized.replace(this.piiPatterns.email, (match) => {
      const replacement = `[EMAIL_${++this.counter}]`;
      map[replacement] = match;
      return replacement;
    });

    // –ó–∞–º–µ–Ω—è–µ–º –∏–º–µ–Ω–∞
    anonymized = anonymized.replace(this.piiPatterns.name, (match) => {
      const replacement = `[NAME_${++this.counter}]`;
      map[replacement] = match;
      return replacement;
    });

    return { anonymized, map };
  }

  /**
   * –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç GPT
   */
  deanonymize(text: string, map: Record<string, string>): string {
    let deanonymized = text;

    for (const [placeholder, original] of Object.entries(map)) {
      deanonymized = deanonymized.replace(
        new RegExp(placeholder, "g"),
        original
      );
    }

    return deanonymized;
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ PlatformGPTService:
/*
const anonymizer = new AnonymizerService();
const { anonymized, map } = anonymizer.anonymize(messages.join('\n'));
const summary = await platformGPT.summarize([anonymized], userToken);
summary.summary = anonymizer.deanonymize(summary.summary, map);
*/
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

```env
# .env
ANONYMIZE_PII=true  # –í–∫–ª—é—á–∏—Ç—å –æ–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏–µ (–¥–ª—è production)
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** 152-–§–ó —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:

- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ –ü–î —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –≥—Ä–∞–∂–¥–∞–Ω
- –ü–µ—Ä–µ–¥–∞–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º (OpenAI)
- –ù–µ –ø–æ–ª—É—á–∏–ª–∏ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ü–î

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∫–ª—é—á–∏—Ç—å –≤ production, –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

---

## üí∞ –ë–ò–õ–õ–ò–ù–ì –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

### ‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∏–ª–ª–∏–Ω–≥ —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ v3.0:** –ö–∞—Ç—è **–ù–ï —Å–ø–∏—Å—ã–≤–∞–µ—Ç** –¥–µ–Ω—å–≥–∏ –Ω–∞–ø—Ä—è–º—É—é!

–ü—Ä–æ—Ü–µ—Å—Å:

```
1. User ‚Üí –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ ‚Üí /api/katya/summarize
2. API Gateway –ø—Ä–∏–º–µ–Ω—è–µ—Ç authenticateToken middleware
3. Katya Service ‚Üí /api/ai/chatgpt (—Å —Ç–æ–∫–µ–Ω–æ–º user)
4. API Gateway –ø—Ä–∏–º–µ–Ω—è–µ—Ç requireBalance('ai_request', 5.0)
5. API Gateway —Å–ø–∏—Å—ã–≤–∞–µ—Ç 5‚ÇΩ —Å user.balance_rub
6. –ó–∞–ø—Ä–æ—Å –∏–¥–µ—Ç –∫ OpenAI
7. –û—Ç–≤–µ—Ç ‚Üí Katya Service ‚Üí User
```

**–ù–∏–∫–∞–∫–æ–≥–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –±–∏–ª–ª–∏–Ω–≥–∞!**

### SQL –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è service_pricing

```sql
-- –î–æ–±–∞–≤–∏—Ç—å —Ç–∞—Ä–∏—Ñ—ã –ö–∞—Ç–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (–≤ src/database/migrations.ts)
INSERT OR IGNORE INTO service_pricing (service_name, unit_type, price_per_unit, currency, is_active) VALUES
  ('katya_summarize', 'request', 5.0, 'RUB', 1),   -- –°—Ç–æ–∏–º–æ—Å—Ç—å = —Å—Ç–æ–∏–º–æ—Å—Ç—å /api/ai/chatgpt
  ('katya_search', 'request', 2.0, 'RUB', 1),       -- –î–µ—à–µ–≤–ª–µ, —Ç.–∫. —á–∞—Å—Ç—å logic –±–µ–∑ AI
  ('katya_question', 'request', 3.0, 'RUB', 1);     -- –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API Gateway

```typescript
// backend/main/src/routes/katya.routes.ts (–ù–û–í–´–ô –§–ê–ô–õ!)
import { Router } from "express";
import { authenticateToken } from "../middleware/auth.middleware";
import { ProxyClient } from "../utils/proxy";

const router = Router();

// –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–∫—Å–∏ –∫ Katya Service
const createKatyaProxy = (): ProxyClient => {
  return new ProxyClient({
    baseURL: process.env.KATYA_SERVICE_URL || "http://localhost:4300",
    timeout: 60000,
    headers: {
      "X-Service": "katya-ai",
    },
  });
};

const katyaProxy = createKatyaProxy();

/**
 * –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ö–∞—Ç–µ
 * Middleware: authenticateToken (–¥–ª—è —Ç–æ–∫–µ–Ω–∞ user)
 * –ë–∏–ª–ª–∏–Ω–≥: —á–µ—Ä–µ–∑ /api/ai/chatgpt (–≤–Ω—É—Ç—Ä–∏ –ö–∞—Ç–∏)
 */
router.use("/api/katya/*", authenticateToken, async (req, res) => {
  try {
    // –£–±–∏—Ä–∞–µ–º '/api/katya' –∏–∑ –ø—É—Ç–∏
    const targetPath = req.originalUrl.replace("/api/katya", "");

    // –ü—Ä–æ–∫—Å–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å, –ø–µ—Ä–µ–¥–∞–≤–∞—è —Ç–æ–∫–µ–Ω
    const result = await katyaProxy.request(
      req.method as any,
      targetPath,
      req.body,
      {
        headers: {
          Authorization: req.headers.authorization, // –ü–µ—Ä–µ–¥–∞–µ–º —Ç–æ–∫–µ–Ω user!
        },
      }
    );

    res.json(result);
  } catch (error: any) {
    res.status(error.status || 500).json(
      error.data || {
        success: false,
        error: error.message,
      }
    );
  }
});

export default router;
```

–î–æ–±–∞–≤–∏—Ç—å –≤ `backend/main/src/index.ts`:

```typescript
import katyaRoutes from "./routes/katya.routes";

// –í setupRoutes():
this.app.use(katyaRoutes); // –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ –¥—Ä—É–≥–∏—Ö —Ä–æ—É—Ç–æ–≤
```

---

## üíæ –°–•–ï–ú–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•

### –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–¥–æ–±–∞–≤–∏—Ç—å –≤ ozon_manager.db)

```sql
-- 1. –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–æ–≤ (–¥–ª—è Telegram –∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
CREATE TABLE IF NOT EXISTS chat_messages (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  message_id BIGINT UNIQUE NOT NULL,
  chat_id BIGINT NOT NULL,
  user_id INTEGER,
  telegram_user_id BIGINT,
  username TEXT,
  first_name TEXT,
  text TEXT NOT NULL,
  reply_to_message_id BIGINT,
  is_katya_mention BOOLEAN DEFAULT 0,
  created_at INTEGER DEFAULT (strftime('%s', 'now')),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
);

-- 2. –°—É–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
CREATE TABLE IF NOT EXISTS chat_summaries (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  chat_id BIGINT NOT NULL,
  summary_text TEXT NOT NULL,
  message_count INTEGER DEFAULT 0,
  start_message_id BIGINT,
  end_message_id BIGINT,
  keywords TEXT,  -- JSON array
  topics TEXT,    -- JSON array
  decisions TEXT, -- JSON array
  created_at INTEGER DEFAULT (strftime('%s', 'now'))
);

-- 3. –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã –æ–±—Å—É–∂–¥–µ–Ω–∏–π (—Ç–µ–º—ã)
CREATE TABLE IF NOT EXISTS chat_contexts (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  chat_id BIGINT NOT NULL,
  topic TEXT NOT NULL,
  description TEXT,
  keywords TEXT,
  ref_message_ids TEXT,  -- JSON array
  decision TEXT,
  decided_by TEXT,
  decided_at INTEGER,
  created_at INTEGER DEFAULT (strftime('%s', 'now')),
  updated_at INTEGER DEFAULT (strftime('%s', 'now'))
);

-- 4. –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π (Q&A)
CREATE TABLE IF NOT EXISTS knowledge_base (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  question TEXT NOT NULL,
  answer TEXT NOT NULL,
  source_chat_id BIGINT,
  source_message_ids TEXT,  -- JSON array
  context_id INTEGER,
  created_by TEXT,
  created_at INTEGER DEFAULT (strftime('%s', 'now')),
  relevance_score REAL DEFAULT 1.0,
  FOREIGN KEY (context_id) REFERENCES chat_contexts(id) ON DELETE SET NULL
);

-- 5. –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
CREATE TABLE IF NOT EXISTS katya_requests (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  user_id INTEGER NOT NULL,
  request_type TEXT NOT NULL,  -- 'summarize', 'search', 'question'
  request_data TEXT,            -- JSON
  response_data TEXT,           -- JSON
  cost_bt REAL NOT NULL,
  cost_rub REAL NOT NULL,
  created_at INTEGER DEFAULT (strftime('%s', 'now')),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ö–∞—Ç–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE IF NOT EXISTS katya_user_settings (
  user_id INTEGER PRIMARY KEY,
  telegram_enabled BOOLEAN DEFAULT 1,
  platform_chat_enabled BOOLEAN DEFAULT 1,
  auto_summarize BOOLEAN DEFAULT 0,
  auto_summarize_threshold INTEGER DEFAULT 100,
  context_window INTEGER DEFAULT 50,
  anonymize_pii BOOLEAN DEFAULT 0,  -- 152-–§–ó
  updated_at INTEGER DEFAULT (strftime('%s', 'now')),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX IF NOT EXISTS idx_messages_chat ON chat_messages(chat_id, created_at DESC);
CREATE INDEX IF NOT EXISTS idx_messages_user ON chat_messages(user_id, created_at DESC);
CREATE INDEX IF NOT EXISTS idx_messages_mention ON chat_messages(is_katya_mention, chat_id);
CREATE INDEX IF NOT EXISTS idx_summaries_chat ON chat_summaries(chat_id, created_at DESC);
CREATE INDEX IF NOT EXISTS idx_contexts_topic ON chat_contexts(topic);
CREATE INDEX IF NOT EXISTS idx_knowledge_question ON knowledge_base(question);
CREATE INDEX IF NOT EXISTS idx_katya_requests ON katya_requests(user_id, created_at DESC);
```

---

## üì± TELEGRAM –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

### Telegram Bot Setup

```typescript
// src/telegram/bot.ts
import TelegramBot from "node-telegram-bot-api";
import { PlatformGPTService } from "../services/platform-gpt.service";
import { MessagesRepository } from "../database/repositories/messages.repo";
import { Logger } from "../utils/logger";

export class KatyaTelegramBot {
  private bot: TelegramBot;
  private platformGPT: PlatformGPTService;
  private messagesRepo: MessagesRepository;
  private logger: Logger;

  constructor(botToken: string, apiGatewayUrl: string, dbPath: string) {
    this.bot = new TelegramBot(botToken, { polling: true });
    this.platformGPT = new PlatformGPTService(apiGatewayUrl);
    this.messagesRepo = new MessagesRepository(dbPath);
    this.logger = new Logger("TelegramBot");

    this.setupHandlers();
    this.logger.info("‚úÖ Telegram –±–æ—Ç –ö–∞—Ç—è –∑–∞–ø—É—â–µ–Ω");
  }

  private setupHandlers() {
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    this.bot.on("message", async (msg) => {
      try {
        await this.messagesRepo.create({
          messageId: msg.message_id,
          chatId: msg.chat.id,
          telegramUserId: msg.from?.id,
          username: msg.from?.username || "unknown",
          firstName: msg.from?.first_name || "",
          text: msg.text || "",
          isKatyaMention: this.isMentioned(msg.text),
        });
      } catch (error) {
        this.logger.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è", error);
      }
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ @–ö–∞—Ç—è —É–ø–æ–º–∏–Ω–∞–Ω–∏–π
    this.bot.on("message", async (msg) => {
      if (!this.isMentioned(msg.text)) return;

      try {
        await this.bot.sendChatAction(msg.chat.id, "typing");

        // ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –£ Telegram —Å–æ–æ–±—â–µ–Ω–∏–π –ù–ï–¢ —Ç–æ–∫–µ–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã!
        // –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å system token –∏–ª–∏ —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

        const messages = await this.messagesRepo.getLastMessages(
          msg.chat.id,
          50
        );

        // TODO: –ü–æ–ª—É—á–∏—Ç—å platform token –¥–ª—è user —á–µ—Ä–µ–∑ telegram_id
        // –ü–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º system token (–±–µ–∑ –±–∏–ª–ª–∏–Ω–≥–∞)
        const systemToken = process.env.SYSTEM_TOKEN || "";

        const summary = await this.platformGPT.summarize(
          messages.map((m) => `${m.username}: ${m.text}`),
          systemToken,
          msg.text
        );

        await this.bot.sendMessage(msg.chat.id, this.formatSummary(summary), {
          parse_mode: "Markdown",
          reply_to_message_id: msg.message_id,
          reply_markup: {
            inline_keyboard: [
              [
                {
                  text: "üîç –ü–æ–¥—Ä–æ–±–Ω–µ–µ",
                  callback_data: `details_${msg.chat.id}`,
                },
                {
                  text: "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                  callback_data: `stats_${msg.chat.id}`,
                },
              ],
            ],
          },
        });
      } catch (error: any) {
        this.logger.error("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ @–ö–∞—Ç—è", error);
        await this.bot.sendMessage(msg.chat.id, `‚ö†Ô∏è –û—à–∏–±–∫–∞: ${error.message}`, {
          reply_to_message_id: msg.message_id,
        });
      }
    });

    // –ö–æ–º–∞–Ω–¥—ã
    this.bot.onText(/\/summary/, (msg) => this.handleSummaryCommand(msg));
    this.bot.onText(/\/search (.+)/, (msg, match) =>
      this.handleSearchCommand(msg, match)
    );
    this.bot.onText(/\/decisions/, (msg) => this.handleDecisionsCommand(msg));
  }

  private isMentioned(text?: string): boolean {
    if (!text) return false;
    return (
      text.includes("@–ö–∞—Ç—è") ||
      text.includes("@Katya") ||
      text.includes("@katya_boss_ai_bot")
    );
  }

  private formatSummary(summary: any): string {
    return `üìä *–°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è*

${summary.summary}

üîë *–ö–ª—é—á–µ–≤—ã–µ —Ç–µ–º—ã:*
${summary.topics.map((t: string) => `‚Ä¢ ${t}`).join("\n")}

‚úÖ *–†–µ—à–µ–Ω–∏—è:*
${
  summary.decisions
    .map((d: any) => `‚Ä¢ ${d.decision} (${d.decided_by})`)
    .join("\n") || "–ù–µ—Ç –ø—Ä–∏–Ω—è—Ç—ã—Ö —Ä–µ—à–µ–Ω–∏–π"
}

üë• *–£—á–∞—Å—Ç–Ω–∏–∫–∏:* ${summary.participants.join(", ")}`;
  }

  private async handleSummaryCommand(msg: TelegramBot.Message) {
    // Similar to @–ö–∞—Ç—è mention handling
  }

  private async handleSearchCommand(
    msg: TelegramBot.Message,
    match: RegExpExecArray | null
  ) {
    // Search implementation
  }

  private async handleDecisionsCommand(msg: TelegramBot.Message) {
    // Show decisions from database
  }
}
```

**‚ö†Ô∏è –í–∞–∂–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** Telegram —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–∫–µ–Ω –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã!

**–†–µ—à–µ–Ω–∏—è:**

1. **–í–∞—Ä–∏–∞–Ω—Ç A (–ø—Ä–æ—Å—Ç–æ–π):** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å system token –±–µ–∑ –±–∏–ª–ª–∏–Ω–≥–∞ –¥–ª—è TG
2. **–í–∞—Ä–∏–∞–Ω—Ç B (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):** –¢—Ä–µ–±–æ–≤–∞—Ç—å —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ TG –∞–∫–∫–∞—É–Ω—Ç–∞ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π (telegram_id ‚Üí user_id)

---

## üß™ –õ–û–ö–ê–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –î–õ–Ø –ù–ò–ö–û–õ–ê–Ø

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### 1. –°–æ–∑–¥–∞—Ç—å `.env` –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```env
# Development Mode
NODE_ENV=development
PORT=4300

# Database (–∫–æ–ø–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞)
DB_PATH=./data/test_db.sqlite

# API Gateway (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ dev mode)
API_GATEWAY_URL=http://localhost:3000

# AI Configuration
USE_PLATFORM_GPT=false  # ‚ö†Ô∏è false –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!
OPENAI_API_KEY=sk-...   # üîë –†–µ–∞–ª—å–Ω—ã–π –∫–ª—é—á OpenAI (–≤–∑—è—Ç—å —É @boss)

# Telegram Bot (—Ç–µ—Å—Ç–æ–≤—ã–π)
TELEGRAM_BOT_TOKEN=<—Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω –æ—Ç @BotFather>
TELEGRAM_BOT_USERNAME=katya_test_bot

# System Token (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ dev mode)
SYSTEM_TOKEN=test_token

# Logging
LOG_LEVEL=debug

# Features
ANONYMIZE_PII=false
```

#### 2. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –ë–î

```bash
# –°–∫–∞—á–∞—Ç—å –∫–æ–ø–∏—é –ë–î —Å —Å–µ—Ä–≤–µ—Ä–∞ (—É @boss –∑–∞–ø—Ä–æ—Å–∏—Ç—å)
# –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ç–µ—Å—Ç–æ–≤—É—é –ë–î:

sqlite3 ./data/test_db.sqlite < test-schema.sql
```

**test-schema.sql:**

```sql
-- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
CREATE TABLE IF NOT EXISTS users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  telegram_id BIGINT UNIQUE,
  username TEXT,
  first_name TEXT,
  created_at INTEGER DEFAULT (strftime('%s', 'now'))
);

CREATE TABLE IF NOT EXISTS chat_messages (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  message_id BIGINT UNIQUE NOT NULL,
  chat_id BIGINT NOT NULL,
  user_id INTEGER,
  username TEXT,
  text TEXT NOT NULL,
  created_at INTEGER DEFAULT (strftime('%s', 'now'))
);

-- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
INSERT INTO users (id, telegram_id, username, first_name) VALUES
  (1, 123456789, 'test_user', '–¢–µ—Å—Ç–æ–≤—ã–π');

INSERT INTO chat_messages (message_id, chat_id, user_id, username, text) VALUES
  (1, 1, 1, 'test_user', '–ü—Ä–∏–≤–µ—Ç, —ç—Ç–æ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ'),
  (2, 1, 1, 'test_user', '–î–∞–≤–∞–π—Ç–µ –æ–±—Å—É–¥–∏–º –Ω–æ–≤—É—é —Ñ–∏—á—É'),
  (3, 1, 1, 'test_user', '–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å React'),
  (4, 1, 1, 'test_user', '–°–æ–≥–ª–∞—Å–Ω—ã?'),
  (5, 1, 1, 'test_user', '–†–µ—à–µ–Ω–æ: –∏—Å–ø–æ–ª—å–∑—É–µ–º React');
```

#### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ dev —Ä–µ–∂–∏–º–µ
npm run dev

# –õ–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç:
# üß™ Using DirectGPTClient (development mode)
# ‚úÖ Telegram –±–æ—Ç –ö–∞—Ç—è –∑–∞–ø—É—â–µ–Ω
# üöÄ Katya Service –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 4300
```

#### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ endpoints (–±–µ–∑ API Gateway!)

**–¢–µ—Å—Ç 1: Health check**

```bash
curl http://localhost:4300/health
# –û–∂–∏–¥–∞–µ—Ç—Å—è: {"status":"ok","service":"katya-ai"}
```

**–¢–µ—Å—Ç 2: –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞ –≤ dev —Ä–µ–∂–∏–º–µ)**

```bash
curl -X POST http://localhost:4300/summarize \
  -H "Content-Type: application/json" \
  -d '{
    "chatId": 1,
    "messageCount": 5,
    "query": "–ü–æ–¥–≤–µ–¥–∏ –∏—Ç–æ–≥–∏"
  }'

# –û–∂–∏–¥–∞–µ—Ç—Å—è:
# {
#   "success": true,
#   "data": {
#     "summary": "–û–±—Å—É–∂–¥–∞–ª–∞—Å—å –Ω–æ–≤–∞—è —Ñ–∏—á–∞...",
#     "topics": ["React", "—Ñ–∏—á–∞"],
#     "decisions": [{"decision": "–ò—Å–ø–æ–ª—å–∑—É–µ–º React", ...}],
#     "keywords": ["React", "—Ñ–∏—á–∞"]
#   }
# }
```

**–¢–µ—Å—Ç 3: Telegram –±–æ—Ç**

```bash
# –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–º—É –±–æ—Ç—É –≤ Telegram:
# @katya_test_bot –ø—Ä–∏–≤–µ—Ç!
# @–ö–∞—Ç—è, –ø–æ–¥–≤–µ–¥–∏ –∏—Ç–æ–≥–∏

# –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–µ–π
```

#### 5. Mock —Ä–µ–∂–∏–º (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ OpenAI)

–î–ª—è —Å–æ–≤—Å–µ–º –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ API –∫–ª—é—á–∞:

```env
USE_MOCK_AI=true  # –í–µ—Ä–Ω–µ—Ç mock –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ GPT
```

```typescript
// src/ai/mock-gpt-client.ts
export class MockGPTClient {
  async summarize(messages: string[]): Promise<SummaryResult> {
    return {
      summary: `Mock —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è ${messages.length} —Å–æ–æ–±—â–µ–Ω–∏–π`,
      topics: ["mock-—Ç–µ–º–∞-1", "mock-—Ç–µ–º–∞-2"],
      decisions: [
        {
          decision: "Mock —Ä–µ—à–µ–Ω–∏–µ 1",
          decided_by: "test_user",
          date: new Date().toISOString(),
        },
      ],
      keywords: ["mock", "test"],
      participants: ["test_user"],
    };
  }
}
```

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –ù–∏–∫–æ–ª–∞—è

#### –ü—Ä–∏–º–µ—Ä 1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ ozon-manager (–∫–∞–∫ reference)

–°–∫–∏–Ω—É—Ç—å –ù–∏–∫–æ–ª–∞—é —ç—Ç–∏ —Ñ–∞–π–ª—ã:

```
backend/ozon-manager/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                 # üëà –ö–∞–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Express + DB
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts             # üëà –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å .env
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stores.routes.ts     # üëà –ü—Ä–∏–º–µ—Ä API —Ä–æ—É—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations.ts        # üëà –ö–∞–∫ –¥–µ–ª–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ SQLite
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îî‚îÄ‚îÄ ozon-api-client.ts   # üëà –ö–∞–∫ –¥–µ–ª–∞—Ç—å HTTP –∫–ª–∏–µ–Ω—Ç—ã
```

#### –ü—Ä–∏–º–µ—Ä 2: AI Routes –∏–∑ API Gateway

```typescript
// backend/main/src/routes/ai.routes.ts (—Å–∫–∏–Ω—É—Ç—å –ù–∏–∫–æ–ª–∞—é)
// –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç /api/ai/chatgpt endpoint
```

#### –ü—Ä–∏–º–µ—Ä 3: Service Config

```json
// frontend/public/services/chatgpt-service.json (—Å–∫–∏–Ω—É—Ç—å –ù–∏–∫–æ–ª–∞—é)
// –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å service –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
```

### Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**katya-api-tests.postman_collection.json:**

```json
{
  "info": {
    "name": "Katya AI Service - Tests",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:4300/health",
          "protocol": "http",
          "host": ["localhost"],
          "port": "4300",
          "path": ["health"]
        }
      }
    },
    {
      "name": "Summarize (Dev Mode)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"chatId\": 1,\n  \"messageCount\": 5,\n  \"query\": \"–ü–æ–¥–≤–µ–¥–∏ –∏—Ç–æ–≥–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è\"\n}"
        },
        "url": {
          "raw": "http://localhost:4300/summarize",
          "protocol": "http",
          "host": ["localhost"],
          "port": "4300",
          "path": ["summarize"]
        }
      }
    },
    {
      "name": "Search History",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"query\": \"React\",\n  \"chatId\": 1,\n  \"limit\": 10\n}"
        },
        "url": {
          "raw": "http://localhost:4300/search",
          "protocol": "http",
          "host": ["localhost"],
          "port": "4300",
          "path": ["search"]
        }
      }
    }
  ]
}
```

### Unit —Ç–µ—Å—Ç—ã (–ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –ù–∏–∫–æ–ª–∞—è)

```typescript
// tests/ai/direct-gpt-client.test.ts
import { DirectGPTClient } from "../../src/ai/direct-gpt-client";

describe("DirectGPTClient", () => {
  let client: DirectGPTClient;

  beforeAll(() => {
    client = new DirectGPTClient(process.env.OPENAI_API_KEY!);
  });

  test("should summarize messages", async () => {
    const messages = [
      "User1: –ü—Ä–∏–≤–µ—Ç!",
      "User2: –î–∞–≤–∞–π—Ç–µ –æ–±—Å—É–¥–∏–º –ø—Ä–æ–µ–∫—Ç",
      "User1: –†–µ—à–µ–Ω–æ: –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–≤—Ç—Ä–∞",
    ];

    const result = await client.summarize(messages);

    expect(result.summary).toBeDefined();
    expect(result.topics).toBeInstanceOf(Array);
    expect(result.decisions).toBeInstanceOf(Array);
  }, 30000); // OpenAI –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º

  test("should handle empty messages", async () => {
    const result = await client.summarize([]);

    expect(result.summary).toBeDefined();
  });
});
```

---

## üì¶ DELIVERABLES –î–õ–Ø –ù–ò–ö–û–õ–ê–Ø

–ü–æ—Å–ª–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ù–∏–∫–æ–ª–∞–π –¥–æ–ª–∂–µ–Ω –ø—Ä–∏—Å–ª–∞—Ç—å:

### 1. katya-service.tar.gz

```
katya-service/
‚îú‚îÄ‚îÄ dist/                  # Compiled JavaScript
‚îú‚îÄ‚îÄ node_modules/          # All dependencies
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ package-lock.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ .env.example           # Template —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
‚îú‚îÄ‚îÄ README.md              # –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
‚îî‚îÄ‚îÄ INTEGRATION.md         # –ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Boss AI
```

### 2. katya-service.json

–ü–æ–ª–æ–∂–∏—Ç—å –≤ `frontend/public/services/katya-service.json`

### 3. SQL –º–∏–≥—Ä–∞—Ü–∏–∏

–§–∞–π–ª `migrations.sql` —Å —Å–æ–∑–¥–∞–Ω —Ç–∞–±–ª–∏—Ü (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é)

### 4. INTEGRATION.md (–ø—Ä–∏–º–µ—Ä)

````markdown
# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Katya Service –≤ Boss AI Platform

## 1. –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤

\`\`\`bash
cd /var/www/boss-ai/backend
mkdir katya-service
cd katya-service
tar -xzf ~/katya-service.tar.gz
\`\`\`

## 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env

\`\`\`bash
cp .env.example .env
nano .env
\`\`\`

–ó–∞–ø–æ–ª–Ω–∏—Ç—å:
\`\`\`env

# Telegram Bot

TELEGRAM_BOT_TOKEN=<–ø–æ–ª—É—á–∏—Ç—å –æ—Ç @BotFather>
TELEGRAM_BOT_USERNAME=katya_boss_ai_bot

# Database (shared)

DB_PATH=/var/www/boss-ai/backend/ozon-manager/data/ozon_manager.db

# API Gateway

API_GATEWAY_URL=http://localhost:3000

# System Token (–¥–ª—è TG –±–µ–∑ –±–∏–ª–ª–∏–Ω–≥–∞)

SYSTEM_TOKEN=<–≤–∑—è—Ç—å –∏–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã>

# Features

ANONYMIZE_PII=false # true –¥–ª—è production —Å –ü–î
\`\`\`

## 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

\`\`\`bash
sqlite3 /var/www/boss-ai/backend/ozon-manager/data/ozon_manager.db < migrations.sql
\`\`\`

## 4. –î–æ–±–∞–≤–∏—Ç—å –≤ PM2

–û–±–Ω–æ–≤–∏—Ç—å `ecosystem.config.js`:

\`\`\`javascript
{
name: "boss-ai-katya-service",
script: "dist/index.js",
cwd: "/var/www/boss-ai/backend/katya-service",
instances: 1,
exec_mode: "fork",
env: {
NODE_ENV: "production",
PORT: 4300,
DB_PATH: "/var/www/boss-ai/backend/ozon-manager/data/ozon_manager.db",
API_GATEWAY_URL: "http://localhost:3000",
LOG_LEVEL: "info"
},
env_file: "/var/www/boss-ai/backend/katya-service/.env",
error_file: "./logs/katya_err.log",
out_file: "./logs/katya_out.log",
log_file: "./logs/katya_combined.log",
time: true,
autorestart: true,
watch: false,
max_memory_restart: "512M"
}
\`\`\`

–ó–∞–ø—É—Å—Ç–∏—Ç—å:
\`\`\`bash
pm2 start ecosystem.config.js --only boss-ai-katya-service
pm2 save
\`\`\`

## 5. –î–æ–±–∞–≤–∏—Ç—å katya.routes.ts –≤ API Gateway

–°–º. —Å–µ–∫—Ü–∏—é "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API Gateway" –≤ –¢–ó.

–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å:
\`\`\`bash
cd /var/www/boss-ai/backend/main
npm run build
pm2 restart boss-ai-api-gateway
\`\`\`

## 6. –î–æ–±–∞–≤–∏—Ç—å katya-service.json –≤ frontend

\`\`\`bash
cp katya-service.json /var/www/boss-ai/frontend/public/services/
cd /var/www/boss-ai/frontend
npm run build
\`\`\`

## 7. –ü—Ä–æ–≤–µ—Ä–∫–∞

- Katya Service: http://localhost:4300/health
- API Gateway proxy: http://localhost:3000/api/katya/health
- Frontend: https://boss-ai.online (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞)

\`\`\`bash
pm2 logs boss-ai-katya-service --lines 50
\`\`\`
\`\`\`

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –†–ê–ó–†–ê–ë–û–¢–ö–ò –î–õ–Ø –ù–ò–ö–û–õ–ê–Ø

### –≠—Ç–∞–ø 1: Backend Core (3-4 –¥–Ω—è)

- [ ] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Express server (port 4300)
- [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite –ë–î Boss AI
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü (chat_messages, chat_summaries, etc.)
- [ ] Health check endpoint (`/health`)
- [ ] Logger setup

### –≠—Ç–∞–ø 2: PlatformGPTService (2 –¥–Ω—è)

- [ ] –ö–ª–∞—Å—Å `PlatformGPTService`
- [ ] –ú–µ—Ç–æ–¥ `summarize()` —á–µ—Ä–µ–∑ `/api/ai/chatgpt`
- [ ] –ú–µ—Ç–æ–¥ `searchAndRank()`
- [ ] –ú–µ—Ç–æ–¥ `answer()`
- [ ] –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è GPT (–≤ `utils/prompts.ts`)
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–æ—Å–æ–±–µ–Ω–Ω–æ 402 Insufficient funds)

### –≠—Ç–∞–ø 3: API Routes (2 –¥–Ω—è)

- [ ] POST `/summarize` - —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è
- [ ] POST `/search` - –ø–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏
- [ ] POST `/question` - –≤–æ–ø—Ä–æ—Å –∫ –ö–∞—Ç–µ
- [ ] GET `/decisions` - —Å–ø–∏—Å–æ–∫ —Ä–µ—à–µ–Ω–∏–π
- [ ] GET/PUT `/settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ user
- [ ] GET `/history` - –∏—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### –≠—Ç–∞–ø 4: Database Repositories (2 –¥–Ω—è)

- [ ] `MessagesRepository` - CRUD –¥–ª—è chat_messages
- [ ] `SummariesRepository` - CRUD –¥–ª—è chat_summaries
- [ ] `ContextsRepository` - CRUD –¥–ª—è chat_contexts
- [ ] `KnowledgeRepository` - CRUD –¥–ª—è knowledge_base
- [ ] `SettingsRepository` - CRUD –¥–ª—è katya_user_settings

### –≠—Ç–∞–ø 5: Telegram Bot (3 –¥–Ω—è)

- [ ] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ (polling)
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ @–ö–∞—Ç—è —É–ø–æ–º–∏–Ω–∞–Ω–∏–π
- [ ] –ö–æ–º–∞–Ω–¥—ã: `/summary`, `/search`, `/decisions`
- [ ] Inline keyboards
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ callback_query

### –≠—Ç–∞–ø 6: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏ (2 –¥–Ω—è)

- [ ] `AnonymizerService` –¥–ª—è 152-–§–ó
- [ ] LRU –∫—ç—à –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è (–∫–∞–∂–¥—ã–µ N —Å–æ–æ–±—â–µ–Ω–∏–π)

### –≠—Ç–∞–ø 7: Testing (2-3 –¥–Ω—è)

- [ ] Unit —Ç–µ—Å—Ç—ã –¥–ª—è PlatformGPTService
- [ ] Integration —Ç–µ—Å—Ç—ã –¥–ª—è routes
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Telegram –±–æ—Ç–∞
- [ ] E2E —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π
- [ ] Performance —Ç–µ—Å—Ç—ã (100+ —Å–æ–æ–±—â–µ–Ω–∏–π)

### –≠—Ç–∞–ø 8: Documentation & Packaging (1 –¥–µ–Ω—å)

- [ ] README.md (–∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ)
- [ ] INTEGRATION.md (–∫–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Boss AI)
- [ ] API Documentation (endpoints)
- [ ] .env.example —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- [ ] migrations.sql
- [ ] –°–æ–∑–¥–∞—Ç—å tar.gz –∞—Ä—Ö–∏–≤

**–ò—Ç–æ–≥–æ:** ~18-22 –¥–Ω–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## üìã –ß–¢–û –ü–û–õ–£–ß–ò–¢ –ù–ò–ö–û–õ–ê–ô –î–õ–Ø –°–¢–ê–†–¢–ê

### –û—Ç @boss –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã:

1. **OpenAI API –∫–ª—é—á** (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

   ```
   OPENAI_API_KEY=sk-proj-...
   ```

2. **–ö–æ–ø–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î** (SQLite —Ñ–∞–π–ª)

   ```bash
   test_db.sqlite (—Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)
   ```

3. **Telegram —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç —Ç–æ–∫–µ–Ω**

   ```
   TELEGRAM_BOT_TOKEN=123456:ABC-DEF...
   ```

4. **–ê—Ä—Ö–∏–≤ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏** (`katya-references.tar.gz`)

   ```
   - ozon-manager/ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞)
   - ai-routes-reference.ts (–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç GPT endpoint)
   - chatgpt-service.json (service config –ø—Ä–∏–º–µ—Ä)
   - test-db.sql (—Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –ë–î)
   - postman-collection.json (API —Ç–µ—Å—Ç—ã)
   ```

5. **–î–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**
   - –≠—Ç–æ –¢–ó (`KATYA_BOT_TZ_v3_FINAL.md`)
   - README –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
   - –°—Ö–µ–º–∞ –ë–î –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

### Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```
–î–µ–Ω—å 1-2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
‚îú‚îÄ‚îÄ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∫–ª—é—á–∞–º–∏
‚îú‚îÄ‚îÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –ë–î
‚îî‚îÄ‚îÄ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OpenAI

–î–µ–Ω—å 3-5: Backend Core
‚îú‚îÄ‚îÄ Express server + routes
‚îú‚îÄ‚îÄ DirectGPTClient (–¥–ª—è dev)
‚îú‚îÄ‚îÄ Database repositories
‚îî‚îÄ‚îÄ –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

–î–µ–Ω—å 6-8: Telegram Bot
‚îú‚îÄ‚îÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
‚îú‚îÄ‚îÄ Handlers (@–ö–∞—Ç—è —É–ø–æ–º–∏–Ω–∞–Ω–∏—è)
‚îú‚îÄ‚îÄ –¢–µ—Å—Ç—ã —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º
‚îî‚îÄ‚îÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DirectGPTClient

–î–µ–Ω—å 9-11: PlatformGPTService
‚îú‚îÄ‚îÄ HTTP –∫–ª–∏–µ–Ω—Ç –∫ API Gateway
‚îú‚îÄ‚îÄ AIClientFactory –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ Mock —Ä–µ–∂–∏–º
‚îî‚îÄ‚îÄ Unit —Ç–µ—Å—Ç—ã

–î–µ–Ω—å 12-14: –û—Å—Ç–∞–ª—å–Ω—ã–µ endpoints
‚îú‚îÄ‚îÄ /search, /question, /decisions
‚îú‚îÄ‚îÄ Settings, History
‚îî‚îÄ‚îÄ Integration —Ç–µ—Å—Ç—ã

–î–µ–Ω—å 15-17: –ü–æ–ª–∏—Ä–æ–≤–∫–∞
‚îú‚îÄ‚îÄ Error handling
‚îú‚îÄ‚îÄ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–µ–Ω—å 18-20: –£–ø–∞–∫–æ–≤–∫–∞
‚îú‚îÄ‚îÄ –°–æ–∑–¥–∞—Ç—å production .env.example
‚îú‚îÄ‚îÄ INTEGRATION.md
‚îú‚îÄ‚îÄ –ê—Ä—Ö–∏–≤ katya-service.tar.gz
‚îî‚îÄ‚îÄ –ü–µ—Ä–µ–¥–∞—Ç—å @boss
```

**–ò—Ç–æ–≥–æ:** ~18-22 –¥–Ω–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ + —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìä –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–¥–ª—è –ù–∏–∫–æ–ª–∞—è)

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ë–î Boss AI –ª–æ–∫–∞–ª—å–Ω–æ (SQLite)
cp /path/to/ozon_manager.db ./data/

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å Katya Service
npm run dev

# 3. –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ /summarize
curl -X POST http://localhost:4300/summarize \
  -H "Authorization: Bearer <test_token>" \
  -H "Content-Type: application/json" \
  -d '{
    "chatId": 123456,
    "messageCount": 10,
    "query": "–ü–æ–¥–≤–µ–¥–∏ –∏—Ç–æ–≥–∏"
  }'

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "success": true,
  "data": {
    "summary": "...",
    "topics": ["—Ç–µ–º–∞1"],
    "decisions": [],
    "keywords": ["–∫–ª—é—á1"]
  }
}
```
````

### Integration —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å API Gateway
cd /var/www/boss-ai/backend/main
npm run dev

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å Katya Service
cd /var/www/boss-ai/backend/katya-service
npm run dev

# 3. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ API Gateway
curl -X POST http://localhost:3000/api/katya/summarize \
  -H "Authorization: Bearer <real_user_token>" \
  -H "Content-Type: application/json" \
  -d '{"chatId": 123, "messageCount": 20}'
```

### Telegram Bot —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. –ü–æ–ª—É—á–∏—Ç—å token
3. –î–æ–±–∞–≤–∏—Ç—å –≤ `.env`: `TELEGRAM_BOT_TOKEN=...`
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Katya Service
5. –ù–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É: `/start`
6. –ù–∞–ø–∏—Å–∞—Ç—å: `@–ö–∞—Ç—è, –ø—Ä–∏–≤–µ—Ç!`
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç

---

## üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –î–û–ë–ê–í–õ–ï–ù–ò–Æ –°–ï–†–í–ò–°–ê –í –ü–õ–ê–¢–§–û–†–ú–£

### –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–∞ (–ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–∞ –æ—Ç –ù–∏–∫–æ–ª–∞—è):

#### –®–∞–≥ 1: –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å

```bash
cd /var/www/boss-ai/backend
mkdir katya-service
cd katya-service
tar -xzf ~/katya-service.tar.gz
cp .env.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

#### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

```bash
sqlite3 /var/www/boss-ai/backend/ozon-manager/data/ozon_manager.db < migrations.sql
```

#### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å API Gateway

```bash
cd /var/www/boss-ai/backend/main/src/routes
# –°–æ–∑–¥–∞—Ç—å katya.routes.ts (–∫–æ–¥ –≤—ã—à–µ)

# –î–æ–±–∞–≤–∏—Ç—å –≤ index.ts:
# import katyaRoutes from './routes/katya.routes';
# this.app.use(katyaRoutes);

cd /var/www/boss-ai/backend/main
npm run build
```

#### –®–∞–≥ 4: –û–±–Ω–æ–≤–∏—Ç—å PM2

```bash
nano /var/www/boss-ai/ecosystem.config.js
# –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é katya-service (—Å–º. –≤—ã—à–µ)

pm2 start ecosystem.config.js --only boss-ai-katya-service
pm2 restart boss-ai-api-gateway
pm2 save
```

#### –®–∞–≥ 5: –î–æ–±–∞–≤–∏—Ç—å frontend config

```bash
cp katya-service.json /var/www/boss-ai/frontend/public/services/
cd /var/www/boss-ai/frontend
npm run build
```

#### –®–∞–≥ 6: –û–±–Ω–æ–≤–∏—Ç—å Nginx (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
sudo systemctl reload nginx
```

#### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# Health checks
curl http://localhost:4300/health
curl http://localhost:3000/api/katya/health

# PM2 —Å—Ç–∞—Ç—É—Å
pm2 status
pm2 logs boss-ai-katya-service --lines 20

# Frontend
# –û—Ç–∫—Ä—ã—Ç—å https://boss-ai.online
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ "–ö–∞—Ç—è AI"
```

---

## üí° –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò –ò BEST PRACTICES

### 1. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

```typescript
// src/utils/cache.ts
import LRU from "lru-cache";

export class RequestCache {
  private cache: LRU<string, any>;

  constructor(max: number = 100) {
    this.cache = new LRU({
      max,
      ttl: 1000 * 60 * 15, // 15 –º–∏–Ω—É—Ç
    });
  }

  get(key: string): any | undefined {
    return this.cache.get(key);
  }

  set(key: string, value: any): void {
    this.cache.set(key, value);
  }

  generateKey(chatId: number, messageCount: number): string {
    return `summary_${chatId}_${messageCount}`;
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
const cache = new RequestCache();
const cacheKey = cache.generateKey(chatId, messageCount);
const cached = cache.get(cacheKey);
if (cached) return cached;
// ... –∑–∞–ø—Ä–æ—Å –∫ GPT
cache.set(cacheKey, summary);
```

### 2. Rate Limiting –¥–ª—è Telegram

```typescript
const rateLimiter = new Map<number, number>(); // userId -> last request timestamp

function checkRateLimit(userId: number): boolean {
  const last = rateLimiter.get(userId) || 0;
  const now = Date.now();

  if (now - last < 10000) {
    // 10 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
    return false;
  }

  rateLimiter.set(userId, now);
  return true;
}
```

### 3. Graceful Shutdown

```typescript
// src/index.ts
process.on("SIGTERM", async () => {
  console.log("SIGTERM received, shutting down gracefully...");

  // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Telegram –±–æ—Ç
  await telegramBot.stop();

  // –ó–∞–∫—Ä—ã—Ç—å –ë–î —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
  db.close();

  // –ó–∞–∫—Ä—ã—Ç—å HTTP server
  server.close(() => {
    console.log("Server closed");
    process.exit(0);
  });
});
```

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –ü–û–î–î–ï–†–ñ–ö–ê

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** –ù–∏–∫–æ–ª–∞–π
**–ò–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä:** @boss (Boss AI Team)
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `/var/www/boss-ai/backend/katya-service`
**–õ–æ–≥–∏:** `pm2 logs boss-ai-katya-service`
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `docs/KATYA_BOT_TZ_v3_FINAL.md`

---

## ‚úÖ –§–ò–ù–ê–õ–¨–ù–´–ô –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò

### –î–ª—è –ù–∏–∫–æ–ª–∞—è (–ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π):

- [ ] –í—Å–µ endpoints —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] Telegram –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ `/api/ai/chatgpt` —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –Ω–∞–ø–∏—Å–∞–Ω—ã
- [ ] Unit —Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] README.md –∏ INTEGRATION.md –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- [ ] .env.example —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- [ ] –°–æ–∑–¥–∞–Ω tar.gz –∞—Ä—Ö–∏–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ —á–∏—Å—Ç–æ–π Ubuntu 20.04

### –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–∞ (–ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è):

- [ ] –ê—Ä—Ö–∏–≤ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω –≤ `/var/www/boss-ai/backend/katya-service`
- [ ] .env –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] PM2 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞
- [ ] API Gateway –æ–±–Ω–æ–≤–ª–µ–Ω (katya.routes.ts)
- [ ] Frontend config –¥–æ–±–∞–≤–ª–µ–Ω (katya-service.json)
- [ ] –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω—ã
- [ ] Health checks –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –¢–µ—Å—Ç —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Telegram –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ @–ö–∞—Ç—è

---

**üéØ –¢–ó v3.0 FINAL –≥–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏!**

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ v3.0:**

- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `/api/ai/chatgpt` (—ç–∫–æ–Ω–æ–º–∏—è)
- ‚úÖ –ï–¥–∏–Ω—ã–π –±–∏–ª–ª–∏–Ω–≥ (–Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
- ‚úÖ –û–¥–∏–Ω OpenAI API –∫–ª—é—á (–ø—Ä–æ—â–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
- ‚úÖ 152-–§–ó –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–≥–∏–±–∫–æ—Å—Ç—å)
- ‚úÖ –ü–æ–ª–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–ø—Ä–æ—Å—Ç–æ—Ç–∞)

–ù–∏–∫–æ–ª–∞–π, —É—Å–ø–µ—Ö–æ–≤ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ! üöÄ
